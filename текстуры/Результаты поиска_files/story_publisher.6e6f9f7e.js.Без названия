(()=>{"use strict";var e,t,r,s,i,o,a={716578:(e,t,r)=>{function s(){return{icon:'<svg fill="none" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M16.87 2c1.79 0 2.43.19 3.08.53.66.35 1.17.86 1.52 1.52s.53 1.3.53 3.08v9.74c0 1.79-.19 2.43-.53 3.08a3.63 3.63 0 0 1-1.52 1.52c-.65.34-1.3.53-3.08.53H7.13c-1.79 0-2.43-.19-3.08-.53s-1.17-.86-1.52-1.52C2.2 19.3 2 18.65 2 16.87V7.13c0-1.79.19-2.43.53-3.08.35-.66.86-1.17 1.52-1.52C4.7 2.2 5.35 2 7.13 2zm.57 2H6.56c-.89 0-1.21.1-1.54.27-.32.17-.58.43-.75.75-.18.33-.27.65-.27 1.54v10.88c0 .89.1 1.21.27 1.54.17.32.43.58.75.75.33.18.65.27 1.54.27h10.88c.89 0 1.21-.1 1.54-.27.32-.17.58-.43.75-.75.18-.33.27-.65.27-1.54V6.56c0-.89-.1-1.21-.27-1.54a1.82 1.82 0 0 0-.75-.75c-.33-.18-.65-.27-1.54-.27z" fill="currentColor"/></svg>',name:"check_box_off_24"}}r.d(t,{getIcon24CheckBoxOff:()=>s})},193086:(e,t,r)=>{function s(){return{icon:'<svg fill="none" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M2.44 4.18C2 5.04 2 6.16 2 8.4v7.2c0 2.24 0 3.36.44 4.22a4 4 0 0 0 1.74 1.74c.86.44 1.98.44 4.22.44h7.2c2.24 0 3.36 0 4.22-.44a4 4 0 0 0 1.74-1.74c.44-.86.44-1.98.44-4.22V8.4c0-2.24 0-3.36-.44-4.22a4 4 0 0 0-1.74-1.74C18.96 2 17.84 2 15.6 2H8.4c-2.24 0-3.36 0-4.22.44a4 4 0 0 0-1.74 1.74zM18.2 9.21a1 1 0 0 0-1.42-1.42L10 14.6l-2.8-2.8a1 1 0 0 0-1.4 1.42l3.5 3.5a1 1 0 0 0 1.4 0z" fill="currentColor" fill-rule="evenodd"/></svg>',name:"check_box_on_24"}}r.d(t,{getIcon24CheckBoxOn:()=>s})},340257:(e,t,r)=>{r.d(t,{API_VERSION:()=>s,BRIDGE_STAT_CALL_ARGUMENTS_MAX_LENGTH:()=>w,CLOSE_STATUS:()=>p,ERROR_CODES:()=>n,ERROR_REASONS:()=>c,ERROR_TYPES:()=>d,GROUP_STATUS:()=>_,MAX_COUNT_OF_APP_INIT:()=>R,NFT_APP_ID:()=>S,ONE_TIME_DONUT_APP_ID:()=>v,ORD_APP_ID:()=>f,OZON_APP_ID:()=>g,PERMISSION_TYPES:()=>l,PLATFORM:()=>a,PMC_PART_CONFIG_KEY_LONG_ID:()=>A,SITPOSTING_APP_ID:()=>m,TEXTLIVE_APPS:()=>h,THROTTLE_SCROLL_TIME:()=>i,VKPAY_APPS:()=>u,VKPAY_TRANSACTION_EVENT:()=>o,VK_CONNECT_EVENTS:()=>b,VK_CONNECT_SUPERAPPKIT_EVENT_TYPE:()=>k,VMOJI_CONSTRUCTOR_APP_ID:()=>E});const s="5.95",i=200,o="VKWebAppActionDone",a={WEB:"web",MOBILE_WEB:"mobile-web"},n={UNKNOWN:1,MISSING_PARAM:2,OLD_MISSING_PARAM:100,CONNECTION_LOST:3,USER_DENIED:4,INVALID_PARAMS:5,UNSUPPORTED_PLATFORM:6,REQUESTS_LIMIT_REACHED:10,ACCESS_DENIED:11,CUSTOM:13,NO_ADS:20},c={ACCESS_DENIED:"Access denied",UNSUPPORTED_PLATFORM:"Unsupported platform",UNSUPPORTED_ACTION:"Unsupported action",NATIVE_APP_IS_NOT_INSTALLED:"VK client is not installed on device",USER_NOT_A_PRIVATE_GROUP_MEMBER:"User is not a member of the given private group",UNKNOWN_ERROR:"Unknown error",CONNECTION_LOST:"Connection lost",NETWORK_ERROR:"Network error",USER_DENIED:"User denied",INVALID_PARAMS:"Invalid params",NO_ADS:"No ads",ADS_ALREADY_PLAYED:"Ads already played",VK_PAY_DISABLED:"This app can't use VK Pay",SCROLL_SUBSCRIBER_ALREADY_EXIST:"Scroll subscriber already exist",SUBSCRIPTION_IS_ALREADY_CANCELLED:"Subscription is in invalid status: subscription is already cancelled",SURVEY_INIT_IN_PROGRESS:"Survey init in progress",SURVEY_ALREADY_INIT:"Survey already init",SURVEY_NO_MATCH:"Survey no match",SURVEY_USER_CANCEL:"Survey user cancel",ALREADY_IN_PROGRESS:"Already in progress",USER_IS_NOT_GROUP_ADMIN:"Only group admins have access to group tokens",DEVICE_CANT_GET_GEODATA:"Device can't get geodata",USER_DIDNT_ALLOWED_ACTION:"User didn't allowed"},d={CLIENT:"client_error",API:"api_error",AUTH:"auth_error"},l={DENIED:"denied",PROMPT:"prompt",GRANTED:"granted"},p=["success","failed"],_={OPEN:0,CLOSED:1,PRIVATE:2},u=[6217559,7131443],h=[7512376],f=51707812,S=51459963,m=7644481,E=7929683,v=51528700,g=51903384,b={VKWebAppAddToCommunity:"add_to_community",VKWebAppAddToCommunityPreload:"get_groups_list",VKWebAppAddToFavorites:"add_to_favorites",VKWebAppAddToFavoritesPreload:"already_added_to_favorites",VKWebAppAddToMenu:"add_to_menu",VKWebAppAddToMenuPreload:"is_in_left_menu",VKWebAppGetCommunityToken:"get_community_token",VKWebAppGetCommunityTokenPreload:"get_community_preload_settings",VKWebAppGetAuthToken:"get_auth_token",VKWebAppGetAuthTokenPreload:"get_auth_token_info",VKWebAppGetPhoneNumber:"get_phone_number",VKWebAppGetPhoneNumberPreload:"already_get_phone_number",VKWebAppGetEmail:"get_email",VKWebAppGetEmailPreload:"already_get_email",VKWebAppGetFriends:"get_friends",VKWebAppAllowNotificationsPreload:"are_notifications_allowed",VKWebAppAllowNotifications:"allow_notifications",VKWebAppDenyNotifications:"deny_notifications",VKWebAppAllowMessagesFromGroup:"allow_messages_from_group",VKWebAppAllowMessagesFromGroupPreload:"can_send_messages_from_group",VKWebAppJoinGroup:"join_group",VKWebAppJoinGroupPreload:"is_group_member",VKWebAppLeaveGroup:"leave_group",VKWebAppLeaveGroupPreload:"is_group_member",VKWebAppOpenApp:"open_app",VKWebAppSendPayload:"send_payload",VKWebAppSendToClient:"send_to_client",VKWebAppSendToClientPreload:"get_open_in_native_permission",VKWebAppShowOrderBox:"order",VKWebAppShowSubscriptionBox:"subscription",VKWebAppShowLeaderBoardBox:"show_leader_board",VKWebAppShowLinkCardBox:"show_link_card",VKWebAppShowNftPaymentBox:"show_nft_pay_box",VKWebAppShowInviteBox:"invite_friends",VKWebAppShowStoryBox:"story_box",VKWebAppShowRequestBox:"send_request",VKWebAppShowRequestBoxPreload:"request_box_preload",VKWebAppStorageGetKeys:"storage_get_keys",VKWebAppStorageSet:"storage_set",VKWebAppStorageGet:"storage_get",VKWebAppOpenArticleEditor:"open_article_edit",VKWebAppSubscribeStoryApp:"subscribe_story_app",VKWebAppClose:"close",VKWebAppGetSilentToken:"get_silent_token",VKWebAppCheckAllowedScopes:"check_allowed_scopes",VKWebAppOpenPayForm:"open_pay_form",VKWebAppCheckSurvey:"check_survey",VKWebAppShowSurvey:"show_survey",VKWebAppAddToChat:"add_to_chat",VKWebAppTrackEvent:"track_event",VKWebAppCallStart:"call_start",VKWebAppCallJoin:"call_join",VKWebAppCallLeft:"call_left",VKWebAppCallFinished:"call_finished",VKWebAppCallGetStatus:"call_get_status",VKWebAppCallStartSharing:"call_start_sharing",VKWebAppCallStopSharing:"call_stop_sharing"},k="vk-sak-sdk",A="mini_apps_long_id",w=256,R=1},391016:(e,t,r)=>{r.d(t,{Handler:()=>_});var s=r(961019),i=r(499061),o=r(288326),a=r(340257),n=r(705744),c=r(7144),d=r(581903),l=r(407033),p=r(476726);class _{get successDescriptor(){return`${this.params.originalHandlerName||this.params.handlerName}Result`}get errorDescriptor(){return`${this.params.originalHandlerName||this.params.handlerName}Failed`}get previousCallsCount(){return this.app?.context?.getHandlerCallsCount(this.params.handlerName)-1||0}shouldLogStat(){return!0}shouldLogCallArgumentsInStat(){return(0,p.partConfigEnabled)("mini_apps_send_stat_arguments_bridge_events")&&Array.isArray(this.app?.bridgeMethodsToBeLogged)&&this.app.bridgeMethodsToBeLogged.includes(this.params.handlerName)}getEventHash(e=!1){return cur.app.options[`${a.VK_CONNECT_EVENTS[`${this.params.handlerName}${e?"Preload":""}`]}_hash`]}getEventHashes(e=!1){return cur.app.options[`${a.VK_CONNECT_EVENTS[`${this.params.handlerName}${e?"Preload":""}`]}_hashes`]}getEventName(e=!1){return a.VK_CONNECT_EVENTS[`${this.params.handlerName}${e?"Preload":""}`]}sendNetworkError(){this.errorHandler({code:a.ERROR_CODES.UNKNOWN,error_type:a.ERROR_TYPES.CLIENT,reason:a.ERROR_REASONS.UNKNOWN_ERROR})}sendConnectionLostError(){this.errorHandler({code:a.ERROR_CODES.CONNECTION_LOST,error_type:a.ERROR_TYPES.CLIENT,reason:a.ERROR_REASONS.CONNECTION_LOST})}sendUserDeniedError(){this.errorHandler({code:a.ERROR_CODES.USER_DENIED,error_type:a.ERROR_TYPES.CLIENT,reason:a.ERROR_REASONS.USER_DENIED})}handleApiError(e){const t=e?.error,r=t?.error_msg,s=t?.error_code;if(s)switch(s){case l.API_ERROR_ACCESS:this.errorHandler({code:a.ERROR_CODES.ACCESS_DENIED,error_type:a.ERROR_TYPES.CLIENT,reason:r});break;case l.API_ERROR_PARAM:this.errorHandler({code:a.ERROR_CODES.INVALID_PARAMS,error_type:a.ERROR_TYPES.CLIENT,reason:r});break;default:this.errorHandler({code:a.ERROR_CODES.CUSTOM,error_type:a.ERROR_TYPES.CLIENT,reason:r||a.ERROR_REASONS.UNKNOWN_ERROR})}else this.errorHandler({code:a.ERROR_CODES.CONNECTION_LOST,error_type:a.ERROR_TYPES.CLIENT,reason:r||a.ERROR_REASONS.UNKNOWN_ERROR})}sendCustomError(e){this.errorHandler({code:a.ERROR_CODES.CUSTOM,reason:e||a.ERROR_REASONS.UNKNOWN_ERROR})}checkParams(e,t){for(let r=0;r<t.length;r++){const{param:s,type:i,isRequired:o,extraChecks:n}=t[r];if(!e.hasOwnProperty(s)&&o)return this.errorHandler({code:a.ERROR_CODES.MISSING_PARAM,reason:`Missing required param "${s}"`}),!1;if(e.hasOwnProperty(s)&&typeof e[s]!==i)return this.errorHandler({code:a.ERROR_CODES.INVALID_PARAMS,reason:`Param "${s}" should be ${i}`},this.callback),!1;if(e.hasOwnProperty(s)&&n&&n.length>0)for(let t=0;t<n.length;t++)if(!n[t].check(e[s]))return this.errorHandler({code:a.ERROR_CODES.INVALID_PARAMS,reason:n[t].error(s)},this.callback),!1}return!0}actionHandler(e){return this.callApi?ajax.post("apps.php",{act:"handle_vk_connect_event",hash:this.getEventHash(),event:this.getEventName(),app_id:this.app.appId,...e},{onDone:t=>{this.handleResponse(t,e,this.checkResponse)},onFail:e=>(this.errorHandler(e),!0)}):{}}checkResponse(e){1===e||0===e?this.successHandler(Boolean(e)):this.successHandler(e)}scopeStringToArray(e){return e?e.replace(/ /g,"").split(","):[]}denyUIAction(){this.errorHandler({error_type:"client_error",code:a.ERROR_CODES.USER_DENIED},null),s.default.pop(this.modal)}allowUIAction(e){this.actionHandler(e),s.default.pop(this.modal)}createDenyUIAction(e){this.params.modal.cancelAction=void 0!==e?()=>this.denyUIAction(e):this.denyUIAction}createAllowUIAction(e){this.params.modal.allowAction=void 0!==e?()=>this.allowUIAction(e):this.allowUIAction}launchUI(e){this.createDenyUIAction(),this.createAllowUIAction(),this.modal=new o.UIAction({...this.params.modal,...e}),s.default.push(this.modal)}_enhanceBtnsWithActions(){this.params.modal.buttons&&this.params.modal.buttons.forEach(((e,t)=>{"deny"===e.type?this.params.modal.buttons[t].action=this.params.modal.cancelAction:this.params.modal.buttons[t].action=this.params.modal.allowAction}))}setData(e,t,r=null){r&&(this.callback=r),e.request_id&&(this.params.request_id=e.request_id),this.params.modal||(this.params.modal={}),e.containerId&&(this.params.modal.containerId=e.containerId),e.pic&&(this.params.modal.pic=e.pic),this.app=t,this.shouldLogCallArgumentsInStat()&&(this.callArguments=e)}handleResponse(e,t,r,s){try{const s=JSON.parse(e);s.hasOwnProperty("error")?this.errorHandler(s.error):r(s,t)}catch(e){s?s(e):this.errorHandler(e)}}handler(e,t,r){if(this.setData(e,t),this.callback=r,this.isWebOnly&&(0,n.isMvk)()||this.isMobileWebOnly&&!(0,n.isMvk)())return this.errorHandler({code:a.ERROR_CODES.UNSUPPORTED_PLATFORM,error_type:a.ERROR_TYPES.CLIENT,reason:a.ERROR_REASONS.UNSUPPORTED_PLATFORM});this.useUI?this.launchUI(e):this.useUI||this.actionHandler(e)}getAppWebviewUrl(){return cur.app.frame.src}cleanCallArguments(e){const t=["request_id","handlerName","method","modal","containerId","pic"];for(const r of t)delete e[r];return e}getSerializedCallArguments(){if(!this.shouldLogCallArgumentsInStat()||!this.callArguments)return null;const e=this.cleanCallArguments({...this.callArguments});let t=JSON.stringify(e);return t.length>a.BRIDGE_STAT_CALL_ARGUMENTS_MAX_LENGTH&&(t=null),t}successHandler(e,t=void 0){if("function"==typeof t&&t(),(0,c.isObject)(e)||(e={result:e}),this.params.request_id&&e&&(e.request_id=this.params.request_id),this.callback({type:this.successDescriptor,data:e},this.params.handlerName),(0,n.isMvk)()&&cur.app.frame.focus(),this.shouldLogStat()){const e=this.getSerializedCallArguments();d.bridgeEventItemStat.logEvent(this.getAppWebviewUrl(),this.app.appId,{event_type:this.params.handlerName,is_success:!0,...e?{call_arguments:e}:{}},void 0,this.app.vkApp.sessionUuid)}}errorHandler(e,t,r){"string"==typeof e&&(e={reason:e}),this.params.request_id&&e&&(e.request_id=this.params.request_id);const s=new i.default(this.errorDescriptor,e,r),o=s.selectErrorType();if("function"==typeof t&&t(o),this.callback(o),(0,n.isMvk)()&&cur.app.frame.focus(),this.shouldLogStat()){const e=this.getSerializedCallArguments();d.bridgeEventItemStat.logEvent(this.getAppWebviewUrl(),this.app.appId,{event_type:this.params.handlerName,is_success:!1,...e?{call_arguments:e}:{}},{error_type:s.type||a.ERROR_TYPES.CLIENT,error_code:s.data.code||a.ERROR_CODES.UNKNOWN},this.app.vkApp.sessionUuid,s.getReadableMessage())}}constructor(e={}){this.params={handlerName:"handler",method:"method",...e},this.callApi=!0,this.useUI=!1,this.callback=null,this.modal=null,this.isWebOnly=!1,this.isMobileWebOnly=!1,this.callArguments=null,this.actionHandler=this.actionHandler.bind(this),this.errorHandler=this.errorHandler.bind(this),this.successHandler=this.successHandler.bind(this),this.denyUIAction=this.denyUIAction.bind(this),this.allowUIAction=this.allowUIAction.bind(this),cur.vkAppSuccessHandler=this.successHandler,cur.vkAppErrorHandler=this.errorHandler,this.checkResponse=this.checkResponse.bind(this),this.getSerializedCallArguments=this.getSerializedCallArguments.bind(this)}}},712466:(e,t,r)=>{r.d(t,{VKWebAppCustomMessage:()=>l});var s=r(603943),i=r(87223),o=r(391016),a=r(957081),n=r(705744),c=r(340257),d=r(76773);window.VKWebAppCustomMessageExternalHandlers=window.VKWebAppCustomMessageExternalHandlers??{};class l extends o.Handler{actionHandler(e){if(e.action&&e.payload){if(this.app.isTextliveApp){const t=window.Textlives?.onBridgeEvent(e);return void(t&&t.then(this.successHandler).catch(this.errorHandler))}if(this.app.appId===c.NFT_APP_ID)return this.handleSetNftAvatar(e),void this.successHandler({result:!0});if(this.app.appId===c.ORD_APP_ID)return this.handleSetOrdData(e),void this.successHandler({result:!0});if(this.app.appId===c.VMOJI_CONSTRUCTOR_APP_ID)return this.handleOpenStickerPicker(e),void this.successHandler({result:!0});if(this.app.appId===c.OZON_APP_ID&&window.cur?.handleOzonAppCustomMessage&&"function"==typeof window.cur.handleOzonAppCustomMessage)return window.cur.handleOzonAppCustomMessage(e),void this.successHandler({result:!0});if(this.app.appId===c.ONE_TIME_DONUT_APP_ID){try{this.handleWithExternalHandlers(e)}catch(e){(0,i.logError)(e)}return void this.successHandler({result:!0})}}this.errorHandler("unknown error")}handleSetNftAvatar({action:e,payload:t}){"VKWebAppSetNFTAvatar"===e&&((0,n.isMvk)()?window.OwnerPhotoUpload2.setNftAvatar(t):window.ajax.post("al_page.php",{act:"owner_avatar_upload",oid:t?.oid},{onDone:(e,r)=>{window.handleVKBridgeSetNftAvatar(t,e,r)}}))}handleOpenStickerPicker({action:e,payload:t}){if("vmoji_character_recereate"!==e)return;const{promo:r,page:i}=t;r&&(0,a.isNewStickerPicker)()&&!(0,n.isMvk)()&&(window.StickerPickerViewer?.showLastPicker(s.ServicePackKey.VMOJI),i?.match("/preview")||window.stManager.add(window.jsc("web/vmoji.js")).then((()=>{window.Vmoji.showAddedToStickerSnackbar()})))}handleSetOrdData({action:e,payload:t}){"ord_data"===e&&t&&(0,d.getStore)().onOrdData({is_ad:t.isAd||!1,ord_pred_id:t.predId||"",erid:t.erId||""})}handleWithExternalHandlers(e){window.VKWebAppCustomMessageExternalHandlers[e.action]?.(e.payload)}constructor(e){super(e),this.params.handlerName="VKWebAppCustomMessage"}}},334052:(e,t,r)=>{r.d(t,{ModalStackOld:()=>s});class s{push(e){e.init(),this.checkStack(),0===cur.vkMiniAppsStack.length&&e.show(),cur.vkMiniAppsStack.push(e)}clearLayerPopups(){this.checkStack(),cur.vkMiniAppsStack.length>0&&(cur.vkMiniAppsStack=cur.vkMiniAppsStack.filter((e=>!~e.appNode.id.indexOf("container_layer"))))}pop(e){const t=cur.vkMiniAppsStack.indexOf(e);~t&&(cur.vkMiniAppsStack.splice(t,1),this.checkForNext())}shift(){cur.vkMiniAppsStack=cur.vkMiniAppsStack.slice(1),this.checkForNext()}checkForNext(){cur.vkMiniAppsStack.length>0&&cur.vkMiniAppsStack[0].show()}constructor(){this.checkStack=()=>{cur.vkMiniAppsStack||(cur.vkMiniAppsStack=[])},this.checkStack(),cur.clearVKMiniAppsLayerPopups=this.clearLayerPopups.bind(this)}}},288326:(e,t,r)=>{r.d(t,{CLOSE_BUTTON_MODES:()=>u,UIAction:()=>v,renderCounter:()=>m,setCounter:()=>E});var s=r(705744),i=r(241936),o=r(287841),a=r(52661),n=r(626490),c=r(787576),d=r(221844),l=r(193086),p=r(716578),_=r(476726);const u={INNER:0,OUTER:1},h="success",f="deny",S="extra",m=e=>{const t=document.createElement("span");return t.classList.add("VkAppModal__buttonCounter"),t.innerText=e,t},E=(e,t)=>{const r=e.find((e=>e.hasCounter));r&&r.counterElement&&(r.counterElement.innerText=t)};class v{addScroll(){(0,i.addPopupScroll)(this.modal.children[0],this.modalParentLayer)}init(){this.containerNode&&this.containerNode.appendChild(this.modal),this.modalParentLayer=this.modal.closest(".layer_wrap"),!1!==this.props.withScroll&&(this.modalParentLayer?this.modalParentLayer.addEventListener("scroll",this.addScroll):window.addEventListener("scroll",this.addScroll))}show(){(0,s.isMvk)()&&document.body.classList.add("vk_app_fixed"),this.props.withoutAnimation?this.modal.classList.add("show"):setTimeout((()=>this.modal.classList.add("show")),300),this.initMvkCloseActions(),this.addScroll()}initMvkCloseActions(){(0,s.isMvk)()&&(window.DirectGames&&cur.app.isDirectGame&&window.DirectGames.onBoxOpen(this),this.props.onlyButtonHide||(this.modal.onclick=e=>{e.target===this.modal&&this.onAction(this.props.cancelAction)}))}close(){this.props.onlyButtonHide||this.onAction(this.props.cancelAction)}destroy(){!1!==this.props.withScroll&&(window.removeEventListener("scroll",this.addScroll),this.modalParentLayer&&this.modalParentLayer.removeEventListener("scroll",this.addScroll)),this._destroyed||((0,s.isMvk)()&&(document.body.classList.remove("vk_app_fixed"),window.DirectGames&&cur.app.isDirectGame&&(window.DirectGames.onBoxClose(this),cur.app.frame.focus())),this.modal.parentNode.removeChild(this.modal),this.callback&&this.callback(),this._destroyed=!0)}_disableButton(e,t=!0){e.disabled=t,e.element.disabled=t}_lockButton(e,t=!0){const r=(0,s.isMvk)()?(0,a.getIcon24Spinner)().icon:(0,n.getIcon16Spinner)().icon,i=`\n    <span class="vk_app_modal_btn__content">${e.title}</span>\n    <span class="vk_app_modal_btn__spinner">${r}</span>\n    `;e.loading=t,e.element.innerHTML=t?i:e.title,e.element.classList.toggle("vk_app_modal_btn--loading",t)}async onAction(e){await e(),this.destroy()}lockButtons(e=!0){const t={[h]:this._lockButton,[f]:this._disableButton,[S]:this._disableButton};this.props.buttons.forEach((r=>t[r.type](r,e)))}_setCounter(e){E(this.props.buttons,e)}_renderBtn(e){const t=document.createElement("button");if(t.setAttribute("type","button"),t.classList.add("vk_app_modal_btn"),t.classList.add(`vk_app_modal_btn--${e.type}`),t.innerText=e.title,t.addEventListener("click",(()=>e.type===S?e.action():this.onAction(e.action))),e.hasCounter){const r=m(0);t.appendChild(r),e.counterElement=r}return e.element=t,e.disabled&&this._disableButton(e),e.loading&&this._lockButton(e),t}_renderBtns(e){const t=e.querySelector(".vk_app_modal_btns"),{buttons:r}=this.props;if(t){r.forEach((e=>t.appendChild(this._renderBtn(e))));const e=r.find((e=>e.type===S));1===r.length&&t.classList.add("vk_app_modal_btns--single-btn"),e&&t.classList.add("vk_app_modal_btns--hasExtraButton")}}_renderCloseBtn(e){const t=document.createElement("button");t.setAttribute("type","button"),t.classList.add("vk_app_modal_close_btn"),(0,s.isMvk)()||this.props.closeButtonMode!==u.OUTER?t.innerHTML=(0,d.getIcon24Cancel)().icon:(t.classList.add("vk_app_modal_close_btn--outer"),t.innerHTML=(0,c.getIcon20Cancel)().icon),t.addEventListener("click",(()=>this.onAction(this.props.cancelAction))),e.children[0].appendChild(t)}_renderCheckboxFields(e,t){const r=document.createElement("div");r.classList.add("MiniAppsCheckbox__fields");const s=document.createElement("h5");if(s.classList.add("MiniAppsCheckbox__fields-title"),s.innerHTML=e,r.appendChild(s),t){const e=document.createElement("h6");e.classList.add("MiniAppsCheckbox__fields-description"),e.innerHTML=t,r.appendChild(e)}return r}_renderCheckbox(e){const{title:t,description:r,...i}=e,o=document.createElement("label");o.classList.add("MiniAppsCheckbox");const a=document.createElement("input");if(a.type="checkbox",a.classList.add("MiniAppsCheckbox__checkbox"),a.addEventListener("change",(t=>e.checked=t.target.checked)),o.appendChild(a),Object.entries(i).forEach((([e,t])=>{a[e]=t})),(0,s.isMvk)()){const e=document.createElement("div");e.classList.add("MiniAppsCheckbox__fake_checkbox","MiniAppsCheckbox__fake_checkbox--checked"),e.innerHTML=(0,l.getIcon24CheckBoxOn)().icon,o.appendChild(e);const t=document.createElement("div");t.classList.add("MiniAppsCheckbox__fake_checkbox","MiniAppsCheckbox__fake_checkbox--unchecked"),t.innerHTML=(0,p.getIcon24CheckBoxOff)().icon,o.appendChild(t)}else{const e=document.createElement("div");e.classList.add("MiniAppsCheckbox__fake_checkbox"),o.appendChild(e)}const n=this._renderCheckboxFields(t,r);return o.appendChild(n),o}_renderCheckboxWrap(e){const t=e.querySelector(".MiniAppsModalCheckbox");t&&this.props.checkbox.map((e=>t.appendChild(this._renderCheckbox(e))))}_renderOuter(){const e=document.createElement("div");return e.classList.add("vk_app_modal_outer"),e}_enhanceBtnsWithActions(){this.props.buttons&&this.props.buttons.forEach(((e,t)=>{e.type===f?this.props.buttons[t].action=this.props.cancelAction:e.type===S?this.props.buttons[t].action=this.props.extraAction:this.props.buttons[t].action=this.props.allowAction}))}_renderScopes(e){return e.map(((e,t)=>{const r=getLang(`vkapps_scope_${e}`);return 0===t?r:r.toLowerCase()})).join(", ")}prepareScopes(e){return 0===e.length?["general"]:e}prepareExtraBtn(){const e=document.createElement("button");return e.setAttribute("type","button"),e.classList.add("vk_app_modal_btn","VkAppModal__button--extra","vk_app_modal_btn--transparent"),e.innerHTML=getLang("apps_connect_modal_messages_scopes_edit"),e.addEventListener("click",this.props.extraAction),e}getThumb(){if(this.props.svgIcon)return this.props.svgIcon;const e=this.props.picClass?this.props.picClass:"";return this.props.pic?`<img src="${this.props.pic}" class="vk_app_modal_container__pic MiniAppModalContainer__pic ${e}" alt aria-label="product">`:""}isHorizontalLayoutSupported(){return(0,s.isMvk)()&&(0,_.partConfigEnabled)("vk_bridge_modals_horizontal_layout")}renderModal(){this.props.containerClass=this.props.containerClass||"",this.props.buttonsClass=this.props.buttonsClass||"",this.props.isGradientModal&&(0,s.isMvk)()&&(this.props.containerClass+=" MiniAppsGradientModal"),this.props.isNoWrapButtons&&(0,s.isMvk)()&&(this.props.buttonsClass+=" MiniAppsNoWrapButtons");const e=this.props.scopes&&this.props.scopes.length&&this.props.extraAction;this.isHorizontalLayoutSupported()&&(this.props.containerClass+=" VkAppModal__Container--horizontalSupport",e&&(this.props.containerClass+=" VkAppModal__Container--withExtraButton"));let t=`\n    <div class="vk_app_modal_container vk_app_modal_container--flex ${this.props.containerClass||""}">\n      <div class="vk_app_modal_content">\n        ${this.getThumb()}\n        <h2 class="vk_app_modal_container__heading">${this.props.title}</h2>\n        ${this._renderSubheading()}\n        ${this._renderTextSeparator()}\n        ${this._renderText(this.props.text)}\n      `;this.props.scopes&&(t+=`\n          <p class="vk_app_modal_container__text">${getLang("apps_connect_modal_messages_scopes_text")}</p>\n          <p class="vk_app_modal_container__list">${this._renderScopes(this.prepareScopes(this.props.scopes))}.</p>`),t+=`\n          </div>\n          ${this.props.checkbox?'<div class="MiniAppsModalCheckbox"></div>':""}\n          <div class="vk_app_modal_btns ${this.props.buttonsClass}"></div>\n      </div>`,this._enhanceBtnsWithActions(),this.modal=this._renderOuter(),this.modal.innerHTML=t,this.props.showCloseBtn&&this._renderCloseBtn(this.modal),e&&this.modal.getElementsByClassName("vk_app_modal_content")[0].appendChild(this.prepareExtraBtn()),this._renderBtns(this.modal),this.props.checkbox&&this._renderCheckboxWrap(this.modal),this.props.scopes&&this._setCounter(this.props.scopes.length)}_renderText(e){if(!e)return"";return(Array.isArray(e)?e:[e]).map((e=>`<p class="vk_app_modal_container__text">${e}</p>`)).join("")}_renderSubheading(){return this.props.subheading?`<h3 class="vk_app_modal_container__subheading">${this.props.subheading}</h3>`:""}_renderTextSeparator(){return this.props.isTextSeparated?'<div class="vk_app_modal_container__text_separator"></div>':""}constructor(e,t){this.props={...e},t&&(this.callback=t),this.props.buttons=this.props.buttons||[],this.containerNode=document.getElementById(this.props.containerId),this.modal=null,this.modalParentLayer=null,this.onAction=this.onAction.bind(this),this.addScroll=(0,o.throttle)(this.addScroll.bind(this),i.THROTTLE_TIME),this.renderModal(),this._destroyed=!1}}},241936:(e,t,r)=>{r.d(t,{THROTTLE_TIME:()=>i,addPopupScroll:()=>o});var s=r(705744);const i=300,o=(e,t)=>{const r=t?t.scrollTop:window.pageYOffset,i=window.cur.app;if(i&&!(0,s.isMvk)()){const t=50*(Boolean(window.vk?.rtl)?1:-1),s=i.frame.clientHeight-360,o=Math.max(103,Math.min(r,s)+102);requestAnimationFrame((function(){e.style.transform=`translateX(${t}%) translateY(${o}px)`}))}}},499061:(e,t,r)=>{r.d(t,{default:()=>i});var s=r(340257);const i=class{_errorStrucuture(e,t){let r={type:this.method,data:{error_type:this.type,error_data:{error_code:e}}};return this.type===s.ERROR_TYPES.API?(r.data.error_data.error_msg=t,this.data.request_params&&(r.data.error_data.request_params=this.data.request_params)):r.data.error_data.error_reason=t,this.data.request_id&&(r.data.request_id=this.data.request_id),this.data.description&&(r.data.error_data.error_description=this.data.description),r}getReadableMessage(){const{error_reason:e,error_msg:t,error_description:r}=this.selectErrorType().data.error_data;return e||t||r}selectErrorType(){if(!this.data.hasOwnProperty("code"))return this.data.hasOwnProperty("error_code")?this._errorStrucuture(this.data.error_code,this.data.error_msg||s.ERROR_REASONS.UNKNOWN_ERROR):this.data.error_msg&&"operation denied by user"===this.data.error_msg.toLowerCase()?this._errorStrucuture(s.ERROR_CODES.USER_DENIED,"User denied"):this._errorStrucuture(s.ERROR_CODES.UNKNOWN,this.data.reason||this.data.error_msg||s.ERROR_REASONS.UNKNOWN_ERROR);switch(this.data.code){case s.ERROR_CODES.MISSING_PARAM:return this._errorStrucuture(s.ERROR_CODES.MISSING_PARAM,this.data.reason||"Missing required params or wrong type of param");case s.ERROR_CODES.CONNECTION_LOST:return this._errorStrucuture(s.ERROR_CODES.CONNECTION_LOST,this.data.reason||s.ERROR_REASONS.CONNECTION_LOST);case s.ERROR_CODES.USER_DENIED:return this._errorStrucuture(s.ERROR_CODES.USER_DENIED,this.data.reason||s.ERROR_REASONS.USER_DENIED);case s.ERROR_CODES.INVALID_PARAMS:return this._errorStrucuture(s.ERROR_CODES.INVALID_PARAMS,this.data.reason||s.ERROR_REASONS.INVALID_PARAMS);case s.ERROR_CODES.ACCESS_DENIED:return this._errorStrucuture(s.ERROR_CODES.ACCESS_DENIED,this.data.reason||s.ERROR_REASONS.ACCESS_DENIED);case s.ERROR_CODES.CUSTOM:return this._errorStrucuture(s.ERROR_CODES.CUSTOM,this.data.reason||this.data.error_msg);case s.ERROR_CODES.REQUESTS_LIMIT_REACHED:return this._errorStrucuture(s.ERROR_CODES.REQUESTS_LIMIT_REACHED,"Requests limit reached");case s.ERROR_CODES.UNKNOWN:return this._errorStrucuture(s.ERROR_CODES.UNKNOWN,s.ERROR_REASONS.UNKNOWN_ERROR);default:return this._errorStrucuture(this.data.code?this.data.code:s.ERROR_CODES.UNKNOWN,this.data.reason||this.data.error_msg||s.ERROR_REASONS.UNKNOWN_ERROR)}}constructor(e,t,r=s.ERROR_TYPES.CLIENT){this.data=t||{},this.method=e,this.type=r}}},422109:(e,t,r)=>{r.d(t,{destroyOpenedApp:()=>a,filterPostMessageOrigin:()=>c,getHostName:()=>o,isAllowedPostMessageOriginHost:()=>d,isVKPayApp:()=>n,objectToQuerystring:()=>i});var s=r(340257);const i=(e,t="?",r=!1)=>Object.keys(e).reduce(((s,i,o)=>[s,0===o?t:"&",encodeURIComponent(i),"=",r&&Array.isArray(e[i])?e[i].map(encodeURIComponent).join(","):encodeURIComponent(e[i])].join("")),""),o=e=>{const t=e.match(/:\/\/(www[0-9]?\.)?(.[^/:]+)/i);return null!=t&&t.length>2&&"string"==typeof t[2]&&t[2].length>0?t[2].toLowerCase():null},a=e=>{if(cur.vkAppQueue){const t=Object.keys(cur.vkAppQueue).filter((t=>~t.indexOf(e)));if(t.length>0){const e=t[0];cur.vkAppQueue[e].destroyView(),delete cur.vkAppQueue[e]}}},n=e=>s.VKPAY_APPS.includes(e);function c(e,t){const r=o(t),s=e.vkApp?e.vk_app_url:e.src,i=o(s);if(r!==i&&!d(e,r))throw Error(`Insecure method call from ${r}. Call must be from ${i}`);return!0}function d(e,t){if(!e.allowed_origin_regexp)return!1;return new RegExp(e.allowed_origin_regexp).test(t)}},57092:(e,t,r)=>{r.d(t,{saveNavigationStatEvent:()=>a});r(8520);var s=r(181938),i=r(856996);let o=[];function a({storyRawId:e,source:t,action:r}){let a=0,n=0;e&&([a,n]=(0,i.splitStoryRawId)(e)),"reply"===t&&(t="replies_list");const c={e:s.STATS_EVENT_TYPE_STORIES_VIEWER_NAVIGATION,owner_id:a,story_id:n,source:t,action:r};o.push(c)}},489617:(e,t,r)=>{r.d(t,{createFriendsAddFx:()=>c,createFriendsAddListFx:()=>u,createFriendsDeleteBulkFx:()=>l,createFriendsDeleteFx:()=>d,createFriendsDeleteListFx:()=>h,createFriendsDeleteSubscriberFx:()=>m,createFriendsEditListFx:()=>f,createFriendsGetCountersFx:()=>g,createFriendsGetFollowersFx:()=>E,createFriendsGetFriendsDeletionSuggestionsFx:()=>a,createFriendsGetFx:()=>o,createFriendsGetListsFx:()=>i,createFriendsGetMutualFx:()=>k,createFriendsGetOnlineFx:()=>_,createFriendsGetRecentFx:()=>b,createFriendsGetRecommendationsFx:()=>n,createFriendsGetRequestsFx:()=>p,createFriendsRequestsToSubscribersFx:()=>v,createFriendsSearchFx:()=>S});var s=r(66044);const i=e=>(0,s.createApiEffect)("friends.getLists",e),o=e=>(0,s.createApiEffect)("friends.get",e),a=e=>(0,s.createApiEffect)("friends.getFriendsDeletionSuggestions",e),n=e=>(0,s.createApiEffect)("friends.getRecommendations",e),c=e=>(0,s.createApiEffect)("friends.add",e),d=e=>(0,s.createApiEffect)("friends.delete",e),l=e=>(0,s.createApiEffect)("friends.deleteBulk",e),p=e=>(0,s.createApiEffect)("friends.getRequests",e),_=e=>(0,s.createApiEffect)("friends.getOnline",e),u=e=>(0,s.createApiEffect)("friends.addList",e),h=e=>(0,s.createApiEffect)("friends.deleteList",e),f=e=>(0,s.createApiEffect)("friends.editList",e),S=e=>(0,s.createApiEffect)("friends.search",e),m=e=>(0,s.createApiEffect)("friends.deleteSubscriber",e),E=e=>(0,s.createApiEffect)("friends.getFollowers",e),v=e=>(0,s.createApiEffect)("friends.requestsToSubscribers",e),g=e=>(0,s.createApiEffect)("friends.getCounters",e),b=e=>(0,s.createApiEffect)("friends.getRecent",e),k=e=>(0,s.createApiEffect)("friends.getMutual",e)},455234:(e,t,r)=>{r.d(t,{createGroupsEditFx:()=>n,createGroupsGetByIdFx:()=>i,createGroupsGetMembersFx:()=>p,createGroupsInviteFx:()=>d,createGroupsIsMemberFx:()=>c,createGroupsJoinFx:()=>o,createGroupsLeaveFx:()=>a,createGroupsRecallInvitationFx:()=>l});var s=r(66044);const i=e=>(0,s.createApiEffect)("groups.getById",e),o=e=>(0,s.createApiEffect)("groups.join",e),a=e=>(0,s.createApiEffect)("groups.leave",e),n=e=>(0,s.createApiEffect)("groups.edit",e),c=e=>(0,s.createApiEffect)("groups.isMember",e),d=e=>(0,s.createApiEffect)("groups.invite",e),l=e=>(0,s.createApiEffect)("groups.recallInvitation",e),p=e=>(0,s.createApiEffect)("groups.getMembers",e)},375827:(e,t,r)=>{r.d(t,{uploadFile:()=>s});const s=(e,t,r)=>{const s=new FormData;e.forEach((({name:e,blob:t,filename:r})=>s.append(e,t,r?encodeURIComponent(r):void 0)));const i=new XMLHttpRequest;return r&&(i.upload.addEventListener("loadstart",r),i.upload.addEventListener("progress",r)),{abort:()=>i.abort(),promise:new Promise(((e,r)=>{i.addEventListener("error",(e=>r(e))),i.addEventListener("load",(()=>e((e=>e.responseType&&"text"!==e.responseType?"document"===e.responseType?e.responseXML:e.response:e.responseText)(i)))),i.open("POST",t,!0),i.send(s)}))}}},484801:(e,t,r)=>{r.d(t,{PackContext:()=>d});var s=r(434518),i=r(763812),o=(0,i._)("_options"),a=(0,i._)("_pack"),n=(0,i._)("_product"),c=(0,i._)("_stockItem");class d{get rawData(){return(0,s._)(this,a)[a]||(0,s._)(this,c)[c]||(0,s._)(this,n)[n]}get isPack(){return Boolean((0,s._)(this,a)[a])}get isProduct(){return Boolean((0,s._)(this,n)[n])}get isStockItem(){return Boolean((0,s._)(this,c)[c])}get isStoreItem(){return this.isProduct||this.isStockItem}get stockItem(){return(0,s._)(this,c)[c]}get id(){const e=(0,s._)(this,o)[o]?.redefine?.id;if(void 0!==e)return e;const t=(0,s._)(this,n)[n]?.id;return void 0!==t?t:(0,s._)(this,a)[a]?.id}setHint(e){return(0,s._)(this,o)[o]?((0,s._)(this,o)[o].hint=e,this):this}get hintId(){return(0,s._)(this,o)[o]?.hint?.id}get hintWidth(){return(0,s._)(this,o)[o]?.hint?.width}get index(){return(0,s._)(this,o)[o]?.index}get referrer(){return(0,s._)(this,o)[o]?.referrer}get tooltip(){return(0,s._)(this,o)[o]?.tooltip}get title(){return(0,s._)(this,o)[o]?.redefine?.title||(0,s._)(this,n)[n]?.title||""}get stickers(){return(0,s._)(this,o)[o]?.redefine?.stickers||(0,s._)(this,a)[a]?.stickers||(0,s._)(this,n)[n]?.stickers}get baseId(){return(0,s._)(this,n)[n]?.base_id}get isStyle(){return void 0!==this.baseId}get hasStyles(){return Boolean(this.styleIds?.length)}get styleIds(){return(0,s._)(this,n)[n]?.style_ids}get canGift(){return Boolean((0,s._)(this,c)[c]?.can_gift)}get vmojiAvatar(){return(0,s._)(this,n)[n]?.vmoji_avatar}get isVmoji(){return Boolean(this.vmojiAvatar||(0,s._)(this,n)[n]?.is_vmoji)}get isPopup(){return(0,s._)(this,n)[n]?.is_popup}get isNew(){return(0,s._)(this,n)[n]?.is_new}get previews(){return(0,s._)(this,n)[n]?.previews}constructor({pack:e,...t}){Object.defineProperty(this,o,{writable:!0,value:void 0}),Object.defineProperty(this,a,{writable:!0,value:void 0}),Object.defineProperty(this,n,{writable:!0,value:void 0}),Object.defineProperty(this,c,{writable:!0,value:void 0}),(0,s._)(this,o)[o]=t,e&&("product"in e?((0,s._)(this,c)[c]=e,(0,s._)(this,n)[n]=e.product):"id"in e&&"type"in e?(0,s._)(this,n)[n]=e:(0,s._)(this,a)[a]=e)}}},498716:(e,t,r)=>{r.d(t,{$favoriteStickers:()=>o,setFavoriteStickers:()=>i});var s=r(624761);const i=s.stickersEmojiKeyboard.createEvent(),o=s.stickersEmojiKeyboard.createStore(null).on(i,((e,t)=>t))},656947:(e,t,r)=>{r.d(t,{$hasAvatar:()=>o,setHasAvatar:()=>i});var s=r(624761);const i=s.stickersEmojiKeyboard.createEvent(),o=s.stickersEmojiKeyboard.createStore(null).on(i,((e,t)=>t))},603943:(e,t,r)=>{r.d(t,{$packs:()=>u,ServicePackKey:()=>s});var s,i,o=r(32489),a=r(61070),n=r(625722),c=r(656947),d=r(684490),l=r(316299),p=r(498716),_=r(484801);!function(e){e[e.FAVORITE=-1]="FAVORITE",e[e.RECENT=-2]="RECENT",e[e.VMOJI=-3]="VMOJI",e[e.UGC=-4]="UGC"}(s||(s={})),function(e){e.RECENT="recent",e.FAVORITE="favourite",e.KEYBOARD="keyboard"}(i||(i={}));const u=(0,o.combine)(a.$ugcInfo,n.$ugcPacks,d.$stockItems,l.$recentStickers,p.$favoriteStickers,c.$hasAvatar,((e,t,r,o,a,n)=>{const c=new Map;let d=[];const l=new Map;let p=0;if(!r||!o||!a)return{};a.length&&(c.set(s.FAVORITE,new _.PackContext({index:p,referrer:i.FAVORITE,redefine:{id:s.FAVORITE,title:"stickers_picker_favorite",stickers:a}})),d.push(s.FAVORITE),p++),o.length&&(c.set(s.RECENT,new _.PackContext({index:p,referrer:i.RECENT,redefine:{id:s.RECENT,title:"stickers_picker_recently_used",stickers:o}})),d.push(s.RECENT),p++);-1!==r?.findIndex((({product:{vmoji_avatar:e}})=>void 0!==e))||n||(c.set(s.VMOJI,new _.PackContext({index:p,referrer:i.KEYBOARD,redefine:{id:s.VMOJI,title:"stickers_picker_vmoji"}})),d.push(s.VMOJI),p++);const u=t?.[0],h=e?.can_edit,f=u?.stickers?.length,S=e?.show_keyboard_onboarding&&h;if(!e?.is_keyboard_hidden&&(f||S)){const e=new _.PackContext({pack:u,index:p,referrer:i.KEYBOARD,tooltip:{header:"stickers_picker_ugc_tooltip_title",text:"stickers_picker_ugc_tooltip_description"},redefine:{id:s.UGC,title:"stickers_picker_ugc"}});h&&e.setHint({id:"stickers:ugc_keyboard_onboarding_tooltip",width:176}),c.set(s.UGC,e),d.push(s.UGC),p++}return r.forEach((e=>{const{product:{id:t,vmoji_avatar:r}}=e;if(c.set(t,new _.PackContext({index:p,referrer:i.KEYBOARD,pack:e})),r){let e=l.get(r.id);e||(e=d.push([])-1,l.set(r.id,e));const s=d[e];Array.isArray(s)&&s.push(t)}else d.push(t);p++})),{packs:c,packsGroups:d}}))},684490:(e,t,r)=>{r.d(t,{$stockItems:()=>o,setStockItems:()=>i});var s=r(624761);const i=s.stickersEmojiKeyboard.createEvent(),o=s.stickersEmojiKeyboard.createStore(null).on(i,((e,t)=>t))},316299:(e,t,r)=>{r.d(t,{$recentStickers:()=>o,setRecentStickers:()=>i});var s=r(624761);const i=s.stickersEmojiKeyboard.createEvent(),o=s.stickersEmojiKeyboard.createStore(null).on(i,((e,t)=>t))},61070:(e,t,r)=>{r.d(t,{$ugcInfo:()=>l,reloadUGCInfo:()=>c,setUGCInfo:()=>n});var s=r(32489),i=r(962177),o=r(624761),a=r(164272);const n=o.stickersEmojiKeyboard.createEvent(),c=o.stickersEmojiKeyboard.createEvent(),d=o.stickersEmojiKeyboard.createEffect((e=>e.cache.ugcInfo.get().catch((()=>null)))),l=o.stickersEmojiKeyboard.createStore(null).on(n,((e,t)=>t)).on(d.doneData,((e,t)=>t)).on(a.submitUGCReportFx.doneData,(()=>null));(0,s.sample)({clock:c,source:i.$api,target:d})},625722:(e,t,r)=>{r.d(t,{$ugcPacks:()=>a,setUGCPacks:()=>o});var s=r(624761),i=r(164272);const o=s.stickersEmojiKeyboard.createEvent(),a=s.stickersEmojiKeyboard.createStore(null).on(o,((e,t)=>t)).on(i.submitUGCReportFx.doneData,(()=>null))},164272:(e,t,r)=>{r.d(t,{submitUGCReport:()=>a,submitUGCReportFx:()=>n});var s=r(32489),i=r(962177),o=r(624761);const a=o.stickersEmojiKeyboard.createEvent(),n=o.stickersEmojiKeyboard.createEffect((e=>{e.cache.clearUGC()}));(0,s.sample)({clock:a,source:i.$api,target:n})},188616:(e,t,r)=>{r.d(t,{VKWebAppCustomMessage:()=>s.VKWebAppCustomMessage,getStore:()=>i.getStore});var s=r(712466),i=r(76773)},76773:(e,t,r)=>{r.d(t,{getStore:()=>a});var s=r(942451),i=r(32489);function o(){return{onOrdData:(0,i.createDomain)("APPS_CONNECT/VKWebAppCustomMessage").createEvent()}}function a(){return(0,s.makeSharedState)("static/js/modules/shared/apps_connect/handlers/VKWebAppCustomMessage/store.ts",o,{version:0})()}},961019:(e,t,r)=>{r.d(t,{default:()=>a});var s=r(942451),i=r(334052),o=r(476726);const a=(0,o.partConfigEnabled)("mini_apps_modal_stack_fix")?new class{initCallback(){window.cur=window.cur||{},window.cur.clearVKMiniAppsLayerPopups=this.clearLayerPopups.bind(this)}get vkMiniAppsStack(){return(0,s.makeSharedState)("MiniAppsModalsStack",(()=>[]),{version:0})()}get modalCount(){return this.vkMiniAppsStack.length}push(e){e.init(),0===this.modalCount&&e.show(),this.vkMiniAppsStack.push(e)}clearLayerPopups(){if(this.modalCount>0){const e=this.vkMiniAppsStack.filter((e=>"appNode"in e&&!e.appNode.id.includes("container_layer")));this.vkMiniAppsStack.splice(0,this.modalCount),this.vkMiniAppsStack.push(...e)}}pop(e){const t=this.vkMiniAppsStack.indexOf(e);-1!==t&&(this.vkMiniAppsStack.splice(t,1),this.checkForNext())}shift(){this.vkMiniAppsStack.shift(),this.checkForNext()}checkForNext(){this.modalCount>0&&this.vkMiniAppsStack[0].show()}constructor(){this.initCallback()}}:new i.ModalStackOld},498084:(e,t,r)=>{r.d(t,{connectTrackTmrGroupsJoin:()=>d,groupsJoinAction:()=>l,trackTmrGroupsJoin:()=>n});var s=r(141229),i=r(933052),o=r(32489),a=r(476726);const n=()=>{(0,a.partConfigEnabled)("group_join_track_event_count")&&(0,s.tmrSendTimespentEvent)(s.MY_TRACKER_COUNT_EVENT_IDS.COMMUNITY_SUBSCRIBE)},c=(0,o.createEffect)({name:"fx/track_group_join",handler:n}),d=e=>(0,o.sample)({clock:e.done,target:c}),l=(e,t,r)=>(0,i.api)("groups.join",e,t,r).then((e=>(n(),e)))},175241:(e,t,r)=>{r.d(t,{connectTrackTmrGroupsJoin:()=>s.connectTrackTmrGroupsJoin,groupsJoinAction:()=>s.groupsJoinAction,trackTmrGroupsJoin:()=>s.trackTmrGroupsJoin});var s=r(498084)},503050:(e,t,r)=>{r.d(t,{createCacheService:()=>i});var s=r(94359);const i=e=>{const t=(0,s.getEffectorServiceDomain)(e),r=Object.create(null),i=t.createStore(Object.create(null)),o=t.createEvent("add"),a=t.createEvent("delete");return i.on(o,((e,{key:t,data:r})=>(e[t]=r,e))).on(a,((e,t)=>(delete e[t],e))),{$cache:i,add:o,delete:a,get:e=>i.getState()[e]||null,isWaited:e=>void 0!==r[e],getWaited:e=>r[e],setWaited:(e,t)=>{r[e]=t},deleteWaited:e=>{delete r[e]}}}},399017:(e,t,r)=>{r.d(t,{createOwnerService:()=>i.createOwnerService,createUserService:()=>s.createUserService});var s=r(667020),i=r(249986)},249986:(e,t,r)=>{r.d(t,{createOwnerService:()=>l});var s=r(32489),i=r(793656),o=r(388078),a=r(503050),n=r(94359),c=r(901219);const d=(0,a.createCacheService)(),l=e=>{const t=e.fields||[],r=(0,n.getEffectorServiceDomain)(e),a=r.createStore({id:0}),l=r.createEvent("initialize"),p=r.createEvent("reload"),_=r.createEffect({name:"initializeFx"}),u=_.pending,h=_.doneData;return _.use((({ownerId:e,useCache:r})=>{if(r){const r=d.get(e);if(r){if(t.every((e=>r.hasOwnProperty(e))))return Promise.resolve(r)}}if(d.isWaited(e)){const r=d.getWaited(e).find((e=>t.every((t=>Boolean(e.fields[t])))));if(r)return r.promise.finally((()=>{d.deleteWaited(e)})),r.promise}let s=o.Ranges.isGroupId(e)?(0,i.apiWithPrefetch)("groups.getById",{group_ids:String(e),fields:t.join(",")}).then((t=>t.groups?.[0]||{id:e})):(0,i.apiWithPrefetch)("users.get",{user_ids:String(e),fields:t.join(",")}).then((e=>e[0]));const a={fields:t.reduce(((e,t)=>(e[t]=!0,e)),{}),promise:s},n=d.isWaited(e)?[...d.getWaited(e),a]:[a];return d.setWaited(e,n),s})),(0,s.sample)({clock:l,source:a,filter:(e,t)=>e.id!==t,fn:(t,r)=>({ownerId:r,useCache:Boolean(e?.useCache)}),target:_}),(0,s.sample)({clock:p,source:a,fn:e=>({ownerId:e.id}),target:_}),(0,s.sample)({clock:_.doneData,target:a}),(0,s.sample)({clock:_.doneData,filter:()=>Boolean(e?.useCache),fn:e=>{const t=d.get(e.id);if(t){if((0,c.isOwnerUser)(t)&&(0,c.isOwnerUser)(e))return{key:e.id,data:{...t,...e}};if((0,c.isOwnerGroup)(t)&&(0,c.isOwnerGroup)(e))return{key:e.id,data:{...t,...e}}}return{key:e.id,data:e}},target:d.add}),{$isInitializing:u,$owner:a,initialize:l,onInitialized:h,reload:p}}},667020:(e,t,r)=>{r.d(t,{createUserService:()=>a});var s=r(32489),i=r(933052),o=r(793656);const a=({domain:e})=>{const t=(e,t)=>!(!e||e.id!==t.userId),r=e.createStore(null),a=e.createEffect((({params:e})=>(0,o.apiWithPrefetch)("users.get",e))),n=e.createEffect((async e=>({userId:e.params.owner_id,response:await(0,i.api)("wall.subscribe",e.params)}))),c=e.createEffect((async e=>({userId:e.params.owner_id,response:await(0,i.api)("wall.unsubscribe",e.params)}))),d=e.createEffect((async e=>({userId:e.params.owner_id,response:await(0,i.api)("video.liveSubscribe",e.params)}))),l=e.createEffect((async e=>({userId:e.params.owner_id,response:await(0,i.api)("video.liveUnsubscribe",e.params)}))),p=e.createEffect((async e=>({userId:e.params.user_id,response:await(0,i.api)("fave.addUser",e.params)}))),_=e.createEffect((async e=>({userId:e.params.user_id,response:await(0,i.api)("fave.removeUser",e.params)}))),u=e.createEffect((async e=>({userId:e.params.owner_id,response:await(0,i.api)("account.ban",e.params)}))),h=e.createEffect((async e=>({userId:e.params.owner_id,response:await(0,i.api)("account.unban",e.params)}))),f=e.createEffect((async e=>({userId:e.params.user_id,response:await(0,i.api)("bestFriends.add",e.params)}))),S=e.createEffect((async e=>({userId:e.params.user_id,response:await(0,i.api)("bestFriends.delete",e.params)})));return(0,s.sample)({clock:a.doneData,fn:e=>e[0]||null,target:r}),(0,s.sample)({clock:n.doneData,source:r,filter:t,fn:e=>({...e,is_subscribed:1}),target:r}),(0,s.sample)({clock:c.doneData,source:r,filter:t,fn:e=>({...e,is_subscribed:0}),target:r}),(0,s.sample)({clock:d.doneData,source:r,filter:t,fn:e=>({...e,video_live:e.video_live?{...e.video_live,is_notifications_blocked:0}:void 0}),target:r}),(0,s.sample)({clock:l.doneData,source:r,filter:t,fn:e=>({...e,video_live:e.video_live?{...e.video_live,is_notifications_blocked:1}:void 0}),target:r}),(0,s.sample)({clock:p.doneData,source:r,filter:t,fn:e=>({...e,is_favorite:1}),target:r}),(0,s.sample)({clock:_.doneData,source:r,filter:t,fn:e=>({...e,is_favorite:0}),target:r}),(0,s.sample)({clock:u.doneData,source:r,filter:t,fn:e=>({...e,blacklisted_by_me:1}),target:r}),(0,s.sample)({clock:h.doneData,source:r,filter:t,fn:e=>({...e,blacklisted_by_me:0}),target:r}),(0,s.sample)({clock:f.doneData,source:r,filter:t,fn:e=>({...e,is_best_friend:!0}),target:r}),(0,s.sample)({clock:S.doneData,source:r,filter:t,fn:e=>({...e,is_best_friend:!1}),target:r}),{fetchUserFx:a,subscribeToPostsFx:n,unsubscribeFromPostsFx:c,subscribeToVideoLiveFx:d,unsubscribeFromVideoLiveFx:l,faveAddUserFx:p,faveRemoveUserFx:_,accountBanFx:u,accountUnbanFx:h,bestFriendAddFx:f,bestFriendDeleteFx:S,$user:r,domain:e}}},867394:(e,t,r)=>{r.d(t,{getEnvConfigValue:()=>o,isEnvConfigEnabled:()=>i});var s=r(476726);function i(e){return(0,s.partConfigEnabled)(e)}function o(e){return(0,s.getConfigValue)(e)}},52646:(e,t,r)=>{r.d(t,{isUserAuthorized:()=>i});var s=r(388078);function i(){const e=window?.vk?.id||0;return!s.Ranges.isZeroOwner(e)}},347636:(e,t,r)=>{r.d(t,{apiFaveAddNarrative:()=>i,apiFaveRemoveNarrative:()=>o});var s=r(933052);function i(e){return(0,s.api)("fave.addNarrative",e)}function o(e){return(0,s.api)("fave.removeNarrative",e)}},898675:(e,t,r)=>{r.d(t,{createFaveService:()=>o});var s=r(32489),i=r(347636);const o=({domain:e})=>{const t=e.createEvent("fire/faveAddNarrative"),r=e.createEvent("fire/faveRemoveNarrative"),o=e.createEffect("fx/faveAddNarrative"),a=e.createEffect("fx/faveRemoveNarrative");return o.use(i.apiFaveAddNarrative),a.use(i.apiFaveRemoveNarrative),(0,s.sample)({clock:t,target:o}),(0,s.sample)({clock:r,target:a}),{fireAddNarrative:t,fireRemoveNarrative:r,addNarrativeFx:o,removeNarrativeFx:a}}},808444:(e,t,r)=>{r.d(t,{DEFAULT_ACCEPT:()=>s,GO_UPLOAD_FILE_TYPES:()=>i,MULTIPLE_BATCH_SIZE:()=>o,MULTIPLE_MAX_COUNT:()=>a});const s=["image/jpeg","image/png","image/gif","image/heic","image/heif","image/webp"],i=["*.jpg","*.JPG","*.jpeg","*.JPEG","*.png","*.PNG","*.gif","*.GIF","*.heic","*.HEIC","*.heif","*.HEIF","*.webp","*.WEBP"],o=5242880,a=5},637990:(e,t,r)=>{r.d(t,{sendUploadRequest:()=>s});const s=(e,t,r)=>new Promise(((s,i)=>{const o=new XMLHttpRequest;o.open("POST",e,!0),r&&(o.upload.onloadstart=e=>{r(e)},o.upload.onprogress=e=>{r(e)}),o.onerror=()=>{i("Unknown error")},o.onreadystatechange=()=>{o.readyState===XMLHttpRequest.DONE&&(200===o.status?s(o.responseText):i())},o.send(t)}))},803464:(e,t,r)=>{r.d(t,{MAX_STORY_VIDEO_DURATION:()=>c,getStoryUploadUrl:()=>_,getStoryUploadUrlApi:()=>p,saveStoryOnServer:()=>h,uploadStoryBlobToServer:()=>u});var s=r(7144),i=r(535277),o=r(303568),a=r(8520),n=r(637990);const c=16,d=(e,t)=>{const{id:r,entry_point:s,ref:i,clickable_stickers:o,question_id:a,mini_app_id:n,live_cover:c,add_to_news:d=1,analytics:l,attachment:p,situational_suggest_id:_,live_cover_position:u,is_authors_ads:h,ord_external_id:f,ord_erid:S}=e,m={group_id:r,add_to_news:d,entry_point:s,ref:i,clickable_stickers:o,question_id:a,mini_app_id:n,live_cover:c,analytics:l,situational_suggest_id:_,is_authors_ads:h?1:0,ord_external_id:f,ord_erid:S};if(p){const e=JSON.parse(p);e.type&&!["url","playlist"].includes(e.type)&&(m.attach_type=e.type),e?.url&&(m.link_url=e.url),e?.text&&(m.link_text=e.text),e?.owner_id&&(m.attach_owner_id=e.owner_id),e?.id&&(m.attach_id=e.id),e?.access_key&&(m.attach_access_key=e.access_key)}return m.attach_type||(m.attach_type=t),c&&u&&(m.live_cover_position=u),m};function l(e){if(!e)return"";const t=(0,a.isString)(e)?JSON.parse(e):e||[],r=t?.stickers?.map((e=>e?.id));return r?.join(",")||""}function p(e,t){return t===o.StoryType.PHOTO?i.storiesService.getPhotoUploadServerFx({...e,sticker_ids:l(e.analytics),upload_v2:1}).then((({upload_url:e})=>e)):i.storiesService.getVideoUploadServerFx(e).then((({upload_url:e})=>e))}function _(e,t){return p(d(e,t),t)}function u(e,t,r){const i=new FormData,o=encodeURIComponent(`edited_${(0,s.irand)(0,99999)}.jpg`);return i.append("file",e,o),(0,n.sendUploadRequest)(t,i,r)}function h(e,t){const r=t===o.StoryType.PHOTO?e:JSON.parse(e)?.response?.upload_result;return i.storiesService.saveFx({upload_results_json:JSON.stringify([{upload_result:r}])}).then((({items:e})=>({story:e[0]})))}},303568:(e,t,r)=>{var s,i,o,a,n;r.d(t,{DynamicStickersTypes:()=>d,StickerTypes:()=>c,StoryBlockType:()=>a,StoryEntryPoint:()=>i,StoryListName:()=>n,StoryPollBackgroundType:()=>u,StorySource:()=>o,StoryStickerSubtype:()=>l,StoryType:()=>s,dynamicStickerIds:()=>p,staticStickerIds:()=>_}),function(e){e.PHOTO="photo",e.VIDEO="video",e.LIVE="live"}(s||(s={})),function(e){e.SWIPE="swipe",e.NAVIGATION_BUTTON="navigation_button",e.SIT_POSTING="sit_posting",e.LINK="link",e.STORY_REPLY="story_reply",e.STORY_REPOST="story_repost",e.CATALOG_ADD="catalog_add",e.DIALOG="dialog",e.STORY_LIVE_FINISHED="story_live_finished",e.DIALOG_VKME="dialog_vkme",e.STORY_VIEWER_FINISHED="story_viewer_finished",e.PUSH_TRY_MASK="push_try_mask",e.STORY_VIEWER_TRY_MASK="story_viewer_try_mask",e.LINK_MASK="link_mask",e.POSTING="posting",e.NEW_STORY_AVATAR="new_story_avatar",e.STORY_REPLIES_LIST="story_replies_list",e.STORIES_FEED="stories_feed",e.STORIES_SEARCH_NEWS="stories_search_news",e.QUESTION_STICKER="question_sticker",e.LIST_MIDDLE="list_middle",e.ARCHIVE_EMPTY_BUTTON="archive_empty_button",e.ARCHIVE_MENU_BUTTON="archive_menu_button",e.IM="im",e.PROFILE_BUTTON="profile_button",e.SHARE="share",e.MINI_APP="mini_app",e.SYSTEM_SHARING="system_sharing",e.SHORTCUT="shortcut",e.ARCHIVE_SHARING="archive_sharing",e.STORY_VIEWER_CAMERA_BUTTON="story_viewer_camera_button",e.STORY_VIEWER_MUSIC="story_viewer_music",e.STORY_VIEWER_MUSIC_SHEET="story_viewer_music_sheet",e.REPOST_TO_STORY_ACTIVITY="repost_to_story_activity",e.CHANGE_AVATAR="change_avatar"}(i||(i={})),function(e){e.FEED="feed",e.FEED_MIDDLE="feed_middle",e.LINK="link",e.PROFILE="profile",e.IM_DIALOGS="im_dialogs",e.IM_DIALOG_HEADER="im_dialog_header",e.SNIPPET="snippet",e.REPLY="reply",e.REPLIES_LIST="replies_list",e.REPLY_STORY="reply_story",e.DISCOVER="discover",e.STORIES_MANAGE="stories_manage",e.USER_PERSONAL_CARD="user_personal_card",e.GROUP_PERSONAL_CARD="group_personal_card",e.NARRATIVE_SNIPPET="narrative_snippet",e.NARRATIVE_STORY="narrative_story",e.NARRATIVE_LINK="narrative_link",e.NARRATIVE_RECOMMENDATIONS="narrative_recommendations",e.NARRATIVE_SECTION="narrative_section",e.FAVE="fave",e.SPAMFEED="sf",e.ADS_PREVIEW="ads_preview",e.LIST_MIDDLE="list_middle",e.PLACE_STORY_LIST="place_story_list",e.SEARCH_STORY_LIST="search_story_list",e.STORY_ARCHIVE="story_archive",e.IM_MSG_LIST="im_msg_list",e.NOSPAM="nospam",e.PROFILE_SNACKBAR="profile_snackbar",e.MY_QUESTIONS="question_story"}(o||(o={})),function(e){e.stories="stories",e.appGroupedStories="app_grouped_stories",e.promoStories="promo_stories",e.discover="discover",e.liveActive="live_active",e.liveFinished="live_finished"}(a||(a={})),function(e){e.feed="feed",e.apps="apps",e.discover="discover"}(n||(n={}));const c={hashtag:1,mention:2,question:3,place:4,music:5,storyReply:6,owner:7,link:8,marketItem:9,post:10,poll:11,sticker:12,app:13,situationalTheme:14,playlist:15,videoButton:16,situationalTemplate:17,spoiler:18},d={situationalTemplate:c.situationalTemplate};var l;!function(e){e.aliexpress="aliexpress_product",e.market="market_item"}(l||(l={}));const p=Object.values(d),_=Object.values(c).filter((e=>!p.includes(e)));var u;!function(e){e.photo="photo",e.gradient="gradient",e.default="default"}(u||(u={}))},253800:(e,t,r)=>{r.d(t,{apiLikesAdd:()=>i,apiLikesDelete:()=>o});var s=r(933052);function i(e){return(0,s.api)("likes.add",e)}function o(e){return(0,s.api)("likes.delete",e)}},417501:(e,t,r)=>{var s;!function(e){e.Story="story"}(s||(s={}))},230752:(e,t,r)=>{r.d(t,{createLikesService:()=>s.createLikesService});var s=r(720207);r(417501)},720207:(e,t,r)=>{r.d(t,{createLikesService:()=>o});var s=r(32489),i=r(253800);const o=({domain:e})=>{const t=e.createEvent("fire/likesAdd"),r=e.createEvent("fire/likesDelete"),o=e.createEffect("fx/likesAdd"),a=e.createEffect("fx/likesDelete");return o.use(i.apiLikesAdd),a.use(i.apiLikesDelete),(0,s.sample)({clock:t,target:o}),(0,s.sample)({clock:r,target:a}),{fireAdd:t,fireDelete:r,addFx:o,deleteFx:a}}},571144:(e,t,r)=>{r.d(t,{apiMessagesSend:()=>i});var s=r(933052);function i(e){return(0,s.api)("messages.send",e)}},845167:(e,t,r)=>{r.d(t,{createMessagesService:()=>o});var s=r(32489),i=r(571144);const o=({domain:e})=>{const t=e.createEvent("fire/messageSend"),r=e.createEffect("fx/messageSend");return r.use(i.apiMessagesSend),(0,s.sample)({clock:t,target:r}),{fireMessagesSend:t,sendFx:r}}},904919:(e,t,r)=>{r.d(t,{apiNarrativesBatchEdit:()=>a,apiNarrativesCreate:()=>i,apiNarrativesDelete:()=>n,apiNarrativesEdit:()=>o,apiNarrativesGetById:()=>c,apiNarrativesGetFeedBlock:()=>d,apiNarrativesGetFromOwner:()=>l,apiNarrativesReorder:()=>_,apiNarrativesSaveCustomCover:()=>p});var s=r(933052);function i(e){return(0,s.api)("narratives.create",e)}function o(e){return(0,s.api)("narratives.edit",e)}function a(e){return(0,s.api)("narratives.batchEdit",e)}function n(e){return(0,s.api)("narratives.delete",e)}function c(e){return(0,s.api)("narratives.getById",e)}function d(e={}){return(0,s.api)("narratives.getFeedBlock",e)}function l(e){return(0,s.api)("narratives.getFromOwner",e)}function p(e){return(0,s.api)("narratives.saveCustomCover",e)}function _(e){return(0,s.api)("narratives.reorder",e)}},404440:(e,t,r)=>{r.d(t,{createNarrativesService:()=>o});var s=r(32489),i=r(904919);const o=({domain:e})=>{const t=e.createEvent("fire/narrativesGetById"),r=e.createEvent("fire/narrativesGetFromOwner"),o=e.createEvent("fire/narrativesGetFeedBlock"),a=e.createEvent("fire/narrativesCreate"),n=e.createEvent("fire/narrativesEdit"),c=e.createEvent("fire/narrativesBatchEdit"),d=e.createEvent("fire/narrativesDelete"),l=e.createEvent("fire/narrativesSaveCustomCover"),p=e.createEvent("fire/narrativesReorder"),_=e.createEffect("fx/narrativesGetById"),u=e.createEffect("fx/narrativesGetFromOwner"),h=e.createEffect("fx/narrativesGetFeedBlock"),f=e.createEffect("fx/narrativesCreate"),S=e.createEffect("fx/narrativesEdit"),m=e.createEffect("fx/narrativesBatchEdit"),E=e.createEffect("fx/narrativesDelete"),v=e.createEffect("fx/narrativesSaveCustomCover"),g=e.createEffect("fx/narrativesReorder");return _.use(i.apiNarrativesGetById),u.use(i.apiNarrativesGetFromOwner),h.use(i.apiNarrativesGetFeedBlock),f.use(i.apiNarrativesCreate),S.use(i.apiNarrativesEdit),m.use(i.apiNarrativesBatchEdit),E.use(i.apiNarrativesDelete),v.use(i.apiNarrativesSaveCustomCover),g.use(i.apiNarrativesReorder),(0,s.sample)({clock:t,target:_}),(0,s.sample)({clock:r,target:u}),(0,s.sample)({clock:o,target:h}),(0,s.sample)({clock:a,target:f}),(0,s.sample)({clock:n,target:S}),(0,s.sample)({clock:c,target:m}),(0,s.sample)({clock:d,target:E}),(0,s.sample)({clock:l,target:v}),(0,s.sample)({clock:p,target:g}),{fireGetById:t,fireGetFromOwner:r,fireGetFeedBlock:o,fireCreate:a,fireEdit:n,fireBatchEdit:c,fireDelete:d,fireSaveCustomCover:l,fireReorder:p,getByIdFx:_,getFromOwnerFx:u,getFeedBlockFx:h,createFx:f,editFx:S,batchEditFx:m,deleteFx:E,saveCustomCoverFx:v,reorderFx:g}}},627086:(e,t,r)=>{r.d(t,{apiPollsCreate:()=>o,apiPollsGetById:()=>i});var s=r(933052);function i(e){return(0,s.api)("polls.getById",e)}function o(e){return(0,s.api)("polls.create",e)}},952597:(e,t,r)=>{r.d(t,{createPollsService:()=>o});var s=r(32489),i=r(627086);const o=({domain:e})=>{const t=e.createEvent("fire/pollsGetById"),r=e.createEvent("fire/pollsCreate"),o=e.createEffect("fx/pollsGetById"),a=e.createEffect("fx/pollsCreate");return o.use(i.apiPollsGetById),a.use(i.apiPollsCreate),(0,s.sample)({clock:t,target:o}),(0,s.sample)({clock:r,target:a}),{fireGetById:t,fireCreate:r,getByIdFx:o,createFx:a}}},42995:(e,t,r)=>{r.d(t,{getEnabledMvkTabs:()=>u,getEnabledWebTabs:()=>p,getMainDataLoadParams:()=>n,getOwnerContentTabsDataRequestParams:()=>d,getSupportedMvkTabs:()=>_,getSupportedWebTabs:()=>l,getViewerDataLoadParams:()=>c});var s=r(867394),i=r(52646);function o(e){return e.join(",")}const a=o(["age_mark","is_sber_verified","is_tinkoff_verified","is_esia_verified","can_ban","can_see_gifts","followers_count","no_index","about","activities","activity","bdate","no_index","blacklisted","blacklisted_by_me","books","buttons","can_call","can_invite_to_chats","can_post","can_see_all_posts","can_see_wishes","can_send_friend_request","can_subscribe_stories","can_write_private_message","career","city","connections","counters","country","emoji_status","first_name_acc","first_name_dat","first_name_gen","first_name_ins","friend_status","games","gifts_tooltip","has_photo","home_town","image_status","interests","is_dead","is_favorite","is_hidden_from_feed","is_subscribed","is_subscribed_stories","last_name_acc","last_name_dat","last_name_gen","last_name_ins","last_seen","military","movies","music","mutual","occupation","online","online_info","owner_state","personal","quotes","relation","relatives","schools","screen_name","social_button_type","domain","sex","site","status","trending","tv","universities","verified","video_live","wall_default","bdate_visibility","contacts","photo_max","photo_medium_rec","photo_rec","can_ask_question","can_subscribe_posts","cover","first_name_nom","lists","maiden_name","nickname","photo_200","photo_400","photo_avg_color","photo_id","photo_max_size","profile_buttons","stories_archive_count","third_party_buttons","service_description","is_best_friend","is_nft","is_followers_mode_on","is_personal_ads_easy_promote_enabled","need_big_msg_btn_in_profile"]);function n(e,t,r){const s=e===t,i={"photos.get":{owner_id:e,album_id:"profile",rev:1,count:1},"users.getSubscriptions":{fields:o(["photo_200","photo_100","description","status","is_nft"]),count:5,extended:1,user_id:e},"users.getFollowers":{fields:o(["photo_200","photo_100","photo_50","is_friend","sex"]),count:s?8:3,user_id:e},"gifts.get":{user_id:e,count:6}};return t&&(r.withoutFriends||(i["friends.get"]={user_id:e,count:12,fields:o(["domain","photo_100","photo_200","online","is_nft"]),order:"hints"}),i["stories.get"]={owner_id:e}),s&&(i["friends.getRequests"]={need_count:1,count:3,need_viewed:0,fields:o(["photo_100","photo_200","sex"]),extended:1},r.withOnlineFriends&&(i["friends.getOnline"]={user_id:e,count:8,order:"hints"}),i["account.getPrivacySettings"]={privacy_keys:"friends_requests,audios,stories,gifts",need_default:0},i["account.getSilentModeStatus"]={}),r.withoutUser||(i["users.get"]={user_ids:e.toString(),fields:a}),i}function c(e){return{user_ids:String(e),fields:o(["is_followers_mode_on","social_button_type"])}}function d(e,t,r={}){const i={};return t.forEach((t=>{switch(t){case"photos":r.isPhotoFeedEnabled?i["photos.photoFeedGet"]={owner_id:e,extended:1,photo_sizes:1,count:6}:i["photos.getAll"]={owner_id:e,photo_sizes:1,extended:1,skip_hidden:1};break;case"videos":i["video.get"]={owner_id:e,need_privacy:1,count:9};break;case"music":i["audio.get"]={owner_id:e,photo_sizes:1,count:8},i["audio.getPlaylists"]={owner_id:e,photo_sizes:1,count:9};break;case"short_videos":i["shortVideo.getOwnerVideos"]={owner_id:e,count:9};break;case"articles":i["articles.getOwnerPublished"]={owner_id:e,count:3};break;case"narratives":i["narratives.getFromOwner"]={owner_id:e,limit:9};break;case"nfts":{const t=(0,s.getEnvConfigValue)("nft_profile_content_count"),r=t||9;(0,s.isEnvConfigEnabled)("nft_profile_market")?i["nftMarket.searchTokens"]={result_type:"model",search_type:"published",limit:r,props:JSON.stringify({owner_id:e}),fields:JSON.stringify(["collection"])}:i["nft.getCollection"]={owner_id:e,limit:r};break}case"albums":i["photos.getAlbums"]={owner_id:e,count:9,need_system:1,need_covers:1,photo_sizes:1}}})),i}function l(){const e=(0,i.isUserAuthorized)(),t=e?["photos","short_videos","videos","music","articles","narratives"]:["short_videos","articles","videos"];return!(0,s.isEnvConfigEnabled)("profile_hide_nfts_tabs")&&e&&t.push("nfts"),(0,s.isEnvConfigEnabled)("profile_enable_album_tabs")&&e&&t.push("albums"),t}function p(){const e=(0,i.isUserAuthorized)(),t=e?["photos","short_videos","music","articles"]:["short_videos","articles"];return!(0,s.isEnvConfigEnabled)("profile_hide_nfts_tabs")&&e&&t.push("nfts"),(0,s.isEnvConfigEnabled)("profile_enable_album_tabs")&&e&&t.push("albums"),t}function _(){const e=(0,i.isUserAuthorized)(),t=e?["photos","short_videos","videos","music","narratives","articles"]:["short_videos"];return!(0,s.isEnvConfigEnabled)("profile_hide_nfts_tabs")&&e&&t.push("nfts"),(0,s.isEnvConfigEnabled)("profile_enable_album_tabs")&&e&&t.push("albums"),t}function u(){const e=(0,i.isUserAuthorized)(),t=e?["photos","short_videos","videos","music","narratives","articles"]:["short_videos"];return!(0,s.isEnvConfigEnabled)("profile_hide_nfts_tabs")&&e&&t.push("nfts"),(0,s.isEnvConfigEnabled)("profile_enable_album_tabs")&&e&&t.push("albums"),t}},566282:(e,t,r)=>{r.d(t,{execute:()=>u,loadMainData:()=>S});var s=r(933052),i=r(927138),o=r(853883),a=r(42995),n=r(793656),c=r(705744),d=r(476726),l=r(972630),p=r(388078),_=r(877414);function u(e,t){const r=[],i=[],a=Object.keys(e),l={},u=new Set;if(!(p.Ranges.isUserId(window.vk?.id)&&(0,d.partConfigEnabled)("web_api_fork"))){const t=(0,d.partConfigEnabled)("profile_unauth_prefetch_web_fix"),r=[];for(const i of a)if(t){try{l[i]=(0,n.loadPrefetchCache)(i,o.API_VERSION,e[i])}catch(e){u.add(i)}l[i]||u.has(i)||r.push((0,s.api)(i,e[i]))}else r.push((0,s.api)(i,e[i]));return t&&!r.length?Promise.resolve(l):Promise.allSettled(r).then((e=>{const r=t?{...l}:{};return e.forEach(((e,t)=>{const s=a[t];"fulfilled"===e.status?r[s]=e.value:((0,d.partConfigEnabled)("web_execute_empty_response_log")&&!(0,c.isMvk)()&&"profile"===window.cur?.module&&"users.get"===s&&(0,_.logProfileError)({error:e.reason,additionalText:"Empty response in fork fallback",extra:{method:s}}),r[s]=!1)})),r}))}for(const t of a){try{l[t]=(0,n.loadPrefetchCache)(t,o.API_VERSION,e[t])}catch(e){u.add(t)}l[t]||u.has(t)||(r.push(`'${t}': fork(API.${t}(${JSON.stringify(e[t])}))`),i.push(`'${t}': wait(forks['${t}'])`))}if(!r.length)return Promise.resolve(l);const h=`\n    var forks = { ${r.join(",")} };\n\n    return { ${i.join(",")} };\n  `;return(0,s.api)("execute",{code:h},t).then((e=>{if((0,d.partConfigEnabled)("profile_fix_bad_execute_response")&&e.response){const t={...l,...e.response};return e.execute_errors&&(t.execute_errors=e.execute_errors),t}return{...l,...e}}))}const h=e=>new Promise((t=>{e?(0,n.apiWithPrefetch)("onboarding.getCards",{icon_sizes:"24,48",block_type:"multi"}).then((e=>{if(!e.count&&!(0,c.isMvk)())return(0,n.apiWithPrefetch)("onboarding.getCards",{icon_sizes:"24,48",block_type:"single"});t({onboardingCards:e})})).then((e=>{t({onboardingSingleCards:e})})).catch((()=>{console.error("error while loading onboarding"),t()})):t()})),f=(e,t)=>new Promise((r=>{e?(0,n.apiWithPrefetch)("users.get",(0,a.getViewerDataLoadParams)(e),t).then((e=>{r(e)})):r([{id:0}])}));function S(e,t,r,s){const o=e===t,p=(0,a.getMainDataLoadParams)(e,t,r),S=(0,n.startCacheMissLog)("profile_main_data"),m=[u(p,s),f(t,s),h(o)];return S(),Promise.all(m).then((([e,t,s])=>{if(!(r?.withoutUser||e["users.get"]&&e["users.get"].length)){const t=e.execute_errors;(0,d.partConfigEnabled)("web_execute_empty_response_log")&&!(0,c.isMvk)()&&t&&(0,_.logProfileError)({error:t,additionalText:"Empty response in users.get execute",extra:{method:"users.get"}});const r="something wrong with owner loading";throw console.error(r),new Error(r)}const a=e["users.get"]&&e["users.get"][0],n=t?.[0],p={viewer:n,owner:a||void 0};return e["friends.get"]&&(p.friends=e["friends.get"]),e["account.getSilentModeStatus"]&&(p.silentModeStatus=e["account.getSilentModeStatus"]),e["photos.get"]&&(p.avatar=e["photos.get"].items[0]),e["stories.get"]&&(p.stories=e["stories.get"]),e["users.getSubscriptions"]&&(p.subscriptions=e["users.getSubscriptions"]),e["users.getFollowers"]&&(p.followers=e["users.getFollowers"]),e["friends.getRequests"]&&(p.friendRequests=e["friends.getRequests"]),e["account.getPrivacySettings"]&&(p.viewerPrivacySettings=e["account.getPrivacySettings"]),e["gifts.get"]&&(p.gifts=e["gifts.get"]),e["friends.getOnline"]&&(p.onlineFriendIds=e["friends.getOnline"]),s&&(p.onboardingCards=s.onboardingCards,p.onboardingSingleCards=s.onboardingSingleCards),a&&(!o&&a.mutual?.count&&(p.mutual={status:i.LoadingStatus.initial}),o&&p.onlineFriendIds?.length&&(p.onlineFriends={status:i.LoadingStatus.initial}),!o&&a.gifts_tooltip&&(p.giftsCatalog={status:i.LoadingStatus.initial}),p.broadcastStatus=(0,l.getUserBroadcastStatus)(a)||void 0),p}))}},877414:(e,t,r)=>{r.d(t,{REQUEST_NAME:()=>s,logProfileError:()=>n,sendProfileApiRequestErrorStat:()=>a});var s,i=r(490712),o=r(953430);function a(e){(0,i.statlogsValueEvent)("profile_api_requests_error",e)}!function(e){e.MainData="main_data",e.AdditionalData="additional_data",e.UploadCover="upload_cover",e.FetchHelpHints="fetch_help_hints",e.FriendsRecommendations="friends.getRecommendations"}(s||(s={}));const n=(0,o.createSentryLogger)({debugPrefix:"[ProfileRedesign Sentry Logger]"})},927138:(e,t,r)=>{var s;r.d(t,{LoadingStatus:()=>s}),function(e){e[e.initial=0]="initial",e[e.pending=1]="pending",e[e.reloading=2]="reloading",e[e.loaded=3]="loaded",e[e.failed=4]="failed"}(s||(s={}))},174872:(e,t,r)=>{r.d(t,{friendsRecommLogAddVisited:()=>a,friendsRecommLogCheckVisited:()=>n,friendsRecommLogCleanVisited:()=>c});var s,i=r(250682),o=r(819490);function a(e,t,r){const s=d();s[e]={ref:t,trackCode:r,date:Date.now()},i.multiAccountLs.set("friends_recomm_visited",s),window.setTimeout((()=>c(e)),o.TIME_TO_SAVE_FRIENDS_VISITED)}function n(e){return d()[e]}function c(e){if(e){const t=d();delete t[e],i.multiAccountLs.set("friends_recomm_visited",t)}else i.multiAccountLs.remove("friends_recomm_visited")}function d(){const e=i.multiAccountLs.get("friends_recomm_visited")||{};return Object.keys(e).forEach((t=>{Date.now()-e[t]?.date>o.TIME_TO_SAVE_FRIENDS_VISITED&&(delete e[t],i.multiAccountLs.set("friends_recomm_visited",e))})),Object.keys(e).length||i.multiAccountLs.remove("friends_recomm_visited"),e}!function(e){e.friends_recomm_visited="friends_recomm_visited"}(s||(s={}))},972630:(e,t,r)=>{r.d(t,{getUserBroadcastStatus:()=>s});const s=e=>{if(!e.status_audio)return null;const t={text:`${e.status_audio.artist} — ${e.status_audio.title}`};return e.status_audio.owner_id&&e.status_audio.id&&(t.audioRawId=`${e.status_audio.owner_id}_${e.status_audio.id}`),t}},819490:(e,t,r)=>{var s;r.d(t,{FRIENDS_RECOM_VISITED:()=>i,TIME_TO_SAVE_FRIENDS_VISITED:()=>o,UsersRecomStatisticEvents:()=>s}),function(e){e.ShowUserRec="show_user_rec"}(s||(s={}));const i="friends_recomm_visited",o=36e5},482567:(e,t,r)=>{r.d(t,{apiStatsTrackEvents:()=>i});var s=r(933052);function i(e){return(0,s.api)("stats.trackEvents",e)}},181938:(e,t,r)=>{r.d(t,{STATS_EVENT_TYPE_STORIES_VIEWER_NAVIGATION:()=>s,STATS_EVENT_TYPE_STORIES_VIEWING_START_TIME:()=>i,STATS_EVENT_TYPE_STORY_LINK_VIEW:()=>o,STATS_EVENT_TYPE_VIDEO_ONBOARDING:()=>a});const s="stories_viewer_navigation",i="stories_viewing_start_time",o="story_link_view",a="video_onboarding"},258504:(e,t,r)=>{r.d(t,{createStatsService:()=>o});var s=r(32489),i=r(482567);const o=({domain:e})=>{const t=e.createEvent("fire/statsTrackEvents"),r=e.createEffect("fx/statsTrackEvents");return r.use(i.apiStatsTrackEvents),(0,s.sample)({clock:t,target:r}),{fireTrackEvents:t,trackEventsFx:r}}},124401:(e,t,r)=>{r.d(t,{apiStoriesAskQuestion:()=>b,apiStoriesBanOwner:()=>C,apiStoriesBanQuestionAuthor:()=>A,apiStoriesDelete:()=>g,apiStoriesDeleteQuestion:()=>k,apiStoriesGet:()=>o,apiStoriesGetArchive:()=>d,apiStoriesGetById:()=>n,apiStoriesGetDetailedStats:()=>h,apiStoriesGetDiscover:()=>c,apiStoriesGetPhotoUploadServer:()=>O,apiStoriesGetQuestions:()=>_,apiStoriesGetReplies:()=>p,apiStoriesGetStats:()=>u,apiStoriesGetVideoUploadServer:()=>T,apiStoriesGetViewers:()=>l,apiStoriesGetWithPrefetch:()=>a,apiStoriesHideAllReplies:()=>D,apiStoriesHidePrivacyBlock:()=>v,apiStoriesHideReply:()=>P,apiStoriesMarkAppNotificationsSeen:()=>R,apiStoriesMarkNotInterested:()=>S,apiStoriesMarkSeen:()=>E,apiStoriesMarkSkipped:()=>f,apiStoriesSave:()=>I,apiStoriesSearch:()=>m,apiStoriesSetDiscoverVisible:()=>x,apiStoriesSubscribeUserToApp:()=>y,apiStoriesUnbanOwner:()=>N,apiStoriesUnbanQuestionAuthor:()=>w});var s=r(933052),i=r(793656);function o(e){return(0,s.api)("stories.get",e)}function a(e){return(0,i.apiWithPrefetch)("stories.get",e)}function n(e){return(0,s.api)("stories.getById",e)}function c(e){return(0,s.api)("stories.getDiscover",e)}function d(e){return(0,s.api)("stories.getArchive",e)}function l(e){return(0,s.api)("stories.getViewers",e)}function p(e){return(0,s.api)("stories.getReplies",e)}function _(e){return(0,s.api)("stories.getQuestions",e)}function u(e){return(0,s.api)("stories.getStats",e)}function h(e){return(0,s.api)("stories.getDetailedStats",e)}function f(e){return(0,s.api)("stories.markSkipped",e)}function S(e){return(0,s.api)("stories.markNotInterested",e)}function m(e){return(0,s.api)("stories.search",e)}function E(e){return(0,s.api)("stories.markSeen",e)}function v(e){return(0,s.api)("stories.hidePrivacyBlock",e)}function g(e){return(0,s.api)("stories.delete",e)}function b(e){return(0,s.api)("stories.askQuestion",e)}function k(e){return(0,s.api)("stories.deleteQuestion",e)}function A(e){return(0,s.api)("stories.banQuestionAuthor",e)}function w(e){return(0,s.api)("stories.unbanQuestionAuthor",e)}function R(e){return(0,s.api)("stories.markAppNotificationsSeen",e)}function y(e){return(0,s.api)("stories.subscribeUserToApp",e)}function O(e){return(0,s.api)("stories.getPhotoUploadServer",e)}function T(e){return(0,s.api)("stories.getVideoUploadServer",e)}function I(e){return(0,s.api)("stories.save",e)}function C(e){return(0,s.api)("stories.banOwner",e)}function N(e){return(0,s.api)("stories.unbanOwner",e)}function x(e){return(0,s.api)("stories.setDiscoverVisible",e)}function P(e){return(0,s.api)("stories.hideReply",e)}function D(e){return(0,s.api)("stories.hideAllReplies",e)}},371164:(e,t,r)=>{r.d(t,{STORIES_ARCHIVE_START_TIME:()=>o,STORIES_EDITOR_FONTS:()=>a,STORIES_MAX_COUNT_REPLIES:()=>i});var s=r(610989);const i=250,o=1559032200,a=[{label:s.getLang("stories_creator_text_label_modern"),fontFamily:"TT Firs Neue"},{label:s.getLang("stories_creator_text_label_playful"),fontFamily:"TT Knickerbockers Script"},{label:s.getLang("stories_creator_text_label_aesthetic"),fontFamily:"TT Knickerbockers Grotesk"},{label:s.getLang("stories_creator_text_label_dynamic"),fontFamily:"TT Commons",fontStyle:"italic"},{label:s.getLang("stories_creator_text_label_classic"),fontFamily:"TT Barrels Trl"},{label:s.getLang("stories_creator_text_label_elegant"),fontFamily:"TT Barrels Trl",fontStyle:"italic"},{label:s.getLang("stories_creator_text_label_rounded"),fontFamily:"TT Rounds Neue",textTransform:"uppercase"},{label:s.getLang("stories_creator_text_label_standard"),fontFamily:"TT Commons"},{label:s.getLang("stories_creator_text_label_handwritten"),fontFamily:"TT Lovelies Script"},{label:s.getLang("stories_creator_text_label_bookish"),fontFamily:"TT Phobos"}]},592238:(e,t,r)=>{r.d(t,{StoryFeedbackLoadMethods:()=>s,fetchFeedbackFx:()=>n,getStoryFeedbackLoadParams:()=>a});var s,i=r(666376),o=r(483534);!function(e){e[e.getViewers=0]="getViewers",e[e.getReplies=1]="getReplies",e[e.getQuestions=2]="getQuestions",e[e.getDetailedStats=3]="getDetailedStats"}(s||(s={}));const a=(e,t)=>({0:{owner_id:e,story_id:t,extended:1,count:100,fields:(0,o.makeOwnerFields)(["photo_100","photo_50"])},1:{owner_id:e,story_id:t,extended:1,fields:(0,o.getStoryOwnerFields)()},2:{owner_id:e,story_id:t,extended:1,fields:(0,o.makeOwnerFields)(["domain","first_name_dat","first_name_ins","last_name_ins","last_name_dat","first_name_gen","last_name_gen"]),count:100},3:{owner_id:e,story_id:t}}),n=i.storiesDomain.createEffect({name:"fire/storiesGetFeedback",handler:({ownerId:e,storyId:t,pollId:r})=>{const s=a(e,t);return Promise.allSettled([i.storiesService.getViewersFx(s[0]),i.storiesService.getRepliesFx(s[1]),i.storiesService.getQuestionsFx(s[2]),r?i.pollsService.getByIdFx({owner_id:e,poll_id:r}):Promise.resolve(null),i.storiesService.getDetailedStatsFx(s[3])]).then((e=>e.map((e=>"fulfilled"===e.status?e?.value:null))))}})},535277:(e,t,r)=>{r.d(t,{STORIES_ARCHIVE_START_TIME:()=>n.STORIES_ARCHIVE_START_TIME,STORIES_EDITOR_FONTS:()=>n.STORIES_EDITOR_FONTS,STORIES_MAX_COUNT_REPLIES:()=>n.STORIES_MAX_COUNT_REPLIES,StoryFeedbackLoadMethods:()=>d.StoryFeedbackLoadMethods,apiStoriesGet:()=>a.apiStoriesGet,apiStoriesGetArchive:()=>a.apiStoriesGetArchive,apiStoriesGetById:()=>a.apiStoriesGetById,apiStoriesGetDiscover:()=>a.apiStoriesGetDiscover,apiStoriesGetReplies:()=>a.apiStoriesGetReplies,apiStoriesGetWithPrefetch:()=>a.apiStoriesGetWithPrefetch,apiStoriesSearch:()=>a.apiStoriesSearch,createStoriesService:()=>s.createStoriesService,decodeBase64:()=>i.decodeBase64,faveService:()=>c.faveService,fetchFeedbackFx:()=>d.fetchFeedbackFx,getStoryFeedbackLoadParams:()=>d.getStoryFeedbackLoadParams,narrativesService:()=>c.narrativesService,saveNavigationStatEvent:()=>o.saveNavigationStatEvent,splitStoryRawId:()=>i.splitStoryRawId,statsService:()=>c.statsService,storiesService:()=>c.storiesService,userService:()=>c.userService});var s=r(179258),i=r(856996),o=r(57092),a=r(124401),n=r(371164),c=r(666376),d=r(592238)},256716:(e,t,r)=>{r.d(t,{FEED_STORIES_BLOCK_OWNER_FIELDS:()=>i,FEED_STORIES_BLOCK_OWNER_MINIMIZED_FIELDS:()=>s});const s=["photo_100"],i=["first_name","last_name","first_name_gen","last_name_gen","first_name_ins","last_name_ins","screen_name","name","is_member","is_closed","photo_50","photo_100","photo_200","friend_status","verified","sex"]},483534:(e,t,r)=>{r.d(t,{getStoryOwnerFields:()=>i,makeOwnerFields:()=>o});var s=r(256716);function i(e=!1){return o(e?s.FEED_STORIES_BLOCK_OWNER_MINIMIZED_FIELDS:s.FEED_STORIES_BLOCK_OWNER_FIELDS)}function o(e){return e.join(",")}},179258:(e,t,r)=>{r.d(t,{createStoriesService:()=>c});var s=r(32489),i=r(124401),o=r(489617),a=r(455234),n=r(175241);const c=({domain:e})=>{const t=e.createEvent("fire/storiesGet"),r=e.createEvent("fire/storiesGetById"),c=e.createEvent("fire/storiesGetArchive"),d=e.createEvent("fire/storiesGetViewers"),l=e.createEvent("fire/storiesGetReplies"),p=e.createEvent("fire/storiesGetQuestions"),_=e.createEvent("fire/storiesGetStats"),u=e.createEvent("fire/storiesGetDetailedStats"),h=e.createEvent("fire/storiesMarkSkipped"),f=e.createEvent("fire/storiesMarkNotInterested"),S=e.createEvent("fire/storiesMarkSeen"),m=e.createEvent("fire/storiesHidePrivacyBlock"),E=e.createEvent("fire/storiesDelete"),v=e.createEvent("fire/storiesAskQuestion"),g=e.createEvent("fire/storiesDeleteQuestion"),b=e.createEvent("fire/storiesBanQuestionAuthor"),k=e.createEvent("fire/storiesUnbanQuestionAuthor"),A=e.createEvent("fire/storiesMarkAppNotificationsSeen"),w=e.createEvent("fire/storiesSubscribeUserToApp"),R=e.createEvent("fire/storiesGetPhotoUploadServer"),y=e.createEvent("fire/storiesGetVideoUploadServer"),O=e.createEvent("fire/storiesSave"),T=e.createEvent("fire/storiesSearch"),I=e.createEvent("fire/storiesUnbanOwner"),C=e.createEvent("fire/storiesBanOwner"),N=e.createEvent("fire/storiesSetDiscoverVisible"),x=e.createEvent("fire/storiesHideReply"),P=e.createEvent("fire/storieHideAllReplies"),D=e.createEffect("fx/storiesGet"),L=e.createEffect("fx/storiesGetById"),M=e.createEffect("fx/storiesGetArchive"),F=e.createEffect("fx/storiesGetViewers"),U=e.createEffect("fx/storiesGetReplies"),V=e.createEffect("fx/storiesGetQuestions"),G=e.createEffect("fx/storiesGetStats"),j=e.createEffect("fx/storiesGetDetailedStats"),B=e.createEffect("fx/storiesMarkSkipped"),W=e.createEffect("fx/storiesMarkNotInterested"),H=e.createEffect("fx/storiesMarkSeen"),K=e.createEffect("fx/storiesHidePrivacyBlock"),Y=e.createEffect("fx/storiesDelete"),$=e.createEffect("fx/storiesAskQuestion"),q=e.createEffect("fx/storiesDeleteQuestion"),Q=e.createEffect("fx/storiesBanQuestionAuthor"),J=e.createEffect("fx/storiesUnbanQuestionAuthor"),z=e.createEffect("fx/storiesMarkAppNotificationsSeen"),X=e.createEffect("fx/storiesSubscribeUserToApp"),Z=e.createEffect("fx/storiesGetPhotoUploadServer"),ee=e.createEffect("fx/storiesGetVideoUploadServer"),te=e.createEffect("fx/storiesSave"),re=e.createEffect("fx/storiesSearch"),se=e.createEffect("fx/storiesUnbanOwner"),ie=e.createEffect("fx/storiesBanOwner"),oe=e.createEffect("fx/storiesSetDiscoverVisible"),ae=e.createEffect("fx/storiesHideReply"),ne=e.createEffect("fx/storiesHideAllReplies"),ce=(0,o.createFriendsAddFx)({domain:e}),de=(0,o.createFriendsDeleteFx)({domain:e}),le=(0,a.createGroupsJoinFx)({domain:e}),pe=(0,a.createGroupsLeaveFx)({domain:e});return D.use(i.apiStoriesGet),L.use(i.apiStoriesGetById),M.use(i.apiStoriesGetArchive),F.use(i.apiStoriesGetViewers),U.use(i.apiStoriesGetReplies),V.use(i.apiStoriesGetQuestions),G.use(i.apiStoriesGetStats),j.use(i.apiStoriesGetDetailedStats),B.use(i.apiStoriesMarkSkipped),W.use(i.apiStoriesMarkNotInterested),H.use(i.apiStoriesMarkSeen),K.use(i.apiStoriesHidePrivacyBlock),Y.use(i.apiStoriesDelete),$.use(i.apiStoriesAskQuestion),q.use(i.apiStoriesDeleteQuestion),Q.use(i.apiStoriesBanQuestionAuthor),J.use(i.apiStoriesUnbanQuestionAuthor),z.use(i.apiStoriesMarkAppNotificationsSeen),X.use(i.apiStoriesSubscribeUserToApp),Z.use(i.apiStoriesGetPhotoUploadServer),ee.use(i.apiStoriesGetVideoUploadServer),te.use(i.apiStoriesSave),re.use(i.apiStoriesSearch),ie.use(i.apiStoriesBanOwner),se.use(i.apiStoriesUnbanOwner),oe.use(i.apiStoriesSetDiscoverVisible),ae.use(i.apiStoriesHideReply),ne.use(i.apiStoriesHideAllReplies),(0,n.connectTrackTmrGroupsJoin)(le),(0,s.sample)({clock:t,target:D}),(0,s.sample)({clock:r,target:L}),(0,s.sample)({clock:c,target:M}),(0,s.sample)({clock:d,target:F}),(0,s.sample)({clock:l,target:U}),(0,s.sample)({clock:p,target:V}),(0,s.sample)({clock:_,target:G}),(0,s.sample)({clock:u,target:j}),(0,s.sample)({clock:h,target:B}),(0,s.sample)({clock:f,target:W}),(0,s.sample)({clock:S,target:H}),(0,s.sample)({clock:m,target:K}),(0,s.sample)({clock:E,target:Y}),(0,s.sample)({clock:v,target:$}),(0,s.sample)({clock:g,target:q}),(0,s.sample)({clock:b,target:Q}),(0,s.sample)({clock:k,target:J}),(0,s.sample)({clock:A,target:z}),(0,s.sample)({clock:w,target:X}),(0,s.sample)({clock:R,target:Z}),(0,s.sample)({clock:y,target:ee}),(0,s.sample)({clock:O,target:te}),(0,s.sample)({clock:T,target:re}),(0,s.sample)({clock:I,target:se}),(0,s.sample)({clock:C,target:ie}),(0,s.sample)({clock:N,target:oe}),(0,s.sample)({clock:x,target:ae}),(0,s.sample)({clock:P,target:ne}),{fireGet:t,fireGetById:r,fireGetArchive:c,fireGetViewers:d,fireGetReplies:l,fireGetQuestions:p,fireGetStats:_,fireGetDetailedStats:u,fireMarkSkipped:h,fireMarkNotInterested:f,fireMarkSeen:S,fireHidePrivacyBlock:m,fireDelete:E,fireAskQuestion:v,fireDeleteQuestion:g,fireBanQuestionAuthor:b,fireUnbanQuestionAuthor:k,fireMarkAppNotificationsSeen:A,fireSubscribeUserToApp:w,fireGetPhotoUploadServer:R,fireGetVideoUploadServer:y,fireSave:O,fireSearch:T,fireUnbanOwner:I,fireBanOwner:C,fireSetDiscoverVisible:N,fireHideReply:x,fireHideAllReplies:P,getFx:D,getByIdFx:L,getArchiveFx:M,getViewersFx:F,getRepliesFx:U,getQuestionsFx:V,getStatsFx:G,getDetailedStatsFx:j,markSkippedFx:B,markNotInterestedFx:W,markSeenFx:H,hidePrivacyBlockFx:K,deleteFx:Y,askQuestionFx:$,deleteQuestionFx:q,banQuestionAuthorFx:Q,unbanQuestionAuthorFx:J,markAppNotificationsSeenFx:z,subscribeUserToAppFx:X,getPhotoUploadServerFx:Z,getVideoUploadServerFx:ee,saveFx:te,searchFx:re,unbanOwnerFx:se,banOwnerFx:ie,setDiscoverVisibleFx:oe,hideReplyFx:ae,hideAllRepliesFx:ne,friendsAddFx:ce,friendsDeleteFx:de,groupsJoinFx:le,groupsLeaveFx:pe}}},666376:(e,t,r)=>{r.d(t,{faveService:()=>S,narrativesService:()=>f,pollsService:()=>m,statsService:()=>h,storiesDomain:()=>_,storiesService:()=>u,userService:()=>E});var s=r(32489),i=r(535277),o=r(258504),a=r(404440),n=r(230752),c=r(845167),d=r(898675),l=r(952597),p=r(399017);const _=(0,s.createDomain)("stories"),u=(0,i.createStoriesService)({domain:_}),h=(0,o.createStatsService)({domain:_}),f=(0,a.createNarrativesService)({domain:_}),S=((0,n.createLikesService)({domain:_}),(0,c.createMessagesService)({domain:_}),(0,d.createFaveService)({domain:_})),m=(0,l.createPollsService)({domain:_}),E=(0,p.createUserService)({domain:_})},856996:(e,t,r)=>{function s(e){return(e?.split("_")??[]).map(Number)}function i(e,t="windows-1251"){return new TextDecoder(t).decode(function(e){const t=atob(e);return Uint8Array.from(t,(e=>e.codePointAt(0)||0))}(e))}r.d(t,{decodeBase64:()=>i,splitStoryRawId:()=>s})},975118:(e,t,r)=>{r.d(t,{Publisher:()=>O});var s=r(474848),i=r(296540),o=r(20025),a=r(850101),n=r(583652),c=r(610989),d=r(303568),l=r(803464),p=r(87223),_=r(705744),u=r(580129),h=r(825534),f=r(675770),S=r(505954),m=r(753457),E=r(8520),v=r(18395),g=r(808444),b=r(794353),k=r(944933),A=r(377056),w=r(296617),R=r(476726),y=r(43591);class O extends i.Component{componentWillUnmount(){this.ordData=null}render(){const e=(0,R.partConfigEnabled)("stories_sticker_template"),t=Math.min(900,window.innerHeight-100),r=t/1.78,i=(0,h.getPhotoEditorLangMap)();window.cur.photoEditorEntryPoint="history";const a=this.props.stickers?.filter((t=>"native"!==t.sticker_type||"situational_template"!==t.sticker?.action_type||e));return(0,s.jsx)(S.AppRootProvider,{mode:"embedded",platform:m.Platform.VKCOM,viewWidth:m.ViewWidth.DESKTOP,children:(0,s.jsx)(n.BaseModal,{disableBodyScroll:!0,onClose:()=>this.onClose(),className:(0,E.classNames)("PhotoEditorTheme PhotoEditorTheme--old Publisher",{"Publisher--zIndexLow":this.props.entrypoint===d.StoryEntryPoint.STORIES_FEED||this.props.entrypoint===d.StoryEntryPoint.STORY_REPOST}),children:(0,s.jsx)(v.PhotoEditor,{context:"story",isAppStickerDisabled:(0,R.partConfigEnabled)("remove_stories_sticker_app"),photoUrl:this.props.photoUrl,backgroundId:this.props.backgroundId,artboardWidth:r,artboardHeight:t,acceptImageTypes:g.DEFAULT_ACCEPT,prepareImageFile:this.prepareImageFile,save:this.save,close:()=>this.onClose(),attachment:this.props.attachment,stickers:a,serviceInfo:this.props.serviceInfo,showStatusActions:!0,statusPanelLeftSideNode:this.props.entrypoint!==d.StoryEntryPoint.MINI_APP&&(0,s.jsx)(w.ActionsMenu,{setOrdData:this.setOrdData}),helpers:{showErrorBox:(e,t)=>(0,o.showFastBox)({title:e},t),logError:e=>(0,p.logError)(e,{environment:"photoEditor"}),getHostName:_.getHostName,prepareStat:u.prepareStat,sendStat:u.sendStat,showStickerShop:f.showStickerShop,fetchStickers:f.fetchStickers,getPhotoEditorData:f.getPhotoEditorData},langMap:i,locked:this.props.locked,storeInit:e=>{window.cur.photoEditorStore=e,(0,E.isFunction)(this.props.onInit)&&this.props.onInit(),(0,u.sendStat)("open_editor")},onDestroy:()=>{delete window.cur.photoEditorStore,delete window.cur.storyPublishContext,delete window.cur.photoEditorEntryPoint},refCb:e=>{e&&(window.cur.renderImageFromState=e.renderImageFromState)}})})})}saveStory(e,t){return(0,l.getStoryUploadUrl)(t,d.StoryType.PHOTO).then((t=>(0,l.uploadStoryBlobToServer)(e,t))).then((e=>(0,l.saveStoryOnServer)(e,d.StoryType.PHOTO)))}constructor(...e){super(...e),this.setOrdData=e=>{this.ordData=e},this.errorHandler=(e,t)=>{const r=e||c.getLang("global_error");(0,o.showFastBox)({title:c.getLang("global_error")},r,c.getLang("global_close"),(()=>{t(),(0,a.curBox)()?.hide()}))},this.save=(e,t,r={})=>{const s=r.storyUploadUrlHash;let i=0,o=0;try{const e=JSON.parse(r.clickableStickers);i=e.original_width,o=e.original_height}catch(e){i=0,o=0}(0,y.trackStoryUploadStart)(s),this.props.onClickSave(),this.saveStory(e,{attachment:JSON.stringify(this.props.attachment),clickable_stickers:r.clickableStickers,mini_app_id:this.props.miniAppId,question_id:this.props.questionId,situational_suggest_id:this.props.serviceInfo?.situational_suggest_id,analytics:r.analytics,hash:r.storyUploadUrlHash,entry_point:this.props.entrypoint,ref:window.cur.module,is_authors_ads:this.ordData?.is_ad,ord_external_id:this.ordData?.ord_pred_id,ord_erid:this.ordData?.erid}).then((e=>{const r=e.story;(0,y.trackStoryUploadEnd)(s,{storyOwnerId:r.owner_id,storyId:r.id,storyType:"photo"===r.type?"photo":"video",height:o,width:i}),this.onClose(!0,!1,e),t()})).catch((e=>((0,y.trackStoryUploadFailure)(s,e),this.errorHandler(e,t),!0))),(0,u.sendStat)("save")},this.prepareImageFile=async e=>{if((0,k.isHeicFile)(e))try{const{url:t}=await(0,A.convertHeicToJpg)(e,window.vk.id),r=await(0,_.getMediaBlob)(t);return new File([r],e.name)}catch(e){if(e?.error_code===b.GO_UPLOADER_ERROR_INCORRECT_SIZE)throw(0,c.langReplace)(c.getLang("global_update_photo_error_too_big"),{width:String(b.GO_UPLOADER_MAX_WIDTH_DEFAULT),height:String(b.GO_UPLOADER_MAX_HEIGHT_DEFAULT)})}return e},this.onClose=(e,t,r)=>{if(t)this.props.onClose(!1);else if(e)window.Stories&&window.Stories.updateFeedStories&&window.Stories.updateFeedStories(),this.props.onClose(!0,r);else{window.cur.photoEditorStore?.getState()?.past.length>1||this.ordData?(0,o.showFastBox)({title:c.getLang("photos_pe_story_editor_close_title"),bodyStyle:"padding: 20px; line-height: 160%;",onShow:()=>{window.cur._noEscHide=!0},onClean:()=>{window.cur._noEscHide=!1}},c.getLang("photos_pe_story_editor_close_text"),c.getLang("box_yes"),(()=>{(0,a.curBox)()?.hide(),this.props.onClose(!1)}),c.getLang("box_no"),(()=>{(0,a.curBox)()?.hide()})):this.props.onClose(!1)}}}}},296617:(e,t,r)=>{r.d(t,{ActionsMenu:()=>p});var s=r(474848),i=r(296540),o=r(79479),a=r(349826),n=r(533048),c=r(610989),d=r(906357),l=r(580129);const p=e=>{const[t,r]=(0,i.useState)(null),p=t=>{r(t),e.setOrdData(t)};return(0,s.jsx)(a.DropdownActionSheet,{trigger:"hover",placement:"top-start",content:(0,s.jsx)(a.DropdownActionSheet.Item,{onClick:e=>{e.stopPropagation(),t?.is_ad?(0,l.sendStat)(l.EVENTS.EDIT_ADVERTISER_MARK):(0,l.sendStat)(l.EVENTS.MARK_ADVERTISER),(0,d.handleOrdMiniappOpen)(t,p,{isSnackbar:!0,edit:!1})},children:t?.is_ad?c.getLang("global_ads_wall_post_ord_mark_as_ads_activated"):c.getLang("global_ads_wall_post_ord_mark_as_ads")}),children:(0,s.jsx)(n.Button,{mode:"tertiary",appearance:"accent",before:(0,s.jsx)(o.Icon16MoreHorizontal,{}),"aria-label":c.getLang("stories_publish_actions_menu")})})}},705074:(e,t,r)=>{r.d(t,{StoryPublisher:()=>p});var s=r(474848),i=r(440961),o=r(975118),a=r(850101),n=r(610989),c=r(20025),d=r(580129),l=r(825534);const p={init(e,t,r,s){this.onClickSave=t||(()=>{}),this.cb=r,this.onInit=s,Promise.all([this.loadStatic(),(0,l.loadPhotoEditorLangs)()]).then((()=>{this.render(e)})).catch((()=>{(0,c.showFastBox)({title:n.getLang("global_error")},n.getLang("global_error"),n.getLang("global_close"),(()=>{(0,a.curBox)()?.hide()}))}))},loadStatic:()=>window.stManager.add([window.jsc("web/story_publisher.js")]),render(e){const t=e?.entrypoint||"",r=e?.miniAppId||0;window.cur.storyPublishContext=!0,"story_repost"===t?(0,d.sendStat)(d.EVENTS.ADD_STORY_FROM_SHARING):(0,d.sendStat)(d.EVENTS.ADD_STORY);let a=document.querySelector(".StoryPublisher");a||(a=document.createElement("div"),a.classList.add("StoryPublisher"),document.body.appendChild(a)),i.render((0,s.jsx)(o.Publisher,{entrypoint:t,miniAppId:r,onClose:this.destroy.bind(this),onClickSave:this.onClickSave.bind(this),photoUrl:e?.photoUrl,attachment:e?.attachment,stickers:e?.stickers,serviceInfo:e?.serviceInfo,questionId:e?.questionId,backgroundId:e?.backgroundId,locked:e?.locked,onInit:this.onInit}),a)},destroy(e,t){const r=document.querySelector(".StoryPublisher");if(r&&i.unmountComponentAtNode(r),this.cb&&this.cb(e,t),delete window.cur.photoEditorStore,delete window.cur.renderImageFromState,e){if(t?.story){const{id:e,owner_id:r}=t?.story;if(e&&r)return void(0,a.showDoneBox)(`\n              <div style="margin-bottom: 8px;">${n.getLang("photos_pe_story_published")}</div>\n              <a href="/story${r}_${e}" target="_blank">\n                 ${n.getLang("photos_open_story_link_text")}\n              </a>\n            `)}(0,a.showDoneBox)(n.getLang("photos_pe_story_published"))}}}},28949:(e,t,r)=>{var s=r(490712),i=r(705074);window.vk?.pe?.static_manager_dynamic_imports&&window.vk?.stDomain&&(r.p=window.vk.stDomain+"/dist/"),window.StoryPublisher=i.StoryPublisher;try{window.stManager.done(window.jsc("web/story_publisher.js"))}catch(e){}requestIdleCallback((()=>{try{(0,s.statlogsValueEvent)("entries_requests",1,"story_publisher","web")}catch{}}),{timeout:5e3})},906357:(e,t,r)=>{r.d(t,{handleOrdMiniappOpen:()=>d});var s=r(422109),i=r(340257),o=r(610989),a=r(188616),n=r(659179),c=r(51963);const d=(e,t,r,d)=>{const l=d?{...e,service:d}:e,p=l?(0,s.objectToQuerystring)(l,"#"):"",_=(0,a.getStore)().onOrdData.watch((s=>{r?.isSnackbar&&(s?.is_ad&&!e?.is_ad?(0,n.showSnackbar)({text:o.getLang("global_ads_wall_post_ord_mark_as_ads_added"),timeout:3e3,type:"ok28"}):!s?.is_ad&&e?.is_ad&&(0,n.showSnackbar)({text:o.getLang("global_ads_wall_post_ord_mark_as_ads_removed"),timeout:3e3,type:"loudspeaker28"})),t(s,r?.ref),_()}));r=r||{};const u={...r,options:{...r.options||{}}},{onDestroy:h,onLoaded:f}=u.options;u.options.asBox?u.options.onDestroy=(...e)=>{h?.(...e),_()}:u.options.onLoaded=(...e)=>{f?.(...e),(0,c.addWkViewHideQueue)((()=>_()))},window.showWiki?.({w:`app${i.ORD_APP_ID}${p}`},u?.edit,u?.ev,u?.options)}},617430:(e,t,r)=>{r.d(t,{friendsRecommLogClear:()=>l,friendsRecommLogGet:()=>d,friendsRecommLogOnFail:()=>u,friendsRecommLogSave:()=>c,friendsRecommLogSend:()=>p,getRef:()=>n});var s,i=r(250682),o=r(879007),a=r(624216);!function(e){e.friends_recomm="friends_recomm"}(s||(s={}));const n=()=>"feed"===window.cur.module&&window.Feed?window.Feed?.getModuleRef():window.cur.module;function c(e,t=!1){const r=d();r.push(e),i.multiAccountLs.set("friends_recomm",r),p(t)}function d(e=!1,t,r=!1){const s=i.multiAccountLs.get("friends_recomm");let a=Array.isArray(s)?s:[];return t&&(a=a.filter((e=>(r?e[1]!==t:e[1]===t)&&(0,o.inArray)(e[0],["show_user_rec","open_user"])))),e&&(a=a.map((e=>e.join("|")))),a}function l(e){if(e){const t=d(!1,e,!0);t.length?i.multiAccountLs.set("friends_recomm",t):i.multiAccountLs.remove("friends_recomm")}else i.multiAccountLs.remove("friends_recomm")}function p(e=!1){!window.cur?.friendsRecommLogIdle&&window?.curNotifier?.idle_manager&&(Array.isArray(window.cur.onIdle)||(window.cur.onIdle=[]),Array.isArray(window.cur.onUnidle)||(window.cur.onUnidle=[]),window.cur.friendsRecommLogIdle=()=>{clearTimeout(window.cur.friendsRecommLog)},window.cur.onIdle.push(window.cur.friendsRecommLogIdle),window.cur.onUnidle.push(p)),clearTimeout(window.cur.friendsRecommLog),e?_():window.cur.friendsRecommLog=window.setTimeout(_,1e4)}function _(){if(window.cur.friendsRecommProcess)return;const e=d(!0);e.length&&(window.cur.friendsRecommProcess=!0,l(),a.ajax.post("al_friends.php",{act:"a_recomm_logs",logs:e},{onDone:()=>{delete window.cur.friendsRecommProcess},onFail:()=>(u(e),delete window.cur.friendsRecommProcess,!0)}))}function u(e){let t=d();t=e.map((e=>e.split("|"))).concat(t),i.multiAccountLs.set("friends_recomm",t)}},961768:(e,t,r)=>{r.d(t,{fetchDataOnAvatarEdit:()=>k,fetchDataOnCoverUpdate:()=>b,fetchDataOnWebProfileItemStat:()=>A,getOwnerCoverPhotoUploadServer:()=>m,removeFromFollowers:()=>S,removeFromFriends:()=>f,removeOwnerCoverPhoto:()=>v,saveOwnerCoverPhoto:()=>g,sendHideOnboardingCards:()=>E,showValidationError:()=>w});var s=r(933052),i=r(451694),o=r(617430),a=r(174872),n=r(756758),c=r(927138),d=r(566282),l=r(20025),p=r(610989),_=r(877414),u=r(581903),h=r(695290);function f(e){const t=e.id,r={user_id:t},i=(0,a.friendsRecommLogCheckVisited)(t);return i&&(r.ref=(0,o.getRef)(),i.trackCode&&(r.track_code=i.trackCode),(0,a.friendsRecommLogCleanVisited)(t)),(0,s.api)("friends.delete",r).then((r=>((0,n.tryLogOutOfSerpClick)(n.outOfSerpProfile,t,n.clickTypeRemoveFriendOut),u.searchStatsCollector.logOutOfSerpEvent({action:"follow"===e.social_button_type?h.SearchClickActionMap.UNSUBSCRIBE_OUT:h.SearchClickActionMap.REMOVE_FRIEND_OUT,type:h.EventItemType.USER}),r)))}function S({id:e}){const t={subscriber_id:e};return(0,s.api)("friends.deleteSubscriber",t)}function m(e){return(0,s.api)("photos.getOwnerCoverPhotoUploadServer",e)}function E(){return(0,s.api)("onboarding.hideCardsBlock",{})}function v(){return(0,s.api)("photos.removeOwnerCoverPhoto",{})}function g(e){return(0,s.api)("photos.saveOwnerCoverPhoto",e)}function b(e){return(0,d.execute)({"users.get":{user_ids:String(e),fields:"cover,photo_avg_color"}}).then((e=>{if(!e["users.get"]){const e=new Error("something wrong with owner loading");throw(0,_.logProfileError)({error:e}),e}return{owner:e["users.get"][0]}}))}function k(e){return(0,d.execute)({"users.get":{user_ids:e.toString(),fields:"has_photo,image_status,photo_max,photo_medium_rec,photo_rec,photo_200,photo_400,photo_avg_color,photo_id,photo_max_size,is_nft"},"photos.get":{owner_id:e,album_id:"profile",rev:1,count:1},"photos.getAll":{owner_id:e,photo_sizes:1,extended:1,skip_hidden:1},"stories.get":{owner_id:e}}).then((e=>{const t={};return e["users.get"]&&(t.owner=e["users.get"][0]),e["photos.get"]&&(t.avatar=e["photos.get"].items[0]),e["stories.get"]&&(t.stories=e["stories.get"]),e["photos.getAll"]&&(t.photos={response:e["photos.getAll"],status:c.LoadingStatus.loaded}),t}))}function A(e){return(0,s.api)("users.get",{user_ids:e.toString(),fields:"id,cover,verified,image_status,has_photo,status,friend_status,profile_buttons,third_party_buttons"}).then((([e])=>e)).catch((e=>{(0,_.logProfileError)({error:e,additionalText:"something wrong with getting owner for stat"})}))}function w(e){(0,l.showFastBox)(p.getLang("friends_add_phone_validation_error_title"),(0,p.langSex)(e.sex||i.BaseSexEnumNames.UNKNOWN,p.getLang("friends_add_phone_validation_error","raw")).replace("{name}",e.first_name_dat||""),p.getLang("friends_add_phone_validation_error_action"),(()=>window.nav.go("/settings?validate=1")),p.getLang("global_cancel"))}},43591:(e,t,r)=>{r.d(t,{trackStoryUploadEnd:()=>d,trackStoryUploadFailure:()=>l,trackStoryUploadStart:()=>c});var s=r(349471),i=r(169834),o=r(147937),a=r(739739),n=r(423522);function c(e){if(!(0,n.isStoryPerfStatsEnabledOnDesktopWeb)())return;const t=(0,a.composeEventObject)(i.StoryEventType.UPLOAD_START);(0,s.saveStoryTechStatsEvent)(t,e)}function d(e,t){if(!(0,n.isStoryPerfStatsEnabledOnDesktopWeb)())return;const r=(0,s.calculateTimeDeltaFromPriorEvent)(i.StoryEventType.UPLOAD_START,e)||0,o=(0,a.composeEventObject)(i.StoryEventType.UPLOAD,{metric_value:r,story_info:{owner_id:t.storyOwnerId,content_id:t.storyId,content_type:t.storyType,width:t.width,height:t.height,duration:"video"===t.storyType&&t.videoDuration?t.videoDuration:0}});(0,s.collectStoryTechStatsEvent)(o),(0,s.resetStoryTechStatsStorage)(e,i.StoryEventType.UPLOAD_START)}function l(e,t){if(!(0,n.isStoryPerfStatsEnabledOnDesktopWeb)())return;const r=(0,a.composeEventObject)(i.StoryEventType.UPLOAD,{error_type:i.StoryErrorType.UPLOAD,error_description:(0,o.stringifyUnknown)(t)});(0,s.collectStoryTechStatsEvent)(r),(0,s.resetStoryTechStatsStorage)(e,i.StoryEventType.UPLOAD_START)}},377056:(e,t,r)=>{r.d(t,{convertHeicToJpg:()=>a,getImageDataFromStorageResponse:()=>o});var s=r(375827),i=r(961768);function o(e,t){return new Promise(((r,s)=>{window.ajax.post("al_page.php",{act:"get_photo_url",oid:e,photo:t},{onDone:(e,t,s)=>{r([e,t,s])},onFail:()=>(s(),!0)})}))}const a=async(e,t)=>{const{upload_url:r}=await(0,i.getOwnerCoverPhotoUploadServer)({upload_v2:1}),a=await(0,s.uploadFile)([{blob:e,name:"file1"}],r).promise,n=JSON.parse(a);if(n?.error_code)throw n;const[c,d,l]=await o(t,a);return{url:c,width:d,height:l,storageResponse:a}}}},n={};function c(e){var t=n[e];if(void 0!==t)return t.exports;var r=n[e]={id:e,loaded:!1,exports:{}};return a[e].call(r.exports,r,r.exports,c),r.loaded=!0,r.exports}c.m=a,e=[],c.O=(t,r,s,i)=>{if(!r){var o=1/0;for(l=0;l<e.length;l++){for(var[r,s,i]=e[l],a=!0,n=0;n<r.length;n++)(!1&i||o>=i)&&Object.keys(c.O).every((e=>c.O[e](r[n])))?r.splice(n--,1):(a=!1,i<o&&(o=i));if(a){e.splice(l--,1);var d=s();void 0!==d&&(t=d)}}return t}i=i||0;for(var l=e.length;l>0&&e[l-1][2]>i;l--)e[l]=e[l-1];e[l]=[r,s,i]},c.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return c.d(t,{a:t}),t},r=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,c.t=function(e,s){if(1&s&&(e=this(e)),8&s)return e;if("object"==typeof e&&e){if(4&s&&e.__esModule)return e;if(16&s&&"function"==typeof e.then)return e}var i=Object.create(null);c.r(i);var o={};t=t||[null,r({}),r([]),r(r)];for(var a=2&s&&e;"object"==typeof a&&!~t.indexOf(a);a=r(a))Object.getOwnPropertyNames(a).forEach((t=>o[t]=()=>e[t]));return o.default=()=>e,c.d(i,o),i},c.d=(e,t)=>{for(var r in t)c.o(t,r)&&!c.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},c.f={},c.e=e=>Promise.all(Object.keys(c.f).reduce(((t,r)=>(c.f[r](e,t),t)),[])),c.u=e=>45458===e?"web/chunks/hls.c49a3f53.js":56229===e?"web/chunks/366130d1.async.1c06797d.js":30072===e?"web/chunks/showCaptchaPopup.a4740a52.js":19072===e?"web/chunks/left_menu_store.b41d694b.js":42255===e?"web/chunks/wikiModalExampleInitiator.bf570c13.js":56965===e?"web/chunks/stories_web_lib.ba126e07.js":17213===e?"web/chunks/2bd60279.async.ea157d31.js":42943===e?"web/chunks/video_web_lib.782f771d.js":53927===e?"web/chunks/questions_boxes_web.d05c4563.js":40482===e?"web/chunks/0ca8e07a.async.981f6895.js":12679===e?"web/chunks/2c4420c0.async.0fa14a60.js":40617===e?"web/chunks/93bd35f8.async.944fc663.js":27602===e?"web/chunks/2fea6d3f.async.fa8b17c6.js":24535===e?"web/chunks/4e9ddeeb.async.0371d26b.js":74336===e?"web/chunks/show_audio_playlist.c4ee742f.js":93033===e?"web/chunks/a6f550f7.async.84ccbfa1.js":89870===e?"web/chunks/5ad2d924.async.2e93ba52.js":17895===e?"web/chunks/money_transfer_box.50183b92.js":50905===e?"web/chunks/money_transfer.e2c2d345.js":21608===e?"web/chunks/bf8fbce1.async.1f467086.js":66118===e?"web/chunks/6fb21264.async.74f2b319.js":36237===e?"web/chunks/2fb8e07d.async.2c799e4e.js":56154===e?"web/chunks/cc6f5392.async.8d8a5bcd.js":58292===e?"web/chunks/437a8ce6.async.378b5454.js":49925===e?"web/chunks/8af15a4d.async.5eadc2fd.js":68349===e?"web/chunks/5f266f5f.async.3ed461f1.js":25459===e?"web/chunks/2c9432b5.async.06e9b990.js":84835===e?"web/chunks/unauth_action_box.29aa267e.js":23045===e?"web/chunks/0d674423.async.5458427b.js":71247===e?"web/chunks/364659da.async.59a0e75a.js":59886===e?"web/chunks/StoryPublisherV2.2ad86f85.js":70989===e?"web/chunks/4b497ab9.async.e13543c1.js":29311===e?"web/chunks/feed-client-nav-skeleton.774b8a5c.js":56091===e?"web/chunks/feed-client-nav-async-right-block.323099af.js":1715===e?"web/chunks/AudioLongtapModal.d6e38506.js":96649===e?"web/chunks/ecomm_market_product_attach.e1343ea9.js":51713===e?"web/chunks/voice_message_player.172315d5.js":9925===e?"web/chunks/speech.257a7e64.js":73214===e?"web/chunks/SilentModeForms.c8c406fe.js":6694===e?"web/chunks/menu_settings.f0cec8c6.js":69706===e?"web/chunks/e0383668.async.b99eb451.js":98875===e?"web/chunks/027f56ea.async.9c2d9378.js":43802===e?"web/chunks/d5b01a55.async.6a0ae0bd.js":59956===e?"web/chunks/463a83c5.async.fb5925ed.js":60648===e?"web/chunks/9c7a90fd.async.29f1c0c3.js":36502===e?"web/chunks/NewStickerPicker.2b684d9a.js":23666===e?"web/chunks/rlottie.a7019eea.js":65437===e?"web/chunks/06f378a9.async.f54ff907.js":52731===e?"web/chunks/stickers-layer-view.8b6ecd29.js":16846===e?"web/chunks/stickers-layer-purchase-details-view.79416845.js":64273===e?"web/chunks/stickers-random-selector-view.7604d0a6.js":12318===e?"web/chunks/stickers-random-selector-packs-view.18dd3b30.js":71409===e?"web/chunks/stickers-random-selector-result-view.c13970f4.js":52007===e?"web/chunks/gift-modal-legacy.7fe8577b.js":73248===e?"web/chunks/5792d39d.async.ad94820b.js":42099===e?"web/chunks/58131fc9.async.2e7c43e3.js":51943===e?"web/chunks/VideoUpload.8e2a8bde.js":10504===e?"web/chunks/StoriesCreatorVKApp.f31236ac.js":54833===e?"web/chunks/performance-stats.99d41d48.js":57088===e?"web/chunks/79f739a7.async.7b7d443d.js":32643===e?"web/chunks/story_blocks.0da84ca4.js":99595===e?"web/chunks/ReportForm.ee85cb0b.js":64695===e?"web/chunks/e9ea6e09.async.8b6d2dfe.js":7894===e?"web/chunks/StickersKit-AgeRestrictionModal.a627c8ef.js":13410===e?"web/chunks/283c0b16.async.33f5912b.js":17448===e?"web/chunks/b1bc3b17.async.86dcbc32.js":99370===e?"web/chunks/VideoEditorModal.cd800b6f.js":95805===e?"web/chunks/PublishClipToVideoModal.fb197348.js":91906===e?"web/chunks/VideoUploadModal.07557685.js":74205===e?"web/chunks/VideoExternalUploadModal.15030051.js":36637===e?"web/chunks/ClipUploadModal.bb853a52.js":18493===e?"web/chunks/AddClipToVideoBlock.d29cc984.js":40953===e?"web/chunks/AddClipToVideoModal.6f004f3e.js":60274===e?"web/chunks/ClipPlayerModule.600f713b.js":60899===e?"chunks/"+e+".0471a2c1.js":40074===e?"chunks/"+e+".4d8e0cba.js":37557===e?"chunks/"+e+".46b5840d.js":29290===e?"chunks/"+e+".b54ef2c0.js":{17356:"web/chunks/videoplayer-interactive",57407:"web/chunks/shopify"}[e]+"."+{17356:"95a5926a",57407:"78df6599"}[e]+".js",c.miniCssF=e=>30072===e?"web/chunks/eba149c1.css":{74336:1,17895:1,50905:1}[e]?"web/chunks/43d06ff5.css":59886===e?"web/chunks/c3646f82.css":1715===e?"web/chunks/4aa73755.css":96649===e?"web/chunks/8272fe04.css":73214===e?"web/chunks/122e7a6e.css":6694===e?"web/chunks/c08e1f96.css":36502===e?"web/chunks/69f2cbe9.css":23666===e?"web/chunks/68f9f3a8.css":52731===e?"web/chunks/0972225c.css":16846===e?"web/chunks/3318c635.css":64273===e?"web/chunks/d57562b6.css":12318===e?"web/chunks/0ef038a3.css":71409===e?"web/chunks/d2224ca1.css":51943===e?"web/chunks/443c0dba.css":10504===e?"web/chunks/8a71df77.css":32643===e?"web/chunks/1deee1aa.css":99595===e?"web/chunks/fb872de1.css":7894===e?"web/chunks/5ea70f5a.css":99370===e?"web/chunks/aa88a2a7.css":95805===e?"web/chunks/70c35bc4.css":{91906:1,74205:1,36637:1}[e]?"web/chunks/f89919fd.css":18493===e?"web/chunks/85bd25a0.css":40953===e?"web/chunks/d66415b4.css":60274===e?"web/chunks/a9cca8ef.css":void 0,c.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),c.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s={},c.l=(e,t,r,i)=>{if(s[e])s[e].push(t);else{var o,a;if(void 0!==r)for(var n=document.getElementsByTagName("script"),d=0;d<n.length;d++){var l=n[d];if(l.getAttribute("src")==e||l.getAttribute("data-webpack")=="vk:"+r){o=l;break}}o||(a=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,c.nc&&o.setAttribute("nonce",c.nc),o.setAttribute("data-webpack","vk:"+r),o.src=e),s[e]=[t];var p=(t,r)=>{o.onerror=o.onload=null,clearTimeout(_);var i=s[e];if(delete s[e],o.parentNode&&o.parentNode.removeChild(o),i&&i.forEach((e=>e(r))),t)return t(r)},_=setTimeout(p.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=p.bind(null,o.onerror),o.onload=p.bind(null,o.onload),a&&document.head.appendChild(o)}},c.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.p="/dist/",i=e=>new Promise(((t,r)=>{var s=c.miniCssF(e),i=c.p+s;if(((e,t)=>{for(var r=document.getElementsByTagName("link"),s=0;s<r.length;s++){var i=(a=r[s]).getAttribute("data-href")||a.getAttribute("href");if("stylesheet"===a.rel&&(i===e||i===t))return a}var o=document.getElementsByTagName("style");for(s=0;s<o.length;s++){var a;if((i=(a=o[s]).getAttribute("data-href"))===e||i===t)return a}})(s,i))return t();((e,t,r,s)=>{var i=document.createElement("link");i.rel="stylesheet",i.type="text/css",i.onerror=i.onload=o=>{if(i.onerror=i.onload=null,"load"===o.type)r();else{var a=o&&("load"===o.type?"missing":o.type),n=o&&o.target&&o.target.href||t,c=new Error("Loading CSS chunk "+e+" failed.\n("+n+")");c.code="CSS_CHUNK_LOAD_FAILED",c.type=a,c.request=n,i.parentNode.removeChild(i),s(c)}},i.href=t,document.head.appendChild(i)})(e,i,t,r)})),o={18440:0},c.f.miniCss=(e,t)=>{o[e]?t.push(o[e]):0!==o[e]&&{1715:1,6694:1,7894:1,10504:1,12318:1,16846:1,17895:1,18493:1,23666:1,30072:1,32643:1,36502:1,36637:1,40953:1,50905:1,51943:1,52731:1,59886:1,60274:1,64273:1,71409:1,73214:1,74205:1,74336:1,91906:1,95805:1,96649:1,99370:1,99595:1}[e]&&t.push(o[e]=i(e).then((()=>{o[e]=0}),(t=>{throw delete o[e],t})))},(()=>{c.b=document.baseURI||self.location.href;var e={18440:0};c.f.j=(t,r)=>{var s=c.o(e,t)?e[t]:void 0;if(0!==s)if(s)r.push(s[2]);else{var i=new Promise(((r,i)=>s=e[t]=[r,i]));r.push(s[2]=i);var o=c.p+c.u(t),a=new Error;c.l(o,(r=>{if(c.o(e,t)&&(0!==(s=e[t])&&(e[t]=void 0),s)){var i=r&&("load"===r.type?"missing":r.type),o=r&&r.target&&r.target.src;a.message="Loading chunk "+t+" failed.\n("+i+": "+o+")",a.name="ChunkLoadError",a.type=i,a.request=o,s[1](a)}}),"chunk-"+t,t)}},c.O.j=t=>0===e[t];var t=(t,r)=>{var s,i,[o,a,n]=r,d=0;if(o.some((t=>0!==e[t]))){for(s in a)c.o(a,s)&&(c.m[s]=a[s]);if(n)var l=n(c)}for(t&&t(r);d<o.length;d++)i=o[d],c.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return c.O(l)},r=self.webpackChunkvkweb=self.webpackChunkvkweb||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var d=c.O(void 0,[91498,50560,89631,85172,762,21529,79210,99364,35623,81765,23592,25304,73085,18373,18887,12042,82314],(()=>c(28949)));d=c.O(d)})();