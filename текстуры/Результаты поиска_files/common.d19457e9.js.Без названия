/*! For license information please see common.d19457e9.js.LICENSE.txt */
(self.webpackChunkvkweb=self.webpackChunkvkweb||[]).push([[23592],{926505:(e,t,o)=>{"use strict";o.r(t),o.d(t,{Embedded:()=>i});var i=function(){function e(e){var t=this;this.receiver=!1,this._requestId=1,this._requests={},this._onMessage=function(e){if(e.origin===t.origin&&e.data&&e.data.embeddedName===t.name){t.target=e.source;var o=e.data,i=o.response;if(i){var s=t._requests[i];s&&s(o.data),t._requests[i]=null}else o.request&&o.action&&Promise.resolve(t.onMessage(o.action,o.data)).then((function(e){t._sendResponse(o.request,o.action,e)}))}},this.name=e.name,this.target=e.target,this.origin=e.origin||"https://"+e.host,this.receiver=e.receiver||!1,this.onMessage=e.onMessage,window.addEventListener("message",this._onMessage,!1)}return e.prototype._sendResponse=function(e,t,o){this.target&&this.target.postMessage({embeddedName:this.name,action:t,response:e,data:o},this.origin)},e.prototype.sendMessage=function(e,t){var o=this;if(void 0===t&&(t={}),!this.target)return Promise.reject();var i=this._requestId,s=new Promise((function(e){o._requestId++,o._requests[i]=e}));return this.target.postMessage({embeddedName:this.name,action:e,data:t,request:i},this.origin),s},e.prototype.destroy=function(){window.removeEventListener("message",this._onMessage,!1),this.target=void 0},e}()},168799:(e,t,o)=>{"use strict";o.d(t,{Icon20Check:()=>i});var i=(0,o(844990).makeIcon)("Icon20Check","check_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20" id="check_20"><path fill-rule="evenodd" d="M17.53 5.22a.75.75 0 0 1 0 1.06l-9.5 9.5a.75.75 0 0 1-1.06 0l-4.5-4.5a.75.75 0 1 1 1.06-1.06l3.97 3.97 8.97-8.97a.75.75 0 0 1 1.06 0" clip-rule="evenodd" /></symbol>',20,20,!1,void 0)},490363:(e,t,o)=>{"use strict";o.d(t,{Icon20ListPlusOutline:()=>i});var i=(0,o(844990).makeIcon)("Icon20ListPlusOutline","list_plus_outline_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20" id="list_plus_outline_20"><path fill-rule="evenodd" d="M2 4.75A.75.75 0 0 1 2.75 4h14.5a.75.75 0 0 1 0 1.5H2.75A.75.75 0 0 1 2 4.75m0 5A.75.75 0 0 1 2.75 9h8.5a.75.75 0 0 1 0 1.5h-8.5A.75.75 0 0 1 2 9.75M15.5 11a.75.75 0 0 1 .75.75V14h2.25a.75.75 0 0 1 0 1.5h-2.25v2.25a.75.75 0 0 1-1.5 0V15.5H12.5a.75.75 0 0 1 0-1.5h2.25v-2.25a.75.75 0 0 1 .75-.75M2 14.75a.75.75 0 0 1 .75-.75H8a.75.75 0 0 1 0 1.5H2.75a.75.75 0 0 1-.75-.75" clip-rule="evenodd" /></symbol>',20,20,!1,void 0)},203788:(e,t,o)=>{"use strict";o.d(t,{Icon20PodcastOutline:()=>i});var i=(0,o(844990).makeIcon)("Icon20PodcastOutline","podcast_outline_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" id="podcast_outline_20"><g fill="none" fill-rule="evenodd"><path d="M0 0h20v20H0z" opacity=".4" /><path fill="currentColor" fill-rule="nonzero" d="M10 5a4 4 0 0 1 4 4v3c0 1.953-1.4 3.578-3.25 3.93v1.32a.75.75 0 1 1-1.5 0v-1.32A4 4 0 0 1 6 12V9a4 4 0 0 1 4-4m0 1.5A2.5 2.5 0 0 0 7.5 9v3a2.5 2.5 0 0 0 4.502 1.498l-.13.002H10.45a.75.75 0 1 1 0-1.5h2.05v-1.5h-2.05a.75.75 0 1 1 0-1.5h2.05A2.5 2.5 0 0 0 10 6.5M10 2a7 7 0 0 1 6.938 6.065A1.5 1.5 0 0 1 18 9.5v3a1.5 1.5 0 0 1-3 0v-3c0-.428.18-.815.468-1.088a5.5 5.5 0 0 0-5.247-4.908L10 3.5a5.5 5.5 0 0 0-5.469 4.912c.29.273.469.66.469 1.088v3a1.5 1.5 0 0 1-3 0v-3a1.5 1.5 0 0 1 1.062-1.435A7 7 0 0 1 10 2" /></g></symbol>',20,20,!1,void 0)},223173:(e,t,o)=>{"use strict";o.d(t,{Icon20ShareOutline:()=>i});var i=(0,o(844990).makeIcon)("Icon20ShareOutline","share_outline_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20" id="share_outline_20"><path fill="currentColor" fill-rule="evenodd" d="M9.764 4.753a.25.25 0 0 1 .402-.198l6.742 5.247a.25.25 0 0 1 0 .395l-6.747 5.25a.25.25 0 0 1-.402-.198v-3.136a.75.75 0 0 0-.75-.75c-2.456 0-4.342.913-5.832 2.197.266-1.454.824-2.577 1.57-3.426 1.066-1.212 2.58-1.941 4.385-2.228a.75.75 0 0 0 .632-.741zm1.324-1.381c-1.15-.895-2.824-.075-2.824 1.38v1.791c-1.81.394-3.434 1.225-4.643 2.6-1.352 1.538-2.117 3.68-2.117 6.445a.75.75 0 0 0 1.329.477c1.362-1.655 3.059-2.942 5.426-3.167v2.35c0 1.456 1.674 2.277 2.823 1.382l6.747-5.25c.9-.7.9-2.061 0-2.762z" clip-rule="evenodd" /></symbol>',20,20,!1,void 0)},136017:(e,t,o)=>{"use strict";o.d(t,{Icon20ThumbsDown:()=>i});var i=(0,o(844990).makeIcon)("Icon20ThumbsDown","thumbs_down_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20" id="thumbs_down_20"><path fill-rule="evenodd" d="m14.725 12.63-1.944 4.52a2.232 2.232 0 0 1-4.283-.883v-2.326a.285.285 0 0 0-.285-.285H4.498c-2.105 0-3.556-2.111-2.8-4.076l2.076-5.4A3.4 3.4 0 0 1 6.947 2h4.849a3.2 3.2 0 0 1 3.2 3.2v6.114c0 .453-.092.9-.271 1.316M16.745 2a.75.75 0 0 0-.75.75v8.5a.75.75 0 0 0 1.5 0v-8.5a.75.75 0 0 0-.75-.75" clip-rule="evenodd" /></symbol>',20,20,!1,void 0)},715782:(e,t,o)=>{"use strict";o.d(t,{Icon20ThumbsDownOutline:()=>i});var i=(0,o(844990).makeIcon)("Icon20ThumbsDownOutline","thumbs_down_outline_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20" id="thumbs_down_outline_20"><path fill-rule="evenodd" d="M10.762 18.503c.898 0 1.711-.532 2.07-1.355l1.77-4.057c.058-.134.097-.224.132-.317.152-.4.24-.823.261-1.251.005-.1.005-.198.005-.345v-4.46c0-.673 0-1.223-.037-1.671-.037-.463-.118-.882-.317-1.272a3.25 3.25 0 0 0-1.42-1.42c-.391-.2-.81-.28-1.273-.318C11.506 2 10.955 2 10.282 2h-2.47c-.829 0-1.433 0-1.974.197a3.25 3.25 0 0 0-1.254.826c-.395.42-.633.975-.96 1.736l-.994 2.32c-.387.902-.698 1.626-.89 2.218-.196.6-.306 1.166-.2 1.726a3.25 3.25 0 0 0 1.378 2.09c.473.319 1.036.441 1.665.498.62.057 1.408.057 2.389.057h1.531v2.578a2.26 2.26 0 0 0 2.26 2.258Zm.695-1.955a.759.759 0 0 1-1.454-.303V13.2c0-.571-.463-1.034-1.034-1.034h-1.96c-1.027 0-1.747-.001-2.29-.05-.543-.05-.803-.141-.963-.249a1.75 1.75 0 0 1-.742-1.125c-.036-.19-.017-.465.152-.983.169-.52.452-1.18.857-2.125l.93-2.167c.399-.93.534-1.215.724-1.417a1.75 1.75 0 0 1 .675-.445c.26-.095.576-.106 1.587-.106h2.311c.713 0 1.202 0 1.581.032.37.03.57.085.713.159.33.168.598.435.765.765.074.144.13.343.16.713.03.38.031.869.031 1.581v4.411c0 .17 0 .23-.003.29-.013.27-.069.537-.165.79-.02.055-.045.11-.113.267l-1.761 4.04ZM16.75 2a.75.75 0 0 0-.75.75v8.5a.75.75 0 0 0 1.5 0v-8.5a.75.75 0 0 0-.75-.75" /></symbol>',20,20,!1,void 0)},684540:(e,t,o)=>{"use strict";o.d(t,{Icon20VinylOutline:()=>i});var i=(0,o(844990).makeIcon)("Icon20VinylOutline","vinyl_outline_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20" id="vinyl_outline_20"><path fill="currentColor" fill-rule="evenodd" d="M10 7.5a2.5 2.5 0 0 0-1.768.732A2.5 2.5 0 0 0 7.5 10c0 .69.28 1.315.732 1.768A2.5 2.5 0 0 0 10 12.5a2.5 2.5 0 0 0 1.768-.732A2.5 2.5 0 0 0 12.5 10a2.5 2.5 0 0 0-.732-1.768A2.5 2.5 0 0 0 10 7.5m-.707 1.793A1 1 0 0 1 10 9a1 1 0 0 1 .707.293A1 1 0 0 1 11 10a1 1 0 0 1-.293.707A1 1 0 0 1 10 11a1 1 0 0 1-.707-.293A1 1 0 0 1 9 10a1 1 0 0 1 .293-.707" clip-rule="evenodd" /><path fill="currentColor" d="M10.21 6.006a4 4 0 0 0-4.205 4.2.75.75 0 0 1-.71.787.75.75 0 0 1-.788-.71 5.5 5.5 0 0 1 5.78-5.775.75.75 0 0 1-.078 1.497m5.283 3.712a.75.75 0 0 0-1.498.077 4 4 0 0 1-4.204 4.2.75.75 0 0 0-.079 1.498 5.5 5.5 0 0 0 4.175-1.602 5.5 5.5 0 0 0 1.606-4.173" /><path fill="currentColor" fill-rule="evenodd" d="M10 1.5a8.47 8.47 0 0 0-6.01 2.49C2.45 5.528 1.5 7.653 1.5 10s.951 4.472 2.49 6.01C5.528 17.55 7.653 18.5 10 18.5s4.472-.951 6.01-2.49c1.539-1.538 2.49-3.663 2.49-6.01s-.951-4.472-2.49-6.01A8.47 8.47 0 0 0 10 1.5M5.05 5.05A6.97 6.97 0 0 1 10 3c1.933 0 3.681.782 4.95 2.05A6.97 6.97 0 0 1 17 10a6.97 6.97 0 0 1-2.05 4.95A6.97 6.97 0 0 1 10 17a6.97 6.97 0 0 1-4.95-2.05A6.97 6.97 0 0 1 3 10c0-1.933.782-3.681 2.05-4.95" clip-rule="evenodd" /></symbol>',20,20,!1,void 0)},126645:function(e){e.exports=function(){"use strict";var e=function(){return e=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var s in t=arguments[o])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},e.apply(this,arguments)},t=1,o=7,i=96*t,s=96*t,a=25,n=function(e,t,i,s,n){if(e<o&&t<o)return!1;if(e>=i-o&&t<o)return!1;if(e<o&&t>=i-o)return!1;if(n){var r=o+2;i<=a&&r--;var _=(i-2*o-r)/2-1;return i<=a&&_++,!(e>o+_&&e<i-o-_-1&&t>o+_&&t<i-o-_-1)&&0<=e&&e<i&&0<=t&&t<i&&s[t][e]}return s[t]&&s[t][e]},r=function(e,t,o,i,s){return void 0===s&&(s=!0),{l:n(e-1,t,o,i,s),r:n(e+1,t,o,i,s),t:n(e,t-1,o,i,s),b:n(e,t+1,o,i,s),current:n(e,t,o,i,s)}},_=function(e,s){if("number"!=typeof s.qrSize)throw new Error("Size should be a number");if("string"!=typeof s.className)throw new Error("Classname should be a string");for(var _=2*t,u=12.7*t,d=12.8*t,l=14.7*t,c=14.8*t,p=15.9*t,m=28.6*t,h=30.5*t,y=84.7776815*t,f=87.3*t,E=71.4*t,g=42.9*t,v=87.2*t,A=85.2*t,w=85.3*t,b=69.5*t,P=98*t,T=100*t,I=[],O=0,C=0,M=0,D=0,S=0;S<e.size;S++){O=0;for(var k=0;k<e.size;k++){M=k+O,O+=i,D=S+C;var L=r(k,S,e.size,e.modules,s.isShowLogo),B="",R="";L.current?(R=!(R=R||L.l||L.r||L.t||L.b?"":"empty")&&L.l&&L.r||L.t&&L.b?"rect":"")||(R+=L.l?"l":L.r?"r":"",(R+=L.t?"t":L.b?"b":"")||(R="empty")):R=!(R=!(R=!(R=!R&&L.l&&L.t&&n(k-1,S-1,e.size,e.modules,s.isShowLogo)?"n_lt":"")&&L.l&&L.b&&n(k-1,S+1,e.size,e.modules,s.isShowLogo)?"n_lb":"")&&L.r&&L.t&&n(k+1,S-1,e.size,e.modules,s.isShowLogo)?"n_rt":"")&&L.r&&L.b&&n(k+1,S+1,e.size,e.modules,s.isShowLogo)?"n_rb":"",R&&(B='<use xlink:href="#'+R+"-"+s.suffix+'"/>',I.push('<g transform="translate('+M+","+D+')">'+B+"</g>"))}C+=i}var x="",F=(e.size-3*o)/2*i+i*o-10;e.size<=a&&(x="scale(0.85)",F+=50);var N=(e.size-o)*s.incTileSize;I.push('<use fill-rule="evenodd" transform="translate(0,0)" xlink:href="#point-'+s.suffix+'"/>'),I.push('<use fill-rule="evenodd" transform="translate('+N+',0)" xlink:href="#point-'+s.suffix+'"/>'),I.push('<use fill-rule="evenodd" transform="translate(0,'+N+')" xlink:href="#point-'+s.suffix+'"/>'),s.isShowLogo&&(s.logoData?I.push('\n        <image\n          preserveAspectRatio="xMidYMid slice" clip-path="url(#logo-mask-'+s.suffix+')"\n          style="width: 750px; height: 750px;" width="750" height="750"\n          transform="translate('+F+","+F+") "+x+'"\n          xlink:href="'+s.logoData+'"\n        />\n      '):I.push('\n        <use style="width: 750px; height: 750px;" width="750" height="750"\n          fill="none"\n          fill-rule="evenodd"\n          transform="translate('+F+","+F+") "+x+'" xlink:href="#vk_logo-'+s.suffix+'"\n        />\n      '));var U=99*e.size,W="",K="translate(0,0)";if(s.isShowBackground){var V=(s.qrSize-40)/s.qrSize,H=U/s.qrSize*21;W='\n      <rect\n        x="0"\n        width="'+U+'"\n        height="'+U+'"\n        rx="'+Math.ceil(U/(s.qrSize/36))+'"\n        fill="'+s.backgroundColor+'"\n      />',K="translate("+H+", "+H+") scale("+V+")"}var j="M0,0 L66,0 C"+y+",-3.44940413e-15 "+T+",15.2223185 "+T+",34 L"+T+",66 C"+T+","+y+" "+y+","+T+" 66,"+T+" L0,"+T+" L0,0 Z",$="M0,0 L"+T+",0 L"+T+",66 C"+T+","+y+" "+y+","+T+" 66,"+T+" L0,"+T+" L0,0 Z";return'\n  <svg\n    version="1.1"\n    viewBox="0 0 '+U+" "+U+'"\n    width="'+s.qrSize+'px"\n    height="'+s.qrSize+'px"\n    '+(s.className?'class="'+s.className+'"':"")+'\n    xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"\n  >\n    <defs>\n      <rect id="rect-'+s.suffix+'" width="100" height="100" fill="'+s.foregroundColor+'"/>\n      <path\n        id="empty-'+s.suffix+'"\n        d="M0,'+m+"v"+g+"C0,"+f+","+d+","+T+","+m+","+T+"h"+g+"c"+p+",0,"+m+"-"+d+","+m+"-"+m+"V"+m+"C"+T+","+u+","+v+",0,"+E+",0H"+m+" C"+d+",0,0,"+d+",0,"+m+'z"\n        fill="'+s.foregroundColor+'"\n      />\n      <path id="b-'+s.suffix+'" d="'+j+'" transform="rotate(-90 50 50)" fill="'+s.foregroundColor+'"/>\n      <path id="r-'+s.suffix+'" d="'+j+'" transform="rotate(-180 50 50)" fill="'+s.foregroundColor+'"/>\n      <path id="l-'+s.suffix+'" d="'+j+'" fill="'+s.foregroundColor+'"/>\n      <path id="t-'+s.suffix+'" d="'+j+'" transform="rotate(90 50 50)" fill="'+s.foregroundColor+'"/>\n      <path id="l-'+s.suffix+'" d="'+$+'" transform="rotate(-90 50 50)" fill="'+s.foregroundColor+'"/>\n      <path id="lt-'+s.suffix+'" d="'+$+'" fill="'+s.foregroundColor+'"/>\n      <path id="lb-'+s.suffix+'" d="'+$+'" transform="rotate(-90 50 50)" fill="'+s.foregroundColor+'"/>\n      <path id="rb-'+s.suffix+'" d="'+$+'" transform="rotate(-180 50 50)" fill="'+s.foregroundColor+'"/>\n      <path id="rt-'+s.suffix+'" d="'+$+'" transform="rotate(90 50 50)" fill="'+s.foregroundColor+'"/>\n      <path\n        id="n_lt-'+s.suffix+'"\n        d="M'+h+","+_+"V0H0v"+h+"h"+_+"C"+_+","+l+","+c+","+_+","+h+","+_+'z"\n        fill="'+s.foregroundColor+'"\n      />\n      <path\n        id="n_lb-'+s.suffix+'"\n        d="M'+_+","+b+"H0V"+T+"h"+h+"v-"+_+"C"+l+","+P+","+_+","+A+","+_+","+b+'z"\n        fill="'+s.foregroundColor+'"\n      />\n      <path\n        id="n_rt-'+s.suffix+'"\n        d="M'+P+","+h+"h"+_+"V0H"+b+"v"+_+"C"+w+","+_+","+P+","+c+","+P+","+h+'z"\n        fill="'+s.foregroundColor+'"\n      />\n      <path id="n_rb-'+s.suffix+'"\n        d="M'+b+","+P+"v"+_+"H"+T+"V"+b+"h-"+_+"C"+P+","+w+","+A+","+P+","+b+","+P+'z"\n        fill="'+s.foregroundColor+'"\n      />\n      <path\n        id="point-'+s.suffix+'"\n        fill="'+s.foregroundColor+'"\n        d="M600.001786,457.329333 L600.001786,242.658167 C600.001786,147.372368 587.039517,124.122784 581.464617,118.535383 C575.877216,112.960483 552.627632,99.9982143 457.329333,99.9982143 L242.670667,99.9982143 C147.372368,99.9982143 124.122784,112.960483 118.547883,118.535383 C112.972983,124.122784 99.9982143,147.372368 99.9982143,242.658167 L99.9982143,457.329333 C99.9982143,552.627632 112.972983,575.877216 118.547883,581.464617 C124.122784,587.027017 147.372368,600.001786 242.670667,600.001786 L457.329333,600.001786 C552.627632,600.001786 575.877216,587.027017 581.464617,581.464617 C587.039517,575.877216 600.001786,552.627632 600.001786,457.329333 Z M457.329333,0 C653.338333,0 700,46.6616668 700,242.658167 C700,438.667167 700,261.332833 700,457.329333 C700,653.338333 653.338333,700 457.329333,700 C261.332833,700 438.667167,700 242.670667,700 C46.6616668,700 0,653.338333 0,457.329333 C0,261.332833 0,352.118712 0,242.658167 C0,46.6616668 46.6616668,0 242.670667,0 C438.667167,0 261.332833,0 457.329333,0 Z M395.996667,200 C480.004166,200 500,220.008332 500,303.990835 C500,387.998334 500,312.001666 500,395.996667 C500,479.991668 480.004166,500 395.996667,500 C312.001666,500 387.998334,500 304.003333,500 C220.008332,500 200,479.991668 200,395.996667 C200,312.001666 200,350.906061 200,303.990835 C200,220.008332 220.008332,200 304.003333,200 C387.998334,200 312.001666,200 395.996667,200 Z"\n      />\n      <g id="vk_logo-'+s.suffix+'">\n        <path\n          fill="'+s.logoColor+'"\n          d="M83.3334 363.333C83.3334 231.34 83.3334 165.343 124.338 124.338C165.343 83.3333 231.34              83.3333 363.333 83.3333H386.667C518.66 83.3333 584.657 83.3333 625.662 124.338C666.667 165.343              666.667 231.34 666.667 363.333V386.667C666.667 518.66 666.667 584.657 625.662 625.662C584.657              666.667 518.66 666.667 386.667 666.667H363.333C231.34 666.667 165.343 666.667 124.338 625.662C83.3334              584.657 83.3334 518.66 83.3334 386.667V363.333Z"\n        />\n        <path\n          fill="#FFF"\n          d="M394.907 508.681C263.293 508.681 183.442 417.365 180.313 265.625H246.972C249.05 377.09              299.763 424.323 338.638 434.036V265.625H402.519V361.82C440.016 357.664 479.264 313.909              492.456 265.625H555.333C545.27 325 502.543 368.754 472.353 386.803C502.566 401.395 551.177              439.593 569.926 508.681H500.815C486.222 462.498 450.476 426.728 402.542 421.872V508.681H394.907Z"\n        />\n      </g>\n      <clipPath id="logo-mask-'+s.suffix+'">\n        <rect x="0" y="0" width="750" height="750" />\n      </clipPath>\n    </defs>\n\n    '+W+'\n\n    <g transform="'+K+'">\n      '+I.join("\n")+"\n    </g>\n  </svg>"},u=function(){function e(t,o,i,s){if(this.version=t,this.errorCorrectionLevel=o,this.mask=s,this.modules=[],this.isFunction=[],t<e.MIN_VERSION||t>e.MAX_VERSION)throw"Version value out of range";if(s<-1||s>7)throw"Mask value out of range";this.size=4*t+17;for(var a=[],n=0;n<this.size;n++)a.push(!1);for(n=0;n<this.size;n++)this.modules.push(a.slice()),this.isFunction.push(a.slice());this.drawFunctionPatterns();var r=this.addEccAndInterleave(i);if(this.drawCodewords(r),-1==s){var _=1e9;for(n=0;n<8;n++){this.applyMask(n),this.drawFormatBits(n);var u=this.getPenaltyScore();u<_&&(s=n,_=u),this.applyMask(n)}}if(s<0||s>7)throw"Assertion error";this.mask=s,this.applyMask(s),this.drawFormatBits(s),this.isFunction=[]}return e.encodeText=function(t,o){var i=l.makeSegments(t);return e.encodeSegments(i,o)},e.encodeBinary=function(t,o){var i=l.makeBytes(t);return e.encodeSegments([i],o)},e.encodeSegments=function(t,o,i,s,a,n){if(void 0===i&&(i=1),void 0===s&&(s=40),void 0===a&&(a=-1),void 0===n&&(n=!0),!(e.MIN_VERSION<=i&&i<=s&&s<=e.MAX_VERSION)||a<-1||a>7)throw"Invalid value";var r,_;for(r=i;;r++){var u=8*e.getNumDataCodewords(r,o),d=l.getTotalBits(t,r);if(d<=u){_=d;break}if(r>=s)throw"Data too long"}for(var c=0,m=[e.Ecc.MEDIUM,e.Ecc.QUARTILE,e.Ecc.HIGH];c<m.length;c++){var h=m[c];n&&_<=8*e.getNumDataCodewords(r,h)&&(o=h)}for(var y=new p,f=0,E=t;f<E.length;f++){var g=E[f];y.appendBits(g.mode.modeBits,4),y.appendBits(g.numChars,g.mode.numCharCountBits(r));for(var v=0,A=g.getData();v<A.length;v++){var w=A[v];y.array.push(w)}}if(y.array.length!=_)throw"Assertion error";var b=8*e.getNumDataCodewords(r,o);if(y.array.length>b)throw"Assertion error";if(y.appendBits(0,Math.min(4,b-y.array.length)),y.appendBits(0,(8-y.array.length%8)%8),y.array.length%8!=0)throw"Assertion error";for(var P=236;y.array.length<b;P^=253)y.appendBits(P,8);for(var T=[];8*T.length<y.array.length;)T.push(0);return y.array.forEach((function(e,t){return T[t>>>3]|=e<<7-(7&t)})),new e(r,o,T,a)},e.prototype.getModule=function(e,t){return 0<=e&&e<this.size&&0<=t&&t<this.size&&this.modules[t][e]},e.prototype.drawCanvas=function(e,t,o){if(e<=0||t<0)throw"Value out of range";var i=(this.size+2*t)*e;o.width=i,o.height=i;for(var s=o.getContext("2d"),a=-t;a<this.size+t;a++)for(var n=-t;n<this.size+t;n++)s.fillStyle=this.getModule(n,a)?"#000000":"#FFFFFF",s.fillRect((n+t)*e,(a+t)*e,e,e)},e.prototype.toSvgString=function(e){if(e<0)throw"Border must be non-negative";for(var t=[],o=0;o<this.size;o++)for(var i=0;i<this.size;i++)this.getModule(i,o)&&t.push("M"+(i+e)+","+(o+e)+"h1v1h-1z");return'<?xml version="1.0" encoding="UTF-8"?>\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 '+(this.size+2*e)+" "+(this.size+2*e)+'" stroke="none">\n\t<rect width="100%" height="100%" fill="#FFFFFF"/>\n\t<path d="'+t.join(" ")+'" fill="#000000"/>\n</svg>\n'},e.prototype.drawFunctionPatterns=function(){for(var e=0;e<this.size;e++)this.setFunctionModule(6,e,e%2==0),this.setFunctionModule(e,6,e%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);var t=this.getAlignmentPatternPositions(),o=t.length;for(e=0;e<o;e++)for(var i=0;i<o;i++)0==e&&0==i||0==e&&i==o-1||e==o-1&&0==i||this.drawAlignmentPattern(t[e],t[i]);this.drawFormatBits(0),this.drawVersion()},e.prototype.drawFormatBits=function(e){for(var t=this.errorCorrectionLevel.formatBits<<3|e,o=t,i=0;i<10;i++)o=o<<1^1335*(o>>>9);var s=21522^(t<<10|o);if(s>>>15!=0)throw"Assertion error";for(i=0;i<=5;i++)this.setFunctionModule(8,i,d(s,i));for(this.setFunctionModule(8,7,d(s,6)),this.setFunctionModule(8,8,d(s,7)),this.setFunctionModule(7,8,d(s,8)),i=9;i<15;i++)this.setFunctionModule(14-i,8,d(s,i));for(i=0;i<8;i++)this.setFunctionModule(this.size-1-i,8,d(s,i));for(i=8;i<15;i++)this.setFunctionModule(8,this.size-15+i,d(s,i));this.setFunctionModule(8,this.size-8,!0)},e.prototype.drawVersion=function(){if(!(this.version<7)){for(var e=this.version,t=0;t<12;t++)e=e<<1^7973*(e>>>11);var o=this.version<<12|e;if(o>>>18!=0)throw"Assertion error";for(t=0;t<18;t++){var i=d(o,t),s=this.size-11+t%3,a=Math.floor(t/3);this.setFunctionModule(s,a,i),this.setFunctionModule(a,s,i)}}},e.prototype.drawFinderPattern=function(e,t){for(var o=-4;o<=4;o++)for(var i=-4;i<=4;i++){var s=Math.max(Math.abs(i),Math.abs(o)),a=e+i,n=t+o;0<=a&&a<this.size&&0<=n&&n<this.size&&this.setFunctionModule(a,n,2!=s&&4!=s)}},e.prototype.drawAlignmentPattern=function(e,t){for(var o=-2;o<=2;o++)for(var i=-2;i<=2;i++)this.setFunctionModule(e+i,t+o,1!=Math.max(Math.abs(i),Math.abs(o)))},e.prototype.setFunctionModule=function(e,t,o){this.modules[t][e]=o,this.isFunction[t][e]=!0},e.prototype.addEccAndInterleave=function(t){var o=this.version,i=this.errorCorrectionLevel;if(t.length!=e.getNumDataCodewords(o,i))throw"Invalid argument";for(var s=e.NUM_ERROR_CORRECTION_BLOCKS[i.ordinal][o],a=e.ECC_CODEWORDS_PER_BLOCK[i.ordinal][o],n=Math.floor(e.getNumRawDataModules(o)/8),r=s-n%s,_=Math.floor(n/s),u=[],d=new c(a),l=0,p=0;l<s;l++){var m=t.slice(p,p+_-a+(l<r?0:1));p+=m.length;var h=d.getRemainder(m);l<r&&m.push(0),u.push(m.concat(h))}var y=[];for(l=0;l<u[0].length;l++)for(var f=0;f<u.length;f++)(l!=_-a||f>=r)&&y.push(u[f][l]);if(y.length!=n)throw"Assertion error";return y},e.prototype.drawCodewords=function(t){if(t.length!=Math.floor(e.getNumRawDataModules(this.version)/8))throw"Invalid argument";for(var o=0,i=this.size-1;i>=1;i-=2){6==i&&(i=5);for(var s=0;s<this.size;s++)for(var a=0;a<2;a++){var n=i-a,r=i+1&2?s:this.size-1-s;!this.isFunction[r][n]&&o<8*t.length&&(this.modules[r][n]=d(t[o>>>3],7-(7&o)),o++)}}if(o!=8*t.length)throw"Assertion error"},e.prototype.applyMask=function(e){if(e<0||e>7)throw"Mask value out of range";for(var t=0;t<this.size;t++)for(var o=0;o<this.size;o++){var i=void 0;switch(e){case 0:i=(o+t)%2==0;break;case 1:i=t%2==0;break;case 2:i=o%3==0;break;case 3:i=(o+t)%3==0;break;case 4:i=(Math.floor(o/3)+Math.floor(t/2))%2==0;break;case 5:i=o*t%2+o*t%3==0;break;case 6:i=(o*t%2+o*t%3)%2==0;break;case 7:i=((o+t)%2+o*t%3)%2==0;break;default:throw"Assertion error"}!this.isFunction[t][o]&&i&&(this.modules[t][o]=!this.modules[t][o])}},e.prototype.getPenaltyScore=function(){for(var t=0,o=0;o<this.size;o++){for(var i=[0,0,0,0,0,0,0],s=!1,a=0,n=0;n<this.size;n++)this.modules[o][n]==s?5==++a?t+=e.PENALTY_N1:a>5&&t++:(e.addRunToHistory(a,i),!s&&e.hasFinderLikePattern(i)&&(t+=e.PENALTY_N3),s=this.modules[o][n],a=1);e.addRunToHistory(a,i),s&&e.addRunToHistory(0,i),e.hasFinderLikePattern(i)&&(t+=e.PENALTY_N3)}for(n=0;n<this.size;n++){i=[0,0,0,0,0,0,0],s=!1;var r=0;for(o=0;o<this.size;o++)this.modules[o][n]==s?5==++r?t+=e.PENALTY_N1:r>5&&t++:(e.addRunToHistory(r,i),!s&&e.hasFinderLikePattern(i)&&(t+=e.PENALTY_N3),s=this.modules[o][n],r=1);e.addRunToHistory(r,i),s&&e.addRunToHistory(0,i),e.hasFinderLikePattern(i)&&(t+=e.PENALTY_N3)}for(o=0;o<this.size-1;o++)for(n=0;n<this.size-1;n++)(s=this.modules[o][n])==this.modules[o][n+1]&&s==this.modules[o+1][n]&&s==this.modules[o+1][n+1]&&(t+=e.PENALTY_N2);for(var _=0,u=0,d=this.modules;u<d.length;u++)for(var l=0,c=d[u];l<c.length;l++)(s=c[l])&&_++;var p=this.size*this.size;return t+=(Math.ceil(Math.abs(20*_-10*p)/p)-1)*e.PENALTY_N4},e.prototype.getAlignmentPatternPositions=function(){if(1==this.version)return[];for(var e=Math.floor(this.version/7)+2,t=32==this.version?26:2*Math.ceil((this.size-13)/(2*e-2)),o=[6],i=this.size-7;o.length<e;i-=t)o.splice(1,0,i);return o},e.getNumRawDataModules=function(t){if(t<e.MIN_VERSION||t>e.MAX_VERSION)throw"Version number out of range";var o=(16*t+128)*t+64;if(t>=2){var i=Math.floor(t/7)+2;o-=(25*i-10)*i-55,t>=7&&(o-=36)}return o},e.getNumDataCodewords=function(t,o){return Math.floor(e.getNumRawDataModules(t)/8)-e.ECC_CODEWORDS_PER_BLOCK[o.ordinal][t]*e.NUM_ERROR_CORRECTION_BLOCKS[o.ordinal][t]},e.addRunToHistory=function(e,t){t.pop(),t.unshift(e)},e.hasFinderLikePattern=function(e){var t=e[1];return t>0&&e[2]==t&&e[4]==t&&e[5]==t&&e[3]==3*t&&Math.max(e[0],e[6])>=4*t},e.MIN_VERSION=1,e.MAX_VERSION=40,e.PENALTY_N1=3,e.PENALTY_N2=3,e.PENALTY_N3=40,e.PENALTY_N4=10,e.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],e.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],e}();function d(e,t){return!!(e>>>t&1)}var l=function(){function e(e,t,o){if(this.mode=e,this.numChars=t,this.bitData=o,t<0)throw"Invalid argument";this.bitData=o.slice()}return e.makeBytes=function(t){for(var o=new p,i=0,s=t;i<s.length;i++){var a=s[i];o.appendBits(a,8)}return new e(e.Mode.BYTE,t.length,o.array)},e.makeNumeric=function(t){if(!this.NUMERIC_REGEX.test(t))throw"String contains non-numeric characters";for(var o=new p,i=0;i<t.length;){var s=Math.min(t.length-i,3);o.appendBits(parseInt(t.substr(i,s),10),3*s+1),i+=s}return new e(e.Mode.NUMERIC,t.length,o.array)},e.makeAlphanumeric=function(t){if(!this.ALPHANUMERIC_REGEX.test(t))throw"String contains unencodable characters in alphanumeric mode";var o,i=new p;for(o=0;o+2<=t.length;o+=2){var s=45*e.ALPHANUMERIC_CHARSET.indexOf(t.charAt(o));s+=e.ALPHANUMERIC_CHARSET.indexOf(t.charAt(o+1)),i.appendBits(s,11)}return o<t.length&&i.appendBits(e.ALPHANUMERIC_CHARSET.indexOf(t.charAt(o)),6),new e(e.Mode.ALPHANUMERIC,t.length,i.array)},e.makeSegments=function(t){return""==t?[]:this.NUMERIC_REGEX.test(t)?[e.makeNumeric(t)]:this.ALPHANUMERIC_REGEX.test(t)?[e.makeAlphanumeric(t)]:[e.makeBytes(e.toUtf8ByteArray(t))]},e.makeEci=function(t){var o=new p;if(t<0)throw"ECI assignment value out of range";if(t<128)o.appendBits(t,8);else if(t<16384)o.appendBits(2,2),o.appendBits(t,14);else{if(!(t<1e6))throw"ECI assignment value out of range";o.appendBits(6,3),o.appendBits(t,21)}return new e(e.Mode.ECI,0,o.array)},e.prototype.getData=function(){return this.bitData.slice()},e.getTotalBits=function(e,t){for(var o=0,i=0,s=e;i<s.length;i++){var a=s[i],n=a.mode.numCharCountBits(t);if(a.numChars>=1<<n)return 1/0;o+=4+n+a.bitData.length}return o},e.toUtf8ByteArray=function(e){e=encodeURI(e);for(var t=[],o=0;o<e.length;o++)"%"!=e.charAt(o)?t.push(e.charCodeAt(o)):(t.push(parseInt(e.substr(o+1,2),16)),o+=2);return t},e.NUMERIC_REGEX=/^[0-9]*$/,e.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,e.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",e}(),c=function(){function e(t){if(this.coefficients=[],t<1||t>255)throw"Degree out of range";for(var o=this.coefficients,i=0;i<t-1;i++)o.push(0);o.push(1);var s=1;for(i=0;i<t;i++){for(var a=0;a<o.length;a++)o[a]=e.multiply(o[a],s),a+1<o.length&&(o[a]^=o[a+1]);s=e.multiply(s,2)}}return e.prototype.getRemainder=function(t){for(var o=this.coefficients.map((function(e){return 0})),i=function(t){var i=t^o.shift();o.push(0),s.coefficients.forEach((function(t,s){return o[s]^=e.multiply(t,i)}))},s=this,a=0,n=t;a<n.length;a++)i(n[a]);return o},e.multiply=function(e,t){if(e>>>8!=0||t>>>8!=0)throw"Byte out of range";for(var o=0,i=7;i>=0;i--)o=o<<1^285*(o>>>7),o^=(t>>>i&1)*e;if(o>>>8!=0)throw"Assertion error";return o},e}(),p=function(){function e(){this.array=[]}return e.prototype.appendBits=function(e,t){if(t<0||t>31||e>>>t!=0)throw"Value out of range";for(var o=t-1;o>=0;o--)this.array.push(e>>>o&1)},e}();(function(e){var t=function(){function e(e,t){this.ordinal=e,this.formatBits=t}return e.LOW=new e(0,1),e.MEDIUM=new e(1,0),e.QUARTILE=new e(2,3),e.HIGH=new e(3,2),e}();e.Ecc=t})(u||(u={})),function(e){var t=function(){function e(e,t){this.modeBits=e,this.numBitsCharCount=t}return e.prototype.numCharCountBits=function(e){return this.numBitsCharCount[Math.floor((e+7)/17)]},e.NUMERIC=new e(1,[10,12,14]),e.ALPHANUMERIC=new e(2,[9,11,13]),e.BYTE=new e(4,[8,16,16]),e.KANJI=new e(8,[8,10,12]),e.ECI=new e(7,[0,0,0]),e}();e.Mode=t}(l||(l={}));var m=128,h="#ffffff",y="#000000",f="#07f";function E(t,o,i,a){if("string"!=typeof t)throw new TypeError("Enter text for encoding");var n=e(e(e({},"object"==typeof o&&null!==o?o:{}),"object"==typeof a&&null!==a?a:{}),{qrSize:"object"==typeof o&&null!==o&&"number"==typeof o.qrSize?o.qrSize:o,className:"object"==typeof o&&null!==o&&"string"==typeof o.className?o.className:i}),r=[u.Ecc.LOW,u.Ecc.MEDIUM,u.Ecc.QUARTILE,u.Ecc.HIGH],d={qrSize:"number"==typeof n.qrSize?n.qrSize:m,className:"string"==typeof n.className?n.className:i||"",isShowLogo:!!n.isShowLogo||!1,isShowBackground:!!n.isShowBackground||!1,foregroundColor:"string"==typeof n.foregroundColor?n.foregroundColor:y,backgroundColor:"string"==typeof n.backgroundColor?n.backgroundColor:h,logoColor:"string"==typeof n.logoColor?n.logoColor:f,suffix:n.suffix?n.suffix.toString():"0",logoData:"string"==typeof n.logoData?n.logoData:null,ecc:"number"==typeof n.ecc&&r[n.ecc]?n.ecc:3,incTileSize:"number"==typeof n.incTileSize?n.incTileSize:s},c=l.makeSegments(t),p=u.encodeSegments(c,r[d.ecc],1,40,-1,!0);return _(p,d)}return{createQR:E}}()},859887:(e,t)=>{"use strict";function o(e){return navigator.clipboard?function(e){return navigator.clipboard.writeText(e).then((function(){return!0}))}(e):function(e){return new Promise((function(t,o){var i=document.createElement("textarea"),s=document.createRange();i.value=e,i.style.position="fixed",i.contentEditable="true",document.body.appendChild(i),i.focus(),i.select(),s.selectNodeContents(i);var a=window.getSelection();a&&(a.removeAllRanges(),a.addRange(s)),i.setSelectionRange(0,999999);try{document.execCommand("copy")?t(!0):o(new Error("copy failed"))}catch(e){o(e)}a&&a.removeAllRanges(),document.body.removeChild(i)}))}(e)}Object.defineProperty(t,"copyTextToClipboard",{enumerable:!0,get:function(){return o}})},627338:(e,t,o)=>{"use strict";o.d(t,{default:()=>i});const i={root:"SpecialProjectHeader-module__root--QbEJE",singleImage:"SpecialProjectHeader-module__singleImage--I5Wcs"}},29700:(e,t,o)=>{"use strict";o.d(t,{default:()=>i});const i={root:"renderAvatarToString-module__root--RBv3N"}},864883:(e,t,o)=>{"use strict";function i(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="currentColor" d="M10.48 1.07c.55.05 1.03.14 1.47.37a3.74 3.74 0 0 1 1.64 1.63c.23.44.32.92.37 1.47.04.53.04 1.18.04 2v5.48c0 .5 0 .92-.03 1.25-.03.33-.1.72-.35 1.03a1.8 1.8 0 0 1-1.35.7c-.4.01-.76-.15-1.04-.32-.3-.17-.64-.41-1.04-.7l-1.7-1.2a7.21 7.21 0 0 0-.43-.3.25.25 0 0 0-.12 0l-.08.05c-.08.04-.18.12-.35.24l-1.7 1.2c-.4.3-.75.54-1.04.71-.28.17-.64.33-1.04.32a1.8 1.8 0 0 1-1.35-.7c-.25-.32-.32-.7-.35-1.03C2 12.94 2 12.52 2 12.02V6.53c0-.7 0-1.3.03-1.79a9.01 9.01 0 0 1 .01-.2c.05-.55.14-1.03.37-1.47a3.75 3.75 0 0 1 1.64-1.63c.44-.23.92-.32 1.47-.37.23-.02.48-.03.76-.03 1.4-.03 2.82-.08 4.2.03Z"/></svg>',name:"bookmark_16"}}o.d(t,{getIcon16Bookmark:()=>i})},253589:(e,t,o)=>{"use strict";function i(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="currentColor" fill-rule="evenodd" d="M6.72 1h2.56c.67 0 1.23 0 1.67.04.47.03.88.12 1.28.31a3.25 3.25 0 0 1 1.42 1.42c.2.4.28.81.31 1.28.04.44.04 1 .04 1.67v6.05c0 .56 0 1.02-.03 1.4-.04.36-.11.76-.37 1.1a1.9 1.9 0 0 1-1.45.73c-.42.01-.8-.17-1.11-.36-.32-.2-.7-.47-1.14-.8L8.5 12.8a7.25 7.25 0 0 0-.44-.3.25.25 0 0 0-.12 0s-.03 0-.08.04c-.08.05-.19.12-.37.26L6.1 13.84c-.45.33-.82.6-1.14.8-.31.19-.69.37-1.1.36a1.9 1.9 0 0 1-1.46-.73 2.06 2.06 0 0 1-.37-1.1C2 12.78 2 12.32 2 11.76V5.72c0-.67 0-1.23.04-1.67.03-.47.12-.88.31-1.28a3.25 3.25 0 0 1 1.42-1.42c.4-.2.81-.28 1.28-.31C5.49 1 6.05 1 6.72 1Zm1.22 11.5Zm.12 0Zm-2.9-9.97c-.36.03-.56.09-.7.16a1.75 1.75 0 0 0-.77.77c-.07.14-.13.34-.16.7-.03.39-.03.88-.03 1.59v5.98c0 .6 0 1 .03 1.3.02.24.05.31.06.32a.4.4 0 0 0 .3.15s.08-.02.3-.14l1.05-.75L6.6 11.6l.07-.05c.27-.2.56-.41.89-.5a1.75 1.75 0 0 1 .88 0c.33.09.62.3.89.5l.07.05 1.36 1c.49.37.8.6 1.06.76.2.12.29.14.3.14a.4.4 0 0 0 .3-.15s.03-.08.05-.32c.03-.3.03-.7.03-1.3V5.75c0-.71 0-1.2-.03-1.58a1.88 1.88 0 0 0-.16-.71 1.75 1.75 0 0 0-.77-.77 1.88 1.88 0 0 0-.7-.16c-.39-.03-.88-.03-1.59-.03h-2.5c-.71 0-1.2 0-1.58.03Z" clip-rule="evenodd"/></svg>',name:"bookmark_outline_16"}}o.d(t,{getIcon16BookmarkOutline:()=>i})},460241:(e,t,o)=>{"use strict";function i(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="currentColor" d="M12.74 3.26a.9.9 0 0 1 0 1.28L9.27 8l3.47 3.46a.9.9 0 0 1 .08 1.18l-.08.1a.9.9 0 0 1-1.28 0L8 9.27l-3.46 3.47a.9.9 0 0 1-1.28-1.28L6.73 8 3.26 4.54a.9.9 0 0 1-.08-1.18l.08-.1a.9.9 0 0 1 1.28 0L8 6.73l3.46-3.47a.9.9 0 0 1 1.28 0Z"/></svg>',name:"cancel_16"}}o.d(t,{getIcon16Cancel:()=>i})},781596:(e,t,o)=>{"use strict";function i(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" fill="none" viewBox="0 0 12 16"><path fill="currentColor" d="M7.23 8 3.86 4.64a.9.9 0 0 1 1.28-1.28l4 4a.9.9 0 0 1 0 1.28l-4 4a.9.9 0 0 1-1.28-1.28L7.23 8Z"/></svg>',name:"chevron_16"}}o.d(t,{getIcon16Chevron:()=>i})},722371:(e,t,o)=>{"use strict";function i(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 3a.75.75 0 0 1 .75.75v5.5h5.5a.75.75 0 0 1 0 1.5h-5.5v5.5a.75.75 0 0 1-1.5 0v-5.5h-5.5a.75.75 0 0 1 0-1.5h5.5v-5.5A.75.75 0 0 1 10 3Z" clip-rule="evenodd"/></svg>',name:"add_20"}}o.d(t,{getIcon20Add:()=>i})},44500:(e,t,o)=>{"use strict";function i(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M17.53 5.22a.75.75 0 0 1 0 1.06l-9.5 9.5a.75.75 0 0 1-1.06 0l-4.5-4.5a.75.75 0 1 1 1.06-1.06l3.97 3.97 8.97-8.97a.75.75 0 0 1 1.06 0Z" clip-rule="evenodd"/></svg>',name:"check_20"}}o.d(t,{getIcon20Check:()=>i})},146194:(e,t,o)=>{"use strict";function i(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 20 20"><path fill="currentColor" fill-rule="evenodd" d="m12.75 4.04-.8 3.3 1.91.35c.96.17 1.82.62 2.07 1.53.26.92-.25 1.84-.82 2.52l-5.08 5.75c-.33.35-.66.64-.99.81-.3.16-.8.33-1.27.05-.46-.26-.58-.76-.6-1.1-.03-.38.03-.82.15-1.3l.84-3.35-1.81-.32c-.92-.16-1.84-.59-2.2-1.45-.39-.92 0-1.9.8-2.76l1.41-1.5c.84-.91 2.07-2.26 3.68-4.05.31-.35.64-.64.96-.82.31-.16.8-.32 1.26-.07.47.25.6.74.64 1.1.03.38-.02.83-.15 1.31Zm-1.37-.75a3.95 3.95 0 0 0-.22.22A330.83 330.83 0 0 1 6.05 9.1c-.63.69-.57 1.05-.52 1.15.16.38.73.5 1.08.56l2.33.41c.56.1.95.67.8 1.24l-.96 3.86a4.71 4.71 0 0 0-.08.4 4.42 4.42 0 0 0 .23-.24l5.04-5.7c.53-.65.55-1.02.52-1.15-.02-.07-.15-.32-.88-.45l-2.45-.44c-.56-.1-.94-.68-.8-1.24l.94-3.81a4.29 4.29 0 0 0 .08-.4Z" clip-rule="evenodd"/></svg>',name:"flash_outline_20"}}o.d(t,{getIcon20FlashOutline:()=>i})},947209:(e,t,o)=>{"use strict";function i(){return{icon:'<svg fill="none" height="20" viewBox="0 0 20 20" width="20" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor"><path d="M2 4.75c0-.41.34-.75.75-.75h14.5a.75.75 0 0 1 0 1.5H2.75A.75.75 0 0 1 2 4.75zm0 5c0-.41.34-.75.75-.75h12.5a.75.75 0 0 1 0 1.5H2.75A.75.75 0 0 1 2 9.75zm0 5c0-.41.34-.75.75-.75h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1-.75-.75z"/><path clip-rule="evenodd" d="M19.28 12.22c.3.3.3.77 0 1.06l-4.5 4.5c-.29.29-.76.29-1.05 0l-2.5-2.5a.75.75 0 0 1 1.05-1.06l1.97 1.97 3.97-3.97c.3-.3.77-.3 1.06 0z" fill-rule="evenodd"/></g></svg>',name:"list_add_outline_20"}}o.d(t,{getIcon20ListAddOutline:()=>i})},26152:(e,t,o)=>{"use strict";function i(){return{icon:'<svg fill="none" height="20" viewBox="0 0 20 20" width="20" xmlns="http://www.w3.org/2000/svg"><clipPath id="list_play_outline_20__a"><path d="M0 0h20v20H0z"/></clipPath><g clip-path="url(#list_play_outline_20__a)" fill="currentColor"><path d="M19.68 11.43c.43.25.43.89 0 1.14l-4.73 2.84c-.42.25-.95-.06-.95-.57V9.16c0-.5.53-.82.95-.57zM2 4.75c0-.41.34-.75.75-.75h14.5a.75.75 0 0 1 0 1.5H2.75A.75.75 0 0 1 2 4.75zm0 5c0-.41.34-.75.75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 2 9.75zm0 5c0-.41.34-.75.75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5a.75.75 0 0 1-.75-.75z"/></g></svg>',name:"list_play_outline_20"}}o.d(t,{getIcon20ListPlayOutline:()=>i})},488439:(e,t,o)=>{"use strict";function i(){return{icon:'<svg fill="none" height="20" viewBox="0 0 20 20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M15 8.5a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3zm-5 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3zm-5 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3z" fill="currentColor"/></svg>',name:"more_20"}}o.d(t,{getIcon20More:()=>i})},594289:(e,t,o)=>{"use strict";function i(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M12 8.13a7.85 7.85 0 0 1-1.5 2.37A7.83 7.83 0 0 1 8.13 12c.83.37 1.72.86 2.37 1.51a7.83 7.83 0 0 1 1.5 2.37c.37-.84.86-1.72 1.51-2.37a7.83 7.83 0 0 1 2.37-1.5 7.85 7.85 0 0 1-2.37-1.51 7.83 7.83 0 0 1-1.5-2.37Zm-.78-2.18c-.42 1.32-1.02 2.72-1.78 3.49-.77.77-2.17 1.36-3.49 1.78a21.07 21.07 0 0 1-1.16.34c-.38.1-.38.79 0 .9a27.15 27.15 0 0 1 .91.25l.25.08c1.32.42 2.72 1.01 3.49 1.78.76.77 1.36 2.17 1.78 3.49a20.84 20.84 0 0 1 .27.9l.07.26c.1.38.79.38.9 0a27.49 27.49 0 0 1 .25-.91l.08-.25c.42-1.32 1.01-2.72 1.78-3.49s2.17-1.36 3.49-1.78a20.84 20.84 0 0 1 .9-.27l.26-.07c.38-.1.38-.8 0-.9a27.49 27.49 0 0 1-.91-.25 20.84 20.84 0 0 1-.25-.08c-1.32-.42-2.72-1.01-3.49-1.78s-1.36-2.17-1.78-3.49a21.13 21.13 0 0 1-.34-1.16c-.1-.38-.8-.38-.9 0a27.15 27.15 0 0 1-.25.91 21.13 21.13 0 0 1-.08.25ZM4.36.76a.39.39 0 0 0-.73 0L3.24 2A1.93 1.93 0 0 1 2 3.22l-1.24.41a.39.39 0 0 0 0 .74l1.24.4A1.93 1.93 0 0 1 3.22 6l.41 1.24a.39.39 0 0 0 .74 0L4.77 6A1.93 1.93 0 0 1 6 4.78l1.24-.42a.39.39 0 0 0 0-.73L6 3.24A1.93 1.93 0 0 1 4.78 2L4.36.76Z"/></svg>',name:"stars_20"}}o.d(t,{getIcon20Stars:()=>i})},84367:(e,t,o)=>{"use strict";function i(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 20 20"><path d="M2.75 4a.75.75 0 0 0 0 1.5H6v9.75a.75.75 0 0 0 1.5 0V5.5h3.25a.75.75 0 0 0 0-1.5h-8Z"/><path d="M10.75 7.5a.75.75 0 0 0 0 1.5h2.5v6.25a.75.75 0 0 0 1.5 0V9h2.5a.75.75 0 0 0 0-1.5h-6.5Z"/></svg>',name:"text_tt_outline_20"}}o.d(t,{getIcon20TextTtOutline:()=>i})},365045:(e,t,o)=>{"use strict";function i(){return{icon:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M13.08 2.65A2.21 2.21 0 0 1 14.64 2c.57 0 1.14.22 1.57.65l1.14 1.14a2.21 2.21 0 0 1 0 3.13l-.94.94-9.17 9.18A3.3 3.3 0 0 1 4.9 18H3a1 1 0 0 1-1-1v-1.9a3.29 3.29 0 0 1 .96-2.33l8.13-8.13 1.99-2zm2.28 4.13.93-.92a.71.71 0 0 0 0-1.02l-1.14-1.13a.71.71 0 0 0-.5-.21.71.71 0 0 0-.51.2l-.93.93 2.15 2.15zm-3.22-1.07-8.11 8.12a1.79 1.79 0 0 0-.53 1.26v1.11a.3.3 0 0 0 .3.3h1.11c.47 0 .93-.19 1.27-.53l8.1-8.11-2.15-2.15z" fill="currentColor"/></svg>',name:"write_outline_20"}}o.d(t,{getIcon20WriteOutline:()=>i})},28998:(e,t,o)=>{"use strict";function i(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M11.08 3h1.84c1.05 0 1.9 0 2.58.06.7.05 1.32.17 1.88.46a4.79 4.79 0 0 1 2.1 2.1c.28.56.4 1.17.46 1.88.06.68.06 1.53.06 2.58v7.62c0 .77 0 1.41-.05 1.91-.04.5-.14 1.03-.48 1.46a2.46 2.46 0 0 1-1.9.93c-.54 0-1.02-.24-1.44-.5-.42-.27-.93-.66-1.55-1.13l-1.61-1.24c-.61-.47-.72-.53-.8-.55a.66.66 0 0 0-.34 0c-.08.02-.19.08-.8.55l-1.61 1.24c-.62.47-1.13.86-1.55 1.13-.42.26-.9.5-1.45.5a2.46 2.46 0 0 1-1.9-.93 2.68 2.68 0 0 1-.48-1.46C4 19.11 4 18.47 4 17.7v-7.62c0-1.05 0-1.9.06-2.58.05-.7.18-1.32.46-1.88a4.79 4.79 0 0 1 2.1-2.1c.56-.28 1.17-.4 1.88-.46C9.18 3 10.03 3 11.08 3Z" clip-rule="evenodd"/></svg>',name:"bookmark_24"}}o.d(t,{getIcon24Bookmark:()=>i})},710870:(e,t,o)=>{"use strict";function i(){return{icon:'<svg fill="none" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M11.08 3h1.84c1.05 0 1.9 0 2.59.06.7.05 1.31.17 1.88.46.9.46 1.63 1.2 2.09 2.1.29.56.4 1.17.46 1.87.06.69.06 1.54.06 2.6v7.6c0 .78 0 1.42-.05 1.92-.04.5-.14 1.03-.48 1.46-.46.58-1.15.92-1.9.93-.54 0-1.02-.24-1.44-.5-.42-.27-.93-.66-1.55-1.13l-1.61-1.24c-.61-.47-.72-.53-.8-.55a.66.66 0 0 0-.34 0c-.08.02-.19.08-.8.55l-1.61 1.24c-.62.47-1.13.86-1.55 1.13-.42.26-.9.5-1.45.5a2.46 2.46 0 0 1-1.9-.93 2.68 2.68 0 0 1-.47-1.46C4 19.11 4 18.47 4 17.7v-7.62c0-1.05 0-1.9.06-2.59.05-.7.17-1.31.46-1.88.46-.9 1.2-1.63 2.1-2.09.56-.29 1.17-.4 1.87-.46C9.18 3 10.03 3 11.1 3zM8.64 4.85c-.6.05-.94.14-1.2.28-.57.28-1.03.74-1.31 1.3-.14.27-.23.62-.28 1.21-.05.6-.05 1.38-.05 2.48v7.53c0 .83 0 1.4.04 1.8.04.41.1.5.1.5.12.16.3.25.5.25 0 0 .12 0 .47-.22.34-.22.79-.56 1.45-1.07l1.58-1.2.1-.09c.44-.33.85-.65 1.32-.78.42-.1.86-.1 1.28 0 .47.13.88.45 1.32.78l.1.08 1.58 1.21c.66.5 1.1.85 1.45 1.07.35.22.46.22.46.22.2 0 .39-.1.5-.25 0 0 .07-.09.11-.5.04-.4.04-.97.04-1.8v-7.53c0-1.1 0-1.88-.05-2.48-.05-.6-.14-.94-.28-1.2a2.99 2.99 0 0 0-1.3-1.31 3.17 3.17 0 0 0-1.21-.28 33.8 33.8 0 0 0-2.48-.05h-1.76c-1.1 0-1.88 0-2.48.05z" fill="currentColor" fill-rule="evenodd"/></svg>',name:"bookmark_outline_24"}}o.d(t,{getIcon24BookmarkOutline:()=>i})},221844:(e,t,o)=>{"use strict";function i(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M7.54 6.26a.9.9 0 0 0-1.28 1.28L10.73 12l-4.47 4.46a.9.9 0 0 0 1.28 1.28L12 13.27l4.46 4.47a.9.9 0 1 0 1.28-1.28L13.27 12l4.47-4.46a.9.9 0 1 0-1.28-1.28L12 10.73 7.54 6.26Z"/></svg>',name:"cancel_24"}}o.d(t,{getIcon24Cancel:()=>i})},30295:(e,t,o)=>{"use strict";function i(){return{icon:'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 0a12 12 0 1 1 0 24 12 12 0 0 1 0-24Zm0 1.5a10.5 10.5 0 1 0 0 21 10.5 10.5 0 0 0 0-21Z" fill="currentColor"/></svg>',name:"check_circle_off_24"}}o.d(t,{getIcon24CheckCircleOff:()=>i})},94785:(e,t,o)=>{"use strict";function i(){return{icon:'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 24a12 12 0 1 0 0-24 12 12 0 0 0 0 24Zm6.2-14.8a1 1 0 0 0-1.4-1.4L10 14.58l-2.8-2.8a1 1 0 0 0-1.4 1.42l3.5 3.5a1 1 0 0 0 1.4 0l7.5-7.5Z" fill="currentColor"/></svg>',name:"check_circle_on_24"}}o.d(t,{getIcon24CheckCircleOn:()=>i})},563442:(e,t,o)=>{"use strict";function i(){return{icon:'<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g id="favorite_24__Page-2" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="favorite_24__favorite_24"><path id="favorite_24__Bounds" d="M0 0h24v24H0z"/><path d="m15.34 8.48 4.43.43c1.54.15 2.02 1.65.83 2.64l-3.47 2.88 1.29 4.7c.42 1.54-.9 2.48-2.2 1.55L12 17.7l-4.21 2.98c-1.31.92-2.63 0-2.2-1.55l1.28-4.7-3.47-2.88c-1.2-1-.72-2.5.83-2.64l4.43-.43 1.95-4.5c.6-1.4 2.17-1.4 2.78 0l1.95 4.5Z" id="favorite_24__Mask" fill="currentColor" fill-rule="nonzero"/></g></g></svg>',name:"favorite_24"}}o.d(t,{getIcon24Favorite:()=>i})},203882:(e,t,o)=>{"use strict";function i(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M12.55 4.7a.6.6 0 0 0-1.1 0L9.83 8.6a.9.9 0 0 1-.77.55l-4.13.26a.6.6 0 0 0-.35 1.05l3.26 2.86a.9.9 0 0 1 .29.9l-.94 3.84a.6.6 0 0 0 .89.66l3.47-2a.9.9 0 0 1 .9 0l3.47 2a.6.6 0 0 0 .88-.66l-.93-3.85a.9.9 0 0 1 .29-.89l3.26-2.86a.6.6 0 0 0-.35-1.05l-4.13-.26a.9.9 0 0 1-.77-.56l-1.62-3.9ZM9.78 4a2.4 2.4 0 0 1 4.44 0l1.4 3.39 3.56.23a2.4 2.4 0 0 1 1.43 4.2l-2.86 2.5.8 3.32a2.4 2.4 0 0 1-3.53 2.64L12 18.54l-3.02 1.74a2.4 2.4 0 0 1-3.54-2.64l.8-3.32-2.85-2.5a2.4 2.4 0 0 1 1.43-4.2l3.56-.23L9.78 4Z" clip-rule="evenodd"/></svg>',name:"favorite_outline_24"}}o.d(t,{getIcon24FavoriteOutline:()=>i})},638338:(e,t,o)=>{"use strict";function i(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M6 6.6c0-.56 0-.84.1-1.05a1 1 0 0 1 .45-.44C6.76 5 7.04 5 7.6 5h.8c.56 0 .84 0 1.05.1a1 1 0 0 1 .44.45c.11.21.11.49.11 1.05v10.8c0 .56 0 .84-.1 1.05a1 1 0 0 1-.45.44c-.21.11-.49.11-1.05.11h-.8c-.56 0-.84 0-1.05-.1a1 1 0 0 1-.44-.45C6 18.24 6 17.96 6 17.4V6.6Zm8 0c0-.56 0-.84.1-1.05a1 1 0 0 1 .45-.44C14.76 5 15.04 5 15.6 5h.8c.56 0 .84 0 1.05.1a1 1 0 0 1 .44.45c.11.21.11.49.11 1.05v10.8c0 .56 0 .84-.1 1.05a1 1 0 0 1-.45.44c-.21.11-.49.11-1.05.11h-.8c-.56 0-.84 0-1.05-.1a1 1 0 0 1-.44-.45c-.11-.21-.11-.49-.11-1.05V6.6Z"/></svg>',name:"pause_24"}}o.d(t,{getIcon24Pause:()=>i})},988668:(e,t,o)=>{"use strict";function i(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M18.5 11.13a1 1 0 0 1 0 1.74l-9 5.2A1 1 0 0 1 8 17.2V6.8a1 1 0 0 1 1.5-.86l9 5.2Z"/></svg>',name:"play_24"}}o.d(t,{getIcon24Play:()=>i})},37055:(e,t,o)=>{"use strict";function i(){return{icon:'<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g id="song_24__Page-2" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="song_24__song_24"><path id="song_24__Bounds" d="M0 0h24v24H0z"/><path d="M13 11.48v5.65c0 4.52-.87 5.39-4.37 5.85C6.96 23.19 5 22.44 5 19.8c0-1.28.8-2.5 2.46-2.81 1.27-.25-.09.02 2.78-.52.7-.13.77-.37.77-.9V3.97c0-1.24.67-1.69 2.66-2.09l4.68-.87c.37-.07.65.07.65.49v4.05c0 .42-.17.6-.59.68l-4.86.86c-.38.1-.55.36-.55.74v3.64Z" id="song_24__Mask" fill="currentColor"/></g></g></svg>',name:"song_24"}}o.d(t,{getIcon24Song:()=>i})},344588:(e,t,o)=>{"use strict";function i(){return{icon:'<svg width="56" height="56" viewBox="0 0 56 56" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M28 52a24 24 0 1 0 0-48 24 24 0 0 0 0 48z" fill="#FC3"/><path fill-rule="evenodd" clip-rule="evenodd" d="M31.86 40.86a1.29 1.29 0 0 1 0 2.57h-7.72a1.29 1.29 0 0 1 0-2.57h7.72zm-1.29-12c.86-.86 1.72 1.71 6 1.71 3.43 0 6.43-1.71 6.86-.86.43.86-2.57 4.29-6.86 4.29-5.14 0-6.86-4.29-6-5.14zm-5.14 0c.86.85-.86 5.14-6 5.14-4.29 0-7.29-3.43-6.86-4.29.43-.85 3.43.86 6.86.86 4.28 0 5.14-2.57 6-1.71zm9.43-10.29c.85-.86 2.57 2.14 6 3.43s4.28 1.29 4.28 2.57c0 .86-.85 1.72-5.14 0-4.29-1.71-6-5.14-5.14-6zm-13.72 0c.86.86-.85 4.29-5.14 6-4.29 1.72-5.14.86-5.14 0 0-1.28.85-1.28 4.28-2.57 3.43-1.29 5.15-4.29 6-3.43z" fill="#805446"/></svg>',name:"pensive_face_56"}}o.d(t,{getIcon56PensiveFace:()=>i})},620407:(e,t,o)=>{"use strict";o.d(t,{AudioPlayerHTML5:()=>r});var i=o(714209),s=o(493810),a=o(109465),n=o(778419);class r{destroy(){}getPlayedTime(){const e=this._currentAudioEl.played;let t=0;for(let o=0;o<e.length;o++)t+=e.end(o)-e.start(o);return t}getCurrentTime(){return this._currentAudioEl.currentTime}clearAudioNode(){this._currentAudioEl=this._createAudioNode(a.SILENCE)}isCurrent(e){return e===this._currentAudioEl}_createAudioNode(e){const t=new n.AudioHlsNode({onBufferUpdate:()=>{this.isCurrent(t)&&this.opts.onBufferUpdate(this.getCurrentBuffered())},onProgressUpdate:()=>{this.isCurrent(t)&&t.src!==a.SILENCE&&this.opts.onProgressUpdate(this.getCurrentProgress(),this.getPlayedTime(),this.getCurrentTime())},onEnd:()=>{this.isCurrent(t)&&t.src!==a.SILENCE&&this.opts.onEnd()},onSeeked:()=>{this.isCurrent(t)&&this.opts.onSeeked()},onSeek:()=>{this.isCurrent(t)&&this.opts.onSeek()},onFail:e=>{this._prefetchAudioEl===t?this._prefetchAudioEl=this._createAudioNode():this.isCurrent(t)&&t.src!==a.SILENCE&&(this._hlsError=e,this.opts.onFail&&this.opts.onFail())},onDurationChange:()=>{this.isCurrent(t)&&this._seekOnReady&&t.duration>0&&(this.seek(this._seekOnReady),this._seekOnReady=!1)},onCanPlay:()=>{this.isCurrent(t)&&this.opts.onCanPlay&&this.opts.onCanPlay()},onPause:(...e)=>{this.isCurrent(t)&&t.src!==a.SILENCE&&this.opts.onPause(...e)},onPlay:(...e)=>{this.isCurrent(t)&&t.src!==a.SILENCE&&this.opts.onPlay(...e)},volume:this.hasOwnProperty("_volume")?this._volume:this.opts.defaultVolume},e);return t}onReady(e){e()}prefetch(e){const t=(0,s.audioUnmaskSource)(e);this._prefetchAudioEl&&this._prefetchAudioEl.url===t||(this._prefetchAudioEl=this._createAudioNode(t))}seek(e){const t=this._currentAudioEl;t.duration>0&&t.src&&t.src!==a.SILENCE?t.currentTime=t.duration*e:this._seekOnReady=e}setVolume(e){void 0===e&&(e=this._currentAudioEl.volume),this._currentAudioEl.volume=e,this._prefetchAudioEl&&(this._prefetchAudioEl.volume=e),this._volume=e}setPlaybackRate(e){this._currentAudioEl.playbackRate=e}getCurrentProgress(){return this._currentAudioEl.currentProgress}getCurrentBuffered(){return this._currentAudioEl&&this._currentAudioEl.currentBuffered}getDuration(){return this._currentAudioEl&&this._currentAudioEl.duration}isFullyLoaded(){return this._currentAudioEl.isFullyLoaded}setUrl(e,t=(()=>{})){let o;if(!e)return t&&t(!1);const i=(0,s.audioUnmaskSource)(e);let n=this._currentAudioEl;if(this._currentAudioEl.src&&this._currentAudioEl.src!==a.SILENCE&&(this._seekOnReady=!1),this._currentAudioEl.src===i)return this.opts.onCanPlay&&this.opts.onCanPlay(),void(t&&t(!0));if(this._prefetchAudioEl){if(this._prefetchAudioEl.src===i)return this._currentAudioEl.pause(),this._currentAudioEl.setUrl(a.SILENCE),this._prefetchAudioEl.readyState>=3&&setTimeout((()=>this.opts.onCanPlay&&this.opts.onCanPlay())),this._currentAudioEl=this._prefetchAudioEl,this._prefetchAudioEl=null,void(t&&t(!0));i!==a.SILENCE&&this._prefetchAudioEl.setUrl(a.SILENCE)}n.src!==i&&(o=n.setUrl(i).then((()=>this._stopFrequencyAnalise()))),o?o.then((()=>t(!0))).catch((()=>t(!1))):t(!0)}play(){this._stopFrequencyAnalise();const e=this._currentAudioEl;if(e.src){const t=e.play();return this._startFrequencyAnalise(),t}return Promise.resolve()}preparePlay(){if(i.browser.safari)return this._currentAudioEl.setUrl(a.SILENCE).then((()=>this._currentAudioEl.play()))}_startFrequencyAnalise(){function e(e,t,o,i){return(o-t)*e/i+t}function t(e,t){return Math.random()*(t-e)+e}this._stopFrequencyAnalise();let o=999,i=null,s=null;this._freqUpdateInterval=setInterval((()=>{let a;this._currentAudioEl.paused?a=[0,0,0,0]:(o++,o>3&&(o=0,i=s,s=[t(.7,1),t(.55,.8),t(.3,.55),t(.03,.45)],i||(i=[t(.7,1),t(.55,.8),t(.3,.55),t(.03,.45)])),a=[e(o,i[0],s[0],3),e(o,i[1],s[1],3),e(o,i[2],s[2],3),e(o,i[3],s[3],3)]),this.opts.onFrequency&&this.opts.onFrequency(a)}),50)}_stopFrequencyAnalise(){clearInterval(this._freqUpdateInterval),this.opts.onFrequency&&this.opts.onFrequency([0,0,0,0])}pause(){this._currentAudioEl.pause(),this._stopFrequencyAnalise()}stop(){this._currentAudioEl.pause(),this.seek(0),this._stopFrequencyAnalise()}_setFadeVolumeInterval(e){if(e){if(!this._fadeVolumeWorker&&window.Worker&&window.Blob){const e=new Blob(["\n          var interval;\n          onmessage = function(e) {\n            clearInterval(interval);\n            if (e.data == 'start') {\n              interval = setInterval(function() { postMessage({}); }, 20);\n            }\n          }\n        "]);try{this._fadeVolumeWorker=new Worker(window.URL.createObjectURL(e))}catch(e){this._fadeVolumeWorker=!1}}this._fadeVolumeWorker?(this._fadeVolumeWorker.onmessage=e,this._fadeVolumeWorker.postMessage("start")):this._fadeVolumeInterval=setInterval(e,60)}else this._fadeVolumeWorker&&(this._fadeVolumeWorker.terminate(),this._fadeVolumeWorker=null),this._fadeVolumeInterval&&clearInterval(this._fadeVolumeInterval)}fadeVolume(e,t,o){e=Math.max(0,Math.min(1,e));const i=this._currentAudioEl;let s=0;if(t){const o=e-i.volume;s=o/(t/20||1)}else s=e<i.volume?-.06:.001;if(Math.abs(e-i.volume)<=.001)return this._setFadeVolumeInterval(),o&&o();let a=i.volume;this._setFadeVolumeInterval((()=>{!t&&s>0&&(s*=1.35),a+=s;let i=!1;if(i=s<0?a<=e:a>=e,i)return this.setVolume(e),this._setFadeVolumeInterval(),o&&o();this.setVolume(a)}))}getErrorData(){const e=this._currentAudioEl.error||{};return{is_hls:this._currentAudioEl.hls?1:0,url:this._currentAudioEl.src,error_code:e.code,error_message:e.message,hls_error:this._hlsError?JSON.stringify(this._hlsError):null}}constructor(e){this.type="html5",this.opts=e||{},this._audioNodes=[],this._currentAudioEl=this._createAudioNode(),this._prefetchAudioEl=this._createAudioNode()}}},603354:(e,t,o)=>{"use strict";o.d(t,{AudioAds:()=>l});var i=o(7144),s=o(381263),a=o(714209),n=o(514640),r=o(944762),_=o(490712),u=o(866953),d=o(981188);class l{get isActive(){return!!this._isActive}set isActive(e){this._isActive=e,this.player.notify(n.events.PLAYER_IS_AD_CHANGED,e)}isPlaying(){return this.isActive}getCurrentAd(){return this._currentAd}setAdsConfig(e){this._adsConfig=e}getCurrentProgress(){return this._adsCurrentProgress}getDuration(){return this._duration}loadAdman(e){const t=t=>e&&e(t);if(this._admanLoaded)return void t();let o=0;(0,s.loadScript)(l.ADMAN_SRC,{onLoad:()=>{this._admanLoaded=!0,t()},onError:()=>{window.abp?(this._admanLoaded=!0,t()):(o+=1,3===o&&(this._admanLoaded=!0),t("script_load_fail"))}})}_fetchAd(e,t,o,s,a){this.loadAdman((r=>{if(!window.AdmanHTML)return this._sendEvent("no_adman",t,l.AD_TYPE,r),s&&s();this._adman=new AdmanHTML;const _=this._adsConfig||vk.audioAdsConfig||window.audioAdsConfig,u={_SITEID:276,ver:251116,vk_id:vk.id,puid1:554,duration:e.duration,content_id:c(e.ownerId,e.id),vk_catid:l.CAT_IDS[t]||l.CAT_IDS.other,sign:_?.sign||""};Object.assign(u,e.ads||{}),nav.objLoc&&nav.objLoc.preview&&(u.preview=(0,i.intval)(nav.objLoc.preview)),cur.adsPreview&&(u.preview=1,u.vk_id=398724832),this._adman.setDebug(!!u.preview),this._adman.onError((()=>s&&s())),this._adman.onReady((()=>{if(!this._adman)return;const e=this._adman.getBannersForSection(l.AD_TYPE);if(e&&e.length){const[i]=e;"statistics"===i.type?(this._play(!0,t),s&&s()):(this._sendEvent("received",t),o?(this._sendEvent("rejected",t,l.AD_TYPE,a),this.deinit(),s&&s()):(this._sendEvent("ready",t),this.player.notify(n.events.AD_READY),this._play(!1,t,s,i)))}else o||this._sendEvent("not_received",t),s&&s()})),this._adman.init({slot:3514,wrapper:document.createElement("div"),params:u,browser:{adBlock:!!window.abp,mobile:!1}}),this._sendEvent("requested",t)}))}_sendEvent(e,t,o,s){const a=o?"/"+o:"",n=s?"/"+s:"";this._adEvents.push(e+"/"+t+a+n),clearTimeout(this._adEventDelay),this._adEventDelay=setTimeout((()=>{ajax.post(this.adsStatUrl,{act:"ad_event",events:this._adEvents.join(","),v:this.playerVersion,abp:(0,i.intval)(window.abp)},{onFail:()=>!0}),this._adEvents=[]}),500)}_play(e,t,o,s){this._adman.onCompleted((()=>{this.deinit(!0),e?this._sendEvent("statistics",t):(this.player.notify(n.events.PROGRESS,0),this.player.notify(n.events.AD_COMPLETED),this.isActive=!1,this._currentAd=null,this._adsCurrentProgress=0,this._sendEvent("completed",t),this.isMvk||(window.document.title=(0,i.replaceEntities)(this._adsPrevTitle)),o&&o())})),this._adman.onStarted((()=>{e||(this.player.setIsPlaying(!0),this.player.notify(n.events.PLAY),this.player.notify(n.events.PROGRESS,0),this.player.notify(n.events.AD_STARTED,(0,d.makeAudioAdFromAdman)(s)),this.updateVolume(),this._sendEvent("started",t),window.statlogsValueEvent&&(0,_.statlogsValueEvent)("audio_web_ad_link","show"))})),this._adman.onPaused((()=>{this.player.setIsPlaying(!1),this.player.notify(n.events.PAUSE)})),this._adman.onPlayed((()=>{this.player.setIsPlaying(!0),this.player.notify(n.events.PLAY)}));const a=[.25,.5,.75];if(this._adman.onTimeRemained((e=>{this._duration=isNaN(e.duration)?0:e.duration,this._adsCurrentProgress=(isNaN(e.percent)?0:e.percent)/100,this.player.notify(n.events.PROGRESS,this._adsCurrentProgress,this._duration),(0,i.each)(a,((e,o)=>{if(this._adsCurrentProgress>=o)return a.shift(),this._sendEvent("progress_"+(0,i.intval)(100*o),t),!1}))})),this._adman.start(l.AD_TYPE),e)return o&&o();this._currentAd=(0,d.makeAudioAdFromAdman)(s),this.isActive=!0,this._adsPrevTitle=document.title,this.isMvk||(window.document.title=getLang("global_audio_ad"))}updateVolume(){this._adman&&this._adman.setVolume(.7*this.player.getVolume())}deinit(e){this._adman=null,!e&&this.player.notify(n.events.AD_DEINITED)}pause(){this._adman&&(this.player.setIsPlaying(!1),this._adman.pause())}stop(){this._adman&&(this.player.setIsPlaying(!1),this._adman.stop())}resume(){this._adman&&(this.player.setIsPlaying(!0),this._adman.resume(),this.player.notify(n.events.PLAY))}checkPlay(e,t){const o=this.player._getPlayingContextSection(),{type:i,reason:s}=this._isAllowed(e),a=()=>t&&t();switch(i){case l.ALLOW_ALLOWED:this._fetchAd(e,o,!1,a);break;case l.ALLOW_DISABLED:a();break;case l.ALLOW_REJECT:this._fetchAd(e,o,!0,!1,s),a()}}hasAdsSupport(){const e=(0,i.intval)(a.browser.version.split(".")[0]);return!(a.browser.ios||a.browser.safari&&this.isMvk||a.browser.chrome&&e<50)}_isAllowed(e){if(vk.widget||(0,r.isPodcast)(e)||(0,u.isExternalStream)(e))return{type:l.ALLOW_DISABLED};const t=this._adsConfig||vk.audioAdsConfig||window.audioAdsConfig;if(t){if(!t.enabled||!this.hasAdsSupport())return{type:l.ALLOW_DISABLED};if(cur.adsPreview)return{type:l.ALLOW_ALLOWED};if(t.day_limit_reached)return{type:l.ALLOW_REJECT,reason:l.REJECT_REASON_LIMIT};return"im"!==this.player._getPlayingContextSection()?{type:l.ALLOW_ALLOWED}:{type:l.ALLOW_REJECT,reason:l.REJECT_REASON_SECTION}}return{type:l.ALLOW_REJECT,reason:l.REJECT_REASON_UNKNOWN}}startPlay(e,t){this.checkPlay(e,t)}constructor(e,t,o){this._isActive=!1,this._currentAd=null,this._adsCurrentProgress=0,this._adman=null,this._admanLoaded=!1,this._adEvents=[],this.player=e||{},this.playerVersion=t||null,this._startAdsTO=null,this._adsConfig=null,this._duration=0,this.isMvk=Boolean(o),this.adsStatUrl=this.isMvk?"audio":"al_audio.php"}}function c(e,t){const o=e.toString(16);let i=t.toString(16);for(;i.length<8;)i="0"+i;return o+i}l.ADMAN_SRC="//ad.mail.ru/static/admanhtml/rbadman-html5.min.js",l.CAT_IDS={my:101,my_playlists:101,audio_feed:109,recent:113,user_wall:104,group_wall:104,user_list:102,group_list:103,user_playlists:102,group_playlists:103,feed:105,search:110,global_search:110,replies:104,im:106,group_status:104,user_status:104,recs:107,recs_audio:107,recs_album:107,other:114},l.AD_TYPE="preroll",l.ALLOW_DISABLED=1,l.ALLOW_ALLOWED=2,l.ALLOW_REJECT=3,l.REJECT_REASON_UNKNOWN="unknown",l.REJECT_REASON_LIMIT="track_limit_exceeded",l.REJECT_REASON_SECTION="section_not_allowed"},109465:(e,t,o)=>{"use strict";o.d(t,{DEFAULT_VOLUME:()=>s,SILENCE:()=>i});const i="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA",s=.4761515102104643},493810:(e,t,o)=>{"use strict";o.d(t,{audioUnmaskSource:()=>n});var i=o(7144);const s="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMN0PQRSTUVWXYZO123456789+/=",a={v:function(e){return e.split("").reverse().join("")},r:function(e,t){let o;e=e.split("");const i=s+s;let a=e.length;for(;a--;)o=i.indexOf(e[a]),~o&&(e[a]=i.substr(o-t,1));return e.join("")},s:function(e,t){let o=e.length;if(o){const i=function(e,t){const o=e.length,i=[];if(o){let e=o;for(t=Math.abs(t);e--;)t=(o*(e+1)^t+e)%o,i[e]=t}return i}(e,t);let s=0;for(e=e.split("");++s<o;)e[s]=e.splice(i[o-1-s],1,e[s])[0];e=e.join("")}return e},i:function(e,t){return a.s(e,t^vk.id)},x:function(e,t){const o=[];return t=t.charCodeAt(0),(0,i.each)(e.split(""),(function(e,i){o.push(String.fromCharCode(i.charCodeAt(0)^t))})),o.join("")}};function n(e){if((!window.wbopen||!~(window.open+"").indexOf("wbopen"))&&~e.indexOf("audio_api_unavailable")){let t,o,i=e.split("?extra=")[1].split("#"),s=""===i[1]?"":r(i[1]);if(i=r(i[0]),"string"!=typeof s||!i)return e;s=s?s.split(String.fromCharCode(9)):[];let n=s.length;for(;n--;){if(o=s[n].split(String.fromCharCode(11)),t=o.splice(0,1,i)[0],!a[t])return e;i=a[t].apply(null,o)}if(i&&"http"===i.substr(0,4))return i}return e}function r(e){if(!e||e.length%4==1)return!1;let t,o,i=0,a=0,n="";for(;o=e.charAt(a++);)o=s.indexOf(o),~o&&(t=i%4?64*t+o:o,i++%4)&&(n+=String.fromCharCode(255&t>>(-2*i&6)));return n}},567005:(e,t,o)=>{"use strict";function i(e,t){let o="";return e.forEach((function(i,s){let a="/audio?performer=1&q="+encodeURIComponent(i.name),n=window.getWebHost?window.getWebHost():"";i.id&&(a=`/artist/${i.id}`),o+=t?`<a class="artist_link" href="${n}${a}">${i.name}</a>`:i.name,s<e.length-1&&(o+=", ")})),o}o.d(t,{getAudioArtistsString:()=>i})},694581:(e,t,o)=>{"use strict";o.d(t,{getAudioPerformers:()=>n});var i=o(944762),s=o(567005),a=o(59052);function n(e,t=!0){let o="";const n=!(0,i.isPodcast)(e)&&t;if(Array.isArray(e[a.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_MAIN_ARTISTS])&&(o=(0,s.getAudioArtistsString)(e[a.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_MAIN_ARTISTS],n)),Array.isArray(e[a.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_FEAT_ARTISTS])&&(o+=" feat. ",o+=(0,s.getAudioArtistsString)(e[a.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_FEAT_ARTISTS],n)),!o){let t=e[a.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_PERFORMER]?e[a.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_PERFORMER].replace(/<\/?em>/g,""):"";if(n){o=`<a class="artist_link" data-performer="${t}" href="${"/audio?performer=1&q="+encodeURIComponent(t)}">${t}</a>`}else o=t}return o}},944762:(e,t,o)=>{"use strict";o.d(t,{isPodcast:()=>a});var i=o(59052),s=o(7144);function a(e){if(!e)return!1;let t=(0,s.isObject)(e)?e.extra:e[i.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_EXTRA];return(0,s.isObject)(t)||(t=JSON.parse(t||"{}")),!!t.podcast}},591060:(e,t,o)=>{"use strict";o.d(t,{serializeAudio:()=>s});var i=o(59052);function s(e){if(!e)return null;if(Array.isArray(e))return e;const t=[e.addHash,e.editHash,e.actionHash,e.deleteHash,e.replaceHash,e.urlHash,e.restoreHash].join("/"),o=[e.coverUrl_l,e.coverUrl_p].join(","),s=[];return s[i.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ID]=e.id,s[i.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_OWNER_ID]=e.owner_id,s[i.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_URL]=e.url,s[i.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_TITLE]=e.title,s[i.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_PERFORMER]=e.performer,s[i.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_DURATION]=e.duration,s[i.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ALBUM_ID]=e.albumId,s[i.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_AUTHOR_LINK]=e.authorLink,s[i.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_LYRICS]=e.lyrics,s[i.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_FLAGS]=e.flags,s[i.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_CONTEXT]=e.context,s[i.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_EXTRA]=e.extra,s[i.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_HASHES]=t,s[i.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_COVER_URL]=o,s[i.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ADS]=e.ads,s[i.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_SUBTITLE]=e.subTitle,s[i.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_MAIN_ARTISTS]=e.mainArtists,s[i.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_FEAT_ARTISTS]=e.featArtists,s[i.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ALBUM]=e.album,s[i.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_TRACK_CODE]=e.trackCode,s[i.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_RESTRICTION]=e.restrictionStatus,s[i.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ALBUM_PART]=e.albumPart,s[i.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_ACCESS_KEY]=e.accessKey,s[i.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_CHART_INFO_INDEX]=e.chartInfo,s}},836901:(e,t,o)=>{"use strict";function i(e,t){if(!window.Worker||!window.Blob)return setTimeout(e,t);{const o=new Blob([`\n      var timeout;\n      onmessage = function(e) {\n        clearTimeout(timeout);\n        if (e.data == 'start') {\n          timeout = setTimeout(function() { postMessage({}); }, ${t});\n        }\n      }\n    `]);try{const t=new Worker(window.URL.createObjectURL(o));return t.onmessage=function(){t.terminate(),e()},t.postMessage("start"),t}catch(o){return setTimeout(e,t)}}}o.d(t,{setWorkerTimeout:()=>i})},72882:(e,t,o)=>{"use strict";function i(e){try{return e.play()||Promise.resolve()}catch(e){return Promise.reject(e)}}o.d(t,{wrapAudioPlay:()=>i})},628411:(e,t,o)=>{"use strict";o.d(t,{EMOJI_HINTS:()=>r,EMOJI_PREFIXED_REPLACES:()=>a,EMOJI_REPLACES:()=>n,emojiRegex:()=>i,skinToneModifierRegex:()=>s});const i=()=>/\u{1F3F4}(?:\u{E0067}\u{E0062}(?:\u{E0065}\u{E006E}\u{E0067}|\u{E0077}\u{E006C}\u{E0073}|\u{E0073}\u{E0063}\u{E0074})\u{E007F}|\u{200D}\u{2620}\u{FE0F}?)|\u{1F469}\u{200D}\u{1F469}\u{200D}(?:\u{1F466}\u{200D}\u{1F466}|\u{1F467}\u{200D}[\u{1F466}\u{1F467}])|\u{1F468}(?:\u{200D}(?:\u{2764}\u{FE0F}?\u{200D}(?:\u{1F48B}\u{200D})?\u{1F468}|[\u{1F468}\u{1F469}]\u{200D}(?:\u{1F466}\u{200D}\u{1F466}|\u{1F467}\u{200D}[\u{1F466}\u{1F467}])|\u{1F466}\u{200D}\u{1F466}|\u{1F467}\u{200D}[\u{1F466}\u{1F467}]|[\u{1F33E}\u{1F373}\u{1F393}\u{1F3A4}\u{1F3A8}\u{1F3EB}\u{1F3ED}\u{1F4BB}\u{1F4BC}\u{1F527}\u{1F52C}\u{1F680}\u{1F692}\u{1F9B0}-\u{1F9B3}])|[\u{1F3FB}-\u{1F3FF}]\u{200D}[\u{1F33E}\u{1F373}\u{1F393}\u{1F3A4}\u{1F3A8}\u{1F3EB}\u{1F3ED}\u{1F4BB}\u{1F4BC}\u{1F527}\u{1F52C}\u{1F680}\u{1F692}\u{1F9B0}-\u{1F9B3}])|\u{1F469}\u{200D}(?:\u{2764}\u{FE0F}?\u{200D}(?:\u{1F48B}\u{200D}[\u{1F468}\u{1F469}]|[\u{1F468}\u{1F469}])|[\u{1F33E}\u{1F373}\u{1F393}\u{1F3A4}\u{1F3A8}\u{1F3EB}\u{1F3ED}\u{1F4BB}\u{1F4BC}\u{1F527}\u{1F52C}\u{1F680}\u{1F692}\u{1F9B0}-\u{1F9B3}])|\u{1F469}\u{200D}\u{1F466}\u{200D}\u{1F466}|(?:\u{1F441}\u{FE0F}?\u{200D}\u{1F5E8}|\u{1F469}[\u{1F3FB}-\u{1F3FF}]\u{200D}[\u{2695}\u{2696}\u{2708}]|\u{1F468}(?:[\u{1F3FB}-\u{1F3FF}]\u{200D}[\u{2695}\u{2696}\u{2708}]|\u{200D}[\u{2695}\u{2696}\u{2708}])|(?:[\u{26F9}\u{1F3CB}\u{1F3CC}\u{1F575}]\u{FE0F}?|[\u{1F46F}\u{1F93C}\u{1F9DE}\u{1F9DF}])\u{200D}[\u{2640}\u{2642}]|[\u{26F9}\u{1F3CB}\u{1F3CC}\u{1F575}][\u{1F3FB}-\u{1F3FF}]\u{200D}[\u{2640}\u{2642}]|[\u{1F3C3}\u{1F3C4}\u{1F3CA}\u{1F46E}\u{1F471}\u{1F473}\u{1F477}\u{1F481}\u{1F482}\u{1F486}\u{1F487}\u{1F645}-\u{1F647}\u{1F64B}\u{1F64D}\u{1F64E}\u{1F6A3}\u{1F6B4}-\u{1F6B6}\u{1F926}\u{1F937}-\u{1F939}\u{1F93D}\u{1F93E}\u{1F9B8}\u{1F9B9}\u{1F9D6}-\u{1F9DD}](?:[\u{1F3FB}-\u{1F3FF}]\u{200D}[\u{2640}\u{2642}]|\u{200D}[\u{2640}\u{2642}])|\u{1F469}\u{200D}[\u{2695}\u{2696}\u{2708}])\u{FE0F}?|\u{1F469}\u{200D}\u{1F467}\u{200D}[\u{1F466}\u{1F467}]|\u{1F469}\u{200D}\u{1F469}\u{200D}[\u{1F466}\u{1F467}]|\u{1F468}(?:\u{200D}(?:[\u{1F468}\u{1F469}]\u{200D}[\u{1F466}\u{1F467}]|[\u{1F466}\u{1F467}])|[\u{1F3FB}-\u{1F3FF}])|\u{1F3F3}\u{FE0F}?\u{200D}\u{1F308}|\u{1F469}\u{200D}\u{1F467}|\u{1F469}[\u{1F3FB}-\u{1F3FF}]\u{200D}[\u{1F33E}\u{1F373}\u{1F393}\u{1F3A4}\u{1F3A8}\u{1F3EB}\u{1F3ED}\u{1F4BB}\u{1F4BC}\u{1F527}\u{1F52C}\u{1F680}\u{1F692}\u{1F9B0}-\u{1F9B3}]|\u{1F469}\u{200D}\u{1F466}|\u{1F1F6}\u{1F1E6}|\u{1F1FD}\u{1F1F0}|\u{1F1F4}\u{1F1F2}|\u{1F469}[\u{1F3FB}-\u{1F3FF}]|\u{1F1ED}[\u{1F1F0}\u{1F1F2}\u{1F1F3}\u{1F1F7}\u{1F1F9}\u{1F1FA}]|\u{1F1EC}[\u{1F1E6}\u{1F1E7}\u{1F1E9}-\u{1F1EE}\u{1F1F1}-\u{1F1F3}\u{1F1F5}-\u{1F1FA}\u{1F1FC}\u{1F1FE}]|\u{1F1EA}[\u{1F1E6}\u{1F1E8}\u{1F1EA}\u{1F1EC}\u{1F1ED}\u{1F1F7}-\u{1F1FA}]|\u{1F1E8}[\u{1F1E6}\u{1F1E8}\u{1F1E9}\u{1F1EB}-\u{1F1EE}\u{1F1F0}-\u{1F1F5}\u{1F1F7}\u{1F1FA}-\u{1F1FF}]|\u{1F1F2}[\u{1F1E6}\u{1F1E8}-\u{1F1ED}\u{1F1F0}-\u{1F1FF}]|\u{1F1F3}[\u{1F1E6}\u{1F1E8}\u{1F1EA}-\u{1F1EC}\u{1F1EE}\u{1F1F1}\u{1F1F4}\u{1F1F5}\u{1F1F7}\u{1F1FA}\u{1F1FF}]|\u{1F1FC}[\u{1F1EB}\u{1F1F8}]|\u{1F1FA}[\u{1F1E6}\u{1F1EC}\u{1F1F2}\u{1F1F3}\u{1F1F8}\u{1F1FE}\u{1F1FF}]|\u{1F1F0}[\u{1F1EA}\u{1F1EC}-\u{1F1EE}\u{1F1F2}\u{1F1F3}\u{1F1F5}\u{1F1F7}\u{1F1FC}\u{1F1FE}\u{1F1FF}]|\u{1F1EF}[\u{1F1EA}\u{1F1F2}\u{1F1F4}\u{1F1F5}]|\u{1F1F8}[\u{1F1E6}-\u{1F1EA}\u{1F1EC}-\u{1F1F4}\u{1F1F7}-\u{1F1F9}\u{1F1FB}\u{1F1FD}-\u{1F1FF}]|\u{1F1EE}[\u{1F1E8}-\u{1F1EA}\u{1F1F1}-\u{1F1F4}\u{1F1F6}-\u{1F1F9}]|\u{1F1FF}[\u{1F1E6}\u{1F1F2}\u{1F1FC}]|\u{1F1EB}[\u{1F1EE}-\u{1F1F0}\u{1F1F2}\u{1F1F4}\u{1F1F7}]|\u{1F1F5}[\u{1F1E6}\u{1F1EA}-\u{1F1ED}\u{1F1F0}-\u{1F1F3}\u{1F1F7}-\u{1F1F9}\u{1F1FC}\u{1F1FE}]|\u{1F1E9}[\u{1F1EA}\u{1F1EC}\u{1F1EF}\u{1F1F0}\u{1F1F2}\u{1F1F4}\u{1F1FF}]|\u{1F1F9}[\u{1F1E6}\u{1F1E8}\u{1F1E9}\u{1F1EB}-\u{1F1ED}\u{1F1EF}-\u{1F1F4}\u{1F1F7}\u{1F1F9}\u{1F1FB}\u{1F1FC}\u{1F1FF}]|\u{1F1E7}[\u{1F1E6}\u{1F1E7}\u{1F1E9}-\u{1F1EF}\u{1F1F1}-\u{1F1F4}\u{1F1F6}-\u{1F1F9}\u{1F1FB}\u{1F1FC}\u{1F1FE}\u{1F1FF}]|[#\*0-9]\u{FE0F}?\u{20E3}|\u{1F1F1}[\u{1F1E6}-\u{1F1E8}\u{1F1EE}\u{1F1F0}\u{1F1F7}-\u{1F1FB}\u{1F1FE}]|\u{1F1E6}[\u{1F1E8}-\u{1F1EC}\u{1F1EE}\u{1F1F1}\u{1F1F2}\u{1F1F4}\u{1F1F6}-\u{1F1FA}\u{1F1FC}\u{1F1FD}\u{1F1FF}]|\u{1F1F7}[\u{1F1EA}\u{1F1F4}\u{1F1F8}\u{1F1FA}\u{1F1FC}]|\u{1F1FB}[\u{1F1E6}\u{1F1E8}\u{1F1EA}\u{1F1EC}\u{1F1EE}\u{1F1F3}\u{1F1FA}]|\u{1F1FE}[\u{1F1EA}\u{1F1F9}]|[\u{1F3C3}\u{1F3C4}\u{1F3CA}\u{1F46E}\u{1F471}\u{1F473}\u{1F477}\u{1F481}\u{1F482}\u{1F486}\u{1F487}\u{1F645}-\u{1F647}\u{1F64B}\u{1F64D}\u{1F64E}\u{1F6A3}\u{1F6B4}-\u{1F6B6}\u{1F926}\u{1F937}-\u{1F939}\u{1F93D}\u{1F93E}\u{1F9B8}\u{1F9B9}\u{1F9D6}-\u{1F9DD}][\u{1F3FB}-\u{1F3FF}]|[\u{26F9}\u{1F3CB}\u{1F3CC}\u{1F575}][\u{1F3FB}-\u{1F3FF}]|[\u{261D}\u{270A}-\u{270D}\u{1F385}\u{1F3C2}\u{1F3C7}\u{1F442}\u{1F443}\u{1F446}-\u{1F450}\u{1F466}\u{1F467}\u{1F470}\u{1F472}\u{1F474}-\u{1F476}\u{1F478}\u{1F47C}\u{1F483}\u{1F485}\u{1F4AA}\u{1F574}\u{1F57A}\u{1F590}\u{1F595}\u{1F596}\u{1F64C}\u{1F64F}\u{1F6C0}\u{1F6CC}\u{1F918}-\u{1F91C}\u{1F91D}\u{1F91E}\u{1F91F}\u{1F930}-\u{1F936}\u{1F9B5}\u{1F9B6}\u{1F9D1}-\u{1F9D5}][\u{1F3FB}-\u{1F3FF}]|[\u{231A}\u{231B}\u{23E9}-\u{23EC}\u{23F0}\u{23F3}\u{25FD}\u{25FE}\u{2614}\u{2615}\u{2648}-\u{2653}\u{267F}\u{2693}\u{26A1}\u{26AA}\u{26AB}\u{26BD}\u{26BE}\u{26C4}\u{26C5}\u{26CE}\u{26D4}\u{26EA}\u{26F2}\u{26F3}\u{26F5}\u{26FA}\u{26FD}\u{2705}\u{270A}\u{270B}\u{2728}\u{274C}\u{274E}\u{2753}-\u{2755}\u{2757}\u{2795}-\u{2797}\u{27B0}\u{27BF}\u{2B1B}\u{2B1C}\u{2B50}\u{2B55}\u{1F004}\u{1F0CF}\u{1F18E}\u{1F191}-\u{1F19A}\u{1F1E6}-\u{1F1FF}\u{1F201}\u{1F21A}\u{1F22F}\u{1F232}-\u{1F236}\u{1F238}-\u{1F23A}\u{1F250}\u{1F251}\u{1F300}-\u{1F320}\u{1F32D}-\u{1F335}\u{1F337}-\u{1F37C}\u{1F37E}-\u{1F393}\u{1F3A0}-\u{1F3CA}\u{1F3CF}-\u{1F3D3}\u{1F3E0}-\u{1F3F0}\u{1F3F4}\u{1F3F8}-\u{1F43E}\u{1F440}\u{1F442}-\u{1F4FC}\u{1F4FF}-\u{1F53D}\u{1F54B}-\u{1F54E}\u{1F550}-\u{1F567}\u{1F57A}\u{1F595}\u{1F596}\u{1F5A4}\u{1F5FB}-\u{1F64F}\u{1F680}-\u{1F6C5}\u{1F6CC}\u{1F6D0}-\u{1F6D2}\u{1F6EB}\u{1F6EC}\u{1F6F4}-\u{1F6F9}\u{1F910}-\u{1F93A}\u{1F93C}-\u{1F93E}\u{1F940}-\u{1F945}\u{1F947}-\u{1F970}\u{1F973}-\u{1F976}\u{1F97A}\u{1F97C}-\u{1F9A2}\u{1F9B0}-\u{1F9B9}\u{1F9C0}-\u{1F9C2}\u{1F9D0}-\u{1F9FF}]|[\xA9\xAE\u{203C}\u{2049}\u{2122}\u{2139}\u{2194}-\u{2199}\u{21A9}\u{21AA}\u{231A}\u{231B}\u{2328}\u{23CF}\u{23E9}-\u{23F3}\u{23F8}-\u{23FA}\u{24C2}\u{25AA}\u{25AB}\u{25B6}\u{25C0}\u{25FB}-\u{25FE}\u{2600}-\u{2604}\u{260E}\u{2611}\u{2614}\u{2615}\u{2618}\u{261D}\u{2620}\u{2622}\u{2623}\u{2626}\u{262A}\u{262E}\u{262F}\u{2638}-\u{263A}\u{2648}-\u{2653}\u{265F}\u{2660}\u{2663}\u{2665}\u{2666}\u{2668}\u{267B}\u{267E}\u{267F}\u{2692}-\u{2697}\u{2699}\u{269B}\u{269C}\u{26A0}\u{26A1}\u{26AA}\u{26AB}\u{26B0}\u{26B1}\u{26BD}\u{26BE}\u{26C4}\u{26C5}\u{26C8}\u{26CE}\u{26CF}\u{26D1}\u{26D3}\u{26D4}\u{26E9}\u{26EA}\u{26F0}-\u{26F5}\u{26F7}-\u{26FA}\u{26FD}\u{2702}\u{2705}\u{2708}-\u{270D}\u{270F}\u{2712}\u{2714}\u{2716}\u{271D}\u{2721}\u{2728}\u{2733}\u{2734}\u{2744}\u{2747}\u{274C}\u{274E}\u{2753}-\u{2755}\u{2757}\u{2763}\u{2764}\u{2795}-\u{2797}\u{27A1}\u{27B0}\u{27BF}\u{2934}\u{2935}\u{2B05}-\u{2B07}\u{2B1B}\u{2B1C}\u{2B50}\u{2B55}\u{3030}\u{303D}\u{3297}\u{3299}\u{1F004}\u{1F0CF}\u{1F170}\u{1F171}\u{1F17E}\u{1F17F}\u{1F18E}\u{1F191}-\u{1F19A}\u{1F1E6}-\u{1F1FF}\u{1F201}\u{1F202}\u{1F21A}\u{1F22F}\u{1F232}-\u{1F23A}\u{1F250}\u{1F251}\u{1F300}-\u{1F321}\u{1F324}-\u{1F393}\u{1F396}\u{1F397}\u{1F399}-\u{1F39B}\u{1F39E}-\u{1F3F0}\u{1F3F3}-\u{1F3F5}\u{1F3F7}-\u{1F4FD}\u{1F4FF}-\u{1F53D}\u{1F549}-\u{1F54E}\u{1F550}-\u{1F567}\u{1F56F}\u{1F570}\u{1F573}-\u{1F57A}\u{1F587}\u{1F58A}-\u{1F58D}\u{1F590}\u{1F595}\u{1F596}\u{1F5A4}\u{1F5A5}\u{1F5A8}\u{1F5B1}\u{1F5B2}\u{1F5BC}\u{1F5C2}-\u{1F5C4}\u{1F5D1}-\u{1F5D3}\u{1F5DC}-\u{1F5DE}\u{1F5E1}\u{1F5E3}\u{1F5E8}\u{1F5EF}\u{1F5F3}\u{1F5FA}-\u{1F64F}\u{1F680}-\u{1F6C5}\u{1F6CB}-\u{1F6D2}\u{1F6E0}-\u{1F6E5}\u{1F6E9}\u{1F6EB}\u{1F6EC}\u{1F6F0}\u{1F6F3}-\u{1F6F9}\u{1F910}-\u{1F93A}\u{1F93C}-\u{1F93E}\u{1F940}-\u{1F945}\u{1F947}-\u{1F970}\u{1F973}-\u{1F976}\u{1F97A}\u{1F97C}-\u{1F9A2}\u{1F9B0}-\u{1F9B9}\u{1F9C0}-\u{1F9C2}\u{1F9D0}-\u{1F9FF}]\u{FE0F}?|[\u{261D}\u{26F9}\u{270A}-\u{270D}\u{1F385}\u{1F3C2}-\u{1F3C4}\u{1F3C7}\u{1F3CA}-\u{1F3CC}\u{1F442}\u{1F443}\u{1F446}-\u{1F450}\u{1F466}-\u{1F469}\u{1F46E}\u{1F470}-\u{1F478}\u{1F47C}\u{1F481}-\u{1F483}\u{1F485}-\u{1F487}\u{1F4AA}\u{1F574}\u{1F575}\u{1F57A}\u{1F590}\u{1F595}\u{1F596}\u{1F645}-\u{1F647}\u{1F64B}-\u{1F64F}\u{1F6A3}\u{1F6B4}-\u{1F6B6}\u{1F6C0}\u{1F6CC}\u{1F918}-\u{1F91C}\u{1F91E}\u{1F91F}\u{1F926}\u{1F930}-\u{1F939}\u{1F93D}\u{1F93E}\u{1F9B5}\u{1F9B6}\u{1F9B8}\u{1F9B9}\u{1F9D1}-\u{1F9DD}]/gu,s=/\uFE0F?\uD83C[\uDFFB-\uDFFF]/,a={e29da4:/(\s|^)([0OО]:\))([\s\.,]|$)/g,f09f9887:/(\s|^)(;-\)+)([\s\.,]|$)/g,f09f9889:/(\s|^)([XХxх]-?D)([\s\.,]|$)/g,f09f9886:/(\s|^)(B-\))([\s\.,]|$)/g,f09f988e:/(\s|^)(3-\))([\s\.,]|$)/g,f09f988c:/(\s|^)(&gt;\()([\s\.,]|$)/g,f09f98a0:/(\s|^)(;[oоOО])([\s\.,]|$)/g,f09f98b0:/(\s|^)(8\|)([\s\.,]|$)/g,f09f98b3:/(\s|^)(8-?[oоOО])([\s\.,]|$)/g,f09f98b2:/(\s|^)(8-\))([\s\.,]|$)/g,f09f988d:/(\s|^)(:[XХ])([\s\.,]|$)/g,f09f98b7:/(\s|^)(:[oоOО])([\s\.,]|$)/g,f09f98a8:/(\s|^)(&lt;3)([\s\.,]|$)/g},n={f09f988a:/(:-\))([\s\.,]|$)/g,f09f9883:/(:-D)([\s\.,]|$)/g,f09f989c:/(;-[PР])([\s\.,]|$)/g,f09f988b:/(:-[pр])([\s\.,]|$)/g,f09f9892:/(:-\()([\s\.,]|$)/g,e298ba:/(:-?\])([\s\.,]|$)/g,f09f988f:/(;-\])([\s\.,]|$)/g,f09f9894:/(3-?\()([\s\.,]|$)/g,f09f98a2:/(:&#039;\()([\s\.,]|$)/g,f09f98ad:/(:_\()([\s\.,]|$)/g,f09f98a9:/(:\(\()([\s\.,]|$)/g,f09f9890:/(:\|)([\s\.,]|$)/g,f09f98a1:/(&gt;\(\()([\s\.,]|$)/g,f09f989a:/(:-\*)([\s\.,]|$)/g,f09f9888:/(\}:\))([\s\.,]|$)/g,f09f918d:/(:like:)([\s\.,]|$)/g,f09f918e:/(:dislike:)([\s\.,]|$)/g,e2989d:/(:up:)([\s\.,]|$)/g,e29c8c:/(:v:)([\s\.,]|$)/g,f09f918c:/(:ok:|:ок:)([\s\.,]|$)/g},r={e29da4:[0,"<3"],f09f988a:[1,":-)"],f09f9883:[2,":-D"],f09f9889:[3,";-)"],f09f9886:[4,"xD"],f09f989c:[5,";-P"],f09f988b:[6,":-p"],f09f988d:[7,"8-)"],f09f988e:[8,"B-)"],f09f9892:[9,":-("],f09f988f:[10,";-]"],f09f9894:[11,"3("],f09f98a2:[12,":'("],f09f98ad:[13,":_("],f09f98a9:[14,":(("],f09f98a8:[15,":o"],f09f9890:[16,":|"],f09f988c:[17,"3-)"],f09f98a0:[18,">("],f09f98a1:[19,">(("],f09f9887:[20,"O:)"],f09f98b0:[21,";o"],f09f98b3:[22,"8|"],f09f98b2:[23,"8o"],f09f98b7:[24,":X"],f09f989a:[25,":-*"],f09f9888:[26,"}:)"],f09f918d:[27,":like:"],f09f918e:[28,":dislike:"],e2989d:[29,":up:"],e29c8c:[30,":v:"],f09f918c:[31,":ok:"]}},503803:(e,t,o)=>{"use strict";o.d(t,{emojiReplace:()=>u,emojiToHTML:()=>r,getEmojiHTML:()=>_});var i=o(714209),s=o(628411),a=o(857243),n=o(8520);function r(e,t){if(i.browser.ipad||i.browser.iphone)return e;e=(e+"").replace(/&nbsp;/g," ").replace(/<br>/g,"\n");for(let t=0;t<2;t++)Object.keys(s.EMOJI_PREFIXED_REPLACES).forEach((t=>{e.replace(s.EMOJI_PREFIXED_REPLACES[t],((e,o,i,s)=>(o||"")+_(t)+(s||"")))}));return Object.keys(s.EMOJI_REPLACES).forEach((t=>{e=e.replace(s.EMOJI_REPLACES[t],((e,o,i)=>_(t)+(i||"")))})),e=e.replace(/\n/g,"<br>"),t&&(e=e.replace(/\uFE0F/g,"").replace((0,s.emojiRegex)(),u)),e}function _(e,t,o,s){if(!o&&t)return t;if(s){return`<i class="emoji @${e}" emoji="${e}"${t?` title="${t}"`:""}></i>`}return`<img class="emoji" src="/emoji/e/${e}${window.devicePixelRatio>=2?"_2x":""}.png"${t?` alt="${t}"`:""}${i.browser.msie&&Number(i.browser.version)>8?' contenteditable="false"':""}>`}function u(e){return _((0,a.emojiSymbolToByteHex)(e),(0,n.encodeHTMLEntities)((0,n.escape)(e)),!0)}},857243:(e,t,o)=>{"use strict";o.d(t,{emojiByteHexToSymbol:()=>a,emojiRemoveSkinToneModifiers:()=>n,emojiSymbolToByteHex:()=>s});var i=o(628411);function s(e){return encodeURIComponent(e.replace(/\uFE0F/giu,"")).replace(/%/gi,"").toLowerCase()}function a(e){const t=e.length%2==1,o=t?e.slice(0,1):"",i=t?e.slice(1):e;let s="";try{s=decodeURIComponent("%"+(a=i,a.split("").reduce(((e,t,o)=>e+t+((o+1)%2==0?" ":"")),"").trim().split(/\s+/)).join("%"))}catch(e){}var a;return o+s}function n(e){return e.replace((0,i.emojiRegex)(),r)}function r(e){return e.replace(i.skinToneModifierRegex,"")}},201193:(e,t,o)=>{"use strict";o.d(t,{MASS_MENTION_ALIASES:()=>s,MASS_MENTION_REGEXP:()=>a,PINNED_CONVERSATION_BIT_MASK:()=>i,VK_OFFICIAL_PEER_ID:()=>n});const i=112,s={all:["all","everyone","все"],online:["online","here","здесь","тут"]},a=new RegExp(['(?!,|;|:|\\.|\\s|<br ?/?>|"|\\(|\\)|\\[|\\]|!|\\?)',"(",[].concat(s.all).concat(s.online).map((e=>`@${e}|\\*${e}`)).join("|"),")",'(?=$|,|;|:|\\.(?![a-z0-9_-])|\\s|<br ?/?>|"|\\(|\\)|\\[|\\]|!|\\?)'].join(""),"gi"),n=-22822305},408063:(e,t,o)=>{"use strict";o.d(t,{wrapAway:()=>n,wrapAwayIfExternal:()=>a});var i=o(705744);const s=new RegExp(`^(https?:\\/\\/)?([a-z0-9_\\-.]+\\.)?${i.VK_SITE_REGEX_SOURCE_UNSAFE}(\\/.*)?`);function a(e,t=!1){return function(e){const t=decodeURIComponent(e);return/^\/[^/]/.test(t)||s.test(t)}(e)?e:n(e,t)}function n(e,t){return"/away.php?to="+encodeURIComponent(decodeURIComponent(e))+(t?"&utf=1":"")}},530960:(e,t,o)=>{"use strict";o.d(t,{decodeHTMLEntitiesDEPRECATED:()=>a,prepareToWriting:()=>n});var i=o(8520),s=o(503803);function a(e){return(0,i.decodeHTMLEntities)(e)}function n(e){let t=(0,i.decodeHTMLEntities)(e);return t=t.replace(/\n\r/gi,"\n"),t=(0,i.escape)(t),t=(0,s.emojiToHTML)(t,!0),t}},753677:(e,t,o)=>{"use strict";function i(e){const t="string"==typeof e?e.match(/^(?:(\d+)h)?(?:(\d+)m)?(?:(\d+)s)?$/):null;return t?(3600*t[1]||0)+(60*t[2]||0)+(+t[3]||0):0}function s(e){let t="";return e>=3600&&(t+=Math.floor(e/3600)+"h",e%=3600),e>=60&&(t+=Math.floor(e/60)+"m",e%=60),e>0&&(t+=Math.floor(e)+"s"),t}o.d(t,{fromString:()=>i,toString:()=>s})},269315:(e,t,o)=>{"use strict";o.d(t,{DEFAULT_MEDIA_SESSION:()=>n,HAS_MEDIA_SESSION:()=>a,clear:()=>r,updateMediaSessionMetadata:()=>_});var i=o(109465);let s;const a=window&&window.navigator&&"mediaSession"in window.navigator&&"MediaMetadata"in window,n=a?navigator.mediaSession:null;async function r(){if(a){s=s||document.createElement("audio"),s.src=i.SILENCE;try{await s.play()}catch(e){}}}function _(e,t=n){if(!t||!a)return;(location.hostname+e.album).length>30&&(e.album=e.album.substring(0,30-location.hostname.length)+"…");const o=t.metadata;o?(o.title=e.title,o.artist=e.artist,o.album=e.album,o.artwork=e.artwork):t.metadata=new MediaMetadata(e)}},459841:(e,t,o)=>{"use strict";o.d(t,{default:()=>c});var i=o(879007),s=o(688701),a=o(452314),n=o(317412);const r="idle",_="pend_rows",u="pend_prefetch",d="done_prefetch",l="done";class c{getListEl(){return this._containerEl}setListEl(e,t){let o;this._containerEl=(0,a.ge)(e),this._scrollNode=t||c.closestOverflowParent(this._containerEl),o=this._scrollNode===window?0:(0,a.getXY)(this._scrollNode)[1],this._contentYOffset=(0,a.getXY)(this._containerEl)[1]-o}options(e){(0,i.extend)(this._opts,e)}_countRows(e){const t=this;let o=0;return(0,i.each)(e,(function(e,s){"string"==typeof s&&(s=(0,a.se)(s)),t._rowClasses?(0,i.each)(t._rowClasses,(function(e,t){if((0,a.hasClass)(s,t))return o++,!1})):o++})),o}_drawRows(e){const t=this;this._opts.drawRows?this._opts.drawRows(t._containerEl,e):(0,i.each)(e,(function(e,o){"string"==typeof o&&(o=(0,a.se)((0,i.trim)(o))),o&&t._containerEl.appendChild(o)})),this.toggleProgress(this._state!==l),!this._forceDrawCalled&&this._opts.onRendered&&this._opts.onRendered(this._offset)}toggleProgress(e){e?!this._isProgressShown&&this._opts.showProgress&&this._opts.showProgress():this._isProgressShown&&this._opts.hideProgress&&this._opts.hideProgress(),this._isProgressShown=e}drawMore(){(0,i.inArray)(this._state,[r,d])?(this._forceDrawCalled=!0,this._drawRows(this._prefetched),this._setState(u),this._prefetched=[],this._requestRows(),this._forceDrawCalled=!1):this._state===l&&this._opts.onNoMore&&this._opts.onNoMore(this._containerEl.childElementCount)}destroy(){this._ev_scroll&&((0,n.removeEvent)(this._scrollNode,"scroll",this._ev_scroll),this._ev_scroll=!1),this._ev_window_resize&&(0,n.removeEvent)(window,"resize",this._ev_window_resize),this._setState(l),this.toggleProgress(!1)}getOffset(){return this._offset}_requestRows(){if(!this.isDone()&&this._state!==d){function e(){this._opts.onNeedRows(this._onRowsProvided.bind(this),this._offset,this._page++,this._state===u,this)}this._initialRender=!1,e.apply(this)}}_onRowsProvided(e,t){if(this.isDone())return;if(!1===e)return this._requestRows();e=e||[];let o=!1;this._needUseExternalOffset?(this._offset=t??0,o=Boolean(t)):(this._offset+=void 0===t?this._countRows(e):t,o=Boolean(e.length));const i=this._containerEl.childElementCount;switch(this._state){case u:0!==e.length&&(this._prefetched=this._prefetched.concat(e)),o?(this._setState(r),this._opts.onHasMore&&this._opts.onHasMore()):(this._setState(d),this._opts.onNoMore&&this._opts.onNoMore(i),0===this._prefetched.length&&this._setState(l)),(o||0!==this._prefetched.length)&&this._onScroll();break;case _:this._drawRows(e),o?(this._setState(u),this._requestRows()):(this._setState(l),this._opts.onNoMore&&this._opts.onNoMore(i)),this.toggleProgress(!1);break;case r:this._prefetched=this._prefetched.concat(e)}}_setState(e){this._state=e}isDone(){return this._state===l}static closestOverflowParent(e){let t,o=e;for(;o&&o.tagName&&(t=(0,a.getStyle)(o,"overflow"),"visible"===t||"page_wrap"===o.id);)o=(0,a.domPN)(o);return o!==window.document&&o!==document.body&&o||(o=window),o}_onScroll(){if(this._forceDrawCalled)return;if(this._state===_)return;const e=this._scrollNode;let t,o,i;e===window?(i=Math.max(document.documentElement.clientHeight,window.innerHeight||0),t=(0,s.scrollGetY)()):(i=(0,a.getSize)(e)[1],t=this._scroll?this._scroll.data.scrollTop:e.scrollTop),i<10||(o=this._containerEl.scrollHeight,o-i-t+this._contentYOffset<10&&(this._state===_||!this._prefetched.length&&this._state===u?(this.toggleProgress(!0),this._setState(_)):this._state===u||this._state===r?(this._drawRows(this._prefetched),this._prefetched=[],this._setState(u),this._requestRows()):this._state===d&&(this._drawRows(this._prefetched),this._prefetched=[],this._setState(l),this._opts.onNoMore&&this._opts.onNoMore(),this.destroy())))}constructor(e,t){if(this.constructor!==c)throw new Error("AutoList: AutoList was called without 'new' operator");if(c._counter=c._counter||0,this._id=c._counter++,this.setListEl(e,t.scrollNode),this._opts=(0,i.extend)({threshold:0,renderImmediate:!1,fetchImmediate:!0},t),!this._containerEl)throw new Error("AutoList: container not found");this._rowClasses=!!this._opts.rowClass&&this._opts.rowClass.split(" "),delete this._opts.rowClass,this._initialRender=this._opts.renderImmediate,this._needUseExternalOffset=this._opts.needUseExternalOffset??!1,this._isProgressShown=!1,this._prefetched=[],this._needUseExternalOffset?this._offset=this._opts.offset??0:this._initialRender?this._offset=0:this._opts.offset?this._offset=this._opts.offset:this._opts.rowClasses?this._offset=this._countRows(this._containerEl.children):this._offset=this._containerEl.children.length,this._page=this._offset>0?1:0,(0,n.addEvent)(this._scrollNode,"scroll",this._ev_scroll=this._onScroll.bind(this)),(0,n.addEvent)(window,"resize",this._ev_window_resize=this._onScroll.bind(this)),this._setState(this._opts.renderImmediate?_:u),this._opts.fetchImmediate?this._requestRows():(this._setState(r),this._onScroll())}}},966823:(e,t,o)=>{"use strict";o.d(t,{initSw:()=>n,onSwReady:()=>s});const i=(0,o(942451).makeSharedState)("sw-loading-state",(()=>({isReady:!1,onReadyCallbacks:[]})),{version:1}),s=e=>{i().isReady?e():i().onReadyCallbacks.push(e)},a=()=>{i().isReady=!0;for(let e of i().onReadyCallbacks)e();i().onReadyCallbacks=[]};async function n(){if(!window.vk.disableSW)try{const[{SWClient:e},{default:t}]=await Promise.all([o.e(8716).then(o.bind(o,742942)),o.e(41837).then(o.bind(o,142074))]);window.sw=new e,await window.sw.register(),window.pushNotifier=new t(window.sw,e),window.sw.storePushHash(),a()}catch(e){console.log(e)}}},368759:(e,t,o)=>{"use strict";o.d(t,{PIN_HIDDEN_ID_OP:()=>_,RECENT_SEARCH_OP:()=>r,imDbGet:()=>d,mount:()=>p});var i=o(248782),s=o(7144),a=o(490712),n=o(879007);const r="recent_search",_="pin_hide";function u(e){return"im_store_"+e}function d(e){return ls.get(u(e))||{}}function l(e,t,o){if(ls.checkVersion()){const i=JSON.stringify(t);(0,s.rand)(0,1e5)<=1&&(0,a.statlogsValueEvent)("im_local_store_size",i.length),o(u(e),i)}}function c(e,t,o){o.key===u(e)&&(t.db=JSON.parse(o.newValue),t.checkTime=Date.now())}function p(e){const t=(0,i.debounce)(((e,t)=>{localStorage.setItem(e,t)}),300);ls.checkVersion()&&function(e,t){const o=["fwd","draft","bind_attach"],i=d(e);let s=!1;for(let e=o.length;e--;)o[e]in i&&(delete i[o[e]],s=!0);s&&l(e,i,t)}(e,t);const o={db:d(e),checkTime:Date.now()},s=c.bind(null,e,o);return window.addEventListener("storage",s,!1),{select:(t,i)=>(Date.now()-o.checkTime>1e3&&(o.db=d(e)),function(e,t,o){return t===r?e[t]||[]:t===_?e[t]&&e[t][o]:e[t]?(0,n.extend)(!0,{},e[t][o]):null}(o.db,t,i)),selectByKey:t=>(Date.now()-o.checkTime>1e3&&(o.db=d(e)),o.db[t]),update(i,s){const a=function(e,t,o){switch(e[t]||(e[t]={}),t){case r:const i=o;i&&i.length>0?e[t]=i:delete e[t];break;case _:const[s,a]=o;a?e[t][s]=+a:delete e[t][s]}return e}(o.db,i,s);return o.db=a,o.checkTime=Date.now(),l(e,a,t)},updateByKey:(i,s)=>(o.db[i]=s,o.checkTime=Date.now(),l(e,o.db,t)),unmount(){window.removeEventListener("storage",s,!1)}}}},984709:(e,t,o)=>{"use strict";o.d(t,{Gifts:()=>h});var i=o(248298),s=o(610989),a=o(20025),n=o(317412),r=o(879007),_=o(850101),u=o(452314),d=o(14563),l=o(953550),c=o(626490),p=o(460241),m=o(857031);const h={deleteGift:function(e,t,o,i={}){window.ajax.post("al_gifts.php",{act:"delete",mid:i.mid,gift:o,hash:i.hash},{onDone:function(e){const o=(0,u.ge)("gift"+t);o&&((0,u.domNS)((0,u.domFC)(o))?(0,u.domNS)((0,u.domFC)(o)).innerHTML=e:(o.appendChild((0,u.ce)("div",{className:"gift_deleted",innerHTML:e})),(0,u.hide)((0,u.domFC)(o)),window.Pagination&&!(0,_.curBox)()&&window.Pagination.recache(-1)),(0,m.isVKCOMProfileRedesignedEnabled)()&&"profile"===window.cur.module&&window.Profile?.updateGiftBlock())},showProgress:()=>{e.classList.add("gift_delete--loading"),e.innerHTML="",e.appendChild((0,u.ce)("div",{className:"gift_delete__spinner",innerHTML:(0,c.getIcon16Spinner)().icon}))},hideProgress:()=>{e.classList.remove("gift_delete--loading"),e.innerHTML=(0,p.getIcon16Cancel)().icon}})},restoreGift:function(e,t,o,i){i=i||{},ajax.post("al_gifts.php",{act:"restore",mid:i.mid,gift:o,hash:i.hash},{onDone:function(){const e=(0,u.ge)("gift"+t);e&&(0,u.domNS)((0,u.domFC)(e))&&((0,u.re)((0,u.domNS)((0,u.domFC)(e))),(0,u.show)((0,u.domFC)(e)),(0,m.isVKCOMProfileRedesignedEnabled)()&&"profile"===window.cur.module&&window.Profile?.updateGiftBlock())}})},markSpamGift:function(e,t,o,i){i=i||{},ajax.post("al_gifts.php",{act:"mark_spam",mid:i.mid,gift:o,hash:i.hash},{onDone:function(e){(0,u.ge)("gift_mark_spam"+t).innerHTML=e}})},initGiftsBox:function(e,t){e.setOptions({width:638,bodyStyle:"padding: 0",grey:!0,hideButtons:!0,onShow:function(){cur.gftbxWasScroll&&(boxLayerWrap.scrollTop=cur.gftbxWasScroll,cur.gftbxWasScroll=!1)}}),t.lang&&(cur.lang=(0,r.extend)(cur.lang||{},t.lang)),(0,r.extend)(cur,{gftbxOffset:t.offset,gftbxAutoload:!0,gftbxWasScroll:!1,gftbxMid:t.mid}),ajax.preload("al_gifts.php",{act:"box",mid:t.mid,offset:t.offset},t.preload),window.uiScrollBox&&window.uiScrollBox.init(e,{onShow:function(){(0,n.addEvent)(boxLayerWrap,"scroll",h.onGiftsScroll),setTimeout(cur.chooseAudioScroll,0)},onHide:function(){(0,n.removeEvent)(boxLayerWrap,"scroll",h.onGiftsScroll)}}),(0,n.addEvent)(boxLayerWrap,"scroll",h.onGiftsScroll);const o=boxLayerWrap.scrollTop;(0,u.elfocus)((0,u.geByClass1)("_scroll_node",e.bodyNode)),boxLayerWrap.scrollTop=o,onBodyResize(),h.onGiftsScroll()},moreGifts:function(){const e=(0,u.ge)("gifts_more_link");(0,i.buttonLocked)(e)||(ajax.post("al_gifts.php",{act:"box",mid:cur.gftbxMid,offset:cur.gftbxOffset},{onDone:function(t,o,i){const s=(0,u.ce)("div",{innerHTML:t}),a=(0,u.ge)("gifts_rows");if(a){for(let e=(0,u.domFC)(s);e;e=(0,u.domFC)(s))a.appendChild(e);cur.gftbxOffset=o,i?h.preloadGifts():(0,u.hide)(e)}},showProgress:i.lockButton.pbind(e),hideProgress:i.unlockButton.pbind(e),cache:1}),cur.gftbxAutoload=!0)},preloadGifts:function(){ajax.post("al_gifts.php",{act:"box",mid:cur.gftbxMid,offset:cur.gftbxOffset},{cache:1})},onGiftsScroll:function(){if(!cur.gftbxAutoload)return;const e=lastWindowHeight,t=(0,u.ge)("gifts_more_link");(0,u.isVisible)(t)&&e>(0,u.getXY)(t,!0)[1]&&t.click()},showGiftBox:function(e,t,o){return window.Profile?window.Profile.showGiftBox(e,t,o):(cur.gftbxWasScroll=boxLayerWrap.scrollTop,boxLayerWrap.scrollTop=0,cur.viewAsBox?cur.viewAsBox():!(0,a.showBox)("al_gifts.php",{act:"get_gift_box",mid:e,fr:e==vk.id?1:0,ref:o},{stat:["gifts.css",window.jsc("web/wide_dd.js"),"wide_dd.css"],cache:1},t))},processBoxOptions(e,t){-1e3!=t&&t&&(requestAnimationFrame((()=>{(0,_.hideBoxLoader)()})),(0,r.extend)(cur,{paymentsOfferPreview:t.paymentsOfferPreview,paymentsPreload:t.paymentsPreload,paymentsAppOrder:t.paymentsAppOrder,paymentsOfferPreload:t.paymentsOfferPreload}),t.orderData&&l.AppOrderBox.initialize(t.orderData.orderId,t.orderData.appId,t.orderData.testMode,t.orderData.hash,t.orderData.votes,t.orderData.discount,t.orderData.billPeriod),(0,r.extend)(cur,{paymentsAuthPayment:t.paymentsAuthPayment,paymentsOrderNotice:t.paymentsOrderNotice,paymentsTryCompleteOrder:t.paymentsTryCompleteOrder,isPaymentsAppOrder:t.isPaymentsAppOrder,paymentsOfferApp:t.paymentsOfferApp,checkoutEnabled:t.checkoutEnabled}),t.showProgress&&d.PaymentsBox.showProgress(""),(0,r.extend)(cur,{votesAmountsData:t.votesAmountsData,paymentsPreferVotes:t.paymentsPreferVotes,votesTypeInit:t.votesTypeInit,psList:t.psList,paymentsWideBox:t.paymentsWideBox,paymentsTooltips:t.paymentsTooltips,paymentsChangeType:0===t.paymentsWideBox?s.getLang("payments_go_change_pay_type"):"",payments_get_votes:s.getLang("payments_get_votes_new"),getVotesDoneHide:!0,paymentsWaitingCache:{},isPaymentComplete:!1,isPaymentAttemted:!1,usdRate:t.usdRate,paymentsHash:t.paymentsHash,paymentComplete:d.PaymentsBox.complete,paymentCanceled:d.PaymentsBox.paymentCanceled,paymentsShowProgress:d.PaymentsBox.showProgress,statSessionId:t.statSessionId}),d.PaymentsBox.initialize(e),cur.checkoutEnabled||(d.PaymentsBox.initPhoneCountry(t.countries,t.country),d.PaymentsBox.initPhoneNumber((0,u.ge)("phone"))),(0,r.extend)(cur,{paymentsTypesSum:t.paymentsTypesSum,instantNeedCVV:t.instantNeedCVV,votesType:t.votesType,paymentsWPreload:t.paymentsWPreload,isMidas:t.isMidas,isHideButtonBackAndText:t.isHideButtonBackAndText}),t.getVotesAmountsOnDone&&d.PaymentsBox.getVotesAmountsOnDone.apply(this,cur.paymentsWPreload))},showGetMoneyBox(e=null){return(0,a.showBox)("al_gifts.php",{act:"get_money",...e},{onDone:this.processBoxOptions})}}},448904:(e,t,o)=>{"use strict";o.d(t,{clipboardProcessPaste:()=>l,copyToClipboard:()=>r._copyWithFakeElement,getFiles:()=>_});var i=o(590335),s=o(879007),a=o(317412),n=o(452314),r=o(106149);function _(e){let t=function(e){return e&&e.clipboardData?e.clipboardData:e&&e.originalEvent&&e.originalEvent.clipboardData?e.originalEvent.clipboardData:window.clipboardData}(e);if(!t)return[];let o=t.items;if(!o)return[];let i=[];for(let e=0;e<o.length;e++)0==o[e].type.indexOf("image")&&i.push(o[e].getAsFile());return i}let u=!1,d=null;function l(e){return new Promise(((t,o)=>{if(u)return(0,a.cancelEvent)(e),o();let[r,_,l,c,p]=(0,i.rangeGet)();if(r){if("paste"===e.type){let o=e.clipboardData||e.originalEvent&&e.originalEvent.clipboardData;if(o&&o.types&&o.getData){(0,a.cancelEvent)(e),u=!0;let n=o.getData("text/html")||(0,s.clean)(o.getData("text/plain"))||"";return t([n,e=>{(0,i.rangeInsert)(r,e),u=!1}])}let d=(0,n.cf)(),m=e.target||window.event.srcElement;for(;m.firstChild;)d.appendChild(m.firstChild);return new Promise((e=>setTimeout((()=>{let t=m.innerHTML||"";m.innerHTML="",m.appendChild(d),e([t,e=>{r=(0,i.rangeCreate)(_,l,c,p),(0,i.rangeInsert)(r,e),u=!1}])}),0)))}if("beforepaste"===e.type)return u=!0,function(){if(!d){let e=(0,n.ge)("utils");d=(0,n.ce)("div",{},{width:"10px",height:"10px",overflow:"hidden"}),(0,n.attr)(d,"contenteditable","true"),e.appendChild(d)}}(),d.focus(),void(d.onpaste=()=>{setTimeout((()=>{let e=d.innerHTML||"";d.innerHTML="",delete d.onpaste,t([e,e=>{r=(0,i.rangeCreate)(_,l,c,p),(0,i.rangeInsert)(r,e),u=!1}])}),0)})}return o()}))}},96526:(e,t,o)=>{"use strict";o.r(t),o.d(t,{ElementTooltip:()=>d,default:()=>l});var i=o(452314),s=o(879007),a=o(317412),n=o(688701),r=o(22307),_=o(857125),u=o(695290);class d{_initEvents(e){this._opts.autoShow&&(this._el_me_event=this._onMouseEnter.bind(this),(0,a.addEvent)(e,"mouseenter",this._el_me_event),this._opts.showOnKeyboard&&(this._el_kd_event=t=>{t.target!==e||t.keyCode!==a.KEY.ENTER&&t.keyCode!==a.KEY.SPACE||this.toggle()}),(0,a.addEvent)(e,"keydown",this._el_kd_event)),(this._opts.autoShow||this._opts.autoHide)&&(this._el_ml_event=this._onMouseLeave.bind(this),(0,a.addEvent)(e,"mouseleave",this._el_ml_event)),this._opts.autoShow||this._opts.customShow||(this._el_c_event=()=>{this._isShown&&this._opts.noHideOnClick||this.toggle(!this._isShown)},(0,a.addEvent)(e,"click",this._el_c_event))}_onMouseEnter(e){clearTimeout(this._hto),this._hto=!1,!this._isShown&&this._opts.autoShow&&(clearTimeout(this._reTimeout),this._reTimeout=!1,clearTimeout(this._sto),this._sto=setTimeout(this.show.bind(this),this._opts.delay))}_onMouseLeave(e){this._clearTimeouts(),this._hto=setTimeout(this._hide.bind(this),200)}_onMouseWindowClick(e){if(this._opts.noAutoHideOnWindowClick)return;let t=e.target;for(;t&&t!==this._ttel&&t!==document.body&&t!==this._el;)t=(0,i.domPN)(t);return(0,i.hasClass)(e.target,"_ap_layer__close")||t&&t!==document.body?void 0:(0,s.isFunction)(this._opts.onWindowClick)?(this._opts.onWindowClick(),(0,a.cancelEvent)(e)):(this.hide(!0),(0,a.cancelEvent)(e))}destroy(){let e;this._el_me_event&&(0,a.removeEvent)(this._el,"mouseenter",this._el_me_event),this._el_ml_event&&(0,a.removeEvent)(this._el,"mouseleave",this._el_ml_event),this._el_c_event&&(0,a.removeEvent)(this._el,"click",this._el_c_event),this._el_kd_event&&(0,a.removeEvent)(this._el,"keydown",this._el_kd_event),this._clearTimeouts(),(0,i.removeData)(this._el,"ett"),(0,i.re)(this._ttel),this._ev_wclick&&(0,a.removeEvent)(document,"mousedown",this._ev_wclick),this._ttel&&(e=(0,i.geByClass1)("_eltt_content",this._ttel)),this._opts.onDestroy&&this._opts.onDestroy(e)}hide(e,t){this._hide(e,t)}_onTooltipMouseEnter(e){this._clearTimeouts()}_onTooltipMouseLeave(e){this._onMouseLeave()}build(){if(!this._ttel){const e=this._opts.withCloseButton?"eltt_with_close_button":"";this._ttel=(0,i.se)(`\n        <div class="eltt ${this._opts.cls||""} ${e}" id="${this._opts.id}">\n          <div class="eltt_arrow_back _eltt_arrow_back">\n            <div class="eltt_arrow"></div>\n          </div>\n          <div class="eltt_content _eltt_content"></div>\n        </div>`),this._ttArrowEl=(0,i.geByClass1)("_eltt_arrow_back",this._ttel);const t=(0,i.geByClass1)("_eltt_content",this._ttel);if(this._opts.content&&((0,s.isString)(this._opts.content)?t.innerHTML=this._opts.content:t.appendChild(this._opts.content)),this._opts.withCloseButton){const e='\n          <div class="eltt_close_button"></div>\n        ';this._ttel.insertAdjacentHTML("beforeend",e),this._closeButton=this._ttel.lastElementChild;const t=e=>{e.stopPropagation(),this.hide(null,!0),this._opts.onCloseButtonClick&&this._opts.onCloseButtonClick()};this._closeButton.addEventListener("click",t),cur.destroy.push((()=>this._closeButton.removeEventListener("click",t)))}this._appendToEl&&this._appendToEl.appendChild(this._ttel),this._opts.onClick&&(this._ttel.addEventListener("click",this._opts.onClick),window.cur.destroy.push((()=>this._ttel.removeEventListener("click",this._opts.onClick))))}}show(){if(this._isShown)return void this.updatePosition();if(this._tooltipStats.handleShow(),this._opts.skipShow)return;if(this._clearTimeouts(),this._ttel||(this.build(),(this._opts.autoShow||this._opts.autoHide)&&(this._ev_ttenter=this._onTooltipMouseEnter.bind(this),this._ev_ttleave=this._onTooltipMouseLeave.bind(this),(0,a.addEvent)(this._ttel,"mouseenter",this._ev_ttenter),(0,a.addEvent)(this._ttel,"mouseleave",this._ev_ttleave))),this._opts.width){const e=(0,s.isFunction)(this._opts.width)?this._opts.width.call(this):this._opts.width;(0,i.setStyle)(this._ttel,"width",e)}(0,i.show)(this._ttel);const e=(0,i.geByClass1)("_eltt_content",this._ttel);this._opts.onFirstTimeShow&&!this._firstTimeShown&&this._opts.onFirstTimeShow.call(this,e,this._ttel),this._opts.onShow&&this._opts.onShow(e,!this._firstTimeShown),this._firstTimeShown=!0,this.updatePosition(),this._isShown=!0,this._el.setAttribute("aria-expanded","true"),this._visTO=setTimeout(i.addClass.pbind(this._ttel,"eltt_vis"),10),this._opts.elClassWhenShown&&(0,i.addClass)(this._el,this._opts.elClassWhenShown),this._ev_wclick&&(0,a.removeEvent)(document,"mousedown",this._ev_wclick),this._ev_wclick=this._onMouseWindowClick.bind(this),(0,a.addEvent)(document,"mousedown",this._ev_wclick)}static getType(e){switch(e){case"top":case"bottom":return d.TYPE_VERTICAL;case"right":case"left":return d.TYPE_HORIZONTAL}}getOptions(){return this._opts}updatePosition(){let e=this._opts.forceSide,t=!!this._opts.getTargetBoundingBox&&this._opts.getTargetBoundingBox(this);if(!t){const e=(0,i.getXY)(this._el),o=(0,i.getSize)(this._el);t={left:e[0],top:e[1],width:o[0],height:o[1]}}const o=this._opts.getWrapEl?this._opts.getWrapEl(this):(0,i.gpeByClass)("audio_layer_container",this._ttel),a=o||(0,i.domClosestOverflowHidden)(this._ttel),_=a!==document.body?(0,i.getXY)(a):[(0,n.scrollGetX)(),(0,n.scrollGetY)()+(0,r.getPageHeaderHeight)()],u=a!==document.body?(0,i.getSize)(a):[window.innerWidth,window.innerHeight],l=(0,i.getSize)(this._ttel),c=this._arrowSize,p=this._opts.noBorder?0:1,m=(0,s.isFunction)(this._opts.offset)?this._opts.offset():this._opts.offset;let h;const y=(e,o)=>{const s={},a=[vk.rtl?"marginRight":"marginLeft","marginTop"].indexOf(e);let n;n=this._opts.align===(vk.rtl?d.ALIGN_LEFT:d.ALIGN_RIGHT)?l[a]-Math.max(p+c+(o||0),Math.min(l[a],t[a?"height":"width"])/2):this._opts.align===(vk.rtl?d.ALIGN_RIGHT:d.ALIGN_LEFT)?Math.max(p+c+(o||0),Math.min(l[a],t[a?"height":"width"])/2):l[a]/2,s[e]=Math.floor(n)-p-c-(o||0),this._opts.onSetArrowPosition(s),(0,i.setStyle)(this._ttArrowEl,s)};if(this._opts.setPos)h=this._opts.setPos(this)||{},d.getType(e)===d.TYPE_VERTICAL?void 0!==h.arrowPosition?(0,i.setStyle)(this._ttArrowEl,{marginLeft:h.arrowPosition}):vk.rtl?y("marginRight"):y("marginLeft"):void 0!==h.arrowPosition?(0,i.setStyle)(this._ttArrowEl,{marginTop:h.arrowPosition}):y("marginTop");else{if(!e&&this._prevSide&&this._opts.preventSideChange)e=this._prevSide;else if(!e)if(this._opts.type===d.TYPE_VERTICAL){const o=document.body.classList.contains("body_im")?this._opts.bottomGap||60:this._opts.bottomGap||0,i=t.top-_[1]>l[1]+c-m[1],s=(0,n.scrollGetY)()+u[1]-(t.top+t.height+c)-o>l[1];e="top"===this._opts.defaultSide?i?"top":"bottom":s?"bottom":"top"}else e=t.left-_[0]<l[0]?"right":"left";let o,s,a,r,p,h,f=(0,i.getXY)(this._appendToEl),E=[t.left-f[0],t.top-f[1]],g=m[0]+E[0];this._opts.centerShift?(g+=this._opts.centerShift||0,o=this._opts.centerShift):this._opts.rightShift&&(o=-(l[0]/2-this._opts.rightShift),g+=o),this._prevSide=e;let v=20;const A=!this._opts.autoAdjustToViewport;switch(this._opts.align===(vk.rtl?d.ALIGN_LEFT:d.ALIGN_RIGHT)?(s=t.width-l[0],a=t.height-l[1]):this._opts.align===(vk.rtl?d.ALIGN_RIGHT:d.ALIGN_LEFT)?(s=0,a=0):(s=-l[0]/2+t.width/2,a=t.height/2-l[1]/2),e){case"bottom":p=s+g,h=t.height+c-m[1]+E[1],o||A||(r=s+t.left+m[0]+l[0]+v-(_[0]+u[0]),r<0&&(r=0),p-=r,o=-r),(0,i.setStyle)(this._ttel,{left:p,top:h});break;case"top":p=s+g,o||A||(r=s+t.left+m[0]+l[0]+v-(_[0]+u[0]),r<0&&(r=0),p-=r,o=-r),(0,i.setStyle)(this._ttel,{left:p}),h=-(0,i.getSize)(this._ttel)[1]-c+m[1]+E[1],(0,i.setStyle)(this._ttel,{top:h});break;case"right":p=t.width+c+g,h=a+m[1]+E[1],o||A||(r=a+t.top+m[1]-(_[1]+v),r>0&&(r=0),h-=r,o=-r),(0,i.setStyle)(this._ttel,{left:p,top:h});break;case"left":p=-l[0]-c+g,h=a+m[1]+E[1],o||A||(r=a+t.top+m[1]-(_[1]+v),r>0&&(r=0),h-=r,o=-r),(0,i.setStyle)(this._ttel,{left:p,top:h})}this._opts.type===d.TYPE_VERTICAL?vk.rtl?y("marginRight",o):y("marginLeft",o):y("marginTop",o)}(0,s.each)(["top","bottom","left","right"],function(t,o){e!==o&&(0,i.removeClass)(this._ttel,"eltt_"+o)}.bind(this)),(0,i.addClass)(this._ttel,"eltt_"+e),(0,i.setStyle)(this._ttel,h)}_hide(e,t){if(this.tempPreventHide)return;let o;if(e&&(o=u.ETooltipEventTypes.TOOLTIP_HIDE_BY_CLICK),t&&(o=u.ETooltipEventTypes.TOOLTIP_HIDE_BY_CROSS),this._tooltipStats.handleHide(o),this._isShown=!1,this._clearTimeouts(),this._reTimeout=setTimeout(function(){(0,i.hide)(this._ttel),this._el.setAttribute("aria-expanded","false"),this._opts.elClassWhenShown&&(0,i.removeClass)(this._el,this._opts.elClassWhenShown),this._opts.onHide&&this._opts.onHide(this._ttel,!!e,!!t)}.bind(this),d.FADE_SPEED),this._opts.onBeforeHide)try{this._opts.onBeforeHide(this._ttel,!!e,!!t)}catch(e){}(0,i.removeClass)(this._ttel,"eltt_vis"),this._ev_wclick&&(0,a.removeEvent)(document,"mousedown",this._ev_wclick)}isShown(){return this._isShown}toggle(){this.isShown()?this.hide():this.show()}_clearTimeouts(){this._visTO&&clearTimeout(this._visTO),this._visTO=!1,this._sto&&clearTimeout(this._sto),this._sto=!1,this._hto&&clearTimeout(this._hto),this._hto=!1,this._reTimeout&&clearTimeout(this._reTimeout),this._reTimeout=!1}getContent(){return(0,i.geByClass1)("_eltt_content",this._ttel)}constructor(e,t){if(this.constructor!==d)throw new Error("ElementTooltip was called without 'new' operator");if(!(e=(0,i.ge)(e))||!e.nodeType)throw new Error("First argument not a DOM element");if((0,i.data)(e,"ett"))return(0,i.data)(e,"ett");if(this._tooltipStats=new _.TooltipsStat(t.helpHintId||"unknown",t.skipShow||!1),this._opts=(0,s.extend)({delay:100,offset:[0,0],type:d.TYPE_VERTICAL,id:"",cls:"",width:null,appendToParent:!1,autoAdjustToViewport:!0,autoShow:!0,autoHide:!1,noHideOnClick:!1,arrowSize:"normal",customShow:!1,align:d.ALIGN_CENTER,withCloseButton:!1,skipShow:!1,onSetArrowPosition:()=>{}},t),this._opts.customShow&&(this._opts.autoShow=!1),this._opts.defaultSide||(this._opts.defaultSide=this._opts.type===d.TYPE_VERTICAL?"top":"left"),this._opts.cls+=" eltt_arrow_size_"+this._opts.arrowSize,this._opts.cls+=" eltt_align_"+this._opts.align,this._opts.noBorder&&(this._opts.cls+=" eltt_noborder"),this._opts.setPos&&!this._opts.forceSide)throw new Error("forceSide parameter should be set if you use setPos");if(this._appendToEl=this._opts.appendTo?this._opts.appendTo:this._opts.appendToParent?(0,i.domClosestPositioned)(e,{noOverflow:!0}):e,this._arrowSize={mini:d.ARROW_SIZE_MINI,normal:d.ARROW_SIZE_NORMAL,big:d.ARROW_SIZE_BIG}[this._opts.arrowSize],this._opts.forceSide){const e=d.getType(this._opts.forceSide);if(void 0===e)throw new Error("ElementTooltip: invalid 'forceSide' option provided: ",this._opts.forceSide);0,this._opts.type=e}this._opts.type===d.TYPE_HORIZONTAL&&void 0===t?.autoAdjustToViewport&&(this._opts.autoAdjustToViewport=!1),this._el=e,(0,i.data)(this._el,"ett",this),this._initEvents(e),this._clearTimeouts(),this._isShown=!1,this._el.setAttribute("aria-expanded","false")}}d.TYPE_VERTICAL=0,d.TYPE_HORIZONTAL=1,d.FADE_SPEED=100,d.ARROW_SIZE_MINI=9,d.ARROW_SIZE_NORMAL=8,d.ARROW_SIZE_BIG=16,d.ALIGN_LEFT="left",d.ALIGN_CENTER="center",d.ALIGN_RIGHT="right";const l=d},839094:(e,t,o)=>{"use strict";o.d(t,{initFavIcon:()=>a,setFavIcon:()=>s});var i=o(452314);function s(e,t){if(!window.icoNode)return;if(e=e+"?"+((stVersions||{}).favicon||""),icoNode.getAttribute("href")===e&&!t)return;const o=(0,i.ce)("link",{rel:"shortcut icon",type:"image/gif",href:e});headNode.replaceChild(o,icoNode),icoNode=o}function a(){window._iconAdd=window.devicePixelRatio>=2?"_2x":""}},594541:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{giftsBox:()=>giftsBox,imageStatusPopup:()=>imageStatusPopup,mobilePromo:()=>mobilePromo,moneyTransferBox:()=>_moneyTransferBox__WEBPACK_IMPORTED_MODULE_11__.moneyTransferBox,reportAd:()=>reportAd,showAudioClaimWarning:()=>showAudioClaimWarning,showPollBox:()=>showPollBox,showSettingsAddressBox:()=>showSettingsAddressBox,showWriteMessageBox:()=>showWriteMessageBox,sureDeleteAll:()=>sureDeleteAll});var _web_lib_message_box__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(20025),_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(671300),_web_lib_ui__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(248298),_web_lib_dom__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(452314),_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(317412),_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(645024),_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(618913),_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(850101),_shared_lib_web_stats__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(144770),_web_settings_addressBox__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(3677),_icons_desktop__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(221844),_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(258643),_moneyTransferBox__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(711877);function showSettingsAddressBox(){(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_0__.showBox)("al_settings.php",{act:"address_box"},{stat:[window.jsc("web/settings.js"),"settings.css"],params:{bodyStyle:"padding: 0;",hideButtons:!0},onDone(e,{hash:t}){(0,_web_settings_addressBox__WEBPACK_IMPORTED_MODULE_9__.initSettingsAddressBox)(e,t)}})}function showWriteMessageBox(e,t,o={}){cur.onFriendMessage&&cur.onFriendMessage(),window.stManager.add([window.jsc("web/page.js"),window.jsc("web/wide_dd.js")]);const i=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_0__.showBox)("al_im.php",{act:"a_write_box",to:t,...o.params},{stat:[window.jsc("web/writebox.js"),"writebox.css","wide_dd.css","page.css","post.css",window.jsc("web/emoji.js"),"notifier.css"],cache:1},e);return i&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.cancelEvent)(e),window.WriteBox&&WriteBox.extractEmoji(),!i}function giftsBox(e,t,o){return cur.viewAsBox?cur.viewAsBox():!(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_0__.showBox)("al_gifts.php",{act:"box",tab:o||"received",mid:e},{cache:1,stat:["gifts.css",window.jsc("web/gifts.js")]},t)}function reportAd(e,t){{let o="",i=null;const s=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_0__.showBox)("/reports.php",{act:"report_ad_box",ad_data:t},{onDone:function(){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_3__.geByClass)("radiobtn","ad_report");window.radioBtns.ad_report={val:0,els:e};const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_3__.ge)("ad_csrf");o=t?t.value:o,i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_3__.ge)("ad_comment")},params:{width:370,onClean:()=>{delete window.radioBtns.ad_report}},stat:["reports.css"]});s.removeButtons(),s.addButton(_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang("box_send"),(a=>{ajax.post("reports.php",{act:"a_report_ad",ad_id:e,reason:window.radioBtns.ad_report.val,comment:i?i.value:"",ad_data:t,hash:o},{onDone:()=>{s.hide(),(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_7__.showDoneBox)(_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang("reports_thanks_for_report"))},showProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_2__.lockButton)(a),hideProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_2__.unlockButton)(a)})})),s.addButton(_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang("global_cancel"),!1,"no")}}const mobilePromo=()=>(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_0__.showBox)("al_login.php",{act:"mobile",box:1});function showAudioClaimWarning(e,t,o){const{id:i,ownerId:s,title:a}=e,n=t.id,{reason:r,original:_}=t,u={width:470};let d,l;if(e.restrictionStatus)return _web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.showAudioRestriction(e);"geo"===r?(d=_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang("audio_claimed_geo"),l=_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang("audio_claim_warning_title")):"site_rules_violation"===r?(d=_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang("audio_site_rules_violation_warning"),l=_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang("audio_site_rules_violation_header")):"replace"===r?(d=_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang("audio_claimed_replacement_available"),l=_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang("audio_claim_warning_title")):"subscription"===r?(u.hideButtons=!0,u.bodyStyle="padding: 0; border-radius: 4px;",u.width=450,l=!1,d=`\n      <div class="audio_claim_popup">\n        <div class="audio_claim_popup__title">${_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang("global_audio_only_with_subscription_title")}</div>\n        <div class="audio_claim_popup__text">${_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang("global_audio_only_with_subscription_text")}</div>\n        <div class="audio_claim_popup__close" onclick="curBox().hide()">${(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_12__.getIcon24Cancel)().icon}</div>\n        ${_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_10__.FlatButton.render({appearance:_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_10__.FlatButtonAppearance.PRIMARY,size:_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_10__.FlatButtonSize.M,round:!0,restAttrs:{onclick:"AudioPlayer.showSubscriptionPopup()"},children:_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang("global_audio_only_with_subscription_btn")}).outerHTML}\n      </div>`):(d=_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang("audio_claim_warning"),l=_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang("audio_claim_warning_title")),u.title=l,d=d.replace(/\{audio\}/g,`<b>${a}</b>`),d=d.replace(/\{objection_link\}/g,`<a href="/help?act=cc_objection&claim=${n}&content=audio${s}_${i}">${_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang("audio_claim_objection")}</a>`),d=d.replace(/\{delete_link\}/g,`<a onclick="deleteAudioOnClaim(${s}, ${i}); return false;">${_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang("audio_claim_delete")}</a>`);const c=[u,d];let p=null;if(o&&_){const e=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.drawAudio(_,"no_extra");c[1]=d.replace(/\{original\}/g,_[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.AUDIO_ITEM_INDEX_PERFORMER]+" - "+_[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.AUDIO_ITEM_INDEX_TITLE])+"<br/><br/>"+e,c.push(_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang("audio_replace_with_original"),(function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_2__.lockButton)(p.btns.ok[0]),o((()=>p.hide()))})),u.textControls=`<a onclick="deleteAudioOnClaim(${s}, ${i}); return false;">${_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang("audio_claim_delete_capital")}</a>`}cur.claimWarning=p=_web_lib_message_box__WEBPACK_IMPORTED_MODULE_0__.showFastBox.apply(null,c)}function sureDeleteAll(title,text,where,objectId,toId,fromId,hash,event){if((0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.checkEvent)(event))return;const box=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_0__.showFastBox)({title},text,_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang("global_delete"),(function(btn){ajax.post("/delete_all.php",{act:where,object_id:objectId,to_id:toId,from_id:fromId,hash,loc:nav.objLoc[0]},{onDone:function(res){if(__debugMode)eval(res);else try{eval(res)}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_6__.logEvalError)(e,res)}box.hide()},showProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_2__.lockButton)(btn),hideProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_2__.unlockButton)(btn)})}),_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang("global_cancel"));return!1}function imageStatusPopup(e,t){Object.assign(t,{act:"image_status"});const o=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_0__.showBox)("special_event.php",t,{containerClass:"ImageStatusPopup__container",params:{hideButtons:!0,needShadow:!1},onFail:function(){return window.cur.imageStatusBox&&window.cur.imageStatusBox.hide(),!0},onDone:function(e,t){const{status_id:o}=t;o&&(0,_shared_lib_web_stats__WEBPACK_IMPORTED_MODULE_8__.saveStatlogEvents)({name:"image_status",value:o,keys:["show_popup"]})}},e);o&&((0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.cancelEvent)(e),window.cur.imageStatusBox=o)}function showPollBox(e,{ref:t,className:o}={}){(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_0__.showBox)("al_voting.php",{act:"get_layout",voting_id:e,for_box:!0,ref:t},{containerClass:o,params:{hideButtons:!0,width:510}})}},711877:(e,t,o)=>{"use strict";o.d(t,{moneyTransferBox:()=>d});var i=o(20025),s=o(879007),a=o(248298),n=o(452314),r=o(645024),_=o(850101),u=o(359136);function d(e,t,o,l,c,p,m){if(cur.viewAsBox)return cur.viewAsBox();if(c){if(!m){let s,a;return 2===c?(s=r.curLang("mail_money_transfer_cancel_confirm")||r.getLang("mail_money_transfer_cancel_confirm"),a=r.curLang("mail_money_transfer_cancel_btn")||r.getLang("mail_money_transfer_cancel_btn")):(s=r.curLang("mail_money_transfer_decline_confirm")||r.getLang("news_fb_money_transfer_decline_confirm"),a=r.curLang("mail_money_transfer_decline_btn")||r.getLang("news_fb_money_transfer_decline_btn")),void(cur.confirmBox=(0,i.showFastBox)(r.getLang("global_action_confirmation"),s,a,d.pbind(e,t,o,l,c,!1,1),r.getLang("global_cancel")))}const s=(0,n.hasClass)((0,n.domPN)(l),"wall_postlink_preview_btn")||(0,n.hasClass)(l,"money_transfer__decline_button"),u=(0,n.geByClass1)("flat_button",(0,n.domPN)(l)),p=()=>{s?((0,n.addClass)(l.firstChild,"round_spinner"),(0,n.removeClass)(l.firstChild,"button")):(0,a.lockButton)(l)},h=()=>{s?((0,n.addClass)(l.firstChild,"button"),(0,n.removeClass)(l.firstChild,"round_spinner")):(0,a.unlockButton)(l)};return 2!==m&&((0,a.disableButton)(u,!0),p(l),cur.confirmBox&&cur.confirmBox.hide()),void ajax.post("al_payments.php?act=a_cancel_money_transfer",{tx_id:e,hash:t,from:s?"snippet":""},{onDone:function(i,a,r){0!==i?(s?((0,n.re)(l),(0,n.hasClass)(u,"secondary")||(0,n.domReplaceEl)(u,r)):(0,n.re)((0,n.domPN)(l)),(0,_.showDoneBox)(a),window.TopNotifier.invalidate()):setTimeout((()=>d(e,t,o,l,c,!1,2)),2e3)},onFail:function(e){return(0,a.disableButton)(u,!1),h(l),setTimeout((0,i.showFastBox)(r.getLang("global_error"),e).hide,2e3),!0}})}return cur.acceptMoneyBtn=l,p?!u.MoneyTransfer.showMoneyTransferBox({request_id:e,request:p,hash:t},{stat:["payments.css",window.jsc("web/payments_legacy.js")]},(e=>((0,_.curBox)()&&(0,_.curBox)().hide(),setTimeout((0,i.showFastBox)(r.getLang("global_error"),e).hide,2e3),!0))):!(0,i.showBox)("al_payments.php",{act:"accept_money_transfer_box",tx_id:e,hash:t},{stat:["payments.css",window.jsc("web/payments_legacy.js")],onFail:e=>((0,_.curBox)()&&(0,_.curBox)().hide(),setTimeout((0,i.showFastBox)(r.getLang("global_error"),e).hide,2e3),!0),onDone(e,t){u.MoneyTransfer.initHandlers(),window.cur=(0,s.extend)(window.cur,{paymentsOptions:t,paymentsPopupWrite(e){e.document.innerHTML!=cur._popup_text&&(e.document.write(window.cur._popup_text),e.document.close(),e.blur(),e.focus(),window.cur._popup_callback&&window.cur._popup_callback())}}),e.setOptions({width:510,bodyStyle:"padding: 0;",hideButtons:!0,onClean(){window.cur.moneyTranferCheckInt&&clearInterval(window.cur.moneyTranferCheckInt),window.removeEventListener("message",u.MoneyTransfer.frameMessage,!1)}}),u.MoneyTransfer.initAccept(t.chkData,t.frame)}},o)}},927984:(e,t,o)=>{"use strict";o.r(t),o.d(t,{AudioMessagePlayer:()=>ie,articlePrepare:()=>I.articlePrepare,bookmark:()=>V,bookmarkArticle:()=>j,bookmarkEvent:()=>Z,bookmarkLink:()=>G,bookmarkNarrative:()=>Q,bookmarkPodcast:()=>q,bookmarkPost:()=>H,bookmarkYoulaProduct:()=>J,deleteAudioOnClaim:()=>te,getIconBookmarked:()=>Y,initTopAudioPlayer:()=>oe,initTopNotifier:()=>k,isArticleLayerOpen:()=>P.isArticleLayerOpen,isPhotoeditor3Available:()=>L,mentionClick:()=>se,openArticleEditor:()=>C.openArticleEditor,podcastStartFrom:()=>K,sendBookmarkLink:()=>$,sendImageStatusStat:()=>ae,setIconBookmarked:()=>z,setNewIconBookmarked:()=>X,shareAudioPlaylist:()=>ee,showAlbum:()=>M.showAlbum,showAlbums:()=>M.showAlbums,showApp:()=>U,showAttachNewProductBox:()=>F,showDonutSubscribePopup:()=>O.showDonutSubscribePopup,showManyPhoto:()=>B,showNftInfo:()=>N,showPhoto:()=>D.showPhoto,showPhotoTags:()=>S.showPhotoTags,showPodcast:()=>W,showVideoTags:()=>R,showWiki:()=>T.showWiki,videoCallback:()=>x});var i=o(736852),s=o(671300),a=o(7144),n=o(452314),r=o(879007),_=o(850101),u=o(317412),d=o(20025),l=o(714209),c=o(645024),p=o(387674),m=o(144770),h=o(714707),y=o(203882),f=o(563442),E=o(864883),g=o(28998),v=o(253589),A=o(710870),w=o(823617),b=o(727412),P=o(28589),T=o(900007),I=o(768772),O=o(344069),C=o(640775),M=o(436927),D=o(760207),S=o(349778);function k(){const e=[window.jsc("web/notifier.js"),"notifier.css"];return{preload:function(){window.stManager.add(e,(()=>window.TopNotifier.preload()))},show:function(t){if(!0!==(0,u.checkEvent)(t))return window.stManager.add(e,(()=>window.TopNotifier.show(t))),(0,u.cancelEvent)(t)},showTooltip:function(t){window.stManager.add(e,(()=>window.TopNotifier.showTooltip(t)))},invalidate:()=>{},setCount:()=>{},createNewEventsBox:()=>{}}}function L(){return!l.browser.msie||parseInt(l.browser.version)>10}function B(e,t,o,i){Page.showManyPhoto(e,t,o,i)}function R(e,t,o){return cur.viewAsBox?cur.viewAsBox():(0,u.checkEvent)(o)?void 0:(window.stManager.add([window.jsc("web/video.js"),"video.css",window.jsc("web/photoview.js"),"photoview.css"],(function(){Photoview.showVideoTags(e,t)})),!1)}function x(e){const t=e.shift();if(window.Videoview&&Videoview.playerCallback[t])return Videoview.playerCallback[t].apply(Videoview,e);throw Error("Unregistered player callback: "+t)}function F(e,t){return(0,w.showProductAttachModal)(t),(0,u.cancelEvent)(e)}function N(e,t){return(0,_.curBox)()||(0,d.showBox)("al_nft.php",{act:"token_details_modal",tokenId:t},{params:{hideButtons:!0,noCloseButton:!0,titleTransparent:!0,bodyStyle:"padding: 16px 24px"}}),(0,u.cancelEvent)(e)}function U(e,t,o,i,s,a){a||(a={});let n=!1,_=(0,r.extend)({w:"app"+t},a);if(o=(0,r.intval)(o),i&&((0,r.isObject)(i)?_=(0,r.extend)(_,i):_.ref=i),a.layer&&(n=!0),(cur.apps&&cur.apps[t]||!o)&&!n){delete _.w;const o="app"+t+(s?"_"+s:""),i=nav.objLoc&&!nav.objLoc[1]&&nav.objLoc[0]===o;return nav.go("/"+o+nav.toStr(_),e,{nocur:i})}s&&(_.mid=s);const u={stat:[window.jsc("web/wkview.js"),"wkview.css",window.jsc("web/apps.js"),"apps.css"]};a.queue&&(u.queue=1);const d=cur.module;if(u.onHide=()=>{cur.module=d,a.onHide&&a.onHide()},a.urlHash&&(_.url_hash=a.urlHash),_["#"]){const e=_["#"];delete _["#"],u.onLoaded=()=>{nav.setLoc((0,r.extend)(nav.objLoc,{"#":e}))}}return(0,T.showWiki)(_,!1,e,u)}function W(e,t,o,i,s){if(!vk.widget)return(0,n.show)(boxLoader),(0,n.show)(boxLayerWrap),(0,_.boxRefreshCoords)(boxLoader),window.stManager.add([window.jsc("web/podcast.js")],(function(){Podcast.show(e,t,null,i,s)})),o&&(0,u.cancelEvent)(o)}function K(e,t,o,i){return window.stManager.add([window.jsc("web/podcast.js")],(function(){Podcast.goToTime(e,t,o,i)})),o&&(0,u.cancelEvent)(o)}function V(e,t,o,i,s=!1,u="",l="",p="",m=1,h){ajax.post("al_bookmarks.php",{act:"bookmark",owner_id:e,object_id:t,type:o,state:s?1:0,hash:i,item_access_hash:u,ref:l||cur.module,track_code:p,show_snack:m,source:h},{onDone:(i,s,u,l)=>{if(i&&!vk.widget){const p=function(i){const _=(0,n.geByClass1)("bookmarks_tag_set",i);if(_&&!(0,a.isEmpty)(s)){const i=[];(0,r.each)(s,((e,t)=>{i.push(t)})),i.sort(((e,t)=>e.order-t.order));let a='<div class="bookmarks_tags_list">';for(let e=0;e<i.length;e++){const t=i[e];a+=`<div class="bookmarks_tags_list_item" data-id="${t.id}">${t.name}</div>`}a+="</div>",a=(0,n.se)(a),a.addEventListener("click",(o=>{const i=(0,n.domClosest)("bookmarks_tags_list_item",o.target);if(i){const o=(0,n.domData)(i,"id"),s=(0,n.toggleClass)(i,"bookmarks_tags_list_item--selected");ajax.post("al_bookmarks.php",{act:"set_tag",item_type:u,item_oid:e,item_id:t,hash:l,tag_id:o,is_tagged:(0,r.intval)(!s),is_from_snackbar:!0},{onFail:e=>((0,d.showFastBox)(c.getLang("global_error"),e),!0)})}})),cur.setBookmarksTagTooltip&&cur.setBookmarksTagTooltip.destroy(),window.stManager.add(["ui_common.css",window.jsc("web/ui_common.js")],(()=>{}));let p=new ElementTooltip(_,{content:a,appendToParent:!0,cls:"bookmarks_tag_set_tt",autoShow:!0,offset:"video"===o?[-95,-10]:[0,-36],onFirstTimeShow:e=>{window.stManager.add(["ui_common.css",window.jsc("web/ui_common.js")],(()=>{cur.setBookmarksTagTooltipScrolls||(cur.setBookmarksTagTooltipScrolls=[]),cur.setBookmarksTagTooltipScrolls.push(new uiScroll((0,n.domFC)(e),{theme:"dark"}))}))},onShow:function(){Notifier.freezeEvents(),curNotifier.tooltipShown=!0},onHide:function(){curNotifier.tooltipShown=!1,curNotifier.unfreezeAfterTooltipHide&&Notifier.unfreezeEvents()}});cur.destroy.push((()=>{cur.setBookmarksTagTooltipScrolls&&(cur.setBookmarksTagTooltipScrolls.forEach((function(e){e.destroy()})),delete cur.setBookmarksTagTooltipScrolls),p.destroy()}))}};(0,_.showDoneBox)(i,{tooltipHandler:p,link:"/bookmarks"})}}})}function H(e,t,o,i,s,a,_="",u=""){if((0,r.isObject)(window.cur)&&(0,r.isFunction)(window.cur.viewAsBox))return window.cur.viewAsBox();const d=Y(e);e.innerHTML=d?(0,n.domData)(e,"add"):(0,n.domData)(e,"remove"),(0,n.domData)(e,"state",d?0:1),V(t,o,i,s,d,a,_,u)}function j(e,t,o,i,s,a,n,r=!1){return t&&(n=Y(t),r?X(t,n,24):z(t,n)),V(o,i,s,a,n),document.querySelectorAll(`._article_${o}_${i}`).forEach((e=>{const t=e.querySelector("._bookmark_btn");r?X(t,n,24):z(t,n)})),(0,u.cancelEvent)(e)}function $(e,t,o,i,s,a){ajax.post("al_bookmarks.php",{act:"bookmark_link",state:e?1:0,hash:t,url:o,img:i,title:s,ref:cur.module,track_code:a},{onDone:e=>{e&&!vk.widget&&(0,_.showDoneBox)(e)}})}function G(e,t,o){const i=Y(t);return z(t,i),$(i,o,(0,n.domData)(t,"link-url"),(0,n.domData)(t,"link-img"),(0,n.domData)(t,"link-title"),(0,n.domData)(t,"track-code")),(0,u.cancelEvent)(e)}function q(e,t,o,i,s){return window.stManager.add([window.jsc("web/podcast.js")],(function(){Podcast.toggleFave(e,t,o,s)})),i&&(0,u.cancelEvent)(i)}function Y(e){return parseInt(e.dataset.state)}function z(e,t){e.dataset.state=String(t?0:1),e.innerHTML=t?(0,y.getIcon24FavoriteOutline)().icon:(0,f.getIcon24Favorite)().icon}function X(e,t,o=16){e.dataset.state=String(t?0:1);const i={16:(0,E.getIcon16Bookmark)().icon,24:(0,g.getIcon24Bookmark)().icon}[o],s={16:(0,v.getIcon16BookmarkOutline)().icon,24:(0,A.getIcon24BookmarkOutline)().icon}[o];e.innerHTML=t?s:i}function Q(e,t,o,i,s,a){const n=Y(t);return z(t,n),V(o,i,s,a,n),n||(0,h.sendNarrativeAnalytic)(h.NarrativeAnalyticEventType.addToBookmarks,{ownerId:o,id:i},window.cur.module),(0,u.cancelEvent)(e)}function Z(e,t,o,i){const s=Y(t);return z(t,s),ajax.post("fave.php",{act:s?"a_delete_group":"a_add_group",gid:o,hash:i},{onDone:(e,t)=>{s||vk.widget||(0,_.showDoneBox)(t)}}),(0,u.cancelEvent)(e)}function J(e,t,o,i,s,a,n="",r=""){const _=Y(t);return X(t,_),V(o,i,s,a,_,n,"",r),(0,u.cancelEvent)(e)}function ee(e,t,o,i){return(0,d.showBox)("like.php",{act:"publish_box",object:"audio_playlist"+t+"_"+o,list:i},{stat:[window.jsc("web/wide_dd.js"),"wide_dd.css",window.jsc("web/sharebox.js")],params:{shareButtonElement:e.target}}),(0,u.cancelEvent)(e)}function te(e,t){const o=e+"_"+t,i=(0,n.geByClass1)("_audio_row_"+o);s.AudioUtils.deleteAudio(i,s.AudioUtils.getAudioFromEl(i,!0)),cur.claimWarning&&cur.claimWarning.hide()}function oe(){window.TopAudioPlayer.init()}const ie={loaded:!1,events:{on(e,t){(0,b.voiceMessagePlayerLoader)().then((()=>{window.AudioMessagePlayer.events.on(e,t)}))}},togglePlay:function(e){(0,b.voiceMessagePlayerLoader)().then((()=>{window.AudioMessagePlayer.togglePlay(e)}))},toggleTranscript:function(e){(0,b.voiceMessagePlayerLoader)().then((()=>{window.AudioMessagePlayer.toggleTranscript(e)}))},detachPlayer:function(e){(0,b.voiceMessagePlayerLoader)().then((()=>{window.AudioMessagePlayer.detachPlayer(e)}))}};function se(e,t,o={}){e&&e.tt&&e.tt.hide&&e.tt.hide({fasthide:1});let s=e,a=!1;if((0,P.isArticleLayerOpen)()&&ArticleLayer.isStandalone()&&(a=!0),s.tagName&&"a"===s.tagName.toLowerCase()&&!s.getAttribute("target")&&!nav.baseBlank){const e=s.getAttribute("hrefparams");let t;e&&(o.params=(0,r.extend)(o.params||{},(0,p.fromQueryString)(e))),s=s.href||"",s=(0,i.stripVKSiteURLOrigin)(s),s.match(/#$/)||!(t=s.match(/^\/(.*?)(\?|#|$)/))?a=!0:(t=t[1],(t.indexOf(".php")>0||t.match(/^(doc\-?\d+_\d+|graffiti\d+|reg\d+|images|utils|\.js|js\/|\.css|css\/)/))&&(a=!0))}if(a){if(!!!(o&&o.params&&o.params._post&&o.params._post_click_type))return!0;e.setAttribute("data-change-location-with-post-away",1),s=e}return nav.go(s,t,o)}function ae(e){e&&(0,m.saveStatlogEvents)({name:"image_status",value:e,keys:["popup_action"]})}},847759:(e,t,o)=>{"use strict";o.d(t,{audioShowActionTooltip:()=>c,bookmarkTooltip:()=>m,mentionOver:()=>p,mobileOnlineTip:()=>d,pageVerifiedTip:()=>l});var i=o(810903),s=o(671300),a=o(879007),n=o(452314),r=o(476726),_=o(857031),u=o(132873);function d(e,t){const o=t.asrtl?0:t.right?289:35,s=t.asrtl?" mobile_tt_asrtl":t.right?" mobile_tt_right":"";return(0,i.showTooltip)(e,{url:"al_login.php",params:{act:"mobile_tt",mid:t.mid,was:t.was},slide:15,ajxdt:200,showdt:200,hidedt:200,forcetoup:t.forcetoup,toup:!1,dir:"auto",asrtl:t.asrtl,appendParentCls:t.appendParentCls,shift:[o,8,7],className:"mobile_tt"+s})}function l(e,t){return(0,i.showTooltip)(e,{url:"/al_page.php",params:{act:"verified_tt",type:t.type,oid:t.oid,force_new_tab:t.forceNewTab?1:0,with_action:t.withAction},slide:15,ajxdt:200,showdt:200,hidedt:200,dir:"auto",shift:t.shift&&t.shift.length?t.shift:[95,5,7],className:"verified_tt",forcetodown:t.forceToDown,appendEl:t.appendEl})}function c(e,t,o){if(cur._addRestoreInProgress)return;const r=(0,n.gpeByClass)("_audio_row",e),_=s.AudioUtils.getAudioFromEl(r,!0);if(!_)return;const d=(0,n.domData)(e,"action"),l=s.AudioUtils.getRowActionName(d,_,r);if("snippet"===d){const t=u.AudioLongtapTooltip.ensure();if(t.isOpen)return;if(t.canShow())return void t.show(e)}const c={text:()=>l,black:1,shift:t||[7,4,0],needLeft:!0,forcetodown:o,noZIndex:!0};(0,a.each)(["_im_mess_stack","top_notify_wrap","_ape_audio_item","wk_history_audio_content"],(function(t,o){if((0,n.gpeByClass)(o,e))return c.appendParentCls=o,!1})),(0,n.gpeByClass)("_im_mess_stack",e)&&(c.shift=[7,10,0],c.noZIndex=!0);const p=e.closest(".CatalogBlock");p&&(c.appendEl=p),(0,i.showTooltip)(e,c)}function p(e,t={}){if(!(0,r.partConfigEnabled)("mail_history_mention_popover")||"im"!==window.cur.module||window.TopNotifier.shown()||window.layers.visible)(0,i.showTooltip)(e,{url:"al_wall.php",params:{act:"mention_tt",mention:e.getAttribute("mention_id"),from:"wall"},shift:t.shift||[52,7,7],hidedt:t.hidedt||500,showdt:500,needLeft:t.needLeft,slide:15,checkLeft:!0,reverseOffset:t.reverseOffset||112,dir:"auto",appendEl:t.appendEl||(0,n.domClosest)("im-page-history-w",e)||(0,n.domClosest)("rb_box_wrap",e)||(0,n.domClosest)("wk_cont",e)||(0,_.isVKCOMProfileRedesignedEnabled)()&&(0,n.domClosest)("box_layout",e)||(0,n.domClosest)("scroll_fix_wrap",e)});else{const t=e.getAttribute("mention_id").match(/^(id|club)(\d+)$/);if(!t)return;let o;switch(t[1]){case"id":o=parseInt(t[2],10);break;case"club":o=-parseInt(t[2],10)}if(!o)return;window.reforgedME&&window.reforgedME.profileInfo&&window.reforgedME.profileInfo.mountProfileInfo({peerId:o,targetElement:e})}}function m(e){let t="";(0,n.gpeByClass)("_im_mess_stack",e)?t="_im_mess_stack":(0,n.gpeByClass)("wall_text",e)&&(t="scroll_fix_wrap"),(0,i.showTooltip)(e,{className:"bookmarks_tt ",shift:[32,8],text:()=>"1"===(0,n.domData)(e,"state")?(0,n.domData)(e,"remove"):(0,n.domData)(e,"add"),black:1,appendParentCls:t})}},815559:(e,t,o)=>{"use strict";o.d(t,{handleGlobalEsc:()=>b,hideCookiesPolicy:()=>P,onCtrlEnter:()=>w,onDocumentClick:()=>v,onEnter:()=>A});var i=o(225538),s=o(736852),a=o(490712),n=o(307188),r=o(476726),_=o(452314),u=o(317412),d=o(879007),l=o(327527),c=o(655883),p=o(714209),m=o(250682),h=o(723561),y=o(387674),f=o(529397),E=o(261180),g=o(87223);function v(e){if((0,r.partConfigEnabled)("ignore_navgo_if_prevented")&&e.defaultPrevented)return;if((0,u.checkEvent)(e))return!0;if((0,E.processAliExpressMiniAppLinkClickEvent)(e))return!1;if(m.ls.set("last_reloaded",[]),cur.onMouseClick&&cur.onMouseClick(e))return;if(!(e=window.event||e.originalEvent||e))return!0;e.target?.dataset?.donutLogEvent&&(0,f.logDonutEvent)(e.target.dataset.donutLogEvent);let t,o=8,l=e.target||e.srcElement;for(;l&&l!==document.body&&"A"!==l.tagName&&o--;)l=l.parentNode;if(!l||"A"!==l?.tagName)return!0;const c=l.onclick||l.onmousedown;if((0,r.partConfigEnabled)("react_global_nav_handling")?Boolean(l.getAttribute("onclick")||l.getAttribute("onmousedown")):!(0,i.isAllowLinkOnclickWebForLink)(l)&&c)return!0;let p=l.href;const h=l.getAttribute("target")||nav.baseBlank;if(p&&h){if((0,_.domClosest)("bookmarks_row_type_link",l)){const e=(nav.fromStr(p)||{}).to;(0,a.statlogsValueEvent)("bookmarks_product_analytics",{link_url:e,time:(0,n.getServerTime)()})}return!0}p=(0,s.stripVKSiteURLOrigin)(p);const v={};if((t=p.match(/^\/(.+?)#[\!\/](.+?)$/))&&!t[1].match(/^app(\d+)/)&&!(0,r.partConfigEnabled)("mini_apps_navgo_hash_fix")){const e=p;v.permanent=t[1],p="/"+t[2],(0,r.partConfigEnabled)("mini_apps_navgo_hash_stats")&&(0,g.logError)("Legacy hash navigation",{breadcrumb:{data:{oldHref:e,newHref:`${p}?_permanent=${v.permanent}`}}})}const A=!!(l.getAttribute&&l.getAttribute("data-post-click-type")&&l.getAttribute("data-post-id"));if(p.match(/#$/)&&!A)return!0;const w=(0,_.domData)(l,"post-id");let b;w&&(v.postId=w);let P=p,T=null;const I=p.match(/^\/(.*?)(\?|#|$)/);if(I)T=I[1];else{if(l.hostname)b=l.hostname,T=l.pathname+l.search;else{const e=/^([^:\/]+)?(?::(\d+))?(\/?[^#]*)(#?.*)$/i.exec(p);if(!e)return!0;b=e[1],T=e[3]||"/"}if(!b||!A)return!0;l.setAttribute("data-change-location-with-post-away",1),P=l}if("add_community_app"===T)return(0,_.attr)(l,"target","_blank"),!0;if(T.indexOf(".php")>0||T.match(/^(doc\-?\d+_\d+|graffiti\d+|reg\d+|images\/|utils\/|\.js|js\/|\.css|css\/|source\b)/)){if(!A)return!0;l.setAttribute("data-change-location-with-post-away",1),P=l}const O=l.getAttribute("hrefparams");O&&(v.params=(0,d.extend)(v.params||{},(0,y.fromQueryString)(O)));try{return nav.go(P,e,(0,d.extend)({},v,{throwErrorOnDisabledPath:!0})),(0,u.cancelEvent)(e)}catch(e){return!0}}function A(e,t){(t=t||window.event).keyCode===u.KEY.ENTER&&(e(),(0,u.cancelEvent)(t))}function w(e,t){(10===(e=e||window.event).keyCode||13===e.keyCode&&(e.ctrlKey||e.metaKey&&p.browser.mac))&&(t(),(0,u.cancelEvent)(e))}function b(e){if(window._wf=1,e.keyCode===u.KEY.ESC&&boxQueue.count()&&!cur._noEscHide)return boxQueue.hideLast(),-1;if(e.keyCode===u.KEY.ESC&&window.articleCloseImageFullSize&&window.articleCloseImageFullSize())return(0,u.cancelEvent)(e);if(e.keyCode===u.KEY.ESC&&window.isArticleLayerOpen&&window.isArticleLayerOpen())return window.ArticleLayer.close(!0),(0,u.cancelEvent)(e);if(e.keyCode===u.KEY.ESC&&window.AuthorPage&&!cur.articleEditorLayer)return window.AuthorPage.close(),(0,u.cancelEvent)(e);if(e.keyCode===u.KEY.ESC&&(0,r.partConfigEnabled)("vkm_reforged_in_vkcom")&&"im"===window.cur?.module)return void((0,h.getCancelStack)().length&&((0,h.cancelStackPop)(),(0,u.cancelEvent)(e)));if(e.keyCode===u.KEY.ESC)return(0,h.cancelStackPop)(),(0,u.cancelEvent)(e);const t=[176,177,178,179];let o=!1;window.audioPlayer&&(t.push(u.KEY.LEFT),t.push(u.KEY.RIGHT)),(0,d.each)(t,(function(t,i){if(e.keyCode===i)return o=!0,!1})),o&&(0,l.getAudioPlayer)().onMediaKeyPressedEvent(e),c.Chat.inited&&191===e.keyCode&&(e.ctrlKey||e.metaKey&&p.browser.mac)&&c.Chat.showFriends()}function P(){(0,_.re)("cookies_policy_wrap"),ajax.post("/settings",{act:"a_hide_cookies_policy"})}},691004:(e,t,o)=>{"use strict";o.d(t,{isInputActive:()=>d,placeholderInit:()=>p,placeholderSetup:()=>c,preventNonNumericalInput:()=>h});var i=o(452314),s=o(317412),a=o(663878),n=o(879007),r=o(714209),_=o(476726),u=o(171444);function d(){return document.activeElement&&((0,i.attr)(document.activeElement,"contenteditable")||"INPUT"===document.activeElement.tagName||"textarea"===document.activeElement.tagName)}function l(e,t={},o,s){const n=e.phshown,_=e.phcont,{back:u,editable:d,hideBackAfter:l,timeout:c,phColor:p="#8C8E91",activeColor:m="#C0C8D0"}=t,h=c||0===c?c:100,y=t.period||200;let f;if(f=d?(void 0!==e.textContent?e.textContent:e.innerText)||(0,i.geByTag)("img",e).length:e.value,n&&(u&&f||!u&&(o&&!o.type||f))?((0,i.hide)(_),e.phshown=!1):n||f||!u&&!s||((0,i.show)(_),e.phshown=!0,r.browser.opera&&s&&(e.setAttribute("placeholder",""),e.removeAttribute("placeholder",""))),u&&!f){if(o&&!o.type){const t=l?i.hide.pbind(_.firstChild.firstChild):null;clearTimeout(e.phanim),e.phanim=setTimeout((function(){(0,a.animate)(_.firstChild.firstChild,{color:m},y,t)}),h)}s&&(clearTimeout(e.phanim),l&&(0,i.show)(_.firstChild.firstChild),e.phanim=setTimeout((function(){(0,a.animate)(_.firstChild.firstChild,{color:p},y)}),h))}}function c(e,t){const o=(0,i.ge)(e);if(!o)return!1;if(!(o.getAttribute?o.getAttribute("contenteditable"):o.contenteditable)&&(0,_.partConfigEnabled)("native_placeholder_enable"))return!1;const a=t?(0,n.clone)(t):{};if(o.phevents&&!a.reload)return;const u=o.getAttribute?o.getAttribute("placeholder"):o.placeholder;if(!u)return;o.removeAttribute("placeholder");let d={},c=!1;const p=["Top","Bottom","Left","Right"];if(a.pad)d=a.pad;else{if(a.fast){for(let e=0;e<4;e++)d["padding"+p[e]]=3,d["margin"+p[e]]=0,d["border"+p[e]+"Width"]=1;(0,n.extend)(d,a.styles||{})}else{const e=[];for(let t=0;t<4;t++)e.push("margin"+p[t]),e.push("padding"+p[t]),e.push("border"+p[t]+"Width");d=(0,i.getStyle)(o,e)}for(let e=0;e<4;e++){const t="margin"+p[e],o="border"+p[e]+"Width";d[t]=(0,n.intval)(d[t])+(0,n.intval)(d[o])+"px",delete d[o]}}if(a.reload){const e=o.previousSibling;e&&(0,i.hasClass)(e,"input_back_wrap")&&(0,i.re)(e)}const m=a.big?" big":"",h=(0,i.getSize)(o)[0]-20,y=o.phcont=o.parentNode.insertBefore((0,i.ce)("div",{className:"input_back_wrap no_select",innerHTML:`<div class="input_back"><div class="input_back_content${m}" style="width: ${h}px;">${u}</div></div>`}),o),f=(0,i.domFC)(y);(0,i.setStyle)(f,d);const E=l.pbind(o,a),g=r.browser.mobile?E:(e,t)=>setTimeout(E.pbind(e,t),0);r.browser.msie&&r.browser.version<8&&(0,i.setStyle)(f,{marginTop:1}),o.phonfocus=function(e){c||(o.focused=!0,cur.__focused=o,!0===e&&((0,i.setStyle)(o,{backgroundColor:"#FFF"}),(0,i.hide)(f)),g(!0,!1))},o.phonblur=function(){c||(cur.__focused=o.focused=!1,(0,i.show)(f),g(!1,!0))},o.phshown=!0,o.phanim=null,(o.value||a.editable&&((void 0!==o.textContent?o.textContent:o.innerText)||(0,i.geByTag)("img",o).length))&&(o.phshown=!1,(0,i.hide)(y)),r.browser.opera_mobile||((0,s.addEvent)(y,"focus click",(function(e){c||(a.editableFocus?(setTimeout(a.editableFocus.pbind(o),0),o.phonfocus()):(o.blur(),o.focus()))})),(0,s.addEvent)(o,"focus"+(a.editable?" click":""),o.phonfocus),(0,s.addEvent)(o,"keydown paste cut input",g)),(0,s.addEvent)(o,"blur",o.phonblur),o.check=g,o.getValue=()=>a.editable?o.innerHTML:o.value,o.setPlaceholder=e=>(0,i.geByClass1)("input_back_content",y).textContent=e,o.setDisabled=e=>c=e,o.setValue=function(e){a.editable?o.innerHTML=e:o.value=e,l(o,a)},o.phevents=!0,o.phonsize=function(){},a.global||a.reload||(cur.__phinputs||(cur.__phinputs=[],cur.destroy.push(function(e){for(let t=0,o=e.length;t<o;t++)(0,i.removeData)(e[t])}.pbind(cur.__phinputs))),cur.__phinputs.push(o))}function p(e,t){const o=(0,i.ge)(e);if(!o)return!1;if(!(o.getAttribute?o.getAttribute("contenteditable"):o.contenteditable)&&(0,_.partConfigEnabled)("native_placeholder_enable"))return!1;const a=t?(0,n.clone)(t):{},d=void 0===(0,i.ce)("input").placeholder||o&&o.getAttribute&&o.getAttribute("contenteditable");if(o.phevents&&!a.reload)return;const l=o.getAttribute?o.getAttribute("placeholder"):o.placeholder;if(!l)return;if(o.getValue=function(){return a.editable?o.innerHTML:o.value},o.setValue=function(e){a.editable?o.innerHTML=e:o.value=e,d&&c(o,a)},o.phonfocus=function(){},o.phonblur=function(){},!d)return;function c(e,t={}){const o=e.phshown,s=e.phcont;let a;t.editable?(a=void 0!==e.textContent?e.textContent:e.innerText,a&&r.browser.opera&&a.match(/^[ ]+$/)&&(a=""),a||(a=(0,i.geByTag)("img",e).length>0),a||(a=(0,i.geByTag)("br",e).length>1),a||(a=(0,i.geByTag)("p",e).length>1)):a=e.value,o&&a?((0,i.hide)(s),e.phshown=!1):o||a||((0,i.show)(s),e.phshown=!0)}if(o.removeAttribute("placeholder"),a.reload){const e=(0,i.domNS)(o);e&&(0,i.hasClass)(e,"placeholder")&&(0,i.re)(e)}const p=o.phcont=(0,i.domInsertAfter)((0,i.ce)("div",{className:"placeholder",innerHTML:'<div class="ph_input"><label class="ph_content" for="'+o.id+'">'+l+"</label></div>"}),o),m=c.pbind(o,a),h=r.browser.mobile?m:(e,t)=>setTimeout(m.pbind(e,t),0);o.phonfocus=function(){o.focused=!0,cur.__focused=o,h(!0,!1)},o.phonblur=function(){cur.__focused=o.focused=!1,h(!1,!0)},o.phshown=!0,(o.value||a.editable&&((void 0!==o.textContent?o.textContent:o.innerText)||(0,i.geByTag)("img",o).length))&&(o.phshown=!1,(0,i.hide)(p)),r.browser.opera_mobile||((0,s.addEvent)(p,"focus click contextmenu",(function(e){a.editableFocus?(setTimeout(a.editableFocus.pbind(o),0),"contextmenu"===e.type&&r.browser.msie&&a.editableFocus(o),o.phonfocus()):(o.blur(),o.focus())})),(0,s.addEvent)(o,"focus"+(a.editable?" click":""),o.phonfocus),(0,s.addEvent)(o,"keydown paste cut input",h)),(0,s.addEvent)(o,"blur",o.phonblur),o.check=h,o.phevents=!0,o.phonsize=function(){},a.global||a.reload||(cur.__phinputs||(cur.__phinputs=[],(0,u.pushNavDestroy)((()=>{if(cur.__phinputs)for(let e=0,t=cur.__phinputs.length;e<t;++e)(0,i.removeData)(cur.__phinputs[e])}))),cur.__phinputs.push(o))}const m=e=>{const t=void 0===e.which?e.keyCode:e.which;String.fromCharCode(t).match(/^[0-9]+$/)||(0,s.cancelEvent)(e)},h=e=>{(0,s.addEvent)(e,"keypress",m)}},134020:(e,t,o)=>{"use strict";o.d(t,{TopMenu:()=>v,autosizeSetup:()=>g,checkPageBlocks:()=>y.checkPageBlocks,getProgressBarEl:()=>w,getProgressHtml:()=>A,leftBlockOut:()=>E,leftBlockOver:()=>f});var i=o(879007),s=o(452314),a=o(663878),n=o(317412),r=o(714209),_=o(723561),u=o(581903),d=o(85953),l=o(984869),c=o(476726),p=o(933052),m=o(832813),h=o(331876),y=o(402271);function f(e){let t=1;e.id||(e=(0,s.ge)("left_hide"+e),t=0),!t&&e.timer||(e.showing?(0,s.removeAttr)(e,"showing"):((0,a.animate)(e,{opacity:t?1:.5},200),t&&(e.showing=1))),e.timer&&(clearTimeout(e.timer),(0,s.removeAttr)(e,"timer"))}function E(e){let t=.5;e.id||(e=(0,s.ge)("left_hide"+e),t=0),e.timer=setTimeout((function(){(0,a.animate)(e,{opacity:t},200),(0,s.removeAttr)(e,"timer")}),1)}function g(e,t={}){if(!(e=(0,s.ge)(e)))return;if(e.autosize)return void e.autosize.update();t.minHeight=(0,i.intval)(t.minHeight)||(0,i.intval)((0,s.getStyle)(e,"height")),t.maxHeight=(0,i.intval)(t.maxHeight);let o=(0,s.getSize)(e)[0]||(0,i.intval)((0,s.getStyle)(e,"width")),a=(0,s.getStyle)(e,"fontSize"),_=(0,s.getStyle)(e,"lineHeight");o<1&&(o=(0,i.intval)((0,s.getStyle)(e,"width",!1))),a.indexOf("em")>0&&(a=(0,i.floatval)(a)*parseInt(window.getComputedStyle(document.body).fontSize)),a=(0,i.intval)(a);const u={width:o,height:10,fontFamily:(0,s.getStyle)(e,"fontFamily"),fontSize:a+"px",lineHeight:_,boxSizing:(0,s.getStyle)(e,"boxSizing")};(0,i.each)(["Top","Bottom","Left","Right"],(function(){u["padding"+this]=(0,s.getStyle)(e,"padding"+this)})),e.autosize={options:t,helper:(0,s.ce)("textarea",{className:"ashelper"},u),handleEvent:function(t,o){let i=o.charCode?String.fromCharCode(o.charCode):o.charCode;if(void 0===i&&(i=String.fromCharCode(o.keyCode),10===o.keyCode||13===o.keyCode?i="\n":!r.browser.msie&&o.keyCode<=40&&(i="")),!i)return t;if(!r.browser.msie)return t.substr(0,e.selectionStart)+i+t.substr(e.selectionEnd);const s=document.selection.createRange();return s.text&&(t=t.replace(s.text,"")),t+i},update:function(t){let o=e.value;!t||"blur"===t.type||"keyup"===t.type||r.browser.msie&&"keypress"!==t.type||t.ctrlKey||t.altKey||t.metaKey||(o=e.autosize.handleEvent(o,t)),o||(o=" "),e.autosize.helper.value!==o&&(e.autosize.helper.value=o);const a=e.autosize.options,n=(0,s.getSize)(e,!0)[1];let u=e.autosize.helper.scrollHeight;const d=u%_;a.exact&&d>2&&(u-=d-2),u<a.minHeight&&(u=a.minHeight);const l={overflow:"hidden"},c=(0,s.getStyle)(e,"overflow").indexOf("auto")>-1?"auto":"hidden";a.maxHeight&&u>a.maxHeight&&(u=a.maxHeight,(0,i.extend)(l,{overflow:"auto",overflowX:"hidden"})),a.addHeight&&(u+=a.addHeight),n===u&&c===l.overflow||(l.height=u,(0,s.setStyle)(e,l),(0,i.isFunction)(a.onResize)&&a.onResize(u))}},t.exact&&("normal"===_&&(_="120%"),_.indexOf("%")>0&&(_=a*(0,i.intval)(_)/100)),utilsNode.appendChild(e.autosize.helper),r.browser.opera_mobile?((0,s.setStyle)(e,{overflow:"hidden"}),e.autosize.update(),(0,n.addEvent)(e,"blur",e.autosize.update)):((0,n.addEvent)(e,"keydown keyup keypress change",e.autosize.update),setTimeout((()=>{(0,s.setStyle)(e,{overflow:"hidden",resize:"none"});const t=(0,s.val)(e);(0,s.val)(e," ",!0),(0,s.val)(e,t,!0),e.autosize.update()}),0))}const v={init:function(){if(this.inited)return!1;this.ecoPlateAnalytics=new h.EcoPlateAnalytics;const e=(0,s.ge)("top_profile_link"),t=(0,s.ge)("top_profile_menu");if(!e||!t)return!1;(0,n.addEvent)(e,"mousedown",v.clicked),this.inited=!0,(0,d.initColorSchemeDropdowns)()},clicked:function(e){return(0,n.checkEvent)(e)||"mousedown"===e.type&&(0,n.checkKeyboardEvent)(e)||v.toggle(),!1},toggle:function(e){if((0,c.partConfigEnabled)("logout_save_user_dialog")){if(document.querySelector(".SaveUserForQuickLoginBox"))return}const t=(0,s.ge)("top_profile_link"),o=(0,s.ge)("top_profile_menu"),i=(0,s.hasClass)(o,"shown");if(void 0!==e&&i===e)return;void 0===e&&(e=!i);const a=(0,s.$)("[data-warning]")?.getAttribute("data-warning"),n=(0,s.$)("[data-security-svg]");(0,s.hasClass)(o,"top_profile_menu_new")&&(e?(u.vkConnectNavigationCollector.logAccountActionsOpen(a),(0,l.logSwitcherAccounts)(),(0,c.partConfigEnabled)("vkprotect_security_recommendation")&&null!==n&&(n.remove(),(0,p.api)("account.setSecurityIndicatorShown",{}))):u.vkConnectNavigationCollector.logAccountActionsClose(a)),this.ecoPlateAnalytics&&this.ecoPlateAnalytics.logTopNavToggle(e),(0,s.toggleClass)(t,"active",e),(0,s.toggleClass)(o,"shown",e),e?((0,_.cancelStackPush)("top_menu",v.toggle.bind(this,!1),!0),cur.introExitTooltipHide&&(cur.introExitTooltipHide(),delete cur.introExitTooltipHide)):(0,_.cancelStackFilter)("top_menu",!0)},show:function(){v.hidetimer&&(clearTimeout(v.hidetimer),v.hidetimer=0),v.toggle(!0)},hide:function(){v.hidetimer||(v.hidetimer=setTimeout((function(){v.toggle(!1),v.hidetimer=0}),200))},select:function(e,t){return!!(0,n.checkEvent)(t)||((0,m.logTopNavElements)(e.href),v.toggle(!1),nav.go(e,t,{noback:!0}))}};function A(e,t){return(0,s.rs)(vk.pr_tpl,{id:e||"",cls:t||""})}function w(e){return(0,s.geByClass1)("ui_progress_bar",e)}},655883:(e,t,o)=>{"use strict";o.d(t,{Chat:()=>c,__qlClear:()=>g,cssAnim:()=>p,hideNewsAnnounce:()=>m,initLegacyBrowserDetectionInAttribute:()=>E,initPostsLegacyVars:()=>I,leftAdBlockClose:()=>h,leftBlockFriendTooltip:()=>f,leftBlockToggleFriend:()=>y,nodeUpdated:()=>T,onLoginCaptcha:()=>b,onLoginDone:()=>A,onLoginFailed:()=>w,onLoginReCaptcha:()=>P,storePasswordCredential:()=>v});var i=o(810903),s=o(248298),a=o(452314),n=o(663878),r=o(317412),_=o(879007),u=o(20025),d=o(714209),l=o(645024);const c={maxHeight:300,tabs:{},counters:{},showFriends:function(){curFastChat.clistBox.visible?curFastChat.clistBox.options.fixed?window.FastChat.clistHide():curFastChat.clistBox.show():(window.FastChat.clistShow(),c.cont.tt&&c.cont.tt.destroy&&c.cont.tt.destroy())},showTT:function(){if(!document.querySelector(".WideScreenAppPage")&&!(0,a.hasClass)(c.wrap,"chat_active")&&!(0,a.hasClass)(c.wrap,"chat_expand")){const e=d.browser.mac?"Cmd":"Ctrl";(0,i.showTooltip)(c.cont,{text:`${l.getLang("head_fr_online_tip")} (${e}+?)`,shift:[-2,4,0],showdt:0,black:1})}},init:function(){c.wrap=(0,a.ce)("div",{id:"chat_onl_wrap",className:"chat_onl_wrap",innerHTML:'\n<div class="chat_tt_wrap"></div>\n<div class="chat_onl_inner">\n  <div class="chat_cont_scrolling"><div class="chat_onl_height"></div></div>\n  <div class="chat_cont_sh_top"></div>\n  <div class="chat_cont_sh_bottom"></div>\n  <a class="chat_tab_wrap" id="chat_tab_wrap" onclick="Chat.showFriends()" onmouseover="Chat.showTT();">\n    <div class="chat_onl_cont">\n      <div class="chat_onl" id="chat_onl"></div>\n    </div>\n  </a>\n</div>'}),utilsNode.appendChild(c.wrap),c.scrollNode=(0,a.geByClass1)("chat_cont_scrolling",c.wrap),c.ttNode=(0,a.geByClass1)("chat_tt_wrap",c.wrap),c.itemsCont=c.scrollNode.firstChild,c.onl=(0,a.ge)("chat_onl"),c.cont=c.onl.parentNode.parentNode,(0,a.hide)(c.wrap),c.inited=!0,window.stManager._addCss(".layers_shown .chat_onl_wrap {margin-right: "+(0,s.sbWidth)()+"px;}")}};function p(e,t,o,i){const s=(0,_.intval)(d.browser.version);if(e&&(d.browser.chrome&&s>14||d.browser.mozilla&&s>13||d.browser.opera&&s>2)){const s="all "+o.duration+"ms "+(o.func||"ease-out");e.style.WebkitTransition=s,e.style.MozTransition=s,e.style.OTransition=s,e.style.transition=s;const n=function(){return d.browser.opera&&(0,_.intval)(d.browser.version)<=12?e.removeEventListener("oTransitionEnd",n):(0,r.removeEvent)(e,"webkitTransitionEnd transitionend msTransitionEnd oTransitionEnd",n),e.style.WebkitTransition="",e.style.MozTransition="",e.style.OTransition="",e.style.transition="",i&&i(),!1};i&&(d.browser.opera&&(0,_.intval)(d.browser.version)<=12?e.addEventListener("oTransitionEnd",n):(0,r.addEvent)(e,"webkitTransitionEnd transitionend msTransitionEnd oTransitionEnd",n)),setTimeout(a.setStyle.pbind(e,t),0)}else(0,n.animate)(e,t,(0,_.extend)(o,{onComplete:i}))}function m(e,t){const o={act:"hide_block",block:e,hash:t};ajax.post("al_index.php",o),(0,a.hide)("news_announce_"+e)}function h(e,t,o){(0,a.setStyle)("left_hide"+e,{visibility:"hidden"}),function(e,t,o){let i="";const r=(0,u.showBox)("reports.php",{act:"hide_ad_box",ad_data:o},{onDone:function(){const e=(0,a.geByClass)("radiobtn","ad_hide");window.radioBtns.ad_hide={val:0,els:e};const t=(0,a.ge)("ad_csrf");i=t?t.value:i},params:{width:370,onClean:()=>{delete window.radioBtns.ad_hide}},stat:["reports.css"]});r.removeButtons(),r.addButton(l.getLang("box_send"),(_=>{(0,s.lockButton)(_),ajax.post("reports.php",{act:"hide_ad",reason_id:window.radioBtns.ad_hide.val,ad_data:o,hash:i}),function(e,t,o){function i(t){if(!t.done)return;if("function"==typeof o&&o(),"ya_direct"===e)return(0,n.animate)(e,{opacity:0},200,(function(){(0,a.re)("ya_direct"),setTimeout((function(){AdsLight.updateBlock("force_hard",2)}),5e3)})),void(window.vk__adsLight.yaDirectAdActive=!1);const i=(0,a.ge)("ads_ad_close_info_"+e);if(!i)return!1;(0,a.setStyle)(i,{opacity:0}),i.style.setProperty("display","block","important"),setTimeout(s,0)}function s(){(0,n.animate)("ads_ad_close_info_"+e,{opacity:1},200,r)}function r(){(0,a.setStyle)("ads_ad_box2_"+e,{visibility:"hidden"})}ajax.post(t,{},{noAds:!0,onDone:i})}(e,t,(()=>{(0,s.unlockButton)(_),r.hide()}))})),r.addButton(l.getLang("global_cancel"),!1,"no")}(e,t,o)}function y(e,t,o,i,s){i&&window.stManager.add(["tooltips.css",window.jsc("web/tooltips.js")]),cur.mfid=e,ajax.post("al_friends.php",{act:i?"add":"remove",mid:e,mf_type:t,hash:o,from:"leftblock"},{onDone:function(t,o,i){if(!t)return nav.reload();const s=(0,a.ge)("left_friend_status_"+e);(0,a.cleanElems)(s.firstChild),t?((0,a.show)(s),(0,a.val)(s,t)):(0,a.hide)(s),o&&(ajax.preload("al_friends.php",{act:"friend_tt",mid:e},[o,i]),setTimeout(f,0))},showProgress:function(){const t=((0,a.ge)("left_friend_subscribed")||{}).tt;t&&(t.hide({fasthide:1}),t.destroy()),(0,a.ge)("left_friend_status_"+e).innerHTML='<img src="/images/upload'+(window.devicePixelRatio>=2?"_2x":"")+'.gif" width="32" />'},hideProgress:()=>(0,a.hide)("left_friend_status_"+e),onFail:function(e){if(e)return(0,u.showFastBox)({title:l.getLang("global_error")},e),!0}}),(0,r.cancelEvent)(s)}function f(){return(0,i.showTooltip)((0,a.ge)("left_friend_subscribed"),{url:"al_friends.php",params:{act:"friend_tt",mid:cur.mfid,from:"leftblock"},slide:15,hidedt:500,shift:[40,-1,3],className:"preq_tt",forcetodown:!0})}function E(){let e=[];(0,_.each)(d.browser,(function(t,o){o&&!(0,_.inArray)(t,["version","mac","search_bot"])&&"flash"!==t.substr(0,5)&&e.push(t)})),e=e.join(" "),document.body.setAttribute("data-useragent",e)}function g(){clearTimeout(window.__qlTimer),setTimeout((()=>clearTimeout(window.__qlTimer)),2e3)}function v(e){if(!d.browserFeatures.cmaEnabled||!window.ResizeObserver||!(0,a.val)("quick_email"))return;if(void 0===window.PasswordCredential)return;const t=new PasswordCredential({id:(0,a.ge)("quick_email").value,password:(0,a.ge)("quick_pass").value,name:e.name,iconURL:e.photo_50});navigator.credentials.store(t)}function A(e,t){g(),v(t),nav.reload({force:!0,from:6})}function w(e,t){switch(g(),e){case-1:location.href=location.href.replace(/^http:/,"https:");break;case 4:let e="/login?m=1"+(t.expire?"&s=0":"");(0,_.each)(["email","ul","pch","to"],(function(o,i){t[i]&&(e+="&"+i+"="+t[i])})),location.href=e;break;case 7:location.href="/login?m=7";break;default:location.href="/login"}}function b(e,t){g(),(0,s.unlockButton)(window.__qfBtn),window.qloginBox=(0,u.showCaptchaBox)(e,t,window.qloginBox,{onSubmit:function(e,t){!function(){const e=(0,a.ge)("quick_captcha_sid"),t=(0,a.ge)("quick_captcha_key"),o=(0,a.ge)("quick_recaptcha"),i=(0,a.ge)("quick_login_form");e||i.appendChild((0,a.ce)("input",{type:"hidden",name:"captcha_sid",id:"quick_captcha_sid",value:""})),t||i.appendChild((0,a.ce)("input",{type:"hidden",name:"captcha_key",id:"quick_captcha_key",value:""})),o||i.appendChild((0,a.ce)("input",{type:"hidden",name:"recaptcha",id:"quick_recaptcha",value:""}))}(),(0,a.ge)("quick_captcha_sid").value=e,(0,a.ge)("quick_captcha_key").value=t,(0,a.ge)("quick_login_form").submit()},onHide:()=>window.qloginBox=!1})}function P(e,t){g(),(0,s.unlockButton)(window.__qfBtn),window.qloginBox=(0,u.showReCaptchaBox)(e,t,window.qloginBox,{onSubmit:function(e){(0,a.ge)("quick_recaptcha").value=e,(0,a.ge)("quick_login_form").submit()},onHide:()=>window.qloginBox=!1})}function T(e,t){(0,a.setStyle)(e,{backgroundColor:"#F5F7FA"}),(0,n.animate)(e,{backgroundColor:"#FFF"},t||6e3,(function(e){(0,a.setStyle)(e,{backgroundColor:null})}))}function I(){window._postsSeen=window._postsSeen??{},window._postsSaved=window._postsSaved??{},window._postsSaveTimer=window._postsSaveTimer??void 0,window._postsSendTimer=window._postsSendTimer??void 0,window._postsCleanTimer=window._postsCleanTimer??void 0,window._postsSeenModules=window._postsSeenModules??{},window._postsExtras=window._postsExtras??{}}},174628:(e,t,o)=>{"use strict";o.d(t,{shortCurrency:()=>a});var i=o(879007),s=o(452314);function a(){const e={};(0,i.each)((0,s.geByClass)("_short_currency"),(function(){const t=(0,s.domData)(this,"short")||"";if(!t)return!0;const o=this.innerHTML,a=(0,i.winToUtf)(o).length,n=(0,s.getStyle)(this,"fontFamily")||"tahoma,arial,sans-serif";if(void 0===e[n]){let t="";for(let e=a-1;e>=0;e--)t+="&#8399;";const i=(0,s.ce)("div",{innerHTML:`<b>${o}</b><b>${t}</b>`},{fontFamily:n,fontSize:"24px"});(0,s.ge)("utils").appendChild(i),e[n]=Math.abs(i.firstChild.offsetWidth-i.lastChild.offsetWidth)>=2*a,(0,s.re)(i)}!1===e[n]&&(0,s.val)(this,t)}))}},590335:(e,t,o)=>{"use strict";o.d(t,{rangeCreate:()=>r,rangeGet:()=>a,rangeInsert:()=>_});var i=o(452314),s=o(714209);function a(){let e=null,t=window.getSelection();t.getRangeAt&&t.rangeCount&&(e=t.getRangeAt(0));let o=null,i=null,s=0,a=0,n=document.activeElement;return e&&("selectionStart"in n?(o=n,i=n,s=n.selectionStart,a=n.selectionEnd):t.rangeCount&&(o=e.startContainer,i=e.endContainer,s=e.startOffset,a=e.endOffset)),[e,o,s,i,a]}function n(e){let t=window.getSelection();return t.removeAllRanges(),t.addRange(e),e}function r(e,t,o,i){let s=document.createRange();return s.setStart(e,t),s.setEnd(o,i),n(s)}function _(e,t){if(t=t?t+"":"",!s.browser.msie&&document.execCommand)document.execCommand("insertHTML",!1,t);else if(e){e.deleteContents();let o=(0,i.cf)(t),s=o.lastChild;e.insertNode(o),s&&((e=e.cloneRange()).setStartAfter(s),e.collapse(!0),n(e))}return e}},756758:(e,t,o)=>{"use strict";o.d(t,{blockNameEmpty:()=>be,blockNameOwn:()=>Pe,blockNameSearch:()=>Te,blockNameSearchGeoGroups:()=>Oe,blockNameSearchGroups:()=>Ie,clickTypeAddFriendOut:()=>ge,clickTypeJoinGroupOut:()=>fe,clickTypeLeaveGroupOut:()=>Ee,clickTypeRemoveFriendOut:()=>ve,generateQID:()=>ct,logLeftMenuClicks:()=>dt,outOfSerpGroup:()=>Ae,outOfSerpProfile:()=>we,removeOutOfSerpClickLogging:()=>nt,removeSearchPositionTracker:()=>ut,saveSearchAttemptStats:()=>lt,serviceApps:()=>C,serviceAppsList:()=>O,serviceAppsManage:()=>M,serviceAudio:()=>x,serviceBookmarksGroups:()=>T,serviceBookmarksUsers:()=>I,serviceDocs:()=>B,serviceEvents:()=>h,serviceFriends:()=>y,serviceFriendsFind:()=>E,serviceGamesCatalog:()=>H,serviceGroups:()=>c,serviceGroupsCatalog:()=>p,serviceManage:()=>F,serviceMarketV2:()=>W,serviceMessages:()=>R,serviceNews:()=>b,servicePhotos:()=>L,serviceSearchAudio:()=>P,serviceSearchClips:()=>S,serviceSearchCommunities:()=>m,serviceSearchPeople:()=>f,serviceSearchStatuses:()=>w,serviceSearchVideo:()=>D,serviceTopSearch:()=>k,serviceUserFriends:()=>V,serviceVideo:()=>N,serviceWall:()=>A,serviceWallGroups:()=>v,serviceWallUsers:()=>g,tryLogOutOfSerpClick:()=>at});var i=o(7144),s=o(317412),a=o(879007),n=o(452314),r=o(490712),_=o(623702),u=o(258643),d=o(476726);const l={},c="groups",p="groups_catalog",m="search_communities",h="events",y="friends",f="search_people",E="friends_find",g="wall_users",v="wall_groups",A="wall",w="search_statuses",b="news",P="search_audio",T="bookmarks_groups",I="bookmarks_users",O="apps_list",C="apps",M="apps_manage",D="search_video",S="search_clips",k="top_search",L="photos",B="docs",R="messages",x="audio",F="manage",N="video",U="market",W="market_v2",K="market_groups",V="profile_user_friends",H="games_catalog",j="",$="tap",G="join_group",q="leave_group",Y="fave",z="unfave",X="write_msg",Q="add_friend",Z="remove_friend",J="restore_friend",ee="show_photo",te="add",oe="remove",ie="play",se="open_artist",ae="open_author_group",ne="open_author_user",re="open_author",_e="show_similar",ue="search_by_tag",de="edit",le="like",ce="open_comments",pe="share",me="expand",he="mark_as_spam",ye="stats",fe="join_group_out",Ee="leave_group_out",ge="add_friend_out",ve="remove_friend_out",Ae="group",we="profile",be="",Pe="own",Te="search",Ie="search_groups",Oe="search_communities_geo",Ce="own_playlists",Me="global_clips",De="own_audios",Se="search_artists",ke="search_playlists",Le="search_global_playlists",Be="search_audios",Re="own_conversations",xe="own_messages",Fe="own_albums",Ne="own_videos",Ue="video_playlists",We="search_videos",Ke="serps",Ve="SERPS_LOGS_DATA_LOCK",He=180,je=100,$e="",Ge="user",qe="group",Ye="app",ze="event",Xe="public",Qe="grid",Ze="list";function Je(e,t,o,s="",a=void 0,r=void 0){let _=0,u="",d=0,l=1,c=0,p=0;return e&&((0,i.isArray)(o)||(o=[o]),o.some((o=>{const i=e.classList.contains(o)?e:(0,n.gpeByClass)(o,e);let m=0;if(i){let o;if(o=s?document.querySelectorAll(s):i.parentNode.children,o){if(_=[...o].indexOf(i)+1,_&&a)for(const e in a)if(a.hasOwnProperty(e)){const t=document.querySelectorAll(a[e]);if(t){const o=[...t].indexOf(i)+1;if(o){d=o,u=e;break}}l++,m++}if(r)for(const t of r){const o=(0,n.gpeByClass)(t,e);o&&(l=o.getAttribute("data-block-num"))}return[c,p]=t(i,m),!0}}}))),[_,c,p,u,d,l]}function et(e,t,o,i,s,a,r){if(!l[e])return;const _=r.target;if(_&&_.classList)switch(e){case c:return void function(e,t,o,i,s,a){if(!t)return;const r=a.classList,_=a.outerHTML,d=a.tagName;let[,l,c,p,m]=Je(a,(e=>{let t=e.getAttribute("id")||e.getAttribute("data-id");return t=t?t.replace("gl_groups","").replace("gl_admin",""):0,[0,"-"+t]}),["_gl_row","search_row"],"#groups_list_tab_groups ._gl_row, #groups_list_search_wrap ._gl_row, #results .search_row, #groups_list_search_wrap .search_row",{[Pe]:"#groups_list_tab_groups ._gl_row",[Te]:"#groups_list_search_wrap ._gl_row, #groups_list_search_wrap .search_row"});if(!m)return;p===Pe&&(i=0,s="");let h=j;if(r.contains("group_row_title")||r.contains("group_row_img")||r.contains("highlight")||r.contains("search_item_img")||"A"===d&&-1!==_.indexOf("return nav.go")){let e=(0,n.gpeByClass)("group_list_row",a)||(0,n.gpeByClass)("groups_row",a);if(!e)return;if(e.hasAttribute("data-clicked"))return;e.setAttribute("data-clicked",!0),h=$}(u.FlatButton.isFlatButton(a)&&u.FlatButton.getAppearance(a)!==u.FlatButtonAppearance.SECONDARY||r.contains("search_sub_button"))&&(h=G);(u.FlatButton.isFlatButton(a)&&u.FlatButton.getAppearance(a)===u.FlatButtonAppearance.SECONDARY||r.contains("search_unsub_button"))&&(h=q);if(p===Pe&&-1!==_.indexOf("GroupsList.subscribe")){if(r.contains("ui_actions_menu"))return;h=G,!cur.scrollList.deleted[-c]&&(h=q)}if(p===Pe&&-1!==_.indexOf("GroupsList.toggleFave")){if(r.contains("ui_actions_menu"))return;h=Y,"1"===a.getAttribute("data-value")&&(h=z)}if(h===j)return;st(),h===$&&it(Ae,e,p,m,o,t,c,l,i,s);rt(e,p,m,h,o,t,c,l,i,s,$e)}(e,t,o,i,s,_);case m:return(0,d.partConfigEnabled)("search_communities_web_blocks_enabled")?void function(e,t,o,i,s,a,r){const _=r.classList,u=r.tagName,d=r.outerHTML,l=Boolean(r?.closest(".block_geo_groups"))||Boolean(r?.closest(".search_communities_block.section_page"))?Oe:Ie,c=r?.closest(".search_row")?.dataset?.id||0,p=(()=>{const e=document.querySelector("#results .block_user_groups"),t=document.querySelector("#results .block_other_groups"),o=document.querySelector("#results .block_geo_groups"),i=document.querySelector("#results .search_communities_block.section_page");if(o&&r?.closest(".block_geo_groups")){const e=[...o.querySelectorAll(".search_row")].findIndex((e=>+e?.dataset?.id==+c));if(-1!==e)return e+1}return[...e?.querySelectorAll(".search_row")||[],...t?.querySelectorAll(".search_row")||[],...i?.querySelectorAll(".search_row")||[]].findIndex((e=>+e?.dataset?.id==+c))+1})(),m=document.querySelector("#results .block_geo_groups")?l===Oe?1:2:1;if(!p)return;let h=j;if(_.contains("search_item_img")||_.contains("highlight")||"A"===u&&-1!==d.indexOf("return nav.go")){let e=(0,n.gpeByClass)("groups_row",r);if(!e)return;if(e.hasAttribute("data-clicked"))return;e.setAttribute("data-clicked",!0),h=$}_.contains("search_sub_button")&&(h=G);_.contains("search_unsub_button")&&(h=q);if(h===j)return;st(),h===$&&it(Ae,e,l,p,o,t,c,0,i,s,a,m);rt(e,l,p,h,o,t,c,0,i,s,$e,"",a,m)}(e,t,o,i,s,a,_):void function(e,t,o,i,s,a,r){if(!t)return;const _=r.classList,u=r.outerHTML,d=r.tagName;let[l,c,p]=Je(r,(e=>{let t=e.getAttribute("data-id");return t||(t=0),[0,"-"+t]}),"search_row","#results .search_row");const m=r?.closest(".search_communities_block.section_page")?Oe:be;if(!l)return;let h=j;if(_.contains("search_item_img")||_.contains("highlight")||"A"===d&&-1!==u.indexOf("return nav.go")){let e=(0,n.gpeByClass)("groups_row",r);if(!e)return;if(e.hasAttribute("data-clicked"))return;e.setAttribute("data-clicked",!0),h=$}_.contains("search_sub_button")&&(h=G);_.contains("search_unsub_button")&&(h=q);if(h===j)return;st(),h===$&&it(Ae,e,m,l,o,t,p,c,i,s);rt(e,m,l,h,o,t,p,c,i,s,$e,"",a)}(e,t,o,i,s,a,_);case p:return void function(e,t,o,i,s,a){if(!t)return;const r=a.classList,_=a.outerHTML,u=a.tagName;let[d,l,c]=Je(a,(e=>{let t=e.getAttribute("data-id");return t||(t=0),[0,"-"+t]}),"search_row","#results .search_row"),p=j;if(r.contains("search_item_img")||r.contains("highlight")||"A"===u&&-1!==_.indexOf("return nav.go")){let e=(0,n.gpeByClass)("groups_row",a);if(!e)return;if(e.hasAttribute("data-clicked"))return;e.setAttribute("data-clicked",!0),p=$}r.contains("search_sub_button")&&(p=G);r.contains("search_unsub_button")&&(p=q);if(p===j)return;st(),p===$&&it(Ae,e,be,d,o,t,c,l,i,s);rt(e,be,d,p,o,t,c,l,i,s,$e)}(e,t,o,i,s,_);case h:return void function(e,t,o,i,s,a){const r=a.classList,_=a.outerHTML,u=a.parentElement?a.parentElement.classList:null;let[d,l,c]=Je(a,(e=>{let t=e.getAttribute("data-id");return t||(t=0),[0,"-"+t]}),"search_row","#groups_list_in_tab_search_all .search_row");if(!d)return;let p=j;if(r.contains("search_item_img")||-1!==_.indexOf("return nav.go")&&u&&u.contains("title")){let e=(0,n.gpeByClass)("search_row",a);if(!e)return;if(e.hasAttribute("data-clicked"))return;e.setAttribute("data-clicked",!0),p=$}r.contains("search_sub_button")&&(p=G);r.contains("search_unsub_button")&&(p=q);if(p===j)return;st(),p===$&&it(Ae,e,be,d,o,t,c,l,i,s);rt(e,be,d,p,o,t,c,l,i,s,$e)}(e,t,o,i,s,_);case y:case V:return void function(e,t,o,i,s,a){const r=a.classList,_=a.outerHTML,u=a.tagName;let[,d,l,c,p]=Je(a,(e=>{let t=e.getAttribute("id");return t=t?t.replace("friends_user_row",""):0,[0,t]}),"friends_user_row","#list_content .friends_user_row, #friends_search_cont .friends_user_row",{[Pe]:"#list_content .friends_user_row",[Te]:"#friends_search_cont .friends_user_row"});if(!p)return;let m=j;c===Pe&&-1!==_.indexOf("showWriteMessageBox")&&(m=X);c===Pe&&-1!==_.indexOf("deleteFriend")&&(m=Z);c===Pe&&r.contains("friends_restore_link")&&(m=J);r.contains("ui_zoom_icon")&&(m=ee);c===Te&&a.id&&-1!==a.id.indexOf("friends_subsc")&&(m=Q);c===Te&&a.id&&-1!==a.id.indexOf("friends_unsubsc")&&(m=Z);if(r.contains("friends_photo_img")||c===Pe&&"A"===u&&-1!==_.indexOf("return nav.go")||c===Te&&"A"===u&&0===r.length){let e=(0,n.gpeByClass)("friends_user_row",a);if(!e)return;if(e.hasAttribute("data-clicked"))return;e.setAttribute("data-clicked",!0),m=$}if(m===j)return;st(),m===$&&it(we,e,c,p,o,t,l,d,i,s);rt(e,c,p,m,o,t,l,d,i,s,$e)}(e,t,o,i,s,_);case E:return void function(e,t,o,i,s,a){const r=a.classList,_=a.outerHTML,u=a.parentElement?a.parentElement.classList:null;if(!t)return;let[d,l,c]=Je(a,(e=>[0,e.getAttribute("data-id")||0]),"search_row","#results .search_row");if(!d)return;let p=j;if(r.contains("search_item_img")||-1!==_.indexOf("return nav.go")&&u&&u.contains("name")){let e=(0,n.gpeByClass)("people_row",a);if(!e)return;if(e.hasAttribute("data-clicked"))return;e.setAttribute("data-clicked",!0),p=$}r.contains("search_sub_button")&&(p=Q);r.contains("search_unsub_button")&&(p=Z);if(p===j)return;st(),p===$&&it(we,e,be,d,o,t,c,l,i,s);rt(e,be,d,p,o,t,c,l,i,s,$e)}(e,t,o,i,s,_);case f:return void function(e,t,o,i,s,a,r){const _=r.classList,u=r.outerHTML,d=r.parentElement?r.parentElement.classList:null;if(!t)return;let[l,c,p]=Je(r,(e=>[0,e.getAttribute("data-id")||0]),"search_row","#results .search_row");if(!l)return;let m=j;if(_.contains("search_item_img")||_.contains("AvatarRich")||(-1!==u.indexOf("return nav.go")||-1!==u.indexOf("searcher.openProfileNps"))&&d&&(d.contains("name")||d.contains("img"))){let e=(0,n.gpeByClass)("people_row",r);if(!e)return;if(e.hasAttribute("data-clicked"))return;e.setAttribute("data-clicked",!0),m=$}_.contains("search_sub_button")&&(m=Q);_.contains("search_unsub_button")&&(m=Z);if(m===j)return;st(),m===$&&it(we,e,be,l,o,t,p,c,i,s);rt(e,be,l,m,o,t,p,c,i,s,$e,"",a)}(e,t,o,i,s,a,_);case T:return void function(e,t,o,i,s,a){const r=a.classList,_=a.outerHTML;let[u,d,l]=Je(a,(e=>{let t=e.getAttribute("data-id");return t||(t=0),[0,t]}),"_bookmark_page_item");if(!u)return;let c=j;if(r.contains("group_link")||r.contains("bookmark_page_item__image")){let e=(0,n.gpeByClass)("_bookmark_page_item",a);if(!e)return;if(e.hasAttribute("data-clicked"))return;e.setAttribute("data-clicked",!0),c=$}(r.contains("ui_zoom")||r.contains("ui_zoom_icon"))&&(c=ee);-1!==_.indexOf("Bookmarks.removeBookmark")&&(c=z);if(c===j)return;st(),c===$&&it(Ae,e,be,u,o,t,l,d,i,s);rt(e,be,u,c,o,t,l,d,i,s,$e)}(e,t,o,i,s,_);case I:return void function(e,t,o,i,s,a){const r=a.classList,_=a.outerHTML,[u,d,l]=Je(a,(e=>{let t=e.getAttribute("data-id");return t||(t=0),[0,t]}),"_bookmark_page_item");if(!u)return;let c=j;if(r.contains("mem_link")||r.contains("bookmark_page_item__image")){let e=(0,n.gpeByClass)("_bookmark_page_item",a);if(!e)return;if(e.hasAttribute("data-clicked"))return;e.setAttribute("data-clicked",!0),c=$}(r.contains("ui_zoom")||r.contains("ui_zoom_icon"))&&(c=ee);-1!==_.indexOf("Bookmarks.removeBookmark")&&(c=z);if(c===j)return;st(),c===$&&it(we,e,be,u,o,t,l,d,i,s);rt(e,be,u,c,o,t,l,d,i,s,$e)}(e,t,o,i,s,_);case P:!function(e,t,o,i,s,a){const r=a.classList,_=a.tagName;let u=(0,n.gpeByClass)("ap_layer_wrap",a);if(u)return;let d=(0,n.gpeByClass)("search_results",a);if(!d)return;let[l,c,p]=Je(a,(e=>{let t=e.getAttribute("data-full-id");return t&&t.indexOf("_")?t.split("_"):[0,0]}),"_audio_row");if(!l)return;let m=j;(r.contains("audio_row__cover_icon")||r.contains("audio_row__performer_title")||r.contains("audio_row__title")||r.contains("audio_row__title_inner")||r.contains("audio_row__title_inner_subtitle")||r.contains("audio_row__inner")||r.contains("audio_player__place")||r.contains("audio_row__action_next")||r.contains("audio_row__performers"))&&(m=ie);r.contains("audio_row__action_add")&&(m=te);"A"===_&&(m=se);if(m===j)return;rt(e,be,l,m,o,t,p,c,i,s,$e)}(e,t,o,i,s,_);break;case D:return void function(e,t,o,i,s,a,n){const r=n.classList;let[_,u,d]=Je(n,(e=>{let t=e.getAttribute("data-id");return t&&t.indexOf("_")?t.split("_"):[0,0]}),"_video_item","#results ._video_item");if(!_)return;let l=j;(r.contains("video_thumb_play")||r.contains("video_item_controls")||r.contains("video_thumb_label_item")||r.contains("video_thumb_label")||r.contains("video_item_title")||r.contains("mv_subtitle"))&&(l=ie);(r.contains("icon_add")||r.contains("video_thumb_action_add")||r.contains("VideoCard__action--add"))&&(l=te);r.contains("icon_added")&&(l=oe);r.contains("group_link")&&(l=ae);r.contains("al_need_login")&&(l=se);r.contains("mem_link")&&(l=ne);if(l===j)return;rt(e,be,_,l,o,t,d,u,i,s,$e,"",a)}(e,t,o,i,s,a,_);case S:return void function(e,t,o,i,s,a,n){const r=n.classList;let[_,u,d]=Je(n,(e=>{let t=e.parentNode.getAttribute("href");return t=t.replace("/clip",""),t&&t.indexOf("_")?t.split("_"):[0,0]}),"ShortVideoGridItem__thumb",".ShortVideoGridItem__thumb");if(!_)return;let l=j;r.contains("ShortVideoGridItem__thumb")&&(l=ie);if(l===j)return;rt(e,be,_,l,o,t,d,u,i,s,$e,"",a)}(e,t,o,i,s,a,_);case x:return void function(e,t,o,i,s,a){const n=a.classList,r=a.tagName,_=a.parentElement?a.parentElement.classList:null,[,u,d,l,c]=Je(a,((e,t)=>{let o="";switch(t){case 1:case 4:case 2:o=e.getAttribute("data-full-id");break;case 0:case 3:case 6:o=e.getAttribute("data-raw-id")}return o&&o.indexOf("_")?o.split("_"):o?[o,0]:[0,0]}),["_audio_pl_item","audio_block_small_item","_audio_row","_video_item"],"\n        ._audio_section__search ._audio_pl_item,\n        ._audio_section__search ._audio_row,\n        ._audio_section__search .audio_block_small_item,\n        ._audio_section__search .video_item,\n        ._audio_search_blocks ._audio_row,\n        ._audio_search_blocks ._video_item,\n        ._audio_search_blocks ._audio_pl_item,\n        ._audio_search_blocks .audio_block_small_item\n      ",{[ke]:".CatalogBlock__search_global_albums ._audio_pl_item",[De]:".CatalogBlock__search_owned_audios ._audio_row",[Be]:".CatalogBlock__search_global_audios ._audio_row",[Se]:".CatalogBlock__search_global_artists .audio_block_small_item",[Me]:".CatalogBlock__search_global_clips .video_item",[Ce]:'._audio_page_block__playlists_items[data-audio-context="search_owned_playlist"] ._audio_pl_item',[Le]:".CatalogBlock__search_global_playlists ._audio_pl_item"});if(!c)return;let p=j;n.contains("audio_row__action_more")||_&&_.contains("audio_row__actions")||(p=ie);n.contains("audio_row__action_next")&&(p=ie);l===De&&n.contains("audio_row__action_recoms")&&(p=_e);l===De&&n.contains("audio_row__action_delete")&&(p=oe);l===De&&n.contains("audio_row__action_add")&&(p=te);l===Be&&n.contains("audio_row__action_add")&&(p=te);l===Me&&n.contains("icon_add")&&(p=te);l===Me&&n.contains("icon_added")&&(p=oe);l===Se&&"A"===r&&(p=se);if(p===j)return;rt(e,l,c,p,o,t,d,u,i,s,$e)}(e,t,o,i,s,_);case k:return void function(e,t,o,i,s,a){const r=a.classList;let _=a;r.contains("ts_contact")||(_=(0,n.gpeByClass)("ts_contact",a,"div#ts_cont_wrap"));let[u,d,l]=Je(_,(()=>[0,(_.id||"").replace("ts_contact","")]),"ts_contact","#ts_cont_wrap .ts_contact");if(!u)return;let c=$,p=$e;switch(_.getAttribute("hinttype")){case"h_friends":p=Ge,r.contains("ts_contact_status")&&(c=X);break;case"h_mutual_friends":case"s_people":case"h_mail_peers":p=Ge;break;case"h_vk_apps":case"h_apps":p=Ye;break;case"h_events":p=ze;break;case"h_publics":p=Xe;break;case"h_visited":case"s_groups":p=qe}rt(e,be,u,c,o,t,l,d,i,s,p)}(e,t,o,i,s,_);case N:return void function(e,t,o,i,s,a,n){const r=n.classList;let[,_,u,l,c]=Je(n,((e,t)=>{let o="";switch(t){case 1:case 3:o=e.getAttribute("data-id");break;case 2:o=e.getAttribute("data-name")}return o&&o.indexOf("_")?o.split("_"):[0,0]}),["video_playlist_item","_video_item","ui_gallery_item"],"\n        #video_layout_search .video_playlist_item,\n        #video_layout_search ._video_item,\n        #video_subtab_pane_search_promo_albums .ui_gallery_item\n      ",{[Fe]:"#video_subtab_pane_search_albums .video_playlist_item",[Ne]:"#video_subtab_pane_search_videos ._video_item",[Ue]:"#video_subtab_pane_search_promo_albums .ui_gallery_item",[We]:"#video_subtab_pane_search_global_videos ._video_item"});if(!c)return;let p=j;(r.contains("icon_add")||r.contains("video_thumb_action_add")||r.contains("VideoCard__action--add"))&&(p=te);r.contains("icon_added")&&(p=oe);const m=(0,d.partConfigEnabled)("video_remove_restore_video_act")?"video-restore-button-widget"===n.id:r.contains("video_restore_act");l===Ne&&m&&(p=te);l===Ne&&r.contains("video_thumb_action_delete")&&(p=oe);(r.contains("video_item_title")||r.contains("video_item_controls")||r.contains("video_thumb_label_item")||r.contains("video_thumb_play"))&&(p=ie);r.contains("group_link")&&(p=ae);r.contains("al_need_login")&&(p=se);r.contains("mem_link")&&(p=ne);p===j&&l===Ue&&(r.contains("VideoCard__controlsOverlay")||r.contains("VideoCard__title")||r.contains("VideoCard__icon")||r.contains("VideoCard__controlsOverlayText"))&&(p=$);if(p===j)return;rt(e,l,c,p,o,t,u,_,i,s,$e,"",a)}(e,t,o,i,s,a,_);case U:case K:return void function(e,t,o,i,s,a){const r=a.classList;let _=Qe;const u=(0,n.gpeByClass)("market_row_line",a,".marketplace_content_search");u&&(_=Ze);const d=_===Qe?"_market_row":"market_row_line";let[l,c,p]=Je(a,(e=>[0,e.getAttribute("data-id")||0]),d,"#marketplace_content ."+d);if(!l)return;let m=j;switch(_){case Ze:(r.contains("market_row_img")||r.contains("link"))&&(m=$),r.contains("market_favourite")&&!r.contains("selected")&&(m=Y),r.contains("market_favourite")&&r.contains("selected")&&(m=z),r.contains("mem_link")&&(m=ne),r.contains("group_link")&&(m=ae);break;case Qe:m=$,(r.contains("icon")||r.contains("fav"))&&(m=Y)}if(m===j)return;rt(e,be,l,m,o,t,p,c,i,s,$e)}(e,t,o,i,s,_);case W:return void function(e,t,o,i,s,a){const n=a.classList,r="ClassifiedsCatalogProduct__serpItem",[_,u,d]=Je(a,(e=>[+e.getAttribute("data-owner-id"),+e.getAttribute("data-id")]),r);if(!_)return;let l=j;n.contains("ClassifiedsCatalogProduct__serpTap")&&(l=$);n.contains("MarketplaceCatalogProductFavouriteButton--favorite")&&(l=Y);n.contains("MarketplaceCatalogProductFavouriteButton--notFavorite")&&(l=z);n.contains("ClassifiedsCatalogProduct__serpOwnerGroup")&&(l=ae);n.contains("ClassifiedsCatalogProduct__serpOwnerUser")&&(l=ne);if(l===j)return;rt(e,be,_,l,o,t,d,u,i,s,$e)}(e,t,o,i,s,_);case R:return void function(e,t,o,i,s,a){let[,n,r,_,u]=Je(a,(e=>{let t=e.getAttribute("data-peer");return t||(t=0),[0,t]}),"_im_dialog","._im_page_dcontent ._im_dialog",{[Re]:"._im_page_dcontent ._im_dialog:not(._im_search)",[xe]:"._im_page_dcontent ._im_dialog._im_search"});if(!u)return;rt(e,_,u,$,o,t,r,n,i,s,$e)}(e,t,o,i,s,_);case B:return void function(e,t,o,i,s,a){const n=a.classList,r=a.outerHTML;let[,_,u,d,l]=Je(a,(e=>{let t=e.getAttribute("id");return t&&(t=t.replace("docs_file_","")),t&&t.indexOf("_")?t.split("_"):[0,0]}),"_docs_item","#docs_list ._docs_item, #docs_search_list ._docs_item",{[Pe]:"#docs_list ._docs_item",[Te]:"#docs_search_list ._docs_item"});if(!l)return;let c=j;d===Te&&n.contains("docs_add_row")&&(c=te);d===Pe&&n.contains("docs_delete_row")&&(c=oe);d===Pe&&-1!==r.indexOf("Docs.restoreItem")&&(c=te);d===Pe&&n.contains("docs_edit_row")&&(c=de);(n.contains("highlight")||n.contains("docs_item_thumb_img")||n.contains("docs_item_icon")||n.contains("docs_item_name"))&&(c=$);-1!==r.indexOf("Docs.tagSearch")&&(c=ue);if(c===j)return;rt(e,d,l,c,o,t,u,_,i,s,$e)}(e,t,o,i,s,_);case O:case C:return void function(e,t,o,i,s,a){const[n,r,_]=Je(a,(e=>{let t=e.getAttribute("id");return t=t?t.replace("app",""):0,[0,t]}),"_apps_cat_row");if(!n)return;let u=$;if(u===j)return;rt(e,be,n,u,o,t,_,r,i,s,$e)}(e,t,o,i,s,_);case H:return void function(e,t,o,i,s,a){const n=a.classList,[r,_,u]=Je(a,(e=>[0,e.getAttribute("data-app-id")||0]),"GameCatalogSearchCard");if(!r)return;let d=j;(n.contains("GameCatalogSearchCard__screenshotImg")||n.contains("GameCatalogSearchCard__run")||n.contains("GameCatalogSearchCard__avatar")||n.contains("GameCatalogSearchCard__name"))&&(d=ie);if(d===j)return;rt(e,be,r,d,o,t,u,_,i,s,$e)}(e,t,o,i,s,_);case L:return void function(e,t,o,i,s,a){const[n,r,_]=Je(a,(()=>{let e=a.getAttribute("href")||"";e=e.replace("/photo","");let t=e.split("_");return 2!==t.length?[0,0]:[t[0],t[1]]}),"page_post_thumb_wrap","._feed_rows .page_post_thumb_wrap");if(!n)return;rt(e,be,n,$,o,t,_,r,i,s,$e)}(e,t,o,i,s,_);case g:case v:case A:case w:case b:return void function(e,t,o,i,s,a){const r=a.classList,_=a.outerHTML,u=(0,n.gpeByClass)("replies",a,".post");if(u)return;let d="feed_row",l="";e!==w&&e!==g&&e!==v||(d="post");e!==g&&e!==v||(l="#page_search_posts .post");const[c,p,m]=Je(a,(e=>{let t;if(e.classList.contains("post"))t=e;else{const o=e.getElementsByClassName("post");if(0===o.length)return[0,0];t=o[0]}if(!t)return[0,0];const o=(t.getAttribute("data-post-id")||"").split("_");return 2===o.length?o:[0,0]}),d,l);if(!c)return;let h=j;const y=(0,n.gpeByClass)("wall_text",a,".post");(y||r.contains("wall_text"))&&(h=$);(r.contains("author")||r.contains("post_img")||r.contains("copy_author")||r.contains("copy_post_img")||r.contains("_copy_post_img")||r.contains("PostHeader__avatar"))&&(h=re);const f=(0,n.gpeByClass)("PostHeaderSubtitle__link",a,"_post");(r.contains("rel_date")||r.contains("published_by_date")||f)&&(h=$);const E=(0,n.gpeByClass)("like",a,".post"),A=(0,n.gpeByClass)("PostBottomActionContainer",a,"_post");(E||r.contains("like")||A)&&(h=le);const b=(0,n.gpeByClass)("comment",a,".post");(b||r.contains("comment"))&&(h=ce);const P=(0,n.gpeByClass)("share",a,".post");(P||r.contains("share"))&&(h=pe);r.contains("ui_actions_menu_item")&&-1!==_.indexOf("bookmarkPost")&&(h=Y);r.contains("ui_actions_menu_item")&&-1!==_.indexOf("wall.markAsSpam")&&(h=he);const T=(0,n.gpeByClass)("PostTextMore",a,"_post");T&&(h=me);if(h===j)return;rt(e,be,c,h,o,t,m,p,i,s,$e)}(e,t,o,i,s,_);case F:case M:return void function(e,t,o,i,s,a){const n=a.classList,r=a.tagName,[_,u,d]=Je(a,(e=>{let t=e.getAttribute("id");return t=t?t.replace("app",""):0,[0,t]}),"_apps_settings_row");if(!_)return;let l=j;n.contains("apps_settings_stats")&&(l=ye);"A"!==r&&"img"!==r||(l=$);if(l===j)return;rt(e,be,_,l,o,t,d,u,i,s,$e)}(e,t,o,i,s,_)}}function tt(){const e=window.vk.id;let t={[e]:{}};const o=_.vkLocalStorage.getItem(Ke);if(!o)return t;try{t=JSON.parse(o)}catch(e){t={}}return t&&e&&(t={...t,[e]:{...t[e]}}),t}function ot(e){if("locked"===_.vkLocalStorage.getItem(Ve))setTimeout((()=>ot(e)),100);else{_.vkLocalStorage.setItem(Ve,"locked");try{e()}catch(e){}_.vkLocalStorage.setItem(Ve,"free")}}function it(e,t,o,i,s,a,n,r,u,d,l=!1,c=0){ot((()=>{const p=window.vk.id;let m=Math.round(+new Date/1e3),h=tt();h[p][e]=h[p][e]||{};const y=Object.keys(h[p][e]);if(y.length>=je){let t=y[0],o=h[p][e][t][0];y.forEach((i=>{let s=h[p][e][i][0];s<o&&(o=s,t=i)})),delete h[p][e][t]}h[p][e][n]=[m,t,o,i,s,a,r,u,d,l,c],_.vkLocalStorage.setItem(Ke,JSON.stringify(h))}))}function st(){ot((()=>{let e=tt();if(!e)return;const t=Math.round(+new Date/1e3);Object.keys(e).forEach((o=>{Object.keys(e[o]).forEach((i=>{let s=e[o][i];Object.keys(s).forEach((e=>{let o=s[e][0];t-o>He&&delete s[e]})),e[o][i]=s,0===Object.keys(s).length&&delete e[o][i]}))})),_.vkLocalStorage.setItem(Ke,JSON.stringify(e))}))}function at(e,t,o){const i=window.vk.id;let s=tt();s[i][e]=s[i][e]||{};const a=s[i][e][t];if(!a)return;Math.round(+new Date/1e3)-a[0]>He?nt(!0,e,t):rt(a[1],a[2],a[3],o,a[4],a[5],t,a[6],a[7],a[8],$e,"",a[9],a[10])}function nt(e,t,o){e&&ot((()=>{const e=window.vk.id;let i=tt();i[e][t]=i[e][t]||{},i[e][t][o]&&(delete i[e][t][o],_.vkLocalStorage.setItem(Ke,JSON.stringify(i)))}))}function rt(e,t,o,i,s,a,n,_,u,d,l,c="",p=!1,m=0){if(!o)return;const h=-(new Date).getTimezoneOffset();(0,r.statlogsValueEvent)("search_position",e,l,i,t,o,p,_,n,a,h,s,u,d,c,m)}function _t(){for(let e in l)l.hasOwnProperty(e)&&ut(e)}function ut(e){if(l[e]){const t=l[e];(0,s.removeEvent)(window,"click",t),delete l[e]}}function dt(e,t){const o=t||e.target.getAttribute("data-stats-key");o&&o.length>0&&(0,r.statlogsValueEvent)("submenu_clicks",0,o)}function lt(e,t,o,i,a="0",n=0,_="0",u="",d=be,c="",p=!1,m=0,h=null,y=0,f=!1){o=o?1:0,a=a&&"0"!==a?a:ct(),f||function(e,t,o,i,s,a,n,_,u="",d=!1,l=0,c=0,p=0){const m=-(new Date).getTimezoneOffset();(0,r.statlogsValueEvent)("search_attempts",e,d,a,i,m,o,n,s,_,t,u,l,c,p)}(e,d,a,i,_,o,n,u,c,p,m,h,y),l[e]&&ut(e);const E=et.pbind(e,i,a,n,u,p);l[e]=E,(0,s.addEvent)(window,"click",E,!1,!1,!0),cur.destroy||(cur.destroy=[]),cur.destroy.some((e=>e===_t))||cur.destroy.push(_t)}function ct(){return(0,a.rand)(-9223372035,9223372035).toFixed(0).concat((0,a.rand)(0,999999999).toFixed(0))}},119243:(e,t,o)=>{"use strict";o.r(t),o.d(t,{sendMask:()=>f,showNarrative:()=>p,showStory:()=>c,storiesPreloadStatic:()=>h});var i=o(20025),s=o(850101),a=o(645024),n=o(134020),r=o(452314),_=o(610390),u=o(169834);let d=!1,l=!1;function c(e,t={},o=void 0){if(cur.storiesNotSupported)return void(0,i.showFastBox)(a.getLang("global_error"),a.getLang("stories_bad_browser"));(0,_.trackStoryOpeningStart)(e,{isColdStart:!l,isAnimated:null!=t.fromEl,viewSource:t.source,navigationSource:u.StoryTypeOpen.OPEN_STORY_BY_CLICK});const s=`stories_viewer_loader_${performance.now()}`;let c=!1;clearTimeout(d),d=setTimeout((function(){document.body.appendChild((0,r.ce)("div",{id:"stories_loader",innerHTML:(0,n.getProgressHtml)("stories_loader_pr","pr_baw pr_medium")+'<div class="back"></div>'})),c=!0,(0,_.trackShowViewerLoader)(s,{isColdStart:!l})}),1e3);const p=[window.jsc("web/stories.js"),"stories.css",window.jsc("web/emoji.js"),window.jsc("web/videoview.js"),"videoplayer.css"];window.stManager.add(p,(function(){clearTimeout(d),(0,r.re)("stories_loader"),l=!0,c&&(0,_.trackHideViewerLoader)(s),window.Stories.show(e,t,o)}))}function p(e,t,o=0,i="",s={}){c(`${e}${o=o?`_${o}`:""}&${`narrative${t}`}/${i=i||`narrative${e}_${t}`}`,s)}let m=!1;function h(){m||cur.storiesNotSupported||(m=!0,window.stManager.add([window.jsc("web/stories.js"),"stories.css",window.jsc("web/story_publisher.js")]))}let y=!1;function f(e,t,o=!1){y||(y=!0,ajax.post("al_stories.php",{act:"send_mask",mask_id:e,hash:t,is_short_video:o},{loader:!0,onDone:(e,t,o,n)=>{"cant_send"===e?(0,i.showFastBox)({title:t,width:460},o,n):(0,s.showDoneBox)(a.getLang("stories_mask_sent")),y=!1},onFail:()=>(y=!1,(0,i.showFastBox)({title:a.getLang("global_box_error_title")},a.getLang("global_unknown_error")),!0)}))}},810903:(e,t,o)=>{"use strict";o.d(t,{destroyAllTooltips:()=>d,hideAllTooltips:()=>u,showHint:()=>_,showTitle:()=>r,showTooltip:()=>n});var i=o(452314),s=o(317412),a=o(879007);function n(e,t){(vk.loaded||t.noload)&&e&&(e.temphide||(e.temphide=function(){e.showing=!1},(0,s.addEvent)(e,"mouseout",e.temphide)),e.showing=!0,"loadingstat"!==e.tt&&(e.tt||(e.tt="loadingstat"),cur.cancelTooltip=!1,t.stat&&window.stManager.add(t.stat),window.stManager.add([window.jsc("web/tooltips.js"),"tooltips.css"],(function(){"loadingstat"===e.tt&&(e.tt=!1),e.showing&&!cur.cancelTooltip&&(!function(e){e.temphide&&((0,s.removeEvent)(e,"mouseout",e.temphide),(0,i.removeAttr)(e,"temphide"),(0,i.removeAttr)(e,"showing"))}(e),e.tt&&e.tt.el&&!t.force||(tooltips.create(e,t),t.onCreate&&t.onCreate()),tooltips.show(e,t))}))))}function r(e,t,o,s){e=(0,i.ge)(e);if(!o){o=[Math.round(20-(0,i.getSize)(e)[0]/2),8]}n(e,(0,a.extend)({text:function(){return t||e.getAttribute("data-title")},shift:o,black:1},s||{}))}function _(e,t){t=t||{};n(e=(0,i.ge)(e),(0,a.extend)({text:function(){return e.getAttribute("data-title")},dir:"auto",width:300,shift:[22,8]},t))}function u(e){tooltips.hideAll(e)}function d(e){tooltips.destroyAll(e)}},744025:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{VideoConstants:()=>VideoConstants,initVideo:()=>initVideo,loadInlineVideo:()=>loadInlineVideo,showInlineVideo:()=>showInlineVideo,showVideo:()=>showVideo});var _shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(490712),_web_lib_date__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(307188),_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(452314),_dom_events__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(317412),_utils_common__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(879007),_lang__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(645024),_message_box__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(20025),_layout_utils__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(134020),_web_unauthorized_unauthorized__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(253693),_web_video_video_utils__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(400281),_shared_lib_site__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(705744),_web_lib_revertLastInlineVideo__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(333976);const rtrgQuery=`//${(0,_shared_lib_site__WEBPACK_IMPORTED_MODULE_10__.getHostName)()}/rtrg?r=w*Z1Flwi3QdbWaoLMc7zOA*7Cr4Nrtojr9otHjsjIhsb2CVqRWalgbvxZw3MzxZa6be3Siu2XY3gvK5fysYtWLWgNwHMpjRTupSGZrcGRNlj7fduqq9*t7ij6CX4aMcBTD5be8mIXJsbTsvP8Zl2RZEd76a4FTuCOFqzMxqGtFc-`;function showVideo(e,t,o={},i){if(cur.viewAsBox)return cur.viewAsBox();if((0,_dom_events__WEBPACK_IMPORTED_MODULE_3__.checkEvent)(i))return;if((0,_web_unauthorized_unauthorized__WEBPACK_IMPORTED_MODULE_8__.isUnauthorizedMediaLayerBoxAvailable)()&&(i||o.openInPopup)&&!o.forceUnauth&&!cur.is_showcase)return _web_unauthorized_unauthorized__WEBPACK_IMPORTED_MODULE_8__.Unauthorized.showMoreBox(null,0,_web_unauthorized_unauthorized__WEBPACK_IMPORTED_MODULE_8__.UnauthorizedSourceType.VIDEO,(()=>{showVideo(e,t,{...o,openInPopup:!1,forceUnauth:!0},i)})),!1;if(o.forceUnauth=!0,window.mvcur&&mvcur.mvShown&&mvcur.minimized&&mvcur.videoRaw==e)return o.fromPlayer||Videoview.unminimize(),!1;const s=nav.objLoc.claim,a=!(!o.addParams||!/^-?\d+_\d+$/.test(o.addParams.post_id))&&o.addParams.post_id;if(!o.playlistId&&a&&(/^public|groups|profile$/.test(cur.module)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.hasClass)("post"+a,"own")?o.playlistId="wall_"+cur.oid:o.playlistId="post_"+o.addParams.post_id),o.playlistId)if(o.addParams=(0,_utils_common__WEBPACK_IMPORTED_MODULE_4__.extend)(o.addParams,{playlist_id:o.playlistId}),window.VideoPlaylist&&VideoPlaylist.getList(o.playlistId))e||(o.addParams.load_playlist=1);else if(/^wall_/.test(o.playlistId)){const e=cur.wallVideos&&cur.wallVideos[o.playlistId];o.addParams.load_playlist=e?.list.length>=50?0:1,o.addParams.show_next=e?.list.length>=1?1:0}else{const e=/^(?:post_)?-?\d+_-?\d+$/.test(o.playlistId)&&!(cur.pageVideosList&&cur.pageVideosList[o.playlistId]);o.addParams.load_playlist=e?1:0,o.addParams.show_next=e?1:0}o.expandPlayer||!cur.videoInlinePlayer||cur.videoInlinePlayer.getVideoId()!=e&&cur.videoInlinePlayer.getProjectId()!=e||!cur.videoInlinePlayer.canExpand()||(o.expandPlayer=cur.videoInlinePlayer),o.expandPlayer&&(o.addParams=(0,_utils_common__WEBPACK_IMPORTED_MODULE_4__.extend)(o.addParams,{expand_player:1}),delete cur.videoInlinePlayer),cur.simple_description&&(o.addParams=(0,_utils_common__WEBPACK_IMPORTED_MODULE_4__.extend)(o.addParams||{},{simple_description:cur.simple_description}));const n=new CallHub((function(){o.hidden?o.hidden(n.data,o,t,e):Videoview.showVideo.apply(Videoview,n.data)}),2);window.stManager.add([window.jsc("web/videoview.js"),"videoview.css",window.jsc("web/page.js"),"page.css"],(()=>{n.failed||(o.hidden||((0,_web_lib_revertLastInlineVideo__WEBPACK_IMPORTED_MODULE_11__.revertLastInlineVideo)(),Videoview.show(i,e,t,o)),n.done())})),(0,_utils_common__WEBPACK_IMPORTED_MODULE_4__.extend)(o,{onDone:function(){const t=Array.prototype.slice.call(arguments);t.unshift(e),n.data=t,n.done()},onFail:function(t){if(n.failed=1,!o.hidden){if(window.mvcur&&mvcur.mvShown)window.Videoview.hide();else{const t=(0,_utils_common__WEBPACK_IMPORTED_MODULE_4__.clone)(nav.objLoc);t.z==="video"+e&&delete t.z,t[0]==="video"+e&&(t[0]="videos"+e.split("_")[0]),nav.setLoc(t)}const o=t&&"object"==typeof t?t?.data:t;if((0,_message_box__WEBPACK_IMPORTED_MODULE_6__.showFastBox)(_lang__WEBPACK_IMPORTED_MODULE_5__.getLang("global_error"),o||_lang__WEBPACK_IMPORTED_MODULE_5__.getLang("global_error_occured")),window.Videoview?.isMinimized())if(mvcur&&mvcur.fallbackData){const{videoRaw:e,options:t,listId:o,mvData:i}=mvcur.fallbackData;mvcur.videoRaw=e,mvcur.options=t,mvcur.listId=o,mvcur.myData=i,mvcur.fallbackData=null,Videoview.initPlaylistBlock(e,t.playlistId,t.catLoadMore),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.show)("mv_player_box"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.hide)("mv_progress_box")}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.val)("mv_player_box","");n.done()}return!0},cache:"status"!==t}),window.VideoPlaylist&&(window.VideoPlaylist.module=null);let r=o.params;return r||(r={act:"show",video:e,list:t,autoplay:o.autoplay?1:0,ad_video:o.ad_video,module:o.module||window.Videoview&&window.Videoview.getVideoModule()||"",webcast:nav.objLoc.webcast?1:0,screen:nav.objLoc.screen?1:0}),cur.is_showcase&&!r.context&&cur.ref_context&&(r.context=cur.ref_context),o.addParams&&(r=(0,_utils_common__WEBPACK_IMPORTED_MODULE_4__.extend)(r,o.addParams)),(0,_utils_common__WEBPACK_IMPORTED_MODULE_4__.trim)(r.module)||(0,_utils_common__WEBPACK_IMPORTED_MODULE_4__.extend)(r,{_nol:JSON.stringify(nav.objLoc)}),r.module&&(window.VideoPlaylist&&(window.VideoPlaylist.module=r.module),o.is_similar&&(r.module+=":similar")),s&&(r.claim=s),ajax.post(`al_video.php?act=${r.act}`,r,o),(0,_web_video_video_utils__WEBPACK_IMPORTED_MODULE_9__.idlizeCall)((()=>{(0,_utils_common__WEBPACK_IMPORTED_MODULE_4__.vkImage)().src=`${locProtocol}${rtrgQuery}`})),!1}function showInlineVideo(videoId,listId,options,ev,thumb){if((0,_dom_events__WEBPACK_IMPORTED_MODULE_3__.checkEvent)(ev))return!0;if(options=options||{},window.mvcur&&mvcur.mvShown||options.hasRestriction)return showVideo(videoId,listId,options,ev);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.attr)(thumb,"data-loading"))return!1;const h=thumb.clientHeight,w=thumb.clientWidth,btn=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.domByClass)(thumb,"page_post_video_play_inline"),onLoaded=options.onLoaded;onLoaded&&delete options.onLoaded;const params={video:videoId,list:listId,autoplay:options.autoplay,module:options.module};return thumb.className.includes("page_video_croppable")&&(params.with_crop=!0),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.domData)(thumb,"stretch-vertical")&&(params.stretch_vertical=1),(0,_utils_common__WEBPACK_IMPORTED_MODULE_4__.extend)(params,options.addParams),window.VideoPlaylist&&(window.VideoPlaylist.module=params.module),showProgress(),loadInlineVideo(params,(function(e,t){hideProgress(),e?onDone.apply(null,t):onFail.apply(null,t)}),options.cache),cur.videoInlinePlayerDestroyerSet||(cur.destroy.push(_web_lib_revertLastInlineVideo__WEBPACK_IMPORTED_MODULE_11__._destroyInlineVideoPlayer),cur.videoInlinePlayerDestroyerSet=1),(0,_utils_common__WEBPACK_IMPORTED_MODULE_4__.vkImage)().src=rtrgQuery,!1;function onDone(title,html,js,opts){(0,_web_lib_revertLastInlineVideo__WEBPACK_IMPORTED_MODULE_11__.revertLastInlineVideo)(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.hide)(thumb);const isMt=thumb.dataset.mtId,isDirectMp4=!!thumb.dataset.directMp4,mtAspectRatio=thumb.dataset.mtAspectRatio?Number(thumb.dataset.mtAspectRatio):0,videoWrap=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.ce)("div",{innerHTML:html,className:"inline_video_wrap"},{width:w,height:isMt&&mtAspectRatio?Math.round(w*mtAspectRatio):h});if(opts&&opts.mvData&&-195297477!==opts.mvData.authorId&&(window._videoLastInlined=[videoWrap,thumb]),thumb.parentNode.appendChild(videoWrap),cur.mvOpts=!(!opts||!opts.mvData)&&opts.mvData,opts.player){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.domByClass)(videoWrap,"video_box_wrap");(0,_utils_common__WEBPACK_IMPORTED_MODULE_4__.isFunction)(onLoaded)&&(opts.player.params[0].onPlayerLoaded=onLoaded);const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.attr)(thumb,"data-link-attr");if(t&&(opts.player.params[0].link_attr=t),isMt){opts.player.params[0].ad_block_id=isMt;const e=thumb.dataset.mtVideoMp4;e&&(opts.player.params[0].direct_mp4=e);const t=thumb.dataset.mtVideoHls;t&&(opts.player.params[0].hls=t),mtAspectRatio&&(opts.player.params[0].aspect_ratio=mtAspectRatio);const o=thumb.firstChild&&thumb.firstChild.firstChild&&thumb.firstChild.firstChild.src;o&&(opts.player.params[0].jpg=o);const i=thumb.firstChild,s=i.dataset.mtLink,a=i.getAttribute("onclick");s&&(opts.player.params[0].link_attr=`href="${s}" onclick="${a}"`)}isDirectMp4&&(opts.player.params[0].direct_mp4=thumb.dataset.directMp4,opts.player.params[0].hls=void 0,opts.player.params[0].dash_sep=void 0,Object.keys(opts.player.params[0]).forEach((e=>{e.startsWith("url")&&(opts.player.params[0][e]=void 0)}))),VideoInitializer.initPlayer(e,opts.player.type,opts.player.params)}try{eval("(function () {"+js+"})();")}catch(e){}if(!params.from_autoplay){const e=window.Notifier;e&&setTimeout((()=>e.lcSend("video_start")),0);const t=window.ap;t&&t.isPlaying()&&(t.pauseByChangeChannel(),t.pausedByVideo=(0,_utils_common__WEBPACK_IMPORTED_MODULE_4__.vkNow)())}ev&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.domClosest)("bookmarks_row_type_video",ev.target)&&(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_0__.statlogsValueEvent)("bookmarks_product_analytics",{item_type:"video",item_owner_id:cur.mvOpts.oid,item_id:cur.mvOpts.vid,time:(0,_web_lib_date__WEBPACK_IMPORTED_MODULE_1__.getServerTime)()}),thumb.setAttribute("data-playing",1)}function onFail(e){params.from_autoplay||(0,_message_box__WEBPACK_IMPORTED_MODULE_6__.showFastBox)(_lang__WEBPACK_IMPORTED_MODULE_5__.getLang("global_error"),e||_lang__WEBPACK_IMPORTED_MODULE_5__.getLang("global_error_occured"))}function showProgress(){thumb.setAttribute("data-loading",1),options.no_progress||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.addClass)(btn,"page_post_video_play_inline_loading"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.val)(btn,(0,_layout_utils__WEBPACK_IMPORTED_MODULE_7__.getProgressHtml)()))}function hideProgress(){thumb.removeAttribute("data-loading"),options.no_progress||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.removeClass)(btn,"page_post_video_play_inline_loading"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.val)(btn,""))}}function loadInlineVideo(e,t,o){const i=(0,_utils_common__WEBPACK_IMPORTED_MODULE_4__.extend)({autoplay:0,module:cur.module},e);(0,_utils_common__WEBPACK_IMPORTED_MODULE_4__.trim)(i.module)||(i._nol=JSON.stringify(nav.objLoc));const s=[window.jsc("web/videoview.js"),"videoview.css"];function a(e,o){(0,_utils_common__WEBPACK_IMPORTED_MODULE_4__.isFunction)(t)&&t(e,o)}i.from_autoplay&&s.push("videoplayer.css"),ajax.post("al_video.php?act=video_box",i,{onDone:function(){a(!0,[].slice.call(arguments))},onFail:function(){return a(!1,[].slice.call(arguments)),!0},stat:s,local:1,cache:o})}const VideoConstants={VIDEO_ITEM_INDEX_OWNER_ID:0,VIDEO_ITEM_INDEX_ID:1,VIDEO_ITEM_INDEX_THUMB:2,VIDEO_ITEM_INDEX_TITLE:3,VIDEO_ITEM_INDEX_FLAGS:4,VIDEO_ITEM_INDEX_DURATION:5,VIDEO_ITEM_INDEX_HASH:6,VIDEO_ITEM_INDEX_OWNER:8,VIDEO_ITEM_INDEX_DATE:9,VIDEO_ITEM_INDEX_VIEWS:10,VIDEO_ITEM_INDEX_PLATFORM:11,VIDEO_ITEM_INDEX_BLOCKED:12,VIDEO_ITEM_INDEX_MUSIC_VIDEO_META:13,VIDEO_ITEM_INDEX_ARIA:14,VIDEO_ITEM_INDEX_RESTRICTION_BLOCK:15,VIDEO_ITEM_INDEX_RESTRICTION_CLASSES:16,VIDEO_ITEM_INDEX_ADMIN_INFO:17,VIDEO_ITEM_INDEX_CARD_MENU_TOGGLE:18,VIDEO_ITEM_INDEX_RAW_DURATION:19,VIDEO_ITEM_INDEX_LINK:20,VIDEO_ITEM_INDEX_TRAILER:21,VIDEO_ITEM_INDEX_VIEWED_DURATION:22,VIDEO_ITEM_INDEX_VIEWED_DAY:23,VIDEO_ITEM_INDEX_LIST_ID:24,VIDEO_ITEM_INDEX_PLAYLIST_ID:25,VIDEO_ITEM_INDEX_CARD_ACTIONS:26,VIDEO_ITEM_INDEX_CARD_PRIVACY_ICONS:27,VIDEO_ITEM_INDEX_SMALL_THUMB:28,VIDEO_ITEM_INDEX_ML_THUMB_ID:29,VIDEO_ITEM_INDEX_PLAY_FROM:30,VIDEO_ITEM_INDEX_RECOMMENDATION_SOURCES:31,VIDEO_ITEM_INDEX_RECOMMENDATION_USERS:32,VIDEO_ITEM_TRACK_CODE:33,VIDEO_ITEM_INDEX_SUBTITLE_PLACE:34,VIDEO_ITEM_INDEX_AVATAR_IMAGE:35,VIDEO_ITEM_INDEX_AVATAR_PLACE:36,VIDEO_ITEM_INDEX_DESCRIPTON:37,VIDEO_ITEM_INDEX_DOWNLOAD_URL:38,VIDEO_ITEM_INDEX_OWNER_HREF:39,VIDEO_ITEM_PUBLISH_DATE:40,VIDEO_ITEM_BOOKMARKED:41,VIDEO_ITEM_BOOKMARK_HASH:42,VIDEO_ITEM_INDEX_UPCOMING_LIVE_DATE:43,VIDEO_ITEM_INDEX_INTERACTIVE:44,VIDEO_ITEM_INDEX_LABEL_PLACE:45,VIDEO_TEMPLATE_INDEX_SUBTITLE_DURATION_WITH_VIEWS:0,VIDEO_TEMPLATE_INDEX_SUBTITLE_LABEL:1,VIDEO_TEMPLATE_INDEX_SUBTITLE_SCHEDULED:2,VIDEO_TEMPLATE_INDEX_SUBTITLE_UPCOMING_LIVE:3,VIDEO_ITEM_FLAG_EXTERNAL:1,VIDEO_ITEM_FLAG_ACTIVE_LIVE:2,VIDEO_ITEM_FLAG_CAN_DOWNLOAD:32,VIDEO_ITEM_FLAG_CAN_EDIT:64,VIDEO_ITEM_FLAG_CAN_DELETE:128,VIDEO_ITEM_FLAG_CAN_ADD:256,VIDEO_ITEM_FLAG_PRIVATE:512,VIDEO_ITEM_FLAG_NO_AUTOPLAY:1024,VIDEO_ITEM_FLAG_ADDED:2048,VIDEO_ITEM_FLAG_SKIP_THUMB_LOAD:4096,VIDEO_ITEM_FLAG_NEED_SIGN_IN:8192,VIDEO_ITEM_FLAG_HD:16384,VIDEO_ITEM_FLAG_DELETED:32768,VIDEO_ITEM_FLAG_CAN_MOVE:65536,VIDEO_ITEM_FLAG_CAN_DELETE_FROM_HISTORY:1<<17,VIDEO_ITEM_FLAG_PRIVATE_BY_LINK:1<<18,VIDEO_ITEM_FLAG_LIVE:1<<19,VIDEO_ITEM_FLAG_PRIVATE_NOT_PUBLISHED:1<<20,VIDEO_ITEM_FLAG_PRIVATE_MEMBERS:1<<21,VIDEO_ITEM_FLAG_HORIZONTAL:1<<22,VIDEO_ITEM_FLAG_NFT_AVATAR:1<<23,VIDEO_ITEM_FLAG_SCHEDULED:1<<24,VIDEO_ITEM_FLAG_CAN_BOOKMARK:1<<25,VIDEO_ITEM_FLAG_BOOKMARKED:1<<26,VIDEO_ITEM_FLAG_UPCOMING_LIVE:1<<27,VIDEO_ITEM_FLAG_INTERACTIVE:1<<28};function initVideo(){window._videoLastInlined=!1}},261180:(e,t,o)=>{"use strict";o.d(t,{processAliExpressMiniAppLinkClickEvent:()=>n});var i=o(528411),s=o(476726),a=o(705744);function n(e){const t=e.target||e.srcElement;if(t&&t.href){const e=t.href;let o,n;try{o=decodeURIComponent(e)}catch(e){return!1}if((0,s.partConfigEnabled)("aliexpress_app_links_redirect_web_links")){if(n=function(e){const t=[new RegExp(`(https?://)?${a.VK_SITE_REGEX_SOURCE_UNSAFE}/app${i.MARKET_ALIEXPRESS_APP_ID}(_6492794)?(#|/|#/)?$`),new RegExp(`(https?://)?${a.VK_SITE_REGEX_SOURCE_UNSAFE}/${i.MARKET_ALIEXPRESS_APP_NAME}(#|/|#/)?$`)];for(const o in t)if(e.match(t[o]))return"/away.php?to="+encodeURIComponent(i.MARKET_ALIEXPRESS_HOME_URL);return""}(o),n)return r(n,t),!0}else if(n=function(e){const t=e.match(new RegExp(`/app${i.MARKET_ALIEXPRESS_APP_ID}#(?:.+)product_id=(d+)`));if(t&&t[1])return"/away.php?to="+encodeURIComponent(`${i.MARKET_ALIEXPRESS_HOME_URL}/item/${t[1]}.html`)}(o),n)return r(n,t),!0}return!1}function r(e,t){"_blank"===t.getAttribute("target")&&void 0!==t.open?t.open(e):window.location.href=e}},953550:(e,t,o)=>{"use strict";o.d(t,{AppOrderBox:()=>l});var i=o(452314),s=o(610989),a=o(879007),n=o(850101),r=o(248298),_=o(20025),u=o(507035),d=o(984709);class l{static instantSkipAppOrder(e,t){const o=(0,i.gpeByClass)("payments_instant_progress_wrap",e);let s={act:"a_order",aid:cur.paymentsOrderAppId,order_id:cur.paymentsOrderId,votes:cur.paymentsPreferVotes,test_mode:cur.paymentsOrderTestMode,_skip_instant:t||1,hash:cur.paymentsOrderHash};void 0!==cur.checkedMaxVotes&&(s.checked_max_votes=cur.checkedMaxVotes),ajax.post("al_apps.php",s,{forceDone:1,onDone:()=>{cur.paymentsCheckOrderCnt=1,(0,n.curBox)().hide(),cur.paymentsCheckOrderCnt=0,cur.fromInstantPay=!0},showProgress:()=>o&&o.classList.add("loading"),hideProgress:()=>o&&o.classList.remove("loading")})}static processOrder(e,t){t||(t=(0,n.curBox)());const o=(0,i.isVisible)("payments_box")?2:0;let a=!1;e||(e=o),o&&(a=t.btns.ok[0],(0,r.lockButton)(a));let c={act:"a_order",aid:cur.paymentsOrderAppId,order_id:cur.paymentsOrderId,votes:cur.paymentsPreferVotes,from:nav.objLoc[0],test_mode:cur.paymentsOrderTestMode,_votes_ok:e,hash:cur.paymentsOrderHash};1==e&&cur.paymentsOrderBillPeriod&&(c.payment_type=cur.votesType),!cur.paymentsOrderBillPeriod&&(0,i.ge)("payments_order_auto_confirm")&&(c.auto_confirm=(0,r.isChecked)("payments_order_auto_confirm")),ajax.post("al_apps.php",c,{forceDone:3==+e?1:0,onDone:(c,p,m,h,y)=>{if(h&&-1e3!==h&&(cur.votesBoxOptions=h),3==e&&-1e3==m)return d.Gifts.processBoxOptions((0,n.curBox)(),h),cur.paymentsCheckOrderCnt=1,t.hide(),void(cur.paymentsCheckOrderCnt=0);if(0===m||m>0)return cur.paymentsPreferVotes=1,o?cur.paymentsShowBoxError(p):(t.hide(),(0,_.showFastBox)(s.getLang("global_error"),p)),void((cur.paymentsOrderBillPeriod||y)&&cur.onSubscriptionFail?cur.onSubscriptionFail(m):cur.onAppOrderFail&&cur.onAppOrderFail(m));if(c.result){let e=(0,n.curBox)();return cur.isPaymentsAppOrder=!1,e&&e.hide(),(0,n.showDoneBox)(p),c.balance&&(0,u.updateMoney)(c.balance),void(cur.onSubscriptionDone&&c.subscriptionStatus&&(cur.onSubscriptionDone(c.subscriptionStatus),cur.onSubscriptionDone=!1))}const f=c.orderId;if(!f)return void(cur.paymentGetOrderItemTO=setTimeout(l.processOrder.pbind(!1,t),1e3));p&&(t=(0,_.showFastBox)("",p)).setOptions({title:!1,width:520,bodyStyle:"padding: 0;",hideButtons:!0}),a&&(0,r.unlockButton)(a),cur.isPaymentsAppOrder=!1,cur.paymentsOrderId=f,c.subscriptionId&&(cur.paymentsSubscriptionId=c.subscriptionId),cur.paymentsOrderCheckHash=c.checkHash;const E=s.getLang("payments_waiting_app_order_complete");(0,i.ge)("payments_box_progress_msg_wrap")?((0,i.val)("payments_box_progress_msg_wrap",`<span id="payments_box_progress_msg">${E}</span>`),cur.paymentsShowProgress()):(0,i.val)("apps_paymentbox_progress_msg_wrap",E),cur.paymentsCheckOrderCnt=0,cur.paymentsCheckOrderInt=setInterval(l.checkOrder,2e3)},onFail:function(e){return!e||(cur.onSubscriptionFail?cur.onSubscriptionFail():cur.onAppOrderFail&&cur.onAppOrderFail(),(0,i.isVisible)("payments_box")?cur.paymentsShowBoxError(e):(t.hide(),(0,_.showFastBox)(s.getLang("global_error"),e)),!0)}})}static checkOrder(){if(15==cur.paymentsCheckOrderCnt)(0,i.ge)("payments_box_progress_msg").innerHTML=s.getLang("payments_waiting_payment_complete_still");else if(cur.paymentsCheckOrderCnt>30)return clearInterval(cur.paymentsCheckOrderInt),(0,n.curBox)().hide(),void(0,_.showFastBox)(s.getLang("payments_app_order_box_title"),s.getLang("payments_app_add_votes_delay"),s.getLang("global_close"),(()=>{cur.paymentsOrderBillPeriod&&cur.onSubscriptionCancel?cur.onSubscriptionCancel():cur.onAppOrderCancel&&cur.onAppOrderCancel(),(0,n.curBox)().hide()}));cur.paymentsCheckOrderCnt++,ajax.post("al_apps.php",{act:"a_check_order",aid:cur.paymentsOrderAppId,order_id:cur.paymentsOrderId,test_mode:cur.paymentsOrderTestMode,from:nav.objLoc[0],hash:cur.paymentsOrderCheckHash},{onDone:(e,t,o,i,s)=>{e&&((0,n.curBox)()&&(0,n.curBox)().hide(),clearInterval(cur.paymentsCheckOrderInt),cur.paymentsCheckOrderCnt=0,(0,n.showDoneBox)(t,{out:1e3}),o&&(0,u.updateMoney)(o),1==e?(cur.paymentsOrderBillPeriod&&cur.onSubscriptionSuccess?(cur.onSubscriptionSuccess(cur.paymentsSubscriptionId),TopNotifier&&TopNotifier.invalidate()):cur.onAppOrderSuccess&&cur.onAppOrderSuccess(cur.paymentsOrderId),cur.onSubscriptionDone&&s&&(cur.onSubscriptionDone(s),cur.onSubscriptionDone=!1)):cur.paymentsOrderBillPeriod&&cur.onSubscriptionFail?cur.onSubscriptionFail(i):cur.onAppOrderFail&&cur.onAppOrderFail(i))},onFail:function(e){return clearInterval(cur.paymentsCheckOrderInt),cur.paymentsShowBoxError(e),!0}})}static initialize(e,t,o,i,s,n,r){(0,a.extend)(cur,{isPaymentsAppOrder:!0,paymentsAuthPayment:!1,paymentsOrderNotice:!1,paymentsOrderId:e,paymentsOrderAppId:t,paymentsOrderTestMode:o,paymentsOrderHash:i,paymentsPreferVotes:s,paymentsOrderDiscount:n,paymentsOrderBillPeriod:r})}}},359136:(e,t,o)=>{"use strict";o.d(t,{MoneyTransfer:()=>k});var i=o(248298),s=o(714209),a=o(174628),n=o(7144),r=o(691004),_=o(317412),u=o(850101),d=o(20025),l=o(452314),c=o(357889),p=o(507035),m=o(879007),h=o(618913),y=o(490712),f=o(610989),E=o(126645),g=o.n(E),v=o(14563),A=o(459841),w=o(823875),b=o(810903),P=o(992851),T=o(705744),I=o(258643),O=o(388078),C=o(377803);const M=1,D=2,S=-1,k={initHandlers(){(0,w.tq)().setInteractiveHandler("MoneyTransfer/receive_method_change",(e=>{const t=e.payload.event.target;if((0,l.hasClass)(t,"disabled"))return;const{value:o,name:i}=e.payload.dataAttrs;k.onReceiveMethodChange(t,o,i)})),(0,w.tq)().setInteractiveHandler("MoneyTransfer/in_chat_focus_amount",(()=>{(0,l.elfocus)("transfer_amount")})),(0,w.tq)().setInteractiveHandler("MoneyTransfer/check_user_message",(()=>{k.checkUserMessage()})),(0,w.tq)().setInteractiveHandler("MoneyTransfer/show_hint",(e=>{(0,b.showHint)(e.payload.event.target)})),(0,w.tq)().setInteractiveHandler("MoneyTransfer/send",(e=>{k.send(Boolean(e.payload.dataAttrs.newWindow))})),(0,w.tq)().setInteractiveHandler("MoneyTransfer/check_participate",(e=>{(0,i.checkbox)(e.payload.event.target),k.checkRequestParticipate()})),(0,w.tq)().setInteractiveHandler("MoneyTransfer/check",(e=>{(0,i.checkbox)(e.payload.event.target)})),(0,w.tq)().setInteractiveHandler("MoneyTransfer/check_auto_accept",(e=>{(0,i.checkbox)(e.payload.event.target),k.checkAutoAccept()})),(0,w.tq)().setInteractiveHandler("MoneyTransfer/about",(e=>{k.aboutBox(e.payload.dataAttrs.aboutKey)})),(0,w.tq)().setInteractiveHandler("MoneyTransfer/history",(()=>{k.historyBox()})),(0,w.tq)().setInteractiveHandler("MoneyTransfer/hide_pin_box",(()=>{k.hidePinBox()})),(0,w.tq)().setInteractiveHandler("MoneyTransfer/check_vk_pay_offer",(()=>{k.checkVkPayOfferBox()})),(0,w.tq)().setInteractiveHandler("MoneyTransfer/clean_amount",(e=>{k.cleanAmount(e.payload.event.target,e.payload.event,Boolean(e.payload.dataAttrs.onlyClean))})),(0,w.tq)().setInteractiveHandler("MoneyTransfer/send_amount_on_enter",(e=>{13===e.payload.event.keyCode&&k.send(),k.autosizeAmount()})),(0,w.tq)().setInteractiveHandler("MoneyTransfer/focus_from_to",(e=>{(0,l.elfocus)(e.payload.event,0,1e4)})),(0,w.tq)().setInteractiveHandler("MoneyTransfer/focus_and_hide_link",(e=>{(0,l.elfocus)(e.payload.event,0,1e4),k.hideLinkCopied()})),(0,w.tq)().setInteractiveHandler("MoneyTransfer/copy_link",(e=>{k.copyLinkToClipboard((0,l.ge)(e.payload.dataAttrs.element))})),(0,w.tq)().setInteractiveHandler("MoneyTransfer/share_qr",(()=>{k.shareQRCode()})),(0,w.tq)().setInteractiveHandler("MoneyTransfer/download_qr",(()=>{k.downloadQRCode()})),(0,w.tq)().setInteractiveHandler("MoneyTransfer/switch_to_transfer_box",(e=>{k.switchBoxSection(e.payload.event.target,"transfer")})),(0,w.tq)().setInteractiveHandler("MoneyTransfer/switch_to_request_box",(e=>{k.switchBoxSection(e.payload.event.target,"request")})),(0,w.tq)().setInteractiveHandler("MoneyTransfer/switch_to_link_box",(e=>{k.switchBoxSection(e.payload.event.target,"link")})),(0,w.tq)().setInteractiveHandler("MoneyTransfer/init_accept",(()=>{k.initAccept(cur.paymentsOptions.chkData,cur.paymentsOptions.frame,!0)}))},init(){this.initHandlers();const e=(0,u.curBox)();if((0,l.ge)("payments_box")!=(0,l.geByClass1)("payments_money_transfer_box",e.bodyNode)&&_message_boxes.length>1){let e=!0;_message_boxes.forEach((function(t,o){e&&(0,l.ge)("payments_box")==(0,l.geByClass1)("payments_money_transfer_box",t.bodyNode)&&(boxLayer.removeChild((0,l.gpeByClass)("popup_box_container",t.bodyNode)),boxQueue._boxes.splice(o,1),delete _message_boxes[o],e=!1)}))}if(cur.moneyLinksTooltip&&(cur.moneyLinksTooltip.destroy(),delete cur.moneyLinksTooltip),e.setOptions({grey:!0}),cur.paymentsOptions.requestId&&!cur.paymentsOptions.vkpayAvailable&&(e.changed=!0,e.setOptions({width:510}),k.send()),(0,r.placeholderInit)("transfer_amount"),(0,r.placeholderInit)("transfer_comment"),cur.paymentsOptions.isChat){if((0,r.placeholderInit)("transfer_chunk_amount"),cur.autoacceptCardDD=new InlineDropdown("transfer_autoaccept_card",{items:cur.paymentsOptions.cards,selected:cur.paymentsOptions.cardSeleceted,withArrow:!0,onShow:k.enableAutoaccept,onSelect:e=>{-1==e?k.sendBind():cur.paymentsOptions.vkpayAvailable&&k.checkAmount((0,l.val)("transfer_amount"))}}),cur.autoacceptCardEl=(0,l.ge)("transfer_autoaccept_card"),(0,l.toggleClass)("transfer_autoaccept_card","disabled",!cur.paymentsOptions.autoAcceptEnabled),cur.paymentsOptions.autoAcceptEnabled&&(0,i.checkbox)("transfer_autoaccept",!0),cur.paymentsOptions.cards.length<2){let e=(0,l.ce)("a",{id:"payments_money_transfer_new_card_lnk",innerHTML:f.getLang("payments_money_transfer_new_card")});(0,_.addEvent)(e,"mousedown",k.sendBind),(0,l.hide)(cur.autoacceptCardEl),cur.autoacceptCardEl.parentNode.appendChild(e)}}else if((0,l.ge)("transfer_to")){(0,l.hide)("payments_money_transfer_user");let e="transfer"===cur.paymentsOptions.boxTab;cur.uiTransferTo=new Dropdown((0,l.ge)("transfer_to"),cur.paymentsOptions.friends.filter((function(t){return e||!0===t[7]})),{big:!0,introText:f.getLang("votes_transfer_start_typing_recipient"),noResult:"",placeholder:f.getLang("votes_transfer_choose_recipients"),multiselect:!1,enableCustom:!0,autocomplete:!0,imageId:"transfer_to_photo",indexkeys:[1,4],noImageSrc:"/images/blank.gif",onChange:e=>{if(!e||-1==e)return;const t=cur.uiTransferTo.val_full();cur.paymentsOptions.toId=t[0],cur.paymentsOptions.hash=t[5],(0,l.val)("payments_money_transfer_summary",t[6]),setTimeout(l.elfocus.pbind("transfer_amount"),100),cur.paymentsOptions.vkpayAvailable&&k.updateMethods()}})}else(0,l.ge)("transfer_method")&&k.initMethods();setTimeout(l.elfocus.pbind("transfer_amount"),100),(0,a.shortCurrency)(),"link"===cur.paymentsOptions.boxTab&&k.genQRCode();let t=(0,l.val)("transfer_amount");t&&k.checkAmount(t,!1,!0),k.autosizeAmount(),k.showMoneyLinksTooltip(),cur.transferPageLoaded=!1,cur.destroy.push(k.destroy)},destroy(){k.stopCheckFrameLoad(),cur.uiTransferTo&&cur.uiTransferTo.destroy(cur.uiTransferTo),cur.qrFrame&&(0,l.re)(cur.qrFrame)},initMethods(){cur.paymentsOptions.onlyCards=!(0,l.isVisible)("payments_money_transfer_receive_methods");let e=cur.paymentsOptions.cardSelected;if([D,M].includes(parseInt(cur.paymentsOptions.forceType)))for(const[t]of cur.paymentsOptions.cards)t===S&&(e=S);if(cur.uiTransferCard=new Dropdown((0,l.ge)("transfer_method"),cur.paymentsOptions.cards,{big:!0,selectedItems:e,onChange:(e,t)=>{if(-2===parseInt(e)){const e=(0,l.se)(t);nav.go(e.getAttribute("data-url"));const o=document.querySelector("#payments_money_transfer_send");return I.FlatButton.lock(o),!1}k.updateTransferType(),k.updateCardFee(!0),(0,l.val)("transfer_amount")||setTimeout(l.elfocus.pbind("transfer_amount"),100)}}),!cur.paymentsOptions.onlyCards){(0,l.geByClass1)("payments_money_transfer_receive_options","payments_money_transfer_receive_methods")&&(window.radioBtns.receiveOptions={els:Array.prototype.slice.apply((0,l.geByClass)("radiobtn")),val:e==S?"vkpay":"cards"})}if(void 0!==cur.paymentsOptions.vkpayBalance&&((0,m.each)((0,l.geByClass)("_code","payments_money_transfer_code_wrap"),(function(){(0,_.addEvent)(this,"mousedown",k.onPinClick),(0,_.addEvent)(this,"keyup",k.onPinKeyUp),(0,_.addEvent)(this,"keypress",k.onPinEnter)})),k.isVKPayFillUpEnabled())){const e=k.getBindCards();e.length>0&&(cur.uiFillUpCard=new Dropdown((0,l.ge)("fill_up_card"),e,{big:!0,selectedItems:cur.paymentsOptions.fillUpCardSelected}))}const t=!cur.paymentsOptions.transferType||cur.paymentsOptions.forceType;t&&k.updateTransferType(),k.updateCardFee(!t)},updateLocalStorageNewWindowSign(){const e=new Date,t=new Date(e.getFullYear(),e.getMonth(),e.getDate()+20+20*Math.random());return localStorage.setItem("money_transfer_new_window",t.getTime()),t},getLocalStorageNewWindowSign(){let e=parseInt(localStorage.getItem("money_transfer_new_window")??0);if(1===e)e=k.updateLocalStorageNewWindowSign().getTime();else if(0===e)return!1;return e>(new Date).getTime()},updateMethods(){const e=cur.paymentsOptions.toId;if(!e||!cur.paymentsOptions.vkpayAvailable||!O.Ranges.isUserIdTransitional(e)&&!O.Ranges.isChatOrChannelPeer(e))return;const t=document.querySelector("#payments_money_transfer_send");(0,l.val)("payments_box_error",""),cur.moneyTranferMethodsReq&&(cur.moneyTranferMethodsReq.abort(),cur.moneyTranferMethodsReq=null),"request"!==cur.paymentsOptions?.boxTab&&(cur.moneyTranferMethodsReq=ajax.post("al_payments.php?act=a_get_money_transfer_methods",{to_id:e},{onDone:(e,o)=>{I.FlatButton.unlock(t),(0,l.val)("payments_money_transfer_methods",e),cur.paymentsOptions=(0,m.extend)(cur.paymentsOptions,o),cur.paymentsOptions.transferType=o.transferType,k.initMethods()},onFail:e=>(e&&(0,n.isString)(e)&&(I.FlatButton.unlock(t),k.showError(e)),!0),showProgress:()=>I.FlatButton.lock(t)}))},send(e=!1,t=!1){const o=(0,u.curBox)(),s=document.querySelector("#payments_money_transfer_send");if(I.FlatButton.isLocked(s))return;if(!cur.paymentsOptions.toId&&cur.uiTransferTo)return void(0,i.notaBene)(cur.uiTransferTo.container);let a=0;if(k.resetTransferWindow(),!(0,l.isVisible)("payments_money_transfer_no_amount_wrap")){if(a=(0,l.val)("transfer_amount"),!a||a<=0)return(0,l.addClass)("payments_money_transfer_amount_wrap","money_error"),setTimeout(l.removeClass.pbind("payments_money_transfer_amount_wrap","money_error"),500),void(0,l.elfocus)("transfer_amount");if(!k.checkAmount(a,!0))return;if((0,i.isChecked)("transfer_participate")){a-=k.getChunkAmount(a,!0)}}if(k.hideMoneyLinksTooltip(),cur.paymentsOptions.onSendStart&&cur.paymentsOptions.onSendStart(),"request"===cur.paymentsOptions.boxTab)return void k.sendRequest(a);k.createFrame();let n={act:"a_init_money_transfer",to_id:cur.paymentsOptions.toId,owner_id:cur.paymentsOptions.ownerId,amount:a,currency:cur.paymentsOptions.currency,comment:(0,l.val)("transfer_comment"),from:cur.paymentsOptions.from,hash:cur.paymentsOptions.hash,accept_vk_pay_offer:cur.paymentsOptions.shouldAcceptVkPayOffer};if(cur.paymentsOptions.vkpayAvailable&&(n.card_id=cur.uiTransferCard.val(),cur.paymentsOptions.onlyCards||(n.receive_method=(0,i.radioval)("receiveOptions")),"-1"===n.card_id)){if(!t)return void k.showPinBox();n.vkpay_pin=t}if(k.isVKPayTransfer()&&k.isVKPayFillUpEnabled()&&k.isFillUpCardSelectionVisible()&&(n.fill_up_card_id=cur.uiFillUpCard.val()),cur.paymentsOptions.requestId&&(n.request_id=cur.paymentsOptions.requestId),cur.paymentsOptions.statSessionId&&(n.stat_session_id=cur.paymentsOptions.statSessionId),(0,l.val)("payments_box_error",""),e||!localStorage||this.isVKPayTransfer()||"-1"===n.card_id||(e=k.getLocalStorageNewWindowSign()),e){cur.paymentsOptions.qid&&(n.act="a_continue_money_transfer",n.qid=cur.paymentsOptions.qid),cur.transferWindow=window.open("","Money Transfer");let e=v.PaymentsBox.popupHtml(f.getLang("payments_cards_redirect"),"","");cur.transferWindow.document.write(e)}ajax.post("al_payments.php",n,{onDone:(t,s)=>{if(s)if(cur.paymentsOptions.qid=t.qid,e)cur.transferWindow?k.updateTransferWindow(s):k.showError(f.getLang("payments_payment_cancelled"),"info_msg");else{let e;cur._popup_text=s,cur._popup_callback=function(){(0,l.hide)("payments_money_transfer_wrap","payments_money_transfer_buttons","payments_box_error","payments_money_transfer_prg","payments_iframe_cookie_disabled_div"),(0,l.show)("payments_money_transfer_iframe","payments_iframe_container"),cur.uiTransferTo&&((0,l.hide)("payments_money_transfer_user_select"),(0,l.show)("payments_money_transfer_user")),(0,l.ge)("payments_iframe_container").scrollTop=0,window.addEventListener("message",k.frameMessage,!1),o.changed=!0,o.setOptions({width:510}),!cur.paymentsOptions.requestId&&(0,l.isVisible)(o.titleWrap)&&o.setBackTitle(k.resetSendBox),(0,l.setStyle)(e,{width:(0,l.ge)("payments_iframe_container").parentNode.offsetWidth-(0,i.sbWidth)()+"px"})},e=(0,l.ge)("transfer_iframe"),e.contentWindow.document.open("text/html","replace"),e.contentWindow.document.write(s),e.contentWindow.document.close(),cur._popup_callback(),k.startCheckFrameLoad(+new Date)}else cur.paymentsOptions.receiptRedesign&&window.addEventListener("message",k.frameMessage,!1),(0,l.hide)("payments_money_transfer_wrap","payments_money_transfer_buttons","payments_box_error","payments_iframe_container",(0,l.geByClass1)("payments_money_transfer_mc_info_msg","payments_money_transfer_iframe")),cur.uiTransferTo&&((0,l.hide)("payments_money_transfer_user_select"),(0,l.show)("payments_money_transfer_user")),(0,l.show)("payments_money_transfer_iframe","payments_money_transfer_prg");k.startCheckStatus(t,e)},onFail:e=>(k.resetTransferWindow(),k.showError(e),!0),showProgress:()=>I.FlatButton.lock(s),hideProgress:()=>I.FlatButton.unlock(s)})},sendRequest(e){let t=document.querySelector("#payments_money_transfer_send"),o={to_id:cur.paymentsOptions.toId,owner_id:cur.paymentsOptions.ownerId,amount:e,currency:cur.paymentsOptions.currency,comment:(0,l.val)("transfer_comment"),from:cur.paymentsOptions.from,hash:cur.paymentsOptions.hash};if(cur.paymentsOptions.statSessionId&&(o.stat_session_id=cur.paymentsOptions.statSessionId),cur.paymentsOptions.isChat){if(o.total_amount=parseInt(e),o.amount=parseInt((0,l.val)("transfer_chunk_amount")),o.pin_message=(0,i.isChecked)("transfer_pin_message")?1:0,(0,i.isChecked)("transfer_autoaccept")&&(cur.autoacceptCardDD&&(o.accept_card=cur.autoacceptCardDD.val()),!o.accept_card||-1==o.accept_card))return k.showError(f.getLang("payments_money_request_error_no_accept_card")),!1;let t=!1;const s=k.getTransferLimit("minAmount"),a=k.getTransferLimit("maxAmount");if(s&&o.amount<s?t=f.getLang("payments_money_request_error_min_chunk_amount_currency"):a&&o.amount>a?t=f.getLang("payments_money_request_error_max_chunk_amount_currency"):o.total_amount&&o.amount>o.total_amount&&(t=f.getLang("payments_money_request_error_chunk_amount_too_big")),t)return k.showError(t),(0,i.notaBene)("transfer_chunk_amount"),!1}(0,l.val)("payments_box_error",""),ajax.post("al_payments.php?act=a_send_money_request",o,{onDone:e=>{(0,u.curBox)().hide(),(0,u.showDoneBox)(e,{out:6e3})},onFail:e=>(k.showError(e),!0),showProgress:()=>I.FlatButton.lock(t),hideProgress:()=>I.FlatButton.unlock(t)})},sendBind(){const e=(0,u.curBox)();k.createFrame(),(0,l.hide)("payments_money_transfer_wrap","payments_money_transfer_buttons","payments_box_error","payments_money_transfer_summary_wrap","payments_iframe_container",(0,l.geByClass1)("msg","payments_money_transfer_iframe"),(0,l.geByClass1)("tb_tabs_wrap",e.bodyNode)),(0,l.show)("payments_money_transfer_iframe","payments_money_transfer_prg"),e.setBackTitle(k.resetSendBox),e.setOptions({width:510});const t={type:"card",only_auth:1,hash:cur.paymentsOptions.bindHash};(0,l.val)("payments_box_error",""),ajax.post("al_payments.php?act=a_getvotes_charge",t,{onDone:(t,o)=>{let s;cur._popup_text=o,cur._popup_callback=function(){(0,l.hide)("payments_money_transfer_prg"),(0,l.show)("payments_iframe_container"),(0,l.ge)("payments_iframe_container").scrollTop=0,window.addEventListener("message",k.frameMessage,!1),cur.autoacceptCardDD&&(0,l.isVisible)(cur.autoacceptCardEl)&&cur.autoacceptCardDD.select(cur.paymentsOptions.cards[0][0]),e.changed=!0,(0,l.setStyle)(s,{width:(0,l.ge)("payments_iframe_container").parentNode.offsetWidth-(0,i.sbWidth)()+"px"})},s=(0,l.ge)("transfer_iframe"),s.contentWindow.document.open("text/html","replace"),s.contentWindow.document.write(o),s.contentWindow.document.close(),cur._popup_callback(),cur.isPaymentCanceled=cur.isPaymentFailed=!1,cur.moneyTranferCheckInt=setInterval((function(){k.checkBindStatus(t),(cur.isPaymentCanceled||cur.isPaymentFailed)&&(clearInterval(cur.moneyTranferCheckInt),cur.isPaymentFailed?k.showError(f.getLang("payments_landing_cancelled")):k.showError(f.getLang("payments_payment_cancelled"),"info_msg"))}),2e3)},onFail:e=>(k.showError(e),!0)})},createFrame(){let e=(0,l.ge)("payments_iframe_container"),t=(0,l.ce)("iframe",{id:"transfer_iframe",name:"transfer_iframe"},{border:0,height:"445px",width:510-(0,i.sbWidth)()+"px",overflowX:"hidden",overflowY:"hidden"});t.frameBorder=0,e.innerHTML="",e.appendChild(t)},popupWrite(e){if(e.document.innerHTML!==cur._popup_text){e.document.write(cur._popup_text),e.document.close();try{e.document.charset="windows-1251"}catch(e){}e.blur(),e.focus(),cur._popup_callback&&cur._popup_callback()}},resetSendBox(){const e=(0,u.curBox)();if(!e)return;const t=(0,l.geByClass1)("tb_tabs_wrap",e.bodyNode);(0,l.hide)("payments_money_transfer_iframe"),(0,l.show)("payments_money_transfer_wrap","payments_money_transfer_buttons","payments_money_transfer_summary_wrap",t,(0,l.geByClass1)("payments_money_transfer_mc_info_msg","payments_money_transfer_iframe")),cur.uiTransferTo&&((0,l.hide)("payments_money_transfer_user"),(0,l.show)("payments_money_transfer_user_select")),t&&e.setOptions({title:""}),e.changed=!1,e.setOptions({width:510}),(0,l.isVisible)(e.titleWrap)&&e.setBackTitle(!1)},resetTransferWindow(){cur.transferWindow&&((0,l.show)("payments_money_transfer_wrap","payments_money_transfer_buttons"),(0,l.hide)("payments_money_transfer_prg","payments_money_transfer_iframe"),cur.transferWindow.location=window.location,cur.transferWindow.close()),cur.transferWindow=void 0},updateTransferWindow(e){const t=cur.transferWindow.document.getElementById("wait_text_container");t&&(t.innerHTML=""),cur.transferWindow.document.write(e),setTimeout((()=>{cur.transferWindow.document.getElementById("popup_payment_form")?.submit()}),1500),window.addEventListener("message",k.frameMessage,!1),(0,l.hide)("payments_money_transfer_wrap","payments_money_transfer_buttons","payments_box_error","payments_iframe_safari_trouble_div","payments_iframe_container"),(0,l.val)("payments_transfer_box_progress_msg",f.getLang("payments_waiting_transfer_complete")),(0,l.show)("payments_money_transfer_iframe","payments_money_transfer_prg")},startCheckStatus(e,t=!1){cur.isPaymentCanceled=cur.isPaymentFailed=!1,cur.moneyTransferRedirected=!1,cur.moneyTranferCheckInt&&clearInterval(cur.moneyTranferCheckInt),cur.moneyTranferCheckInt=setInterval((function(){if(k.checkStatus(e,t),cur.isPaymentCanceled||cur.isPaymentFailed){let t=k.resetTransferWindow();if(t&&t(),clearInterval(cur.moneyTranferCheckInt),e.accept)return void(0,u.curBox)().hide();cur.isPaymentFailed?k.showError(f.getLang("payments_landing_cancelled")):k.showError(f.getLang("payments_payment_cancelled"),"info_msg")}}),2e3)},hideBoxQueue(){for(;boxQueue.count();)boxQueue.hideLast(!1)},stopListeningFrameMessages(){window.removeEventListener("message",k.frameMessage,!1)},checkStatus(e,t){const o={act:"a_check_money_transfer",qid:e.qid,hash:e.hash};e.accept&&(o.accept=e.accept),ajax.post("al_payments.php",o,{onDone:(o,s,a,n)=>{if(!o||4==o&&cur.moneyTransferRedirected)t&&cur.transferWindow?.closed&&(k.showError(f.getLang("payments_payment_cancelled")),k.stopListeningFrameMessages(),k.resetTransferWindow(),cur.isPaymentFailed=!1,cur.isPaymentCanceled=!1);else{if(1==o||3==o){if(t){0===cur.paymentsOptions.transferType||cur.paymentsOptions.transferType===M?cur.transferWindow&&!cur.transferWindow.closed&&(k.resetTransferWindow(),k.hideBoxQueue()):(k.resetTransferWindow(),k.hideBoxQueue())}else cur.paymentsOptions.transferType===D?(k.resetTransferWindow(),k.hideBoxQueue()):cur.paymentsOptions.receiptRedesign&&((0,l.hide)(document.querySelector(".payments_money_transfer_footer")),n?.receipt_link&&k.setIframeByLink(n.receipt_link));n||(0,u.showDoneBox)(s,{out:6e3});const i=nav.objLoc;e.accept||"settings"!==i[0]||"payments"!==i.act||"transfer"!==i.section||(cur.historyOffset||(cur.historyOffset={}),cur.historyOffset.transfer=0,(0,P.showNextPaymentsHistory)(!1,i.section)),3==o&&(n&&n.title&&(0,d.showFastBox)({title:n.title},s,f.getLang("payments_remember_card_btn"),k.rememberAcceptCard.pbind(n),f.getLang("payments_dont_remember_card_btn")),TopNotifier.invalidate(),cur.acceptMoneyBtn&&(0,l.hasClass)((0,l.domPN)(cur.acceptMoneyBtn),"feedback_buttons")?((0,l.re)((0,l.domPN)(cur.acceptMoneyBtn)),cur.acceptMoneyBtn=!1):cur.acceptMoneyBtn&&((0,l.re)((0,l.geByClass1)("_decline_btn",(0,l.domPN)(cur.acceptMoneyBtn))),(0,l.domReplaceEl)(cur.acceptMoneyBtn,a),cur.acceptMoneyBtn=!1))}else if(2==o||5==o)k.showError(s),k.stopListeningFrameMessages(),cur.isPaymentFailed=!1,cur.isPaymentCanceled=!1;else{if(4==o){if(cur.moneyTransferRedirected=!0,cur._popup_text=a,t&&cur.transferWindow)k.updateTransferWindow(a);else{let e;cur._popup_callback=function(){(0,l.hide)("payments_money_transfer_prg"),(0,l.show)("payments_iframe_container"),(0,l.ge)("payments_iframe_container").scrollTop=0,window.addEventListener("message",k.frameMessage,!1),(0,u.curBox)().changed=!0,(0,l.setStyle)(e,{width:(0,l.ge)("payments_iframe_container").parentNode.offsetWidth-(0,i.sbWidth)()+"px"})},e=(0,l.ge)("transfer_iframe"),e.contentWindow.document.open("text/html","replace"),e.contentWindow.document.write(a),e.contentWindow.document.close(),cur._popup_callback()}return}if(6==o)return void((0,l.isVisible)("payments_money_transfer_prg")||((0,l.hide)("payments_iframe_container"),(0,l.show)("payments_money_transfer_iframe","payments_money_transfer_prg")))}clearInterval(cur.moneyTranferCheckInt)}},onFail:e=>(clearInterval(cur.moneyTranferCheckInt),k.resetTransferWindow()(),k.showError(e),!0)})},checkBindStatus(e){let t={act:"a_getvotes_check",type:"card"};e&&(e.oid||e.qid)&&(t.oid=e.oid,t.qid=e.qid,t.hash=e.hash),ajax.post("al_payments.php",t,{onDone:(e,t,o)=>{e&&(1==e?(k.resetSendBox(),k.enableAutoaccept(),o&&cur.autoacceptCardDD&&((0,l.isVisible)(cur.autoacceptCardEl)||((0,l.hide)((0,l.geByTag)("A",cur.autoacceptCardEl.parentNode)[0]),(0,l.show)(cur.autoacceptCardEl)),cur.paymentsOptions.cards.unshift([o.bindingId,o.bin]),cur.autoacceptCardDD.setItems(cur.paymentsOptions.cards),cur.autoacceptCardDD.select(o.bindingId))):2!=e&&10!=e||k.showError(t),clearInterval(cur.moneyTranferCheckInt))},onFail:e=>(clearInterval(cur.moneyTranferCheckInt),k.showError(e),!0)})},paymentCanceled(e){e?cur.isPaymentFailed=!0:cur.isPaymentCanceled=!0,k.frameHeight()},frameHeight(e,t){let o=(0,l.ge)("transfer_iframe");e?(e=Math.max(e,250),cur.prevFrameHeight=o.style.height,o.style.height=e+"px"):(o.style.height=cur.prevFrameHeight,(0,l.removeClass)("payments_iframe_container","payments_threeds_frame")),t||((0,l.ge)("payments_iframe_container").style.height=(e||cur.prevFrameHeight)+15+"px"),(0,l.ge)("payments_iframe_container").scrollTop=0},frameMessage(e){if(!(0,u.curBox)()&&cur.paymentsOptions.receiptRedesign)return void k.stopListeningFrameMessages();if(!(e.origin.match(/^https?:\/\/([a-zA-Z0-9\-.]+\.)?money\.mail\.ru$/)||e.origin.match(new RegExp(`^https?:\\/\\/([a-zA-Z0-9\\-.]+\\.)?${T.VK_SITE_REGEX_SOURCE_UNSAFE}$`))&&cur.paymentsOptions?.receiptRedesign))return!1;let t={};if(e.data){switch(typeof e.data){case"object":t=e.data;break;case"string":"{"===e.data.substr(0,1)&&(t=(0,p.parseJSON)(e.data))}if("billing"!==t.type)return!1}vk.dev&&(0,h.debugLog)(t);const o=(0,l.geByClass1)("payments_iframe_container",(0,u.curBox)().bodyNode)||(0,l.ge)("payments_iframe_container");if(cur.transferPageLoaded=!0,"resizeFrame"===t.action?setTimeout(k.frameHeight.pbind(t.action_params.height),200):"submit"===e.data||"3dsPage"===t.action?(setTimeout(k.frameHeight.pbind(600,!0),200),(0,l.addClass)(o,"payments_threeds_frame")):"3dsFinish"===t.action?(k.frameHeight(),(0,l.removeClass)(o,"payments_threeds_frame")):"session_fail"===t.action?((0,l.hide)(o),k.resetTransferWindow(),(0,l.show)("payments_iframe_safari_trouble_div"),k.updateLocalStorageNewWindowSign()):"putPixel"===t.action&&"page_load"===t.action_params.alias?(v.PaymentsBox.finishFormMeasure("dmr_transfer"),(0,y.statlogsValueEvent)("money_transfers",0,"iframe_loaded")):"paySuccess"===t.action?setTimeout(k.frameHeight.pbind(500),300):"payError"===t.action&&(0,l.isVisible)("payments_iframe_container")&&((0,l.hide)("payments_iframe_container"),(0,l.val)("payments_transfer_box_progress_msg",f.getLang("payments_waiting_transfer_complete")),(0,l.show)("payments_money_transfer_iframe","payments_money_transfer_prg")),cur.paymentsOptions.receiptRedesign){if("make_one_more_transfer"===t.action||"close_window"===t.action)switch(clearInterval(cur.moneyTranferCheckInt),k.resetTransferWindow(),k.stopListeningFrameMessages(),t.action){case"make_one_more_transfer":k.resetSendBox();break;case"close_window":k.hideBoxQueue()}if("get_transfer_source"===t.action){let e=vk.dev?"*":window.location.origin;cur.transferWindow&&cur.transferWindow.postMessage(JSON.stringify({from:cur.paymentsOptions.from}),e);let t=(0,l.ge)("transfer_iframe");t&&t.contentWindow.postMessage(JSON.stringify({action:"set_transfer_source",source:cur.paymentsOptions.from}),e)}}},setIframeByLink(e){let t=(0,l.geByClass1)("payments_iframe_container",(0,u.curBox)().bodyNode)||(0,l.ge)("payments_iframe_container"),o=(0,l.ce)("iframe",{id:"transfer_iframe",name:"transfer_iframe"},{border:0,height:"445px",width:"510px",overflowX:"hidden",overflowY:"hidden"});o.frameBorder=0,t.innerHTML="",t.appendChild(o),(0,l.hide)((0,l.ge)("payments_money_transfer_prg")),(0,l.show)(t),o.src=e},startCheckFrameLoad(e){cur.frameLoadChecker=setInterval((function(){if(cur.transferPageLoaded)k.stopCheckFrameLoad();else{+new Date-e>5e3&&(k.stopCheckFrameLoad(),k.resetTransferWindow(),(0,l.hide)("payments_iframe_container"),(0,l.show)("payments_iframe_safari_trouble_div"),k.updateLocalStorageNewWindowSign())}}),1e3)},stopCheckFrameLoad(){clearInterval(cur.frameLoadChecker)},initAccept(e,t,o=!1){if(o)cur.transferWindow=window.open("/","Money transfer"),cur.transferWindow.document.write(t),(0,l.hide)("payments_box_error","payments_iframe_container","payments_iframe_safari_trouble_div","payments_iframe_container"),(0,l.val)("payments_transfer_box_progress_msg",f.getLang("payments_waiting_transfer_complete")),(0,l.show)("payments_money_transfer_iframe","payments_money_transfer_prg");else{let e=(0,l.geByClass1)("payments_iframe_container",(0,u.curBox)().bodyNode)||(0,l.ge)("payments_iframe_container");(0,l.show)(e);let o=(0,l.ce)("iframe",{id:"transfer_iframe",name:"transfer_iframe"},{border:0,height:"445px",width:"510px",overflowX:"hidden",overflowY:"hidden"});o.frameBorder=0,e.innerHTML="",e.appendChild(o),o.contentWindow.document.open("text/html","replace"),o.contentWindow.document.write(t),o.contentWindow.document.close(),k.startCheckFrameLoad(+new Date)}window.addEventListener("message",k.frameMessage,!1),k.startCheckStatus(e,o)},rememberAcceptCard(e){const t=(0,u.curBox)()||{};let o=t.btns.ok[0];ajax.post("al_payments.php?act=a_remember_money_transfer_accept_card",{card_id:e.card_id,hash:e.hash},{onDone:t.hide,showProgress:()=>I.FlatButton.lock(o),hideProgress:()=>I.FlatButton.unlock(o)})},cleanAmount(e,t,o){if(13===t.keyCode)return;let i=e.value.replace(/[^0-9]/g,"");i=i.replace(/^0+/,""),e.value!=i&&(e.value=i),o||(k.checkAmount(i),k.autosizeAmount(),cur.paymentsOptions.cardsFee&&k.updateCardFee(!0))},getTransferLimit(e){let t="request"===cur.paymentsOptions.boxTab?0:cur.paymentsOptions.transferType;return"balance"===e&&parseInt(t)===D?cur.paymentsOptions.vkpayBalance:(cur.paymentsOptions.isChat&&"request"===cur.paymentsOptions.boxTab&&"maxAmount"===e&&cur.autoacceptCardDD&&-2===cur.autoacceptCardDD.val()&&(t=2),cur.paymentsOptions.limits[t][e])},checkAmount(e,t,o){let s=!1;const a=(0,l.hasClass)("payments_money_transfer_amount_wrap","money_error"),n=parseInt(cur.uiTransferCard?.val())===S,r=k.isVKPayTransfer(),_=k.isVKPayFillUpEnabled();if(t&&a)return r&&e>k.getTransferLimit("balance")&&!_&&(0,d.showFastBox)({title:f.getLang("payments_vkpay_low_balance_title"),width:420},f.getLang("payments_vkpay_low_balance_text"),f.getLang("payments_vkpay_topup_button"),nav.go.pbind("/vkpay#action=refill"),f.getLang("global_close")),!1;const u=cur.paymentsOptions.isChat&&"request"===cur.paymentsOptions.boxTab,c=u&&(0,i.isChecked)("transfer_participate"),p=k.getTransferLimit("minAmount")*(c?2:1),m=k.getTransferLimit("maxAmount"),h=k.getTransferLimit("balance"),y=(0,f.langNumeric)(p,cur.paymentsOptions.currencyStr,!0),E=f.getLang("payments_money_transfer_amount_limits").replace("{min_amount}",y);let g=!u;if(u&&cur.autoacceptCardDD&&-2===cur.autoacceptCardDD.val()&&(g=!0),n&&r&&_&&!(void 0!==h&&e<=h)||k.hideFillUpCardSelection(),t&&p&&e<p)s=f.getLang("payments_money_transfer_error_min_amount_currency").replace("{min_amount}",y);else if(m&&g&&e>m){const e=(0,f.langNumeric)(m,cur.paymentsOptions.currencyStr,!0);s=f.getLang("payments_money_transfer_error_max_amount_currency").replace("{max_amount}",e)}else if(n&&void 0!==h&&e>h)if(r&&_){k.getBindCards().length>0?k.showFillUpCardSelection():s=f.getLang("payments_money_transfer_low_balance")}else s=f.getLang("payments_money_transfer_low_balance");const v=(0,l.ge)("payments_money_transfer_notice");if(0!=s)return(0,l.val)(v,s),(0,l.addClass)("payments_money_transfer_amount_wrap","money_error"),!1;if((a||o||e<p)&&((e<p||"request"===cur.paymentsOptions.boxTab)&&(0,l.val)(v,E),(0,l.removeClass)("payments_money_transfer_amount_wrap","money_error")),!t&&u){const t=k.getChunkAmount(e,c);if((0,l.val)("transfer_chunk_amount",t),p&&e<p)(0,l.val)(v,E);else{const o=c?e-t:e,i=(0,f.langNumeric)(o,cur.paymentsOptions.currencyStr,!0);(0,l.val)(v,f.getLang("payments_money_transfer_will_be_requested").replace("{amount}",i))}}return!0},getChunkAmount(e,t){const o=k.getTransferLimit("minAmount"),i=k.getTransferLimit("maxAmount");let s=Math.max(o||100,Math.ceil(e/Math.max(1,cur.paymentsOptions.chatCount-(t?0:1))));return i&&(s=Math.min(s,i)),s},autosizeAmount(){let e=(0,l.ge)("transfer_amount"),t=(0,l.ce)("span",{innerHTML:e.value||"0"},{fontFamily:(0,l.getStyle)(e,"fontFamily"),fontSize:(0,l.getStyle)(e,"fontSize"),fontWeight:(0,l.getStyle)(e,"fontWeight")});(0,l.ge)("utils").appendChild(t);let o=Math.floor((0,l.getSize)(t)[0])+50;(0,l.re)(t),cur.amountMinSize||(cur.amountMinSize=80),o<cur.amountMinSize&&(o=cur.amountMinSize),(0,l.setStyle)(e,{width:o})},checkUserMessage(){(0,p.checkTextLength)(cur.paymentsOptions.maxTextLength,(0,l.ge)("transfer_comment"),(0,l.ge)("transfer_comment_limit_message"),!1,!0),((0,l.val)("transfer_comment_limit_message")&&(0,l.isVisible)("transfer_comment_limit_message")?l.hide:l.show)("payments_money_transfer_fee_link")},checkRequestParticipate(){k.checkAmount((0,l.val)("transfer_amount"))},checkRequestNoAmount(e,t){e&&uiTabs.switchTab(e),t?((0,l.hide)("payments_money_transfer_amount_wrap","transfer_participate"),(0,l.show)("payments_money_transfer_no_amount_wrap")):((0,l.hide)("payments_money_transfer_no_amount_wrap"),(0,l.show)("payments_money_transfer_amount_wrap","transfer_participate"),(0,l.elfocus)("transfer_amount"))},checkAutoAccept(){(0,l.toggleClass)("transfer_autoaccept_card","disabled",!(0,i.isChecked)("transfer_autoaccept"))},enableAutoaccept(){(0,i.isChecked)("transfer_autoaccept")||((0,i.checkbox)("transfer_autoaccept",!0),(0,l.removeClass)("transfer_autoaccept_card","disabled"))},showMoneyTransferBox:(e,t,o=void 0,i=null)=>(0,d.showBox)("al_payments.php",{...e,act:"money_transfer_box"},{...t,onDone(e,t){i?.(),cur.paymentsOptions=t,e.setOptions({width:510,bodyStyle:"padding: 0;",hideButtons:!0,onClean(){cur.moneyTranferCheckInt&&clearInterval(cur.moneyTranferCheckInt),nav.objLoc.z&&"moneysend"===nav.objLoc.z.substr(0,9)&&(delete nav.objLoc.z,nav.setLoc(nav.objLoc))}}),k.init()},onFail:o}),aboutBox:e=>!(0,d.showFastBox)({title:f.getLang("payments_money_transfer_about_title"),width:560},f.getLang(e)),showError(e,t){e&&((0,l.ge)("payments_box_error").innerHTML="",(0,c.showMsg)("payments_box_error",e,t||"error"),(0,l.show)("payments_box_error")),(0,l.ge)("payments_money_transfer_wrap")&&(k.resetSendBox(),cur.moneyTranferCheckInt&&(clearInterval(cur.moneyTranferCheckInt),cur.moneyTranferCheckInt=!1))},switchBoxSection(e,t){if(cur.paymentsOptions.boxTab!==t){if(e&&uiTabs.switchTab(e),"transfer"===cur.paymentsOptions.boxTab&&(0,l.isVisible)("payments_money_transfer_iframe")&&(k.resetSendBox(),cur.moneyTranferCheckInt&&(clearInterval(cur.moneyTranferCheckInt),cur.moneyTranferCheckInt=!1)),"transfer"===cur.paymentsOptions.boxTab&&cur.paymentsMoneyBoxTTHide&&cur.paymentsMoneyBoxTTHide(),"link"===cur.paymentsOptions.boxTab&&((0,l.hide)("payments_money_link_box"),(0,l.show)("payments_money_transfer_request_box"),k.hideMoneyLinksTooltip()),cur.paymentsOptions.boxTab=t,"link"===t)(0,l.hide)("payments_money_transfer_request_box"),(0,l.show)("payments_money_link_box"),k.hideMoneyLinksTooltip(),k.genQRCode(),k.showMoneyLinksTooltip();else{(0,l.val)("payments_money_transfer_summary",cur.paymentsOptions.boxSections[t].summary);const e=document.querySelector("#payments_money_transfer_send");I.FlatButton.setLabel(e,cur.paymentsOptions.boxSections[t].btn),(0,l.val)("payments_money_transfer_user_select_label",cur.paymentsOptions.boxSections[t].user_select_label),k.checkAmount((0,l.val)("transfer_amount"),!1,!0),"transfer"===t&&k.updateCardFee(!0)}(0,l.toggle)("payments_money_transfer_nf_warning","transfer"===t),(0,l.toggle)("payments_money_transfer_methods","transfer"===t),(0,l.toggle)("payments_money_transfer_vk_pay_offer","transfer"===t),k.renderSelectBox(),setTimeout(l.elfocus.pbind("transfer_amount"),100)}},genQRCode(){const e=(0,l.ge)("payments_money_transfer_qr");if(e.childNodes.length)return;const t={isShowLogo:!0,isShowBackground:!1,foregroundColor:C.default.colorTextPrimary.normal.value,logoColor:C.default.colorIconAccent.normal.value};(0,l.val)(e,g().createQR(cur.paymentsOptions.transferLink,115,"qr-code",t))},shareQRCode(){k.hideMoneyLinksTooltip(!0),(0,d.showBox)("like.php",{act:"publish_box",object:"moneysend"+vk.id+"_0",list:""})},downloadQRCode(){if(!cur.paymentsOptions.qrUrl)return!1;let e=(0,l.ce)("iframe",{src:cur.paymentsOptions.qrUrl});return utilsNode.appendChild(e),cur.qrFrame&&(0,l.re)(cur.qrFrame),cur.qrFrame=e,!1},hideLinkCopied(){(0,m.each)((0,l.geByClass)("_link_copied","payments_money_link_box"),l.hide.pbind(this))},copyLinkToClipboard(e){k.hideLinkCopied(),k.hideMoneyLinksTooltip(!0),e.select(),document.execCommand("copy");const t=(0,l.geByClass1)("_link_copied",(0,l.gpeByClass)("_link_wrap",e));(0,l.show)(t)},renderSelectBox(){if(!cur.uiTransferTo)return;const e="transfer"===cur.paymentsOptions.boxTab;cur.uiTransferTo.setData([]),cur.uiTransferTo.setOptions({autocomplete:!1}),cur.uiTransferTo.setData(cur.paymentsOptions.friends.filter((function(t){return e||!0===t[7]}))),cur.uiTransferTo.setOptions({autocomplete:!0}),cur.paymentsOptions.toId=null,cur.paymentsOptions.hash=null,cur.uiTransferTo.clear(),cur.uiTransferTo.deselectTokens(),(0,l.val)("payments_money_transfer_methods","")},updateImHistory(e,t,o){const i=(0,l.geByClass1)("_money_transfer"+t,e);if(!i)return;let s=(0,l.geByClass1)("_accept_btn",i);s&&((0,l.re)((0,l.geByClass1)("_decline_btn",(0,l.domPN)(s))),(0,l.domReplaceEl)(s,o))},initHistoryBox(e,t,o,a){let n=(0,l.ge)("ui_money_transfer_load_more");if(n){let r=(0,l.ge)("settings_transfer_history").tBodies[0];cur.userAutoScroll=new A.default(r,{offset:o,onNoMore:l.re.pbind(n),onNeedRows:(o,i)=>{let s={act:"money_transfer_history_box",offset:i,owner_id:e};t&&(s.request_id=t),a&&(s.hash=a),ajax.post("al_payments.php",s,{onDone:o})},drawRows:(e,t)=>{if(s.browser.msie){const o=(0,l.se)("<table>"+t+"</table>");t=(0,l.geByTag)("tr",o);for(let o in t)1==t[o].nodeType&&e.appendChild(t[o])}else e.insertAdjacentHTML("beforeEnd",t)},showProgress:()=>(0,i.lockButton)(n),hideProgress:()=>(0,i.unlockButton)(n),rowClass:"settings_history_row"})}},historyBox(){(0,d.showBox)("al_payments.php?act=money_transfer_history_box")},showMoneyLinksTooltip(){if(!cur.paymentsOptions.moneylinks_feature_tooltip||cur.moneyLinksTooltip)return;let e,t,o;(0,l.isVisible)("payments_money_link_box")?(e=(0,l.geByClass1)("payments_money_transfer_link_copy_btn","payments_money_link_box"),t=f.getLang("payments_money_link_btn_feature_text"),o={forceSide:"right",width:320,offset:[6,0]}):(e=(0,l.geByClass1)("ui_tab",(0,l.geByClass1)("_moneylink_tab","box_layer")),e&&(t=f.getLang("payments_money_link_tab_feature_text"),o={forceSide:"bottom",width:250,offset:[0,4]})),e&&setTimeout((function(){cur.moneyLinksTooltip=new ElementTooltip(e,(0,m.extend)({content:'<div class="feature_tooltip__close" onclick="cur.moneyLinksTooltip.hide();"></div>'+t,cls:"feature_intro_tt feature_info_tooltip moneylinks_feature_tooltip",autoShow:!1,noHideOnClick:!0,noAutoHideOnWindowClick:!0,appendTo:(0,l.geByClass1)("ui_tabs","box_layer"),onHide:k.hideMoneyLinksTooltip.pbind(!0)},o)),cur.moneyLinksTooltip.show(),cur.destroy.push(k.hideMoneyLinksTooltip)}),500)},hideMoneyLinksTooltip(e){e&&ajax.post("al_index.php",{act:"hide_feature_tt",hash:cur.paymentsOptions.moneylinks_feature_tooltip_hash,type:"moneylinks"}),cur.moneyLinksTooltip&&(cur.moneyLinksTooltip.destroy(),delete cur.moneyLinksTooltip)},showPinBox(){(0,l.addClass)((0,u.curBox)().bodyNode,"payments_box_code_showed"),(0,l.show)("payments_money_transfer_layer_bg","payments_money_transfer_code_box"),(0,m.each)((0,l.geByClass)("_code","payments_money_transfer_code_wrap"),(function(){(0,l.val)(this,"")})),(0,l.elfocus)("payments_code1"),(0,u.curBox)().changed=!0;const e=document.querySelector("#payments_money_transfer_send");e&&(e.style.pointerEvents="none",setTimeout((()=>{e.style.pointerEvents="auto"}),0))},hidePinBox(){(0,l.hide)("payments_money_transfer_layer_bg","payments_money_transfer_code_box"),(0,l.removeClass)((0,u.curBox)().bodyNode,"payments_box_code_showed"),(0,u.curBox)().changed=!1},checkVkPayOfferBox(){const e="payments_money_transfer_vk_pay_offer_box",t=!(0,i.isChecked)(e),o=document.querySelector("#payments_money_transfer_send");I.FlatButton.setDisabled(o,!t),(0,i.checkbox)(e)},onPinKeyUp(e){const t=e.target;if(8==e.keyCode){const e=(0,l.domPS)(t);if(e){const t=e.getAttribute("data-index");(0,l.val)(e,""),cur.paymentsOptions.vkpcode[t]="",cur.paymentsOptions.vkpcode[t-1]="",(0,l.elfocus)(e)}}},onPinEnter(e){const t=e.target;if(!(e.keyCode>=47&&e.keyCode<=57))return(0,_.cancelEvent)(e);{const o=t.getAttribute("data-index");cur.paymentsOptions.vkpcode||(cur.paymentsOptions.vkpcode=[]),cur.paymentsOptions.vkpcode[o-1]=e.key,(0,l.val)(t,String.fromCharCode(9679));const i=(0,l.domNS)(t);i?setTimeout(l.elfocus.pbind(i),10):setTimeout((function(){t.blur(),k.checkPin()}),10)}},onPinClick(e){const t=e.target,o=(0,l.domPS)(t);if(o&&!(0,l.val)(o))return(0,_.cancelEvent)(e)},checkPin(){const e=cur.paymentsOptions.vkpcode.join("");delete cur.paymentsOptions.vkpcode,(0,l.val)("payments_money_transfer_code_error",""),ajax.post("al_payments.php?act=a_check_vkpay_pin",{code:e,hash:cur.paymentsOptions.pinHash},{onDone:t=>{if(1==t)return(0,l.hide)((0,l.geByClass1)("_code_enter","payments_money_transfer_code_box")),void(0,l.show)((0,l.geByClass1)("_code_recover","payments_money_transfer_code_box"));k.hidePinBox(),k.send(!1,e)},onFail:e=>(e&&(0,l.val)("payments_money_transfer_code_error",e),(0,m.each)((0,l.geByClass)("_code","payments_money_transfer_code_wrap"),(function(){(0,l.val)(this,""),(0,i.notaBene)(this)})),(0,l.elfocus)("payments_code1"),!0),showProgress:function(){(0,l.hide)("payments_money_transfer_code_wrap"),(0,l.show)("payments_money_transfer_spinner")},hideProgress:function(){(0,l.hide)("payments_money_transfer_spinner"),(0,l.show)("payments_money_transfer_code_wrap")}})},onReceiveMethodChange(e,t,o){(0,i.radiobtn)(e,t,o),k.updateTransferType(e),k.updateCardFee(!0)},updateTransferType(e){void 0!==cur.paymentsOptions.forceType?cur.paymentsOptions.transferType=cur.paymentsOptions.forceType:parseInt(cur.uiTransferCard.val())===S?cur.paymentsOptions.transferType=D:cur.paymentsOptions.onlyCards?cur.paymentsOptions.transferType=0:(void 0===e&&(0,m.each)(radioBtns.receiveOptions.els,(function(){(0,l.hasClass)(this,"on")&&(e=this)})),void 0!==e&&(cur.paymentsOptions.transferType=(0,m.intval)((0,l.attr)(e,"data-type")))),k.checkAmount((0,l.val)("transfer_amount"),!1,!0)},updateCardFee(e){if(!cur.uiTransferCard||"request"===cur.paymentsOptions.boxTab)return;const t=(0,m.intval)((0,l.val)("transfer_amount")),o=k.getTransferLimit("minAmount"),i=(0,l.ge)("payments_money_transfer_to_card"),s=cur.uiTransferCard.val(),a=cur.paymentsOptions.cardsFee[s],n=0===cur.paymentsOptions.transferType,r=parseInt(s)===S||cur.paymentsOptions.forceType===M||cur.paymentsOptions.forceType===D,_=parseInt(s)!==S&&!cur.paymentsOptions.receiverVkpay||0===cur.paymentsOptions.forceType;let u=f.getLang("payments_transfer_without_fee"),d=f.getLang("payments_money_transfer_btn"),c=r?"payments_money_transfer_to_vkpay":"payments_money_transfer_to_card",p=_,h=0;if((0,l.toggleClass)(i,"disabled",r),(0,l.toggleClass)("payments_money_transfer_to_vkpay","disabled",_),0===parseInt(s))n&&(u=cur.paymentsOptions.mastercardPromoEnabled?f.getLang("payments_transfer_method_without_fee_for_mastercard"):f.getLang("payments_money_transfer_commission_undefined"));else if(parseInt(s)===S)p=!0;else if(n&&a&&(a.percent||a.vkPay&&a.vkPay.percent)){const e=a.free_amount_rest||0,o=a.free_amount_min||0;if(!e||t>e||o&&t<o){let o=t;t>e&&(o=t-e);const i=a.percent||0,s=a.min||0,n=a.add||0;h=o*i,h<s?h=s:h+=n,h=+(Math.round(h+"e+3")+"e-3"),h=+(Math.round(h+"e+2")+"e-2"),u=(0,f.langNumeric)(h,cur.paymentsOptions.cardsFeeStr,!0)}if(a.vkPay){const e=t+h,o=a.vkPay.percent||0,i=a.vkPay.min||0,s=a.vkPay.add||0;let n=e*o;n<i?n=i:n+=s,h=+(Math.round(h+n+"e+2")+"e-2"),n=+(Math.round(n+"e+2")+"e-2"),u=(0,f.langNumeric)(h,cur.paymentsOptions.cardsFeeStr,!0),u+=(0,f.langNumeric)(n,cur.paymentsOptions.cardsFeeVkPayStr,!0)}}!c||e&&!p||(0,l.ge)(c).classList.contains("on")||(0,l.ge)(c).click(),t>=o&&!(0,l.hasClass)("payments_money_transfer_amount_wrap","money_error")&&((0,l.val)("payments_money_transfer_notice",u),0===parseInt(s)&&n||(d=(0,f.langNumeric)(+(Math.round(t+h+"e+2")+"e-2"),cur.paymentsOptions.buttonAmountStr,!0)));const y=document.querySelector("#payments_money_transfer_send");I.FlatButton.setLabel(y,d)},isVKPayFillUpEnabled:()=>1==cur.paymentsOptions.vkpayFillUpEnabled,isVKPayTransfer:()=>parseInt(cur.paymentsOptions.transferType)===D,getBindCards:()=>cur.paymentsOptions.cards.filter((e=>{const t=parseInt(e[0]);return 0!==t&&t!==S})),hideFillUpCardSelection(){(0,l.hide)("payments_money_transfer_fill_up_cards")},showFillUpCardSelection(){(0,l.show)("payments_money_transfer_fill_up_cards")},isFillUpCardSelectionVisible:()=>(0,l.isVisible)("payments_money_transfer_fill_up_cards")}},14563:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{PaymentsBox:()=>PaymentsBox});var _icons_desktop__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(275563),_shared_evbus__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(823875),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(714209),_shared_lib_common__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(7144),_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(610989),_shared_lib_site__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(705744),_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(490712),_web_lib_accessibility__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(967886),_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(850101),_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(618913),_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(452314),_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(317412),_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(927984),_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(20025),_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(810903),_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(248298),_web_lib_ui_util__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(357889),_web_lib_utils__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(507035),_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(879007),_web_payments_app_order_box__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(953550);class PaymentsBox{static initHandlers(){(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("PaymentsBox/ps_promo_banner_click",(e=>{(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_5__.statlogsValueEvent)("payments_ps_promo_banner_event","","votes_buypage","relocate"),PaymentsBox.getVotesAmounts(!1,"spasibo",e.payload.target)})),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("PaymentsBox/save_phone_prefix_click",(e=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.elfocus)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByTag1)("input",e.payload.target.parentNode),0,0)})),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("PaymentsBox/save_phone_input",(e=>{13===e.payload.event.keyCode&&PaymentsBox.saveSmsPhone()})),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("PaymentsBox/get_votes_amounts",(e=>{PaymentsBox.getVotesAmounts(!1,e.payload.dataAttrs.name,e.payload.target)})),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("PaymentsBox/phone_code_input",(e=>{13===e.payload.event.keyCode&&PaymentsBox.smsSendCode()})),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("PaymentsBox/show_confirm_on_enter",(e=>{13===e.payload.event.keyCode&&PaymentsBox.showConfirm()})),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("PaymentsBox/show_confirm",(()=>{PaymentsBox.showConfirm()})),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("PaymentsBox/show_types",(()=>{PaymentsBox.showTypes()})),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("PaymentsBox/show_terminal_tt",(e=>{PaymentsBox.paymentsShowTerminalTT(e.payload.target,e.payload.dataAttrs.name)})),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("PaymentsBox/show_phone_form",(()=>{PaymentsBox.showPhoneForm(2)})),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("PaymentsBox/show_phone_form_1",(()=>{PaymentsBox.showPhoneForm(1)})),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("PaymentsBox/show_all_prices",(e=>{PaymentsBox.showAllPrices(e.payload.target)})),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("PaymentsBox/change_option",(e=>{const{index:t,name:o}=e.payload.dataAttrs;PaymentsBox.onChangeOption(e.payload.target,t,o)})),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("PaymentsBox/focus_votes",(()=>{PaymentsBox.onChangeOption((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("last","payments_getvotes_amounts"),4,"payments_getvotes_amounts")})),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("PaymentsBox/update_pay_amount",(e=>{PaymentsBox.updatePayAmount(e.payload.target)})),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("PaymentsBox/make_checkbox",(e=>{(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.checkbox)(e.payload.target)})),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("PaymentsBox/toggle_email",(e=>{PaymentsBox.toggleEmail(e.payload.target)}))}static initialize(e){PaymentsBox.initHandlers(),window.curNotifier&&curNotifier.idle_manager&&curNotifier.idle_manager.started&&((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_2__.isArray)(cur.onUnidle)||(cur.onUnidle=[]),(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_2__.isArray)(cur.onIdle)||(cur.onIdle=[]),cur.onUnidle.push((()=>{cur.getVotesDoneHide=!0})),cur.onIdle.push((()=>{cur.getVotesDoneHide=!1})));let t={bodyStyle:"padding: 0;",hideButtons:!0};if(cur.paymentsWideBox){let e={width:cur.checkoutEnabled?800:780,height:390};cur.checkoutEnabled||(e.title=!1),t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_17__.extend)(t,e)}else t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_17__.extend)(t,{width:480});if(e.setOptions((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_17__.extend)(t,{onClean:()=>{let t="sms"===cur.votesType&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_box_progress");cur.smsChkStatInt&&clearInterval(cur.smsChkStatInt);for(let e in cur.paymentsWaitingCache)cur.paymentsWaitingCache[e][2]&&clearInterval(cur.paymentsWaitingCache[e][2]);cur.smsAmountsInt&&clearTimeout(cur.smsAmountsInt),cur.isPaymentsAppOrder&&(cur.isPaymentComplete||cur.isPaymentAttemted)?e.onDone?e.onDone():(e.hide(),_web_payments_app_order_box__WEBPACK_IMPORTED_MODULE_18__.AppOrderBox.processOrder(1,e)):cur.isPaymentsAppOrder&&!cur.paymentsCheckOrderCnt&&cur.paymentsOrderBillPeriod&&cur.onSubscriptionCancel?cur.onSubscriptionCancel():cur.isPaymentsAppOrder&&!cur.paymentsCheckOrderCnt&&cur.onAppOrderCancel?cur.onAppOrderCancel():cur.paymentsTryCompleteOrder&&(cur.isPaymentComplete||cur.isPaymentAttemted)&&e.onDone&&e.onDone(),PaymentsBox.removeCheckOffersEvent(),window.removeEventListener("message",PaymentsBox.frameMessage,!1),window.removeEventListener("message",PaymentsBox.handlePaymentCompleteMessage,!1),t&&(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_7__.showDoneBox)(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_get_votes_box_close_notice"),{out:6e3})}})),(cur.fromInstantPay||cur.paymentsAuthPayment)&&(e.onDone=!1),cur.votesBox=e,cur.destroy.push((()=>{for(;boxQueue.count();)boxQueue.hideLast(!1)})),cur.checkoutEnabled)if(cur.paymentsWideBox){PaymentsBox.showProgress(""),PaymentsBox.submitDmrCheckout(cur.paymentsPreferVotes,!0);let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_wide_box_close_btn");e&&(e.onclick=cur.votesBox.hide)}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_cont"),window.radioBtns.payments_getvotes_amounts={els:Array.prototype.slice.apply((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("radiobtn",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_amounts")))},PaymentsBox.setButtons(cur.payments_get_votes,PaymentsBox.showConfirm);else cur.votesTypeInit&&(PaymentsBox.getVotesAmounts(!1,cur.votesTypeInit),cur.votesTypeInit=!1)}static initPhoneCountry(e,t){cur.countries=e,cur.defCountry=t,cur.uiPhoneCountry=new Dropdown((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("phone_country"),cur.countries,{selectedItems:t,big:!0,autocomplete:!0,multiselect:!1,onChange:e=>{let t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("phone"),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_phone_prefix"),i=cur.uiPhoneCountry.val_full()[3];if(0===e||"0"===e||""===e||!1===e||void 0===e){let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(o);if(i==e)return;for(let t=0,o=cur.countries.length;t<o;++t)if(cur.countries[t][3]==e)return cur.uiPhoneCountry.val(cur.countries[t]);return cur.uiPhoneCountry.val(cur.defCountry,!0)}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(o,i),setTimeout(_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.elfocus.pbind(t),0)}}),cur.destroy.push(cur.uiPhoneCountry.destroy.bind(cur.uiPhoneCountry))}static initPhoneNumber(e){e&&["input","keydown","keyup","mousedown","mouseup","select","contextmenu","drop"].forEach((function(t){e.addEventListener(t,(e=>{const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domClosestByTag)("input",e.target);t&&(t.value=t.value.replace(/\D/g,""))}))}))}static validateEmail(e){return e.length<64&&e.match(/^.{1,40}@.{1,40}$/)&&e.match(/^([a-z0-9_\-]{0,40}\.){0,10}[a-z0-9_\-*]{1,40}@(([a-z0-9][a-z0-9_\-]{0,40})?[a-z0-9]\.){1,6}[a-z]{2,7}$/i)}static getEmail(){let e=!1;if(cur.paymentsEmailCheckbox)if((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isChecked)(cur.paymentsEmailCheckbox)){if(e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_17__.trim)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(cur.paymentsEmailInput)),!e)return(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.notaBene)(cur.paymentsEmailInput),""}else e="false";return e}static toggleEmail(e){"INPUT"===e.tagName&&(e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("checkbox",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domPN)(e)),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isChecked)(e))||((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.checkbox)(e),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isChecked)(e)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.elfocus)(cur.paymentsEmailInput))}static unbind(e,t,o,i){if((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isButtonLocked)("payments_getvotes_submit"))return;const s=cur.paymentsPreferVotes;if(!o){const o="card"==e?_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_unbind_card_confirm"):_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_revoke_token_confirm");return void(cur.confirmBox=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)({title:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("global_action_confirmation"),bodyStyle:"padding: 20px; line-height: 160%;"},o,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_unbind_card_btn"),(()=>{PaymentsBox.unbind(e,t,!0)}),_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("global_cancel")))}const a={act:"a_del_instant_method",type:e,prefer_votes:i?-1:s,hash:t};cur.isPaymentsAppOrder&&cur.paymentsOrderAppId&&(a.aid=cur.paymentsOrderAppId),ajax.post("al_payments.php",a,{onDone:PaymentsBox.getVotesAmountsOnDone,onFail:function(e){return PaymentsBox.showBoxError(e),!0},showProgress:()=>{cur.confirmBox?cur.confirmBox.showProgress():(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockButton)("payments_getvotes_submit")},hideProgress:()=>{cur.confirmBox?cur.confirmBox.hide():(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)("payments_getvotes_submit")}})}static instantPay(){if((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isButtonLocked)("payments_getvotes_submit"))return;const e=(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_7__.curBox)();if(cur.isPaymentAttemted=!0,cur.paymentsAuthPayment)return void e.hide();let t,o,i;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_amounts")&&(cur.votesAmountsVal=(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.radioval)("payments_getvotes_amounts")),void 0===cur.votesAmountsData[cur.votesAmountsVal]){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("votes_num")?parseInt((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("votes_num").value,10):0;if(!(e>0))return;cur._otherVotes=e,t=cur._otherAmount,o=cur._otherAmount,i=cur.votesAmountCustomTimeHash}else t=cur.votesAmountsData[cur.votesAmountsVal][2],o=cur.votesAmountsData[cur.votesAmountsVal][3],i=cur.votesAmountsData[cur.votesAmountsVal][4];let s={act:"a_getvotes_charge",type:cur.votesType,instant_pay:1,amount:t,order_amount:o,hash:i};cur.statSessionId&&(s.stat_session_id=cur.statSessionId),cur.isPaymentsAppOrder&&cur.paymentsOrderId&&(s.order_id=cur.paymentsOrderId,s.order_app_id=cur.paymentsOrderAppId,s.order_bill_period=cur.paymentsOrderBillPeriod,s.order_hash=cur.paymentsOrderHash),PaymentsBox.disablePaymentTypesRows(),ajax.post("al_payments.php",s,{onDone:(e,t,o,i)=>{PaymentsBox.setCurMidas(i),cur.smsChkStatCnt=0,cur.smsChkStatInt=setInterval((()=>{PaymentsBox.checkStatus(cur.votesType,e)}),2e3),PaymentsBox.showProgress&&PaymentsBox.showProgress()},onFail:e=>(PaymentsBox.showBoxError(e),!0),showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockButton.pbind("payments_getvotes_submit"),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton.pbind("payments_getvotes_submit")})}static showAllPrices(e){return(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_17__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("radiobtn",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_amounts")),((e,t)=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)(t)})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)(e),!1}static paymentsShowTerminalTT(e,t){let o="";cur.paymentsTooltips[t]&&(o+=cur.paymentsTooltips[t]),o&&(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_13__.showTooltip)(e,{text:o,dir:"auto",slide:15,className:"payments_terminal_tt",shift:[-3,3],hasover:1})}static updatePayAmount(o){let v=o.value.replace(/[^0-9]/g,"");const i=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_17__.intval)(parseInt(v,10));v=i<1e4?i:parseInt(i.toString().substr(0,4),10),o.value!==v.toString()&&(o.value=v);let amount=0;if(cur.votesAmountsData.calcPayAmount){-1==cur.votesAmountsData.calcPayAmount.indexOf("return")&&(cur.votesAmountsData.calcPayAmount="return "+cur.votesAmountsData.calcPayAmount);const calcFunc="(function(votes){"+cur.votesAmountsData.calcPayAmount+";})("+v+")";try{amount=eval(calcFunc)}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_8__.logEvalError)(e,calcFunc)}amount=amount?Math.ceil(100*amount)/100:0,amount=parseInt(amount,10)==amount?amount.toFixed(0):amount.toFixed(2),cur._otherAmount=amount,cur._otherVotes=v}const isBonusVotesDiscount=!!cur.votesAmountsData.calcBonusVotesForDiscount,isPriceDiscount=!!cur.votesAmountsData.calOriginalAmountForDiscount;let bonusElement=null;if(bonusElement=isBonusVotesDiscount?document.getElementById("personal_discount_bonus"):isPriceDiscount?document.getElementById("personal_discount_original_amount"):document.getElementById("payments_other_votes_bonus"),bonusElement&&(cur.votesAmountsData.bonusesTable||cur.votesAmountsData.calcBonusVotes||isBonusVotesDiscount||isPriceDiscount)){let bonus=0;if(cur.votesAmountsData.calcBonusVotes||isBonusVotesDiscount||isPriceDiscount){const calcFunc="(function(votes){"+(cur.votesAmountsData.calcBonusVotes||cur.votesAmountsData.calcBonusVotesForDiscount||cur.votesAmountsData.calOriginalAmountForDiscount)+";})("+v+")";try{bonus=eval(calcFunc)}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_8__.logEvalError)(e,calcFunc)}}else for(let e in cur.votesAmountsData.bonusesTable)if(v>=e){const t=Math.floor(v*cur.votesAmountsData.bonusesTable[e]/e);t>bonus&&(bonus=t)}if(bonus)if(isBonusVotesDiscount)bonusElement.innerHTML=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("apps_personal_discount_amount_gift_calc",bonus),bonusElement.style.display="block";else if(isPriceDiscount){let e="";e=cur.votesAmountsData.currency_str?bonus>0?(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.langNumeric)(bonus,cur.votesAmountsData.currency_str):"":bonus>0?_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_votes_cost_in_rubles",bonus):"",bonusElement.innerHTML=e,bonusElement.style.display="inline-block"}else bonusElement.innerHTML=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_bonus_votes",bonus),bonusElement.style.display="inline-block";else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)(bonusElement)}if(cur.votesAmountsData.currency_str?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("votes_amount").innerHTML=amount>0?(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.langNumeric)(amount,cur.votesAmountsData.currency_str):"":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("votes_amount").innerHTML=amount>0?_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_votes_cost_in_rubles",amount):"",isPriceDiscount){const e=document.getElementById("votes_amount");e&&e.classList.add("payments_opt_gift")}}static onChangeOption(e,t,o){let i;if((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.radiobtn)(e,t,o),"payments_getvotes_amounts"===o){const e=cur.votesAmountsData[t];if(e){cur.votesAmountsVal=t,i=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_get_votes_for_X").replace("{amount}",e[1]),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("votes_num",""),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("votes_amount","");const o=document.getElementById("personal_discount_original_amount");o&&(o.style.display="none"),cur.paymentsEmailCheckbox&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isChecked)(cur.paymentsEmailCheckbox)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.elfocus)(cur.paymentsEmailInput)}else i=cur.payments_get_votes,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.elfocus)("votes_num");cur.checkoutEnabled?PaymentsBox.setButtons(i,PaymentsBox.showConfirm):PaymentsBox.setButtons(i,cur.votesAmountIsInstant||e&&e.length>=5?PaymentsBox.instantPay:PaymentsBox.showConfirm,cur.paymentsChangeType,PaymentsBox.showTypes)}}static setConfirmButtons(){if("card"!=cur.votesType&&cur.psList[cur.votesType]){const e=cur.paymentsWideBox?_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_back_to_ps_list"):_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_go_ps_list");let t=!cur.psList[cur.votesType].in_menu;cur.paymentsInstantPayType==cur.votesType?t?PaymentsBox.setButtons(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_pay_order_btn"),PaymentsBox.instantPay,e,PaymentsBox.showPaySystemsList):PaymentsBox.setButtons(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_pay_order_btn"),PaymentsBox.instantPay):t?PaymentsBox.setButtons(cur.payments_get_votes,PaymentsBox.showConfirm,e,PaymentsBox.showPaySystemsList):PaymentsBox.setButtons(cur.payments_get_votes,PaymentsBox.showConfirm)}else cur.checkoutEnabled?PaymentsBox.setButtons(cur.payments_get_votes,PaymentsBox.showConfirm):PaymentsBox.setButtons(cur.payments_get_votes,PaymentsBox.showConfirm,cur.paymentsChangeType,PaymentsBox.showTypes)}static popupWrite(e){return!(e.document.innerHTML==cur._popup_text||!cur._popup_text)&&(e.document.write(cur._popup_text),e.document.close(),e.blur(),e.focus(),cur._popup_callback&&cur._popup_callback(),!0)}static show3DsFrame(e,t){if(cur.threeds_submitted)return!0;cur.threeds_submitted=!0;let o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_iframe_container"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("cards_iframe");i||(i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ce)("iframe",{id:"card_iframe",name:"card_iframe"},{border:0,height:"435px",width:o.parentNode.offsetWidth+"px",overflowX:"hidden",overflowY:"hidden"}),i.frameBorder=0,o.innerHTML="",o.appendChild(i));let s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ce)("form",{target:"card_iframe",method:"POST",action:e});for(let e in t)Object.prototype.hasOwnProperty.call(t,e)&&s.appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ce)("input",{type:"hidden",name:e,value:t[e]}));o.appendChild(s),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)("payments_iframe_container",cur.checkoutEnabled?"payments_threeds_checkout_frame":"payments_threeds_frame"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_iframe_container"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_box_progress"),s.submit()}static submitDmrCheckout(e,t=!1){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_box_progress")&&!t)return;(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockButton)("payments_getvotes_submit");const o=cur.psList.dmr_checkout;let i=!1;const s=(e*o.vote_cost).toFixed(2);if(!e||e<=0?i=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_web_no_sum"):o.min_amount&&e<o.min_amount?i=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_min_amount_limit_votes").replace("%s",o.min_amount):o.max_amount&&e>o.max_amount?i=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_max_amount_limit_votes").replace("%s",o.max_amount):void 0!==o.rest_amount_day&&e>o.rest_amount_day?i=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_rest_amount_day_votes").replace("%s",o.rest_amount_day):void 0!==o.rest_amount_week&&e>o.rest_amount_week&&(i=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_rest_amount_week_votes").replace("%s",o.rest_amount_week)),i)return PaymentsBox.showBoxError(i),!1;const a=PaymentsBox.getEmail();if(""===a)return(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)("payments_getvotes_submit"),!1;if(a&&"false"!==a&&!PaymentsBox.validateEmail(a))return(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.notaBene)(cur.paymentsEmailInput),PaymentsBox.showBoxError(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_error_invalid_email")),!1;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)("payments_iframe_container","payments_threeds_checkout_frame");let n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_iframe_container"),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ce)("iframe",{id:"card_iframe",name:"card_iframe"},{border:0,height:cur.isMidas?"560px":"435px",width:n.parentNode.offsetWidth+"px",overflowX:"hidden",overflowY:"hidden",display:"block",borderRadius:"0 0 4px 4px"});r.frameBorder=0,n.innerHTML="",n.style.height=r.style.height,n.appendChild(r),window.addEventListener("message",PaymentsBox.frameMessage,!1);let _=cur.votesType;!_&&cur.votesTypeInit&&(_=cur.votesTypeInit);const u={act:"a_getvotes_charge",type:"dmr_checkout",hash:cur.paymentsHash,amount:s,stat_session_id:cur.statSessionId,votes:e};_&&(u.pay_method=_),cur.paymentsAuthPayment&&(u.only_auth=1),a&&(u.email=a),cur.votesAmountsData.appoveCode&&(u.approve_code=cur.votesAmountsData.appoveCode),cur.isPaymentsAppOrder&&cur.paymentsOrderId&&(u.order_id=cur.paymentsOrderId,u.order_app_id=cur.paymentsOrderAppId,u.order_bill_period=cur.paymentsOrderBillPeriod,u.order_hash=cur.paymentsOrderHash),cur.votesAmountsData.purchaseDescr&&(u.purchase_descr=cur.votesAmountsData.purchaseDescr),PaymentsBox.trackingProtectionEnabled((function(){(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_5__.statlogsValueEvent)("payments",0,"votes","dmr_checkout","iframe_track_protection_enabled")}),(function(){(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_5__.statlogsValueEvent)("payments",0,"votes","dmr_checkout","iframe_track_protection_disabled")})),ajax.post("al_payments.php",u,{onDone:function(t,i,a,n){if(PaymentsBox.setCurMidas(n),!t)return;if(-2==t){const t=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("global_money_amount_rub",Math.floor(s));return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_getvotes_confirm_msg",i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_box_votes_num",e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_box_amount",t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_box_votes_money",_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_money_for_votes",e).replace("{money}",t)),cur.votesAmountsData.resend_msg&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_getvotes_sms_resend",cur.votesAmountsData.resend_msg),cur.votesAmountsData.confirm_hash=a,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("confcode",""),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_box_confcode_wrap"),PaymentsBox.enablePaymentTypesRows(),void PaymentsBox.approveGetCode()}if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_getvotes_confirm")&&PaymentsBox.showVotesAmounts(),!cur.paymentsWideBox){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_submit");PaymentsBox.setButtons(e.innerHTML,PaymentsBox.showConfirm,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("global_back"),PaymentsBox.showVotesAmounts)}cur._popup_text=i,cur._popup_callback=!1,cur._popup_callback=function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)("payments_getvotes_submit"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_getvotes_wrap","payments_getvotes_buttons","payments_box_progress","payments_box_error"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_iframe_container"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_iframe_container").scrollTop=0};let r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("card_iframe");if(r.contentWindow.document.open("text/html","replace"),r.contentWindow.document.write(i),r.contentWindow.document.close(),cur._popup_callback(),cur.isMidas){let e=r.closest(".popup_box_container");e&&(e.style.width="520px",e.style.minWidth="520px",e.style.minHeight="560px",e.style.height=null);let t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_iframe_container");if(t.style.width="520px",t.style.minHeight="560px",t.style.height=null,r.style.width="520px",r.style.minWidth="520px",r.style.minHeight="560px",r.style.height=null,document.body.attributes.scheme&&"vkcom_dark"==document.body.attributes.scheme.value&&e&&(e.querySelector(".box_title_wrap").style.backgroundColor="#19191a",e.querySelector(".box_body").style.backgroundColor="#19191a"),cur.isHideButtonBackAndText){let t=e.querySelector(".payments_box_summary");t&&(t.style.display="none")}}cur.smsChkData=t,cur.isPaymentComplete=cur.isPaymentCanceled=cur.isPaymentFailed=!1,cur.smsChkStatCnt=0,cur.smsChkStatInt=setInterval((function(){PaymentsBox.checkStatus("dmr_checkout",t),o.use_iframe&&(cur.isPaymentCanceled||cur.isPaymentFailed)?(clearInterval(cur.smsChkStatInt),PaymentsBox.showVotesAmounts(),cur.isPaymentFailed?PaymentsBox.showBoxError(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_landing_cancelled")):PaymentsBox.showBoxError(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_payment_cancelled")),window.removeEventListener("message",PaymentsBox.frameMessage,!1)):cur.isPaymentComplete&&"dmr_checkout"!=o.name&&PaymentsBox.showTypes()}),2e3)},onFail:e=>((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isButtonLocked)("payments_getvotes_submit")||PaymentsBox.setConfirmButtons(),PaymentsBox.showBoxError(e),!0),frame:_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.safari_mobile})}static submitCard(e){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_box_progress"))return;(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockButton)("payments_getvotes_submit");const t=cur.psList.card;let o=!1;const i=(e*t.vote_cost).toFixed(2);if(!e||e<=0?o=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_web_no_sum"):t.min_amount&&e<t.min_amount?o=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_min_amount_limit_votes").replace("%s",t.min_amount):t.max_amount&&e>t.max_amount?o=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_max_amount_limit_votes").replace("%s",t.max_amount):null!=t.rest_amount_day&&e>t.rest_amount_day?o=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_rest_amount_day_votes").replace("%s",t.rest_amount_day):null!=t.rest_amount_week&&e>t.rest_amount_week&&(o=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_rest_amount_week_votes").replace("%s",t.rest_amount_week)),o)return PaymentsBox.showBoxError(o),!1;const s=PaymentsBox.getEmail();if(""===s)return(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)("payments_getvotes_submit"),!1;if(s&&"false"!==s&&!PaymentsBox.validateEmail(s))return(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.notaBene)(cur.paymentsEmailInput),PaymentsBox.showBoxError(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_error_invalid_email")),!1;if(cur.votesAmountsData.needApprove){const t=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("global_money_amount_rub",Math.floor(i));return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_getvotes_confirm_msg",cur.votesAmountsData.needApprove),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_box_votes_num",e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_box_amount",t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_box_votes_money",_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_money_for_votes",e).replace("{money}",t)),cur.votesAmountsData.resend_msg&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_getvotes_sms_resend",cur.votesAmountsData.resend_msg),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("confcode",""),delete cur.votesAmountsData.needApprove,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_box_confcode_wrap"),void PaymentsBox.approveGetCode()}let a;if(PaymentsBox.disablePaymentTypesRows(),t.use_iframe){let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_iframe_container"),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ce)("iframe",{id:"card_iframe",name:"card_iframe"},{border:0,height:"435px",width:e.parentNode.offsetWidth+"px",overflowX:"hidden",overflowY:"hidden"});t.frameBorder=0,e.innerHTML="",e.appendChild(t),window.addEventListener("message",PaymentsBox.frameMessage,!1)}else{const e=`scrollbars=1, resizable=1, menubar=1, left=${0}, top=${0}, toolbar=1, status=1`;a=window.open("","_blank",e),cur._popup_text=PaymentsBox.popupHtml(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_cards_redirect"),"",""),PaymentsBox.popupWrite(a)}const n={act:"a_getvotes_charge",type:"card",hash:cur.paymentsHash,amount:i,stat_session_id:cur.statSessionId};cur.paymentsAuthPayment&&(n.only_auth=1),s&&(n.email=s),cur.votesAmountsData.appoveCode&&(n.approve_code=cur.votesAmountsData.appoveCode),cur.isPaymentsAppOrder&&cur.paymentsOrderId&&(n.order_id=cur.paymentsOrderId,n.order_app_id=cur.paymentsOrderAppId,n.order_bill_period=cur.paymentsOrderBillPeriod,n.order_hash=cur.paymentsOrderHash),PaymentsBox.trackingProtectionEnabled((function(){(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_5__.statlogsValueEvent)("payments",0,"votes","dmr","iframe_track_protection_enabled")}),(function(){(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_5__.statlogsValueEvent)("payments",0,"votes","dmr","iframe_track_protection_disabled")})),ajax.post("al_payments.php",n,{onDone:function(o,s,n,r){if(PaymentsBox.setCurMidas(r),o){if(-2==o){t.use_iframe||a.close();const o=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("global_money_amount_rub",Math.floor(i));return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_getvotes_confirm_msg",s),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_box_votes_num",e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_box_amount",o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_box_votes_money",_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_money_for_votes",e).replace("{money}",o)),cur.votesAmountsData.resend_msg&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_getvotes_sms_resend",cur.votesAmountsData.resend_msg),cur.votesAmountsData.confirm_hash=n,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("confcode",""),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_box_confcode_wrap"),PaymentsBox.enablePaymentTypesRows(),void PaymentsBox.approveGetCode()}if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_getvotes_confirm")&&PaymentsBox.showVotesAmounts(),t.use_iframe||((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)("payments_getvotes_submit"),PaymentsBox.showProgress()),cur._popup_text=s,cur._popup_callback=!1,t.use_iframe){cur._popup_callback=function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)("payments_getvotes_submit"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_getvotes_wrap","payments_getvotes_buttons","payments_box_progress","payments_box_error"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_iframe_container"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_iframe_container").scrollTop=0};let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("card_iframe");e.contentWindow.document.open("text/html","replace"),e.contentWindow.document.write(s),e.contentWindow.document.close(),cur._popup_callback()}else a.document.open("text/html","replace"),a.document.write(s),a.document.close(),a.blur(),a.focus();cur.smsChkData=o,cur.isPaymentComplete=cur.isPaymentCanceled=cur.isPaymentFailed=!1,cur.smsChkStatCnt=0,cur.smsChkStatInt=setInterval((function(){PaymentsBox.checkStatus("card",o),!t.use_iframe&&a.closed?setTimeout((function(){cur.isPaymentComplete||(clearInterval(cur.smsChkStatInt),PaymentsBox.showBoxError(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_payment_cancelled"),"info_msg"),PaymentsBox.setConfirmButtons())}),500):t.use_iframe&&(cur.isPaymentCanceled||cur.isPaymentFailed)?(clearInterval(cur.smsChkStatInt),PaymentsBox.showVotesAmounts(),cur.isPaymentFailed?PaymentsBox.showBoxError(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_landing_cancelled")):PaymentsBox.showBoxError(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_payment_cancelled")),window.removeEventListener("message",PaymentsBox.frameMessage,!1)):cur.isPaymentComplete&&"alfabank"!=t.name&&"dmr"!=t.name&&PaymentsBox.showTypes()}),2e3)}},onFail:function(e){return t.use_iframe||a.close(),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isButtonLocked)("payments_getvotes_submit")||PaymentsBox.setConfirmButtons(),PaymentsBox.showBoxError(e),!0},frame:_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.safari_mobile})}static trackingProtectionEnabled(e,t){let o=new XMLHttpRequest;o.open("GET","https://top-fwz1.mail.ru/counter2?id=1",!0),o.onreadystatechange=function(){200!==o.status?e():t(),o.onreadystatechange=null},o.send()}static submitPaymentSystem(e){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_box_progress"))return;const t=cur.votesType,o=cur.psList[t];let i=!1,s=0,a=0,n=0,r=0;if(!o.simple_redirect){if(!e)return;s=(e*o.vote_cost).toFixed(2),a=(e*o.vote_cost/cur.usdRate).toFixed(2),n=Math.floor(s),r=100*(s-n),!e||e<=0?i=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_web_no_sum"):o.min_amount&&e<o.min_amount?i=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_min_amount_limit_votes").replace("%s",o.min_amount):o.max_amount&&e>o.max_amount?i=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_max_amount_limit_votes").replace("%s",o.max_amount):null!=o.rest_amount_day&&e>o.rest_amount_day?i=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_rest_amount_day_votes").replace("%s",o.rest_amount_day):null!=o.rest_amount_week&&e>o.rest_amount_week&&(i=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_rest_amount_week_votes").replace("%s",o.rest_amount_week))}if(i)return PaymentsBox.showBoxError(i),!1;const _=PaymentsBox.getEmail();if(""===_)return;if(_&&"false"!==_&&!PaymentsBox.validateEmail(_))return void PaymentsBox.showBoxError(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_error_invalid_email"));if(PaymentsBox.showProgress(),PaymentsBox.disablePaymentTypesRows(),"mailmoney_vkpay"===t){const e={act:"a_getvotes_charge",type:t,hash:cur.paymentsHash,amount:s,random_auth:0,stat_session_id:cur.statSessionId};ajax.post("al_payments.php",e,{onDone:(e,t,o,i)=>{PaymentsBox.setCurMidas(i);const s=(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_7__.curBox)(),a={noLocChange:1,skipBoxesHide:1,noClickHide:1};cur.isPaymentsAppOrder?cur.app.openAppInLayer(e,!1,!0,a):(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_11__.showWiki)({w:e},!1,!1,a),s._hide(!1,!0),cur.onExternalAppDone=e=>{s._show(),e.status||(PaymentsBox.showBoxError(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_payment_cancelled"),"info_msg"),PaymentsBox.setConfirmButtons(),clearInterval(cur.smsChkStatInt)),cur.onExternalAppDone=null,window.WkView&&WkView.hide(!1,!0)},cur.smsChkStatCnt=0,cur.smsChkStatInt=setInterval((function(){PaymentsBox.checkStatus(cur.votesType,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.data,null,s)}),2e3)},onFail:e=>(PaymentsBox.showBoxError(e),PaymentsBox.setConfirmButtons(),!0)})}else{if(cur.votesAmountsData.oauth_url&&(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_remember_wallet")||(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isChecked)("payments_remember_wallet"))){const e=cur.votesAmountsData.oauth_params;let i="";for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t)){i+=`<input type="hidden" autocomplete="off" name="${t}" value="${e[t]}"/>`}let a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("paymentSystemsForm");a.action=cur.votesAmountsData.oauth_url,a.method="post",a.innerHTML=i;const n=cur.votesAmountsData.popup_params||{},r="_blank",u=n.width||700,d=n.height||600,l=`scrollbars=1, resizable=1, menubar=0, left=${Math.floor(window.screen.width/2)-u/2}, top=${Math.floor(window.screen.height/2)-d/2}, width=${u}, height=${d}`,c=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payment_redirect").replace("%s",o.title),p=`<form action="${a.action}" method="${a.method}" id="popup_payment_form" accept-charset="UTF-8">${a.innerHTML}</form>`;cur._popup_text=PaymentsBox.popupHtml(c,p,"document.getElementById('popup_payment_form').submit()"),cur._popup_callback=!1,window.addEventListener("message",PaymentsBox.handlePaymentCompleteMessage,!1);let m=window.open("",r,l);cur.smsChkStatCnt=0,cur.oauthState=0;let h=0;return cur.smsChkStatInt=setInterval((function(){if(2==cur.oauthState)PaymentsBox.checkStatus(cur.votesType,cur.smsChkData);else if(0==cur.oauthState&&(h=cur.isPaymentComplete&&cur.paymentCompleteParams&&cur.paymentCompleteParams.code?cur.paymentCompleteParams.code:0,h)){cur.oauthState=1;let e={act:"a_getvotes_charge",type:t,oauth_code:h,hash:cur.paymentsHash,amount:s,stat_session_id:cur.statSessionId};return cur.paymentsAuthPayment&&(e.only_auth=1),_&&(e.email=_),void ajax.post("al_payments.php",e,{onDone:(e,t,o,i)=>{PaymentsBox.setCurMidas(i),cur.oauthState=2,cur.smsChkData=e},onFail:e=>(clearInterval(cur.smsChkStatInt),PaymentsBox.showBoxError(e),PaymentsBox.setConfirmButtons(),!0)})}(m.closed&&!cur.isPaymentComplete||cur.isPaymentComplete&&!h)&&(clearInterval(cur.smsChkStatInt),cur.isPaymentComplete?PaymentsBox.showBoxError(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_sms_money_fail")):PaymentsBox.showBoxError(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_payment_cancelled"),"info_msg"),PaymentsBox.setConfirmButtons())}),2e3),void PaymentsBox.popupWrite(m)}if(cur.votesAmountsData.provider&&-1!==["dmr","paypal","yandexmoney","api_provider"].indexOf(cur.votesAmountsData.provider)){const e=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payment_redirect").replace("%s",o.title);let i,a={act:"a_getvotes_charge",type:t,hash:cur.paymentsHash,amount:s,random_auth:0,stat_session_id:cur.statSessionId};if(_&&(a.email=_),"paypal"===cur.votesAmountsData.provider||"yandexmoney"===cur.votesAmountsData.provider){let e;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_remember_wallet")?(a.remember_wallet=(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isChecked)("payments_remember_wallet")||cur.forceRebind,cur.forceRebind&&(cur.forceRebind=!1)):a.remember_wallet=1,a.remember_wallet){const t=cur.votesAmountsData.popup_params||{},o=t.width||700,i=t.height||600;e=`scrollbars=1, resizable=1, menubar=0, left=${Math.floor(window.screen.width/2)-o/2}, top=${Math.floor(window.screen.height/2)-i/2}, width=${o}, height=${i}`}else{e=`scrollbars=1, resizable=1, menubar=1, left=${0}, top=${0}, toolbar=1, status=1`}i=a.remember_wallet?window.open("","",e):window.open("","_blank",e);const t=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payment_redirect").replace("%s",o.title);cur._popup_text=PaymentsBox.popupHtml(t,"",""),PaymentsBox.popupWrite(i)}ajax.post("al_payments.php",a,{onDone:function(t,o,s,a){if(PaymentsBox.setCurMidas(a),!t)return;let n="api_provider"!==cur.votesAmountsData.provider;cur.canOpenPopup=n;let r=!n;PaymentsBox.checkStatusCallback=t=>{if("paypal"===cur.votesAmountsData.provider||"yandexmoney"===cur.votesAmountsData.provider){if(i&&!i.closed&&!r){r=!0;let o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("paymentSystemsForm");o.action=t.action,o.method="get";let s="";for(let e in t.params)if(Object.prototype.hasOwnProperty.call(t.params,e)){s+=`<input type="hidden" autocomplete="off" name="${e}" value="${t.params[e]}"/>`}o.innerHTML=s;let a=`<form action="${o.action}" method="${o.method}" id="popup_payment_form" accept-charset="UTF-8">${o.innerHTML}</form>`;cur._popup_text=PaymentsBox.popupHtml(e,a,"document.getElementById('popup_payment_form').submit()"),PaymentsBox.popupWrite(i)}(i.closed&&!cur.isPaymentComplete||cur.isPaymentComplete)&&(clearInterval(cur.smsChkStatInt),PaymentsBox.showBoxError(cur.isPaymentComplete?_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_sms_money_fail"):_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_payment_cancelled")),PaymentsBox.setConfirmButtons())}else cur._popup||(cur._popup=window.open("","_blank"))},cur.smsChkData=t,cur.smsChkStatCnt=0,cur.smsChkStatInt=setInterval((()=>{PaymentsBox.checkStatus(cur.votesType,t)}),2e3)},onFail:function(e){return(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isButtonLocked)("payments_getvotes_submit")||PaymentsBox.setConfirmButtons(),PaymentsBox.showBoxError(e),!0}})}else{if(!cur.isAdsPayment){const t={act:"a_getvotes_invoice",type:cur.votesType,amount:s,votes:e,invoice_hash:cur.votesAmountsData.invoice_hash,stat_session_id:cur.statSessionId};ajax.post("al_payments.php",t)}let i=o.gate_params,u="",d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("paymentSystemsForm"),l=(new Date).getTime();for(let t in i)if(Object.prototype.hasOwnProperty.call(i,t)){let o=i[t];o=o.replace("{amount_votes}",e),o=o.replace("{amount_rub}",s),o=o.replace("{amount_usd}",a),o=o.replace("{amount_rub_int}",n),o=o.replace("{amount_rub_frac}",r),o=o.replace("{time}",l),u+=`<input type="hidden" autocomplete="off" name="${t}" value="${o}"/>`}let c=o.gate_url;c=c.replace("{time}",l),c=c.replace("{amount_votes}",e),c=c.replace("{amount_rub}",s),c=c.replace("{amount_usd}",a),c=c.replace("{amount_rub_int}",n),c=c.replace("{amount_rub_frac}",r),d.action=c,d.method=o.gate_method,d.innerHTML=u;const p="_blank",m=`scrollbars=1, resizable=1, menubar=1, left=${0}, top=${0}, toolbar=1, status=1`;let h=!1;try{const i=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payment_redirect").replace("%s",o.title),n=`<form action="${d.action}" method="${d.method}" id="popup_payment_form" accept-charset="${o.gate_charset}">${d.innerHTML}</form>`;cur._popup_text=PaymentsBox.popupHtml(i,n,`Payments.submitPopupForm("${t}", "${e}", "${s}", "${a}")`),cur._popup_callback=!1,h=window.open("",p,m),(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_5__.statlogsValueEvent)("payments","","votes",t,"start"),cur.smsChkData=!1,cur.isPaymentComplete=!1,cur.smsChkStatCnt=0,cur.smsChkStatInt=setInterval((function(){PaymentsBox.checkStatus(cur.votesType,!1),h.closed&&!cur.isPaymentComplete&&(clearInterval(cur.smsChkStatInt),PaymentsBox.showBoxError(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_payment_cancelled"),"info_msg"),o.simple_redirect?PaymentsBox.setButtons(!1,!1,cur.paymentsChangeType,PaymentsBox.showTypes):PaymentsBox.setConfirmButtons())}),2e3),PaymentsBox.popupWrite(h)}catch(e){d.submit()}_&&ajax.post("al_payments.php",{act:"a_set_receipt_email",email:_,hash:cur.paymentsHash},{onFail:e=>!0})}}}static approveSendCode(){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("confcode").value;if(!e.length)return void(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.notaBene)("confcode");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_box_error");let t=0;for(let o=0;o<e.length;o++)t+=parseInt(e[o]);if(t%=10,t!=cur.votesAmountsData.approveCodeChk)return PaymentsBox.showBoxError(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_invalid_code")),void(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.notaBene)("confcode");cur.votesAmountsData.appoveCode=e,PaymentsBox.showConfirm()}static approveGetCode(e){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockButton)("payments_getvotes_submit");let t={act:"a_getvotes_approve_code",hash:cur.votesAmountsData.confirm_hash};return e&&(t.resend=1),ajax.post("al_payments.php",t,{onDone:function(t,o){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)("payments_getvotes_submit"),1==t?PaymentsBox.showBoxError(o):e||(cur.votesAmountsData.approveCodeChk=o,PaymentsBox.refreshBox(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_confirm"),PaymentsBox.setButtons(cur.payments_get_votes,PaymentsBox.approveSendCode,cur.paymentsChangeType,cur.checkoutEnabled?PaymentsBox.showVotesAmounts:PaymentsBox.showTypes))},onFail:function(e){return PaymentsBox.showBoxError(e),PaymentsBox.setConfirmButtons(),!0}}),!1}static smsSendPin(){if(null==cur.votesAmountsVal)return!1;const e=cur.votesAmountsData[cur.votesAmountsVal][3],t=cur.votesAmountsData[cur.votesAmountsVal][2];if(4!=e&&8!=t&&(2!=e||5!=t))return!1;const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("confcode").value;o.length&&((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockButton)("payments_getvotes_submit"),ajax.post("al_payments.php",{act:"a_getvotes_validate",code:o,oid:cur.votesAmountsData[cur.votesAmountsVal][3],qid:cur.smsChkData.qid,hash:cur.smsChkData.hash},{onDone:function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)("payments_getvotes_submit"),PaymentsBox.showProgress(),cur.smsChkStatCnt=0,cur.smsChkStatInt=setInterval(PaymentsBox.checkStatus.pbind("sms",cur.smsChkData),2e3)},onFail:function(e){return PaymentsBox.showBoxError(e),!0}}))}static smsSendCode(){if("card"===cur.votesType)return!1;if(null!=cur.votesAmountsVal){const e=cur.votesAmountsData[cur.votesAmountsVal][3],t=cur.votesAmountsData[cur.votesAmountsVal][2];if(4==e||8==t||2==e&&5==t)return PaymentsBox.smsSendPin()}const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("confcode").value;e.length?((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockButton)("payments_getvotes_submit"),ajax.post("al_payments.php",{act:"a_getvotes_validate",pid:cur.votesAmountsVal,code:e,hash:cur.votesAmountsData[cur.votesAmountsVal].hash},{onDone:function(e){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)("payments_getvotes_submit"),e&&3==cur.votesAmountsData[cur.votesAmountsVal][2]?PaymentsBox.getVotesCharge(!1,!0):e&&PaymentsBox.getVotesCharge()},onFail:function(e){return PaymentsBox.showBoxError(e),!0}})):(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.notaBene)("confcode")}static smsGetCode(e){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockButton)("payments_getvotes_submit");let t={act:"a_getvotes_validate",hash:cur.votesAmountsData[cur.votesAmountsVal].hash,pid:cur.votesAmountsVal};e&&(t.resend=1),ajax.post("al_payments.php",t,{onDone:function(e,t){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)("payments_getvotes_submit"),2==e?(PaymentsBox.showBoxError(t,"ok_msg"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.elfocus)("confcode")):e&&3==cur.votesAmountsData[cur.votesAmountsVal][2]?PaymentsBox.getVotesCharge(!1,!0):e?PaymentsBox.getVotesCharge():(PaymentsBox.refreshBox(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_confirm"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.elfocus)("confcode"),cur.paymentsWideBox?PaymentsBox.setButtons(cur.payments_get_votes,PaymentsBox.smsSendCode,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_change_phone_number"),PaymentsBox.showPhoneForm):PaymentsBox.setButtons(cur.payments_get_votes,PaymentsBox.smsSendCode,cur.paymentsChangeType,PaymentsBox.showTypes))},onFail:function(e){return PaymentsBox.showBoxError(e),PaymentsBox.setConfirmButtons(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.elfocus)("confcode"),!0}})}static confirmPinCode(){const e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_17__.trim)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("confcode").value);if(!e.length)return void(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.notaBene)("confcode");let t={act:"a_getvotes_confirm_pin",hash:cur.updateTnxHash,ps:cur.votesType,qid:cur.smsChkData.qid,pin:e};PaymentsBox.showProgress(),ajax.post("al_payments.php",t,{onDone:function(){cur.smsChkStatInt=setInterval((()=>{PaymentsBox.checkStatus(cur.votesType,cur.smsChkData)}),2e3)},onFail:function(e){PaymentsBox.refreshBox(),PaymentsBox.showBoxError(e)}})}static checkPinKeyPress(e){if((e=e||window.event).ctrlKey||e.altKey||e.metaKey)return;let t=null;return null===e.which&&e.keyCode>=32?t=String.fromCharCode(e.keyCode):0!==e.which&&0!==e.charCode&&e.which>=32&&(t=String.fromCharCode(e.which)),null!==t?!(t<"0"||t>"9")&&void 0:void 0}static fillBDay(){let params={act:"a_getvotes_fill_bday"};ajax.post("al_payments.php",params,{onDone:function(js){if(js)try{eval(js)}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_8__.logEvalError)(e,js)}}})}static showOffer(e){let t={act:"a_getvotes_offer",offer_id:e,offer_aid:cur.paymentsOfferApp||0,app_currency:cur.offersAppCurrency||0};cur.app&&cur.app.options&&(t.aid=cur.app.options.aid),cur.paymentsOfferPreview&&(t.offer_view=cur.paymentsOfferPreview),ajax.post("al_payments.php",t,{onDone:PaymentsBox.offerOnLoad,onFail:e=>(e&&(PaymentsBox.showBoxError(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_getvotes_wrap")),!0)})}static showNextOffers(e){let t={act:"a_getvotes_amounts",type:"offers",offset:cur.offersOffset,app_currency:cur.offersAppCurrency,hash:cur.paymentsHash};cur.app&&cur.app.options&&(t.isAppOrder=cur.paymentsOfferApp?1:0,t.aid=cur.app.options.aid),ajax.post("al_payments.php",t,{onDone:function(t,o){o&&(t||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)(e),cur.offersOffset+=20,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_offers_wrap").innerHTML+=o,PaymentsBox.checkOffers())},showProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockButton)(e),hideProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)(e)})}static showConfirm(){cur.votesAmountsVal=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_amounts")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.radioval)("payments_getvotes_amounts"):0;const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("votes_num")?parseInt((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("votes_num").value,10):0;if(void 0===cur.votesAmountsVal)return;cur.votesAmountsVal&&null==cur.votesAmountsData[cur.votesAmountsVal]&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("votes_num")&&!e&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.notaBene)("votes_num");let t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_spasibo_rules_accept");if(t&&!(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isChecked)(t)){let e={text:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_spasibo_rules_not_accepted"),dir:"auto",className:"payments_terminal_tt",hasover:1};return cur.paymentsWideBox&&(e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_17__.extend)(e,{shift:[-30,10]})),void(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_13__.showTooltip)(t,e)}if((0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_7__.curBox)().changed=!0,"sms"===cur.votesType){cur.isResetCheckedMaxSmsVotesValue&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_confirm_msg").innerHTML=cur.votesAmountsData.confirm_msg_again,cur.isResetCheckedMaxSmsVotesValue=!1);const t=cur.votesAmountsData.confirm_type;if(2==t&&null!=cur.votesAmountsData.checked_max_sms_votes_val&&(cur.votesAmountsVal=cur.votesAmountsData.checked_max_sms_votes_val,cur.votesAmountsData.checked_max_sms_votes_val=0,cur.isResetCheckedMaxSmsVotesValue=!0),null==cur.votesAmountsData[cur.votesAmountsVal]&&e){if(!t)return void PaymentsBox.getVotesCharge(e,!0);cur.votesAmountsData[-1]=[e,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("global_money_amount_rub",cur._otherAmount),cur.votesAmountsData[0][2],0],cur.votesAmountsVal=-1}void 0===cur.votesAmountsData[cur.votesAmountsVal]&&(cur.votesAmountsVal=0);const o=cur.votesAmountsData[cur.votesAmountsVal][0],i=cur.votesAmountsData[cur.votesAmountsVal][1],s=cur.votesAmountsData[cur.votesAmountsVal][2],a=cur.votesAmountsData[cur.votesAmountsVal][3],n=cur.votesAmountsData[cur.votesAmountsVal][6];if(0==s){cur.smsChkData={oid:a,qid:0,hash:cur.votesAmountsData.check_hash};let e=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_to_get_send_sms",o);cur.paymentsWideBox||(e+=`<br/>${_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_service_cost")}`);const t=cur.votesAmountsData[cur.votesAmountsVal];if(e=e.replace("{number}",cur.votesAmountsData[cur.votesAmountsVal][4]),e=e.replace("{text}",`<nobr>${cur.votesAmountsData[cur.votesAmountsVal][5]}${vk.id}</nobr>`),e=e.replace("{amount}",cur.votesAmountsData[cur.votesAmountsVal][1]),t.invoice_hash&&cur.statSessionId){PaymentsBox.showWaiting("");const i={act:"a_getvotes_invoice",type:cur.votesType,oid:a,votes:o,invoice_hash:t.invoice_hash,stat_session_id:cur.statSessionId};ajax.post("al_payments.php",i,{onDone:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_waiting_msg").innerHTML=e},onFail:function(e){return clearInterval(cur.smsChkStatInt),PaymentsBox.needContinue=0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_getvotes_waiting")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_getvotes_confirm")?PaymentsBox.showVotesAmounts():PaymentsBox.setButtons(cur.payments_get_votes,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_getvotes_confirm")?PaymentsBox.getVotesCharge:PaymentsBox.showConfirm,cur.paymentsChangeType,PaymentsBox.showTypes),PaymentsBox.showBoxError(e),!0}})}else PaymentsBox.showWaiting(e)}else if(5==s||6==s||8==s)PaymentsBox.getVotesCharge();else if(7==s){PaymentsBox.getVotesCharge(),cur._popup_text=PaymentsBox.popupHtml(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_cards_redirect"),"",""),cur._popup_callback=!1,cur._popup_href=!1;const e="/payments?act=go_gate&type=sms",t=Math.floor(window.screen.width/2)-350,o=Math.floor(window.screen.height/2)-300;(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_8__.debugLog)(e),cur._popup=window.open(e,"_blank",`scrollbars=1, resizable=1, menubar=0, left=${t}, top=${o}, width=700, height=600`)}else if(1!=s&&4!=s&&1!=t)PaymentsBox.getVotesCharge(!1,!0);else{if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_box_votes_num",o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_box_amount",i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_box_votes_money",n),3==a&&(PaymentsBox.checkStatusCallback=function(e){cur.isResetCheckedMaxSmsVotesValue=!1,cur.checkedMaxVotes=e,PaymentsBox.getVotesAmounts(!0)}),2==t&&o<=cur.votesAmountsData.confirm_max_votes){if(cur.paymentsWideBox)return void PaymentsBox.getVotesCharge();(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_box_confcode_wrap"),PaymentsBox.refreshBox(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_confirm"),PaymentsBox.setButtons(cur.payments_get_votes,PaymentsBox.getVotesCharge,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("global_back"),PaymentsBox.showVotesAmounts)}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_box_confcode_wrap"),PaymentsBox.smsGetCode();cur.votesAmountsData.resend_msg&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_getvotes_sms_resend",cur.votesAmountsData.resend_msg),cur.votesAmountsData.confirm_wait_comment&&cur.votesAmountsData.confirm_wait_comment[a]?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_getvotes_confirm_comm",cur.votesAmountsData.confirm_wait_comment[a]),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_confirm_comm_wrap")):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_confirm_comm").innerHTML="",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_getvotes_confirm_comm_wrap"))}}else{let t;t=cur.votesAmountsData[cur.votesAmountsVal]?cur.votesAmountsData[cur.votesAmountsVal][0]:e,cur.checkoutEnabled?PaymentsBox.submitDmrCheckout(t):"card"===cur.votesType?PaymentsBox.submitCard(t):PaymentsBox.submitPaymentSystem(t)}}static offerOnLoad(html,js){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)("payments_getvotes_submit"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_offers_list");let offerView=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_offer_view");if(offerView){offerView.innerHTML=html,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)(offerView);try{eval(js)}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_8__.logEvalError)(e,js)}}}static showWaiting(e){const t=cur.votesAmountsData[cur.votesAmountsVal]?cur.votesAmountsData[cur.votesAmountsVal][3]:0;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_waiting_msg").innerHTML=e,t&&cur.votesAmountsData.confirm_wait_comment&&cur.votesAmountsData.confirm_wait_comment[t]?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_waiting_comm").innerHTML=cur.votesAmountsData.confirm_wait_comment[t],(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_waiting_comm")):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_waiting_comm").innerHTML="",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_getvotes_waiting_comm")),PaymentsBox.refreshBox(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_waiting"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_getvotes_buttons"),cur.paymentsWideBox&&cur.votesAmountsData[cur.votesAmountsVal]&&cur.votesAmountsData[cur.votesAmountsVal][7]?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_waiting_amount").innerHTML=cur.votesAmountsData[cur.votesAmountsVal][6],(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_waiting_phone").innerHTML=cur.votesAmountsData[cur.votesAmountsVal][7],(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_waiting_mo")):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_getvotes_waiting_mo"),delete cur.paymentsWaitingCache[cur.votesType],cur.smsChkStatInt&&clearInterval(cur.smsChkStatInt),cur.smsChkStatCnt=0,cur.smsChkStatInt=setInterval(PaymentsBox.checkStatus.pbind(cur.votesType,cur.smsChkData),2e3)}static showPhoneForm(e,t){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("_msg","payments_getvotes_phone").innerHTML=t||_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_get_votes_input_phone"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("phone").value="",PaymentsBox.refreshBox(),t&&cur.paymentsWideBox?PaymentsBox.setButtons(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_save_phone"),PaymentsBox.saveSmsPhone):PaymentsBox.setButtons(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_save_phone"),PaymentsBox.saveSmsPhone,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("global_back"),2==e?PaymentsBox.getVotesAmounts:e?PaymentsBox.showVotesAmounts:PaymentsBox.showTypes),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_phone");const o=cur.uiPhoneCountry.container;if("spasibo"===cur.votesType)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)(o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_phone_prefix","+79");else{const e=cur.uiPhoneCountry.selectedItems();if(e.length>0)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_phone_prefix",e[0][3]);else for(let e=0,t=cur.countries.length;e<t;++e)cur.countries[e][0]==cur.defCountry&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_phone_prefix",cur.countries[e][3]);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)(o)}return cur.paymentsBoxClass=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_box").className,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)("payments_box","payments_phone_form"),!1}static showPaySystemsList(){return PaymentsBox.refreshBox(),cur.paymentsWideBox&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_title").innerHTML=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_ps_list_title_header").innerText),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_ps","payments_votes_vkpay_promo_banner"),cur.votesType=!1,PaymentsBox.setButtons(!1,!1,cur.paymentsChangeType,PaymentsBox.showTypes),!1}static showVotesAmounts(){return PaymentsBox.refreshBox(),cur.checkoutEnabled?PaymentsBox.setButtons(cur.payments_get_votes,PaymentsBox.showConfirm):"card"!==cur.votesType&&cur.psList[cur.votesType]&&!cur.psList[cur.votesType].in_menu?PaymentsBox.setButtons(cur.payments_get_votes,PaymentsBox.showConfirm,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_go_ps_list"),PaymentsBox.showPaySystemsList):PaymentsBox.setButtons(cur.payments_get_votes,PaymentsBox.showConfirm,cur.paymentsChangeType,PaymentsBox.showTypes),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_cont","payments_getvotes_wrap","payments_getvotes_buttons"),cur.paymentsWideBox&&cur.paymentsOrderNotice&&((0,_web_lib_ui_util__WEBPACK_IMPORTED_MODULE_15__.showMsg)("payments_box_error",cur.paymentsOrderNotice,"info_msg",null),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_box_error")),(0,_web_lib_accessibility__WEBPACK_IMPORTED_MODULE_6__.updateAriaElements)(),delete cur.votesAmountsData.appoveCode,!1}static showTypes(){if(cur.paymentsWideBox)return PaymentsBox.showVotesAmounts(),!1;if(PaymentsBox.refreshBox(),cur.votesAmountsVal=void 0,cur.votesAmountsData=[],(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_getvotes_buttons"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_method","payments_votes_vkpay_promo_banner"),cur.paymentBoxTitle){(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_7__.curBox)().setOptions({title:cur.paymentBoxTitle})}return!1}static setButtons(e,t,o,i){if(!cur.paymentsWideBox||e){if(e){let o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_submit");o&&(o.innerHTML=e,o.onclick=t,o.dataset.taskClick="",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)(o,"payments_getvotes_buttons"))}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_getvotes_buttons");if(cur.paymentsWideBox){let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_back");e&&(e.innerHTML="",o&&e.appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ce)("div",{className:"button",innerHTML:o,onclick:i,"data-task-click":""})))}else{let e=(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_7__.curBox)();e&&(cur.paymentBoxTitle||(cur.paymentBoxTitle=e.getOptions().title),o?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("box_title",e.titleWrap).innerHTML=`<div class="back"><span class="back__icon">${(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_19__.getIcon24BrowserBack)().icon}</span>${_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_box_title_back")}</div>`,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("back",e.titleWrap).onclick=i,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("back",e.titleWrap).dataset.taskClick=""):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("box_title",e.titleWrap).innerHTML=cur.paymentBoxTitle)}}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_getvotes_buttons")}static showBoxError(e,t){if("object"==typeof e&&(e=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("global_error_occured")),e&&cur.paymentsWideBox&&cur.checkoutEnabled){let t=new _web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.MessageBox({title:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("global_error"),hideButtons:!0}),o=(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_7__.curBox)();o&&o.hide(),t.content(e).show()}else{if(e){let o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_box_error");o&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(o,""),(0,_web_lib_ui_util__WEBPACK_IMPORTED_MODULE_15__.showMsg)(o,e,t||"error"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)(o))}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_box_progress","payments_iframe_container"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_wrap"),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)("payments_getvotes_submit"),PaymentsBox.hideRowProgress(),PaymentsBox.enablePaymentTypesRows()}}static showProgress(e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_box_progress_msg","string"==typeof e?e:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_waiting_payment_complete")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_box_error","payments_getvotes_wrap","payments_getvotes_buttons"),cur.paymentsWideBox&&e?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_box_progress_link"):e||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_box_progress_link"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_box_progress")}static hideRowProgress(){["payments_getvotes_ps",cur.paymentsWideBox?"payments_box_menu":"payments_getvotes_method"].forEach((e=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)(e)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("payments_getvotes_active_row",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)(e)).forEach((t=>{"payments_box_menu"!==e?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)(t,"payments_getvotes_active_row"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)(t,"payments_progress")}))}))}static refreshBox(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_box_progress","payments_box_error","payments_getvotes_method","payments_getvotes_cont","payments_getvotes_phone","payments_getvotes_confirm","payments_getvotes_waiting","payments_getvotes_other","payments_getvotes_terminals","payments_getvotes_ps","payments_getvotes_foreign_cards_warning","payments_iframe_container"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_wrap"),cur.smsChkStatInt&&!cur.paymentsWideBox&&clearInterval(cur.smsChkStatInt),cur.paymentsBoxClass&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_box").className=cur.paymentsBoxClass,cur.paymentsBoxClass=""),cur.votesType&&"card"!==cur.votesType||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_foreign_cards_warning"),PaymentsBox.enablePaymentTypesRows()}static saveSmsPhone(){const e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_17__.trim)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("phone")),t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_17__.trim)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_phone_prefix")||{})||"");e&&(cur.paymentsWaitingCache.sms&&(clearInterval(cur.paymentsWaitingCache.sms[2]),delete cur.paymentsWaitingCache.sms),cur.newSmsPhone=t+e,PaymentsBox.getVotesAmounts())}static startFormMeasure(){cur.formMeasureTime=Date.now(),vk.dev&&(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_8__.debugLog)(cur.formMeasureTime)}static finishFormMeasure(e){if(cur.formMeasureTime){const t=Date.now()-cur.formMeasureTime;vk.dev&&(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_8__.debugLog)(t),delete cur.formMeasureTime,(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_5__.statlogsValueEvent)("payments_frame_load_time",t,e)}}static frameMessage(e){if(!e.origin.match(/^https?:\/\/([a-zA-Z0-9\-\.]+\.)?paymentgate\.ru$/)&&!e.origin.match(/^https?:\/\/([a-zA-Z0-9\-\.]+\.)?money\.mail\.ru$/)&&!e.origin.match(/^https?:\/\/co\.vkpay\.io$/))return!1;let t={};if(e.data){switch(typeof e.data){case"object":t=e.data;break;case"string":"{"===e.data.substr(0,1)&&(t=(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_16__.parseJSON)(e.data))}if("billing"!==t.type)return!1}if("pageLoad"===t.action||"formLoad"===t.action)cur.paymentsIgnoreResize=!1;else if("paySuccess"===t.action||"closeWindow"==t.action&&"ok"==t.action_params.status)cur.paymentsIgnoreResize=!0,cur.checkoutEnabled&&(PaymentsBox.showProgress(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_iframe_container"));else if("submit"===e.data||"3dsPage"===t.action)setTimeout(PaymentsBox.frameHeight.pbind(600,!0),200),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)("payments_iframe_container",cur.checkoutEnabled?"payments_threeds_checkout_frame":"payments_threeds_frame");else if("3dsFinish"===t.action)PaymentsBox.frameHeight(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)("payments_iframe_container",cur.checkoutEnabled?"payments_threeds_checkout_frame":"payments_threeds_frame");else if("resizeFrame"===t.action)if(t.action_params.height<10&&cur.paymentsIgnoreResize)cur.paymentsIgnoreResize=!1;else{const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_iframe_container");e&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(e,"payments_threeds_checkout_frame")&&setTimeout(PaymentsBox.frameHeight.pbind(t.action_params.height),200)}else"putPixel"===t.action&&"page_load"===t.action_params.alias?(PaymentsBox.finishFormMeasure("dmr"),(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_5__.statlogsValueEvent)("payments",0,"votes","dmr","iframe_loaded")):"session_fail"===t.action?(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_5__.statlogsValueEvent)("payments",0,"votes","dmr","iframe_session_fail"):("payError"===t.action||"closeWindow"==t.action&&["error","cancel"].includes(t.action_params.status))&&cur.checkoutEnabled?PaymentsBox.checkoutDecline(t.action_params):"typePaymentMethod"===t.action&&cur.checkoutEnabled&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)("payments_iframe_container","payments_threeds_checkout_frame"),t.action_params&&t.action_params.system&&PaymentsBox.checkoutPayMethodChanged(t.action_params.system))}static frameHeight(e,t){let o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("card_iframe");o&&(e?(cur.prevFrameHeight=o.style.height,o.style.height=e+"px"):(o.style.height=cur.prevFrameHeight,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)("payments_iframe_container",cur.checkoutEnabled?"payments_threeds_checkout_frame":"payments_threeds_frame")));let i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_iframe_container");i&&(cur.paymentsWideBox&&!cur.checkoutEnabled||t||(i.style.height=(e||cur.prevFrameHeight)+(cur.checkoutEnabled?0:10)+"px"),i.scrollTop=0)}static paymentCanceled(e){e?cur.isPaymentFailed=!0:cur.isPaymentCanceled=!0,PaymentsBox.frameHeight()}static checkoutDecline(e){let t=e||{};t.act="checkout_decline",t.qid=cur.smsChkData.qid,t.hash=cur.smsChkData.declineHash,ajax.post("payments",t,{onDone:function(e){return PaymentsBox.stopCheckAndShowError(e),!0},onFail:function(e){return PaymentsBox.stopCheckAndShowError(e),!0}})}static checkoutPayMethodChanged(e){e&&ajax.post("payments",{act:"checkout_ps_choose",qid:cur.smsChkData.qid,pay_method:e})}static stopCheckAndShowError(e){clearInterval(cur.smsChkStatInt),PaymentsBox.needContinue=0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_getvotes_waiting")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_getvotes_confirm")?PaymentsBox.showVotesAmounts():cur.checkoutEnabled?PaymentsBox.setButtons(cur.payments_get_votes,PaymentsBox.showConfirm):PaymentsBox.setButtons(cur.payments_get_votes,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_getvotes_confirm")?PaymentsBox.getVotesCharge:PaymentsBox.showConfirm,cur.paymentsChangeType,PaymentsBox.showTypes),PaymentsBox.showBoxError(e)}static complete(e,t){cur.paymentCompleteParams=t,cur.isPaymentComplete=!0}static checkStatus(e,t,o,i){if("sms"===e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_box_progress")&&!cur.paymentsWideBox&&7!=cur.votesAmountsData[cur.votesAmountsVal][2])if(15==cur.smsChkStatCnt)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_box_progress_msg").innerHTML=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_waiting_payment_complete_still");else if(cur.smsChkStatCnt>30){return clearInterval(cur.smsChkStatInt),cur.isPaymentAttemted=!0,(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_7__.curBox)().hide(),void(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_internet_getting_votes"),_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_get_votes_delay"))}let s={act:"a_getvotes_check",type:e,votes_purchase:cur.isPaymentsAppOrder||cur.paymentsWideBox||cur.paymentsInstantPayType?0:1};t&&(t.oid||t.qid)?(s.oid=t.oid,s.qid=t.qid,s.hash=t.hash):s.hash=cur.psList[e].check_hash,0==cur.smsChkStatCnt&&(s.start=1),cur.statSessionId&&(s.stat_session_id=cur.statSessionId),t.test&&(s.test=1);let a=i||(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_7__.curBox)();ajax.post("al_payments.php",s,{onDone:function(o,i,s){if("sms"===e&&cur._popup&&cur._popup.closed)return clearInterval(cur.smsChkStatInt),cur.smsChkStatCnt=0,PaymentsBox.showBoxError(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_payment_cancelled"),"info_msg"),void PaymentsBox.setConfirmButtons();if(o){if(1==o){if(window.cur.paymentSuccess=!0,"mailmoney_vkpay"===e&&WkView&&(a._show(),cur.onExternalAppDone=null,WkView.hide(!1,!0)),cur.isPaymentAttemted=!0,PaymentsBox.needContinue&&(cur.needContinue=1,PaymentsBox.needContinue=0),cur.paymentsHideLastBoxOnly)boxQueue.hideLast(!1),delete cur.paymentsHideLastBoxOnly;else for(;boxQueue.count();)boxQueue.hideLast(!1);if(i&&!cur.isPaymentsAppOrder&&(!cur.paymentsTryCompleteOrder||!a.onDone)){let e=new _web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.MessageBox({width:400,hideButtons:!0,bodyStyle:"padding: 0; border-radius: 8px;"});e.content(i),e.show()}s&&(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_16__.updateMoney)(s)}else if(2==o||10==o)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_getvotes_waiting")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_getvotes_confirm")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_iframe_container")?PaymentsBox.showVotesAmounts():PaymentsBox.setButtons(cur.payments_get_votes,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_getvotes_confirm")?PaymentsBox.getVotesCharge:PaymentsBox.showConfirm,cur.paymentsChangeType,PaymentsBox.showTypes),PaymentsBox.showBoxError(i);else if(3==o){let o="sms"===e;cur.votesAmountsData[cur.votesAmountsVal]?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_box_votes_num",cur.votesAmountsData[cur.votesAmountsVal][0]),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_box_amount",cur.votesAmountsData[cur.votesAmountsVal][1]),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_box_votes_money",o?cur.votesAmountsData[cur.votesAmountsVal][6]:cur.votesAmountsData[cur.votesAmountsVal][1])):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_box_votes_num",cur._otherVotes),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_box_amount",cur._otherAmount+" "+(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.langNumeric)(cur._otherAmount,cur.votesAmountsData.currency_price_str)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_box_votes_money",cur._otherAmount+" "+(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.langNumeric)(cur._otherAmount,cur.votesAmountsData.currency_price_str))),o||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_getvotes_confirm_msg",_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_get_votes_ps_enter_code")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_getvotes_confirm_amount")),cur.votesAmountsData.confirm_wait_comment&&cur.votesAmountsData.confirm_wait_comment[t.oid]?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_confirm_comm").innerHTML=cur.votesAmountsData.confirm_wait_comment[t.oid],(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_confirm_comm_wrap")):o&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_confirm_comm").innerHTML="",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_getvotes_confirm_comm_wrap")),"spasibo"===e&&(cur.updateTnxHash=i),PaymentsBox.refreshBox(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_box_confcode_wrap","payments_getvotes_confirm"),o&&i&&PaymentsBox.showBoxError(i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("confcode").onkeypress=o?"":PaymentsBox.checkPinKeyPress,PaymentsBox.setButtons(cur.payments_get_votes,o?PaymentsBox.smsSendCode:PaymentsBox.confirmPinCode,cur.paymentsChangeType,PaymentsBox.showTypes)}else{if(4==o){if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_getvotes_waiting")&&!cur.paymentsWaitingCache.sms){let e=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_to_get_send_sms",cur.votesAmountsData[cur.votesAmountsVal][0]);cur.paymentsWideBox||(e+=`<br/>${_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_service_cost")}`),e=e.replace("{number}",i.service_number),e=e.replace("{text}",`<nobr>${i.message_text}</nobr>`),e=e.replace("{amount}",cur.votesAmountsData[cur.votesAmountsVal][1]),PaymentsBox.showWaiting(e)}return}if(5==o)PaymentsBox.refreshBox(),PaymentsBox.showConfirm();else if(6==o)delete cur.votesAmountsData.oauth_url,delete cur.paymentsInstantPayType,PaymentsBox.showVotesAmounts(),PaymentsBox.showBoxError(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_instant_pay_amount_limit_error")),PaymentsBox.setConfirmButtons(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_remember_wallet",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("payments_getvotes_confirm_descr","payments_getvotes_cont"));else{if(7==o)return void(cur._popup&&!cur._popup_href&&(cur._popup_href=i,cur._popup.location.href=i));if(8==o)return void PaymentsBox.checkStatusCallback(i);if(9==o)return void PaymentsBox.show3DsFrame(i,s)}}clearInterval(cur.smsChkStatInt),cur.smsChkStatCnt=0}},onFail:function(e){return PaymentsBox.stopCheckAndShowError(e),!0}}),cur.smsChkStatCnt++}static checkStatusCallback(e){}static getVotesCharge(e,t){if((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isButtonLocked)("payments_getvotes_submit")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_box_progress"))return;if(!((e=parseInt(e,10))||null!=cur.votesAmountsVal&&cur.votesAmountsData[cur.votesAmountsVal]))return;let o={act:"a_getvotes_charge",type:cur.votesType,hash:cur.paymentsHash,stat_session_id:cur.statSessionId};const i=PaymentsBox.getEmail();""!==i&&(i&&(o.email=i),t?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockButton)("payments_getvotes_submit"):PaymentsBox.showProgress(),e?(o.pid=-1,o.votes=e):(o.pid=cur.votesAmountsVal,-1==cur.votesAmountsVal&&(o.votes=cur.votesAmountsData[cur.votesAmountsVal][0])),cur.isResetCheckedMaxSmsVotesValue&&(o.pay_by_repay_status=1),PaymentsBox.disablePaymentTypesRows(),ajax.post("al_payments.php",o,{onDone:(o,i,s,a)=>{PaymentsBox.setCurMidas(a),PaymentsBox.votesChargeOnDone(o,e,t)},onFail:e=>((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)("payments_getvotes_submit"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_box_progress")&&PaymentsBox.setButtons(cur.payments_get_votes,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_getvotes_confirm")?PaymentsBox.getVotesCharge:PaymentsBox.showConfirm,cur.paymentsChangeType,PaymentsBox.showTypes),PaymentsBox.showBoxError(e),!0)}))}static votesChargeOnDone(e,t,o){if(e)if((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)("payments_getvotes_submit"),-1==e)PaymentsBox.getVotesAmounts(!0);else if(e.qid)if(cur.smsChkData=e,o){const e=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_for_get_n_votes",t||cur.votesAmountsData[cur.votesAmountsVal][0]);let o=cur.votesAmountsData.confirm_wait_msg.replace("{amount}",e);if(o+=t?`<br/>${_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_service_cost_rubles",cur._otherAmount)}`:`<br/>${_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_service_cost").replace("{amount}",cur.votesAmountsData[cur.votesAmountsVal][1])}`,cur.paymentsWideBox){o+=`<br><br/><a onclick="return PaymentsBox.showPhoneForm(1);">${_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_change_phone_number")}</a>`}PaymentsBox.showWaiting(o)}else cur.smsChkStatCnt=0,cur.smsChkStatInt=setInterval(PaymentsBox.checkStatus.pbind(cur.votesType,e),2e3)}static getVotesAmounts(e,t,o){if(null!=t&&cur.paymentsWideBox){if(cur.votesType==t&&cur.votesTypeInit!=t&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_getvotes_cont")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_getvotes_terminals")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_getvotes_ps")))return;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_getvotes_waiting")?cur.paymentsWaitingCache[cur.votesType]=[(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_title").innerHTML,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_waiting").innerHTML,cur.smsChkStatInt]:cur.smsChkStatInt&&!cur.paymentsWaitingCache[t]&&clearInterval(cur.smsChkStatInt),cur.votesType=t}else null!=t&&(cur.votesType=t);if(!cur.votesType)return void(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_foreign_cards_warning");if(cur.paymentsWideBox&&!o&&(o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domPN)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("payments_method_"+cur.votesType,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_box_menu")))),cur.paymentsWideBox&&cur.paymentsTypesSum&&cur.paymentsTypesSum[t]){let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_summary_bill");e?e.innerHTML=cur.paymentsTypesSum[t]:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_order_sum",cur.paymentsTypesSum[t]),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_17__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("payments_tt"),((e,t)=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)(t)}))}let i="term"===cur.votesType||"ps"===cur.votesType;if(i){PaymentsBox.refreshBox(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_getvotes_method");let e="";if("term"===cur.votesType?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_terminals"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_votes_vkpay_promo_banner"),e="payments_terminals_title_header"):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_ps"),e="payments_ps_list_title_header"),cur.paymentsWideBox&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_title").innerHTML=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)(e).innerText),PaymentsBox.setButtons(!1,!1,cur.paymentsChangeType,PaymentsBox.showTypes),!cur.paymentsWideBox)return}const s=["payments_getvotes_ps",cur.paymentsWideBox?"payments_box_menu":"payments_getvotes_method"];for(let t=0;t<s.length;t++){let a=s[t];if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)(a)||cur.paymentsWideBox&&!o||"payments_box_menu"===a&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_getvotes_ps")&&o&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(o.parentNode,"payments_getvotes_ps_list"))continue;let n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)(a),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("payments_getvotes_active_row",n);if(!e&&r.length&&!cur.paymentsWideBox)return;r.forEach((e=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)(e,"payments_getvotes_active_row"),cur.paymentsWideBox&&!i&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)(e,"payments_progress")}))}if(o&&(!cur.paymentsWideBox||"payments_box_menu"!==o.parentNode.id||i||e||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)(o,"payments_progress"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)(o,"payments_getvotes_active_row")),cur.paymentsWideBox&&cur.paymentsWaitingCache[t])return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_title").innerHTML=cur.paymentsWaitingCache[t][0],(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_waiting").innerHTML=cur.paymentsWaitingCache[t][1],PaymentsBox.refreshBox(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_waiting","payments_getvotes_title"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_getvotes_buttons"),void PaymentsBox.hideRowProgress();if(i)return;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_getvotes_buttons")&&!cur.paymentsWideBox&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockButton)("payments_getvotes_submit");let a={act:"a_getvotes_amounts",type:cur.votesType,prefer_votes:cur.paymentsPreferVotes,hash:cur.paymentsHash};if(cur.statSessionId&&(a.stat_session_id=cur.statSessionId),cur.isPaymentsAppOrder&&cur.paymentsOrderAppId&&(a.aid=cur.paymentsOrderAppId,cur.paymentsOrderBillPeriod&&(a.bill_period=cur.paymentsOrderBillPeriod),cur.paymentsOrderDiscount&&(a.discount=cur.paymentsOrderDiscount)),"sms"===a.type)cur.checkedMaxVotes&&(a.checked_max_votes=cur.checkedMaxVotes,cur.checkedMaxVotes=0),cur.newSmsPhone&&(a.phone=cur.newSmsPhone,cur.newSmsPhone=!1),cur.isCorpPhone&&(a.corp=cur.isCorpPhone,cur.isCorpPhone=!1);else if("offers"===a.type){if(cur.app&&cur.app.options&&(a.isAppOrder=cur.paymentsOfferApp?1:0,a.aid=cur.app.options.aid,a.orderBox=cur.isPaymentsAppOrder?1:0),cur.paymentsPreload)return PaymentsBox.getVotesAmountsOnDone.apply(this,cur.paymentsPreload),cur.paymentsPreload=!1,void(cur.paymentsOfferPreload&&(PaymentsBox.offerOnLoad.apply(this,cur.paymentsOfferPreload),cur.paymentsOfferPreload=!1,cur.paymentsOneOffer=!0))}else if("spasibo"===a.type)cur.newSmsPhone&&(a.phone=cur.newSmsPhone,cur.newSmsPhone=!1),cur.needContinue&&(a.continue=1,cur.needContinue=0);else if(cur.psList[a.type]&&cur.psList[a.type].simple_redirect)return PaymentsBox.hideRowProgress(),void PaymentsBox.submitPaymentSystem();ajax.post("al_payments.php",a,{onDone:PaymentsBox.getVotesAmountsOnDone,onFail:e=>(PaymentsBox.showBoxError(e),!0)})}static getVotesAmountsOnDone(result,html,data,js,title){if(PaymentsBox.hideRowProgress(),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)("payments_getvotes_submit"),cur.paymentsWideBox&&(title&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_getvotes_title",title),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_title")),data&&data.menu_money)){let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_summary_bill");e?e.innerHTML=data.menu_money:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(`payments_method_${cur.votesType}_descr`,data.menu_money)}if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_votes_vkpay_promo_banner"),-1==result)return void PaymentsBox.showPhoneForm();if(-2==result)return void PaymentsBox.showPhoneForm(!1,html);if(-3==result){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("payments_getvotes_method_opt","payments_box_menu");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("payments_getvotes_active_row","payments_box_menu"));for(let t=0;t<e.length;t++){let o=e[t];if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(o,"payments_getvotes_active_row")){o.onclick();break}}return}if(!result)return PaymentsBox.showProgress(""),void(cur.smsAmountsInt=setTimeout((()=>{PaymentsBox.getVotesAmounts(!0)}),1e3));if(!html)return;let other;if(2==result?(other=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_other"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(other,html)):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_getvotes_cont",html),cur.votesAmountsData=data,(cur.fromInstantPay&&2==cur.votesAmountsData.confirm_type||2!=cur.votesAmountsData.confirm_type||!cur.votesAmountsData.checked_max_sms_votes_val)&&PaymentsBox.showVotesAmounts(),cur.votesType&&"card"!==cur.votesType?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_getvotes_foreign_cards_warning"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_foreign_cards_warning"),cur.paymentsPreload&&"offers"===cur.votesType?PaymentsBox.setButtons(!1):"offers"===cur.votesType?PaymentsBox.setButtons(!1,!1,cur.paymentsChangeType,PaymentsBox.showTypes):cur.paymentsPreload&&PaymentsBox.setButtons(cur.payments_get_votes,PaymentsBox.showConfirm),window.radioBtns.payments_getvotes_amounts={els:Array.prototype.slice.apply((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("radiobtn",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_amounts")))},data.confirm_msg&&data.confirm_type&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_getvotes_confirm_msg",data.confirm_msg),2==result&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_getvotes_wrap"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)(other)),js)try{eval(js)}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_8__.logEvalError)(e,js)}cur.instantNeedCVV&&(PaymentsBox.showConfirm(),cur.instantNeedCVV=!1),cur.paymentsEmailInput=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_receipt_email"),cur.paymentsEmailCheckbox=!!cur.paymentsEmailInput&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("_checkbox",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domPN)(cur.paymentsEmailInput))}static popupHtml(e,t,o){return`<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">\n<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">\n<head>\n    <meta http-equiv="content-type" content="text/html; charset=windows-1251" />\n    <meta http-equiv="X-UA-Compatible" content="IE=edge" />\n    <style>\n        body {font-family:tahoma,verdana,arial,sans-serif,Lucida Sans; font-size:11px;}\n        .text {position:relative; top:40%; text-align:center; line-height:24px;}\n        .text img {margin-bottom:8px;}\n        .text_container {position:absolute; top:0; left:0; right:0; bottom:0; line-height:150%; height: 100%;}\n    </style>\n    <script type="text/javascript">\n      if (!window.vk) window.vk = {loginscheme: '${vk.loginscheme}', ip_h: '${vk.ip_h}', __domain: '${(0,_shared_lib_site__WEBPACK_IMPORTED_MODULE_4__.getHostName)()}'};\n    <\/script>\n    <script type="text/javascript" src="${window.stManager.getCompiledPath(window.jsc("web/payments_legacy.js"))}"><\/script>\n</head>\n<body>\n${t}\n<div id="wait_text_container" class="text_container">\n    <div class="text">\n        <img src="/images/progress.gif" /><br/>${e}\n    </div>\n</div>\n<script type="text/javascript">\n  var st = setTimeout(function() {try {${o}; clearTimeout(st)} catch(e) {}}, 100)\n<\/script>\n</body>\n</html>`}static viewOffer(e){this.setButtons(e,(()=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("start_offer").submit(),PaymentsBox.setButtons(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("payments_back_to_offers_list"),PaymentsBox.backToOffersList,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("global_cancel"),PaymentsBox.backToOffersList)}),_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("global_cancel"),PaymentsBox.backToOffersList)}static backToOffersList(){if(cur.paymentsOneOffer)return(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_7__.curBox)().hide();(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_offer_view"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_offers_list"),cur.votesTypeInit||!1===cur.votesTypeInit?PaymentsBox.setButtons(!1):PaymentsBox.setButtons(!1,!1,cur.paymentsChangeType,PaymentsBox.showTypes)}static initializeOfferChecker(e,t,o,i){cur.offersOffset=e,cur.offersAppCurrency=t,PaymentsBox.checkOffersList=[],PaymentsBox.checkOffersDo=()=>{if(o)return;const e=PaymentsBox.checkOffersList.join(",");PaymentsBox.checkOffersList=[],ajax.post("al_payments.php",{act:"a_offers_stat",offers:e,hash:i}),PaymentsBox.checkOffersTO=!1},PaymentsBox.checkOffers(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.addEvent)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("box_layer_wrap"),"scroll",PaymentsBox.checkOffers)}static removeCheckOffersEvent(){(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.removeEvent)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("box_layer_wrap"),"scroll",PaymentsBox.checkOffers)}static checkOffers(){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("payments_offer",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_offers_wrap")),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("box_layer_wrap").scrollTop,o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getSize)("box_layer_wrap")[1];e.forEach((e=>{const i=e,s=i.offsetTop;s+30<t+o&&s+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getSize)(i)[1]-20>t&&!i.getAttribute("checked")&&(i.setAttribute("checked",1),PaymentsBox.checkOffersList.push(i.id.substr(15)),PaymentsBox.checkOffersTO||(PaymentsBox.checkOffersTO=setTimeout(PaymentsBox.checkOffersDo,1e3)))}))}static offersRemoveButtons(){cur.votesTypeInit?PaymentsBox.setButtons(!1):PaymentsBox.setButtons(cur.paymentsChangeType,PaymentsBox.showTypes,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("global_close"),(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_7__.curBox)().hide)}static disablePaymentTypesRows(){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("payments_getvotes_method_opt");if(e&&e.length>0)for(let t=0;t<e.length;t++){let o=e[t];o.classList.contains("payments_getvotes_active_row")?o.classList.add("payments_getvotes_noevents_row"):o.classList.add("payments_getvotes_disabled_row","payments_getvotes_noevents_row")}}static enablePaymentTypesRows(){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("payments_getvotes_method_opt");if(e&&e.length>0)for(let t=0;t<e.length;t++)e[t].classList.remove("payments_getvotes_disabled_row","payments_getvotes_noevents_row")}static handlePaymentCompleteMessage(e){e.origin==window.origin&&e.data.type&&"paymentCompleteMessage"===e.data.type&&window.PaymentsBox.complete(e.data.newUrl,e.data.params)}static setCurMidas(e){"object"==typeof e&&"isMidas"in e&&("cur"in window||(window.cur={}),window.cur.isMidas=Boolean(e.isMidas))}}},3677:(e,t,o)=>{"use strict";o.d(t,{initSettingsAddressBox:()=>d});var i=o(452314),s=o(879007),a=o(317412),n=o(810903),r=o(248298),_=o(610989),u=o(258643);function d(e,t){e.setOptions({title:_.getLang("settings_addrbox_title")});const o=document.querySelector("#settdbx_addr"),d=document.querySelector("#settdbx_addr_tt_place");o.onfocus=function(){-2===cur.addrChecked&&(0,n.showTooltip)(d,{text:_.getLang("settings_addrbox_hint"),dir:"left",slideX:15,className:"settings_pwd_tt",shift:[-12,-15,0],onCreate:function(){(0,a.removeEvent)(d,"mouseout")}})},o.onblur=function(){d.tt&&d.tt.hide()},(0,i.elfocus)(o),setTimeout(i.elfocus.pbind(o),100),(0,i.setStyle)(o,{width:230-(0,i.ge)("settdbx_base").offsetWidth-8}),(0,s.extend)(cur,{settDomainCheckAddress:function(e){clearTimeout(cur.addressCheckTO),cur.lastAddress!==(0,i.val)("settdbx_addr")&&(cur.addressCheckTO=setTimeout(cur.settDomainDoCheckAddress,e||0))},settDomainDoCheckAddress:function(){let e=document.querySelector("#settdbx_submit"),t=document.querySelector("#settdbx_advices");cur.lastAddress=(0,i.val)("settdbx_addr"),ajax.post("al_settings.php",{act:"a_check_address",name:cur.lastAddress,from:"box"},{onDone:function(o){cur.addrChecked=1,u.FlatButton.setLabel(e,o),u.FlatButton.setDisabled(e,!1),(0,i.val)(t,"")},onFail:function(s){let a=(s=s.split("<*>"))[1],n=s[2];return s=s[0],n?(cur.addrChecked=-2,o.onfocus()):(cur.addrChecked=-1,o.onblur()),u.FlatButton.setLabel(e,s),u.FlatButton.setDisabled(e,!0),(0,i.val)(t,a),!0}})},settDomainAdvisedAddress:function(e){(0,i.val)("settdbx_addr",e),cur.settDomainCheckAddress()},settDomainAddressSubmit:function(e){if(1!==cur.addrChecked)return void(0,r.notaBene)("settings_addr");let o=(0,i.val)("settdbx_addr"),s={act:"a_change_address",hash:t,name:o};u.FlatButton.lock(e),window.ajax.post("al_settings.php",s,{onDone:function(e){nav.go(o,!1,{params:{from:"address_box"}})},showProgress:()=>u.FlatButton.lock(e),hideProgress:()=>u.FlatButton.unlock(e)})}})}},992851:(e,t,o)=>{"use strict";o.d(t,{showNextPaymentsHistory:()=>n});var i=o(248298),s=o(714209),a=o(452314);const n=(e,t)=>{if((0,i.isButtonLocked)(e))return;let o,n;return(0,i.lockButton)(e),t||(t="votes"),void 0===cur.historyOffset[t]&&(cur.historyOffset[t]=5),"transfer"===t?(o={act:"a_transfer_history"},n=(0,a.ge)("settings_transfer_history")):"subscriptions"===t?(o={act:"a_payments_subsciptions"},n=(0,a.ge)("settings_payments_subscriptions")):"games"===t?(o={act:"a_payments_games"},n=(0,a.ge)("settings_payments_games")):"goods_orders"===t?(o={act:"a_payments_goods_orders"},n=(0,a.ge)("settings_payments_goods_orders")):(o={act:"a_votes_history"},n=(0,a.ge)("settings_votes_history")),o.offset=n.rows.length,"subscriptions"===t&&(o.extra_items_count=cur.historyExtraItemsSubscriptions),ajax.post("al_settings.php",o,{onDone:function(o,r,_){const u=n.tBodies[0];if(o){if((0,i.unlockButton)(e),s.browser.msie){const e=(0,a.se)("<table>"+o+"</table>");Array.from((0,a.geByTag)("tr",e)).forEach((e=>{1===e.nodeType&&u.appendChild(e)}))}else u.insertAdjacentHTML("beforeEnd",o);"subscriptions"===t&&_&&(cur.historyExtraItemsSubscriptions=_)}o&&!r||((0,a.addClass)(u.lastChild,"settings_votes_history_last"),(0,a.hide)(e))}}),!1}},555282:(e,t,o)=>{"use strict";o.d(t,{AudioList:()=>_});var i=o(434518),s=o(763812),a=o(306198),n=o(605204),r=(0,s._)("_ensureFetchable");class _{fetchAt(e,t){return(0,i._)(this,r)[r]().fetchAt(e,t)}fetchNext(e){return(0,i._)(this,r)[r]().fetchNext(e)}async ensureAt(e){const t=this.ensureAbsIndex(e);let o=this.audioAt(t);return o||this.fetchAt(t,{prefetch:!0})}ensureAbsIndex(e){return(0,a.ensureAudioListAbsIndex)(this,e)}get maxIndex(){return(0,n.getAudioListMaxIndex)(this)}constructor(){Object.defineProperty(this,r,{value:u})}}function u(){const{fetchable:e}=this;if(!e)throw new Error("AudioListFetchable not implemented");return e}},306198:(e,t,o)=>{"use strict";o.d(t,{ensureAudioListAbsIndex:()=>a});var i=o(415096),s=o(458820);function a(e,t){const o=(0,i.indexAbs)(e.length,t);if(!(0,s.isValidAudioListAbsIndex)(e,o))throw new Error("Index is out of range");return o}},605204:(e,t,o)=>{"use strict";function i(e){const t=e.length;return e.infinite?t:t-1}o.d(t,{getAudioListMaxIndex:()=>i})},458820:(e,t,o)=>{"use strict";o.d(t,{isValidAudioListAbsIndex:()=>s});var i=o(605204);function s(e,t){return t>=0&&t<=(0,i.getAudioListMaxIndex)(e)}},486973:(e,t,o)=>{"use strict";o.d(t,{toAudioData:()=>n});var i=o(966512),s=o(590572),a=o(760325);function n(e){const{duration:t}=e;return{identity:(0,i.toOwnedAudioIdentityData)(e),title:e.title,artwork:u(e),url:e.url||null,isExplicit:e.is_explicit??!1,authors:r(e),duration:Number.isFinite(t)?t:void 0,isBlocked:d(e)}}function r(e){return{main:e?.main_artists?.map(_)??[],feat:e?.featured_artists?.map(_)??[],raw:e.artist}}function _(e){return{name:e.name}}function u(e){const t=e.album?.thumb;return t?(0,s.toAudioArtworkImages)(t):[]}function d({dmca_blocked:e,content_restricted:t}){return!!e||(0,a.isNumber)(t)&&0!==t}},966512:(e,t,o)=>{"use strict";function i(e){return{id:e.id,ownerId:e.owner_id,accessKey:e.access_key}}o.d(t,{toOwnedAudioIdentityData:()=>i})},379183:(e,t,o)=>{"use strict";var i;o.d(t,{AudioType:()=>i}),function(e){e.MusicTrack="music_track",e.MusicSnippet="music_snippet",e.PodcastEpisode="podcast_episode",e.PodcastTrailer="podcast_trailer",e.Radio="radio"}(i||(i={}))},590572:(e,t,o)=>{"use strict";o.d(t,{toAudioArtworkImages:()=>s});const i=[["photo_34",34],["photo_68",68],["photo_135",135],["photo_270",270],["photo_300",300],["photo_600",600],["photo_1200",1200]];function s(e){const t=[];if(!e)return t;for(const[o,s]of i){const i=e[o];i&&t.push({src:i,size:s})}return t}},330690:(e,t,o)=>{"use strict";o.d(t,{AudioNavScreenModalType:()=>d,AudioNavScreenPageType:()=>u,AudioNavScreenProvider:()=>l});var i,s=o(434518),a=o(763812),n=o(331635),r=o(127126);const _=(0,o(942451).makeSharedState)("domains/audio/AudioNavScreenState",(()=>({page:null,catalogSectionId:null,modals:[]})),{version:1});var u,d;!function(e){e.Catalog="audio_catalog",e.Artist="music_artist",e.Album="music_album",e.Playlist="music_playlist",e.Track="music_track",e.SnippetsFeed="music_snippets_list",e.Podcast="podcast_podcast"}(u||(u={})),function(e){e.Album="music_album_popup",e.Playlist="music_playlist_popup",e.Longtap="music_longtap_preview_popup",e.PodcastEpisode="podcast_episode_popup"}(d||(d={}));let l=(i=(0,a._)("_clearModal"),class{get isModal(){return!!_().modals.length}get screen(){const e=_(),t=e.modals[0];return t||e.page}get catalogSectionId(){return this.screen!==u.Catalog?null:_().catalogSectionId}setPage(e,t){const o=_();o.page=e,o.catalogSectionId=t??null}clearPage(){const e=_();e.page=null,e.catalogSectionId=null}pushModal(e){_().modals.unshift(e)}popModal(e){const t=_();t.modals[0]===e?t.modals.shift():(0,s._)(this,i)[i]()}constructor(){Object.defineProperty(this,i,{value:c})}});function c(){_().modals=[]}l=(0,n.__decorate)([r.scope.global()],l)},392248:(e,t,o)=>{"use strict";o.d(t,{toMusicSnippetAudioClip:()=>u,toMusicSnippetAudioData:()=>_,toMusicTrackAudioData:()=>r});var i=o(486973),s=o(379183),a=o(962954);function n(e,t){return{...(0,i.toAudioData)(t),type:e,hasLyrics:t.has_lyrics??!1,authors:d(t),album:c(t),duration:t.duration,subtitle:t.subtitle??"",releaseAudioIdentity:t.release_audio_id?a.OwnedIdentity.fromRawId(t.release_audio_id):null,apiAudio:t}}function r(e){return{...n(s.AudioType.MusicTrack,e),isFocusTrack:e.is_focus_track??!1}}function _(e){return{...n(s.AudioType.MusicSnippet,e),clip:null}}function u(e){return e?.clip_from&&e?.clip_to?{to:e.clip_to,from:e.clip_from}:null}function d(e){return{main:e.main_artists?.map(l)??[],feat:e.featured_artists?.map(l)??[],raw:e.artist}}function l(e){return{name:e.name,id:e.id}}function c(e){const{album:t}=e;return t?{id:t.id,ownerId:t.owner_id,title:t.title}:null}},559967:(e,t,o)=>{"use strict";o.d(t,{VideoGroup:()=>s});var i=o(327813);class s{get data(){return this._data}constructor(e){this._data=e,(0,i.makeAutoObservable)(this,{},{autoBind:!0})}}},710063:(e,t,o)=>{"use strict";o.d(t,{VideoOwnerStore:()=>r});var i=o(327813),s=o(847891),a=o(559967),n=o(822311);class r{static isVideoGroup(e){return e instanceof a.VideoGroup}static isVideoUser(e){return e instanceof n.VideoUser}getById(e){if(s.Ranges.isGroupId(e)){const t=s.Ranges.convertOwnerIdToGroupId(e);return this.groupsStore.getById(t)}if(s.Ranges.isUserId(e))return this.usersStore.getById(e)}constructor(e,t){this.groupsStore=e,this.usersStore=t,(0,i.makeAutoObservable)(this)}}},822311:(e,t,o)=>{"use strict";o.d(t,{VideoUser:()=>s});var i=o(327813);class s{get data(){return this._data}constructor(e){this._data=e,(0,i.makeAutoObservable)(this,{},{autoBind:!0})}}},163633:(e,t,o)=>{"use strict";o.d(t,{Video:()=>n});var i=o(327813),s=o(643010),a=o(710063);class n{static createRawId(e){return(0,s.getIdentityRawId)(e)}get rawId(){const{id:e,owner_id:t}=this.data;return n.createRawId({id:e,ownerId:t})}get data(){return this._data}get owner(){return this.ownerStore instanceof a.VideoOwnerStore?this.ownerStore.getById(this._data.owner_id):this.ownerStore?.getOwner(this._data.owner_id)}constructor(e,t){this._data=e,this.ownerStore=t,(0,i.makeAutoObservable)(this,{},{autoBind:!0})}}},572466:(e,t,o)=>{"use strict";o.d(t,{EmitterFactory:()=>d});var i,s=o(434518),a=o(763812),n=o(331635),r=o(127126),_=o(919225),u=o(460480);let d=(i=(0,a._)("_logger"),class{create(e={}){return new _.Emitter({catchListener:e=>{if(!(e instanceof Error))throw e;(0,s._)(this,i)[i].log(e)},...e})}constructor(e){Object.defineProperty(this,i,{writable:!0,value:void 0}),(0,s._)(this,i)[i]=e}});d=(0,n.__decorate)([r.scope.global(),(0,n.__metadata)("design:paramtypes",[u.ErrorLogger])],d)},314710:(e,t,o)=>{"use strict";o.d(t,{MediaFocus:()=>y});var i=o(434518),s=o(763812),a=o(942451),n=o(103555),r=o(343505);const _=(0,a.makeSharedState)("media-focus",(()=>({instance:null})),{version:1});var u=(0,s._)("_mediaSessionController"),d=(0,s._)("_channels"),l=(0,s._)("_lastActiveChannel"),c=(0,s._)("_handleChannelStart"),p=(0,s._)("_handleChannelStop"),m=(0,s._)("_update"),h=(0,s._)("_updateMediaSession");class y{static ensure(){const e=_();return e.instance||(e.instance=new y),e.instance}createChannel(e){if((0,i._)(this,d)[d].has(e))throw new Error(`MediaFocusChannel id ${e} already registered`);const t=new n.MediaFocusChannel(e);return(0,i._)(this,d)[d].set(e,t),t.events.on("start",(()=>(0,i._)(this,c)[c](t))),t.events.on("stop",(()=>(0,i._)(this,p)[p](t))),(0,i._)(this,m)[m](),t}constructor(){Object.defineProperty(this,l,{get:f,set:void 0}),Object.defineProperty(this,m,{value:E}),Object.defineProperty(this,h,{value:g}),Object.defineProperty(this,u,{writable:!0,value:void 0}),Object.defineProperty(this,d,{writable:!0,value:void 0}),Object.defineProperty(this,c,{writable:!0,value:void 0}),Object.defineProperty(this,p,{writable:!0,value:void 0}),(0,i._)(this,u)[u]=new r.MediaSessionController,(0,i._)(this,d)[d]=new Map,(0,i._)(this,c)[c]=e=>{(0,i._)(this,d)[d].get(e.id)===e&&(0,i._)(this,m)[m]()},(0,i._)(this,p)[p]=e=>{(0,i._)(this,d)[d].get(e.id)===e&&(0,i._)(this,m)[m]()}}}function f(){return[...(0,i._)(this,d)[d].values()].filter((e=>e.active)).sort(((e,t)=>t.activatedAt-e.activatedAt)).at(0)}function E(){(0,i._)(this,h)[h]()}function g(){const e=(0,i._)(this,u)[u],t=(0,i._)(this,d)[d].get("calls"),o=t?.active?t:(0,i._)(this,l)[l];o&&e.current!==o.mediaSession&&e.setCurrent(o.mediaSession)}},103555:(e,t,o)=>{"use strict";o.d(t,{MediaFocusChannel:()=>d});var i=o(434518),s=o(763812),a=o(919225),n=o(485526),r=(0,s._)("_emitter"),_=(0,s._)("_active"),u=(0,s._)("_activatedAt");class d{get events(){return(0,i._)(this,r)[r].listenable}get active(){return(0,i._)(this,_)[_]}get activatedAt(){return(0,i._)(this,u)[u]}start(){(0,i._)(this,_)[_]||((0,i._)(this,_)[_]=!0,(0,i._)(this,u)[u]=+new Date,(0,i._)(this,r)[r].emit("start"))}stop(){(0,i._)(this,_)[_]&&((0,i._)(this,_)[_]=!1,(0,i._)(this,r)[r].emit("stop"))}constructor(e){Object.defineProperty(this,r,{writable:!0,value:void 0}),Object.defineProperty(this,_,{writable:!0,value:void 0}),Object.defineProperty(this,u,{writable:!0,value:void 0}),(0,i._)(this,r)[r]=new a.Emitter,(0,i._)(this,_)[_]=!1,(0,i._)(this,u)[u]=0,this.mediaSession=new n.MediaSessionObject,this.id=e}}},343505:(e,t,o)=>{"use strict";o.d(t,{MediaSessionController:()=>l});var i=o(434518),s=o(763812),a=(0,s._)("_native"),n=(0,s._)("_supportedActions"),r=(0,s._)("_current"),_=(0,s._)("_setActionHandler"),u=(0,s._)("_applyNative"),d=(0,s._)("_handleChangeCurrentData");class l{get current(){return(0,i._)(this,r)[r]}setCurrent(e){(0,i._)(this,r)[r]?.events.off("change",(0,i._)(this,d)[d]),(0,i._)(this,r)[r]=e,e.events.on("change",(0,i._)(this,d)[d]),(0,i._)(this,u)[u](e)}constructor(){if(Object.defineProperty(this,_,{value:c}),Object.defineProperty(this,u,{value:p}),Object.defineProperty(this,a,{writable:!0,value:void 0}),Object.defineProperty(this,n,{writable:!0,value:void 0}),Object.defineProperty(this,r,{writable:!0,value:void 0}),Object.defineProperty(this,d,{writable:!0,value:void 0}),(0,i._)(this,a)[a]=null,(0,i._)(this,n)[n]=["nexttrack","pause","play","previoustrack","seekbackward","seekforward","seekto","skipad","stop","hangup","enterpictureinpicture"],(0,i._)(this,r)[r]=null,(0,i._)(this,d)[d]=({diff:{metadata:e,playbackState:t,actionHandler:o,positionState:s,cameraActive:n,microphoneActive:r}})=>{const u=(0,i._)(this,a)[a];u&&(void 0!==e&&(u.metadata=e),t&&(u.playbackState=t),o&&(0,i._)(this,_)[_](o[0],o[1]),void 0!==s&&u.setPositionState(s??void 0),void 0!==n&&"setCameraActive"in u&&u.setCameraActive(n),void 0!==r&&"setMicrophoneActive"in u&&u.setMicrophoneActive(r))},"undefined"==typeof window||!("mediaSession"in window.navigator))return;const e=window.navigator.mediaSession;(0,i._)(this,a)[a]=e,"setCameraActive"in e&&(0,i._)(this,n)[n].push("togglecamera"),"setMicrophoneActive"in e&&(0,i._)(this,n)[n].push("togglemicrophone")}}function c(e,t){const o=(0,i._)(this,a)[a];if(o)try{o.setActionHandler(e,t)}catch(e){t&&console.error(e)}}function p(e){const t=(0,i._)(this,a)[a];if(t){t.metadata=e.metadata,t.playbackState=e.playbackState,t.setPositionState(e.positionState),"setCameraActive"in t&&t.setCameraActive(e.cameraActive),"setMicrophoneActive"in t&&t.setMicrophoneActive(e.microphoneActive);for(const t of(0,i._)(this,n)[n]){const o=e.actionHandlers.get(t)??null;(0,i._)(this,_)[_](t,o)}}}},485526:(e,t,o)=>{"use strict";o.d(t,{MediaSessionObject:()=>m});var i=o(434518),s=o(763812),a=o(919225),n=(0,s._)("_emitter"),r=(0,s._)("_actionHandlers"),_=(0,s._)("_positionState"),u=(0,s._)("_metadata"),d=(0,s._)("_playbackState"),l=(0,s._)("_cameraActive"),c=(0,s._)("_microphoneActive"),p=(0,s._)("_emitChange");class m{get events(){return(0,i._)(this,n)[n].listenable}get metadata(){return(0,i._)(this,u)[u]}set metadata(e){(0,i._)(this,u)[u]=e,(0,i._)(this,p)[p]({metadata:e})}get playbackState(){return(0,i._)(this,d)[d]}set playbackState(e){(0,i._)(this,d)[d]=e,(0,i._)(this,p)[p]({playbackState:e})}get actionHandlers(){return(0,i._)(this,r)[r]}get positionState(){return(0,i._)(this,_)[_]}get cameraActive(){return(0,i._)(this,l)[l]}get microphoneActive(){return(0,i._)(this,c)[c]}setPositionState(e){(0,i._)(this,_)[_]=e,(0,i._)(this,p)[p]({positionState:e})}setActionHandler(e,t){this.actionHandlers.set(e,t),(0,i._)(this,p)[p]({actionHandler:[e,t]})}setCameraActive(e){(0,i._)(this,l)[l]=e,(0,i._)(this,p)[p]({cameraActive:e})}setMicrophoneActive(e){(0,i._)(this,c)[c]=e,(0,i._)(this,p)[p]({microphoneActive:e})}constructor(){Object.defineProperty(this,p,{value:h}),Object.defineProperty(this,n,{writable:!0,value:void 0}),Object.defineProperty(this,r,{writable:!0,value:void 0}),Object.defineProperty(this,_,{writable:!0,value:void 0}),Object.defineProperty(this,u,{writable:!0,value:void 0}),Object.defineProperty(this,d,{writable:!0,value:void 0}),Object.defineProperty(this,l,{writable:!0,value:void 0}),Object.defineProperty(this,c,{writable:!0,value:void 0}),(0,i._)(this,n)[n]=new a.Emitter,(0,i._)(this,r)[r]=new Map,(0,i._)(this,u)[u]=null,(0,i._)(this,d)[d]="none",(0,i._)(this,l)[l]=!1,(0,i._)(this,c)[c]=!1}}function h(e){(0,i._)(this,n)[n].emit("change",{diff:e})}},214450:(e,t,o)=>{"use strict";o.d(t,{MediaPlayersSwitch:()=>l});var i,s=o(434518),a=o(763812),n=o(942451),r=o(572466),_=o(510301);!function(e){e.ChannelAutoResume="CHANNEL_AUTO_RESUME",e.Unknown="UNKNOWN"}(i||(i={}));const u=(0,n.makeSharedState)("media-players-switch",(()=>({instance:null})),{version:0});var d=(0,a._)("_resume");class l{static ensure(e){const t=u();return t.instance||(t.instance=new l(e.resolve(r.EmitterFactory))),t.instance}connect(e){const t=new _.MediaPlayersSwitchChannel(e,this.emitterFactory),o=this.handlePlay.bind(this,t),i=this.handleStop.bind(this,t),s=this.handleMute.bind(this,t),a=this.handleUnmute.bind(this,t);t.events.on("play",o),t.events.on("stop",i),t.events.on("mute",s),t.events.on("unmute",a);return{emit:t.emitter.emit.bind(t.emitter),disconnect:()=>{t.events.off("play",o),t.events.off("stop",i),t.events.off("mute",s),t.events.off("unmute",a),this.activeChannel===t&&(this.activeChannel=null),this.mutedChannel===t&&(this.mutedChannel=null)}}}resume(e={reason:i.Unknown}){return(0,s._)(this,d)[d]({...e,reason:e.reason??i.Unknown})}autoResume(e){(0,s._)(this,d)[d]({...e,reason:i.ChannelAutoResume})}pause(e={}){this.activeChannel&&!this.activeChannel.state.isPaused&&this.mutedChannel&&!this.mutedChannel.state.isPaused&&(e.initiatedByCalls?this.activeChannel.pauseByCalls(e):(this.activeChannel.pause(e),this.mutedChannel.pause(e)))}stop(e={}){this.activeChannel&&(this.activeChannel.stop(e),this.activeChannel=null)}handlePlay(e,t=!1){t?(e!==this.mutedChannel&&this.mutedChannel?.state.isPlaying&&this.mutedChannel.pause({}),this.mutedChannel=e):(e!==this.activeChannel&&this.activeChannel?.state.isPlaying&&this.activeChannel.pause({}),this.activeChannel=e)}handleMute(e){e!==this.mutedChannel&&this.mutedChannel?.state.isPlaying&&this.mutedChannel.pause({}),this.activeChannel===e&&(this.activeChannel=null),this.mutedChannel=e}handleUnmute(e){e!==this.activeChannel&&this.activeChannel?.state.isPlaying&&this.activeChannel.pause({}),this.mutedChannel===e&&(this.mutedChannel=null),this.activeChannel=e}handleStop(e){e===this.activeChannel&&(this.activeChannel=null),e===this.mutedChannel&&(this.mutedChannel=null)}constructor(e){Object.defineProperty(this,d,{value:c}),this.emitterFactory=e,this.activeChannel=null,this.mutedChannel=null}}function c(e){!this.activeChannel||this.activeChannel.state.isPlaying||e.initiatedByCalls&&!this.activeChannel.state.isPausedByCalls||this.activeChannel.resume(e)}},510301:(e,t,o)=>{"use strict";o.d(t,{MediaPlayersSwitchChannel:()=>u});var i=o(434518),s=o(763812),a=(0,s._)("_connectEvents"),n=(0,s._)("_handlePlay"),r=(0,s._)("_handlePause"),_=(0,s._)("_handleStop");class u{get events(){return this.emitter.listenable}get state(){return this._state}set state(e){this._state={...this._state,...e},(this._state.isPlaying||this._state.isPaused||this._state.isPausedByCalls)&&(this._state.isIdle=!1)}pauseByCalls(e){this.state={isPausedByCalls:!0},this.pause(e)}constructor(e,t){Object.defineProperty(this,a,{value:d}),Object.defineProperty(this,n,{writable:!0,value:void 0}),Object.defineProperty(this,r,{writable:!0,value:void 0}),Object.defineProperty(this,_,{writable:!0,value:void 0}),this.emitterFactory=t,this._state={isIdle:!0,isPlaying:!1,isPaused:!1,isPausedByCalls:!1},this.emitter=this.emitterFactory.create(),(0,i._)(this,n)[n]=()=>{this.state={isPlaying:!0,isPaused:!1,isPausedByCalls:!1}},(0,i._)(this,r)[r]=()=>{this.state={isPlaying:!1,isPaused:!0}},(0,i._)(this,_)[_]=()=>{this.state={isPlaying:!1,isPaused:!1,isPausedByCalls:!1}},this.resume=e.resume.bind(this),this.pause=e.pause.bind(this),this.stop=e.stop.bind(this),(0,i._)(this,a)[a]()}}function d(){const{events:e}=this;e.on("play",(0,i._)(this,n)[n]),e.on("pause",(0,i._)(this,r)[r]),e.on("stop",(0,i._)(this,_)[_])}},121092:(e,t,o)=>{"use strict";o.d(t,{MyTracker:()=>l});var i,s=o(434518),a=o(763812),n=o(331635),r=o(127126),_=o(795624),u=o(787945),d=o(561017);let l=(i=(0,a._)("_activityCounters"),class{ensureActivityCounter({counterId:e="2579437",activityId:t,timespentType:o="screen",strict:a=!0}){const n=`${e}/${t}`;let r=(0,s._)(this,i)[i].get(n);if(r&&r.timespentType!==o)throw new Error(`ActivityCounter ${n} already registered with another timespentType (created: ${r.timespentType}, given: ${o})`);return r||(r=new d.MyTrackerActivityCounter({tmr:this.tmr,authService:this.authService,counterId:e,activityId:t,timespentType:o,strict:a}),(0,s._)(this,i)[i].set(n,r)),r}constructor(e,t){Object.defineProperty(this,i,{writable:!0,value:void 0}),(0,s._)(this,i)[i]=new Map,this.authService=e,this.tmr=t}});l=(0,n.__decorate)([r.scope.global(),(0,n.__metadata)("design:paramtypes",[_.AuthService,u.Tmr])],l)},561017:(e,t,o)=>{"use strict";o.d(t,{MyTrackerActivityCounter:()=>c});var i=o(434518),s=o(763812),a=(0,s._)("_authService"),n=(0,s._)("_tmr"),r=(0,s._)("_isActiveTimespent"),_=(0,s._)("_tmrStartTimespent"),u=(0,s._)("_tmrStopTimespent"),d=(0,s._)("_tmrIncrement"),l=(0,s._)("_userId");class c{get isActiveTimespent(){return(0,i._)(this,r)[r]}startTimespent(){if(this.isActiveTimespent){if(this.strict)throw new Error("ActivityCounter already started")}else(0,i._)(this,_)[_](),(0,i._)(this,r)[r]=!0}stopTimespent(){if(this.isActiveTimespent)(0,i._)(this,u)[u](),(0,i._)(this,r)[r]=!1;else if(this.strict)throw new Error("ActivityCounter is not started")}increment(){(0,i._)(this,d)[d]()}constructor({authService:e,tmr:t,counterId:o,activityId:s,timespentType:c,strict:f}){Object.defineProperty(this,_,{value:p}),Object.defineProperty(this,u,{value:m}),Object.defineProperty(this,d,{value:h}),Object.defineProperty(this,l,{get:y,set:void 0}),Object.defineProperty(this,a,{writable:!0,value:void 0}),Object.defineProperty(this,n,{writable:!0,value:void 0}),Object.defineProperty(this,r,{writable:!0,value:void 0}),(0,i._)(this,r)[r]=!1,(0,i._)(this,a)[a]=e,(0,i._)(this,n)[n]=t,this.counterId=o,this.activityId=s,this.timespentType=c,this.strict=f}}function p(){(0,i._)(this,n)[n].push({id:this.counterId,type:"startTimespent",activity:this.activityId,userId:(0,i._)(this,l)[l],canUseInBackground:"service"===this.timespentType})}function m(){(0,i._)(this,n)[n].push({id:this.counterId,type:"stopTimespent",activity:this.activityId,userId:(0,i._)(this,l)[l],canUseInBackground:"service"===this.timespentType})}function h(){(0,i._)(this,n)[n].push({id:this.counterId,type:"incrementEventTimespent",activity:this.activityId,userId:(0,i._)(this,l)[l]})}function y(){return(0,i._)(this,a)[a].userId??0}},607248:(e,t,o)=>{"use strict";o.d(t,{usePatchChildrenRef:()=>n});var i=o(296540),s=o(313251);const a=e=>"string"==typeof e.type,n=e=>{const t=(0,i.isValidElement)(e)&&(a(e)?e.ref:e.props.getRootRef),o=(0,s.useExternRef)(t);return(0,i.useEffect)((()=>{o.current||console.error("Кажется, в children передан компонент, который не поддерживает свойство getRootRef. Мы не можем получить ссылку на корневой dom-элемент этого компонента")}),[e?.type,o]),[o,(0,i.isValidElement)(e)?(0,i.cloneElement)(e,{[a(e)?"ref":"getRootRef"]:o}):e]}},455548:(e,t,o)=>{"use strict";o.d(t,{getLottieManager:()=>i});const i=(0,o(8520).asyncImportLoader)((async()=>{const{LottieManager:e}=await Promise.all([o.e(69706),o.e(23666)]).then(o.bind(o,441120));return e}))},958327:(e,t,o)=>{"use strict";o.d(t,{createAccountGetHelpHintsFx:()=>u,createAccountGetInfoFx:()=>a,createAccountGetPrivacySettingsFx:()=>c,createAccountGetProfileInfoFx:()=>_,createAccountHideHelpHintFx:()=>d,createAccountSetInfoFx:()=>n,createAccountShowHelpHintFx:()=>l,createAccountUnbanFx:()=>p});var i=o(32489),s=o(66044);const a=e=>(0,s.createApiEffect)("account.getInfo",e),n=e=>(0,i.attach)({effect:(0,s.createApiEffect)("account.setInfo",e),mapParams:({query:e,...t})=>({...t,query:{...e,value:r(e.value)}})});function r(e){return"boolean"==typeof e?e?"1":"0":"number"==typeof e?String(e):e}const _=e=>(0,s.createApiEffect)("account.getProfileInfo",e),u=e=>(0,s.createApiEffect)("account.getHelpHints",e),d=e=>(0,s.createApiEffect)("account.hideHelpHint",e),l=e=>(0,s.createApiEffect)("account.showHelpHint",e),c=e=>(0,s.createApiEffect)("account.getPrivacySettings",e),p=e=>(0,s.createApiEffect)("account.unban",e)},523430:(e,t,o)=>{"use strict";o.d(t,{createAudioAddDislikeFx:()=>E,createAudioAddFx:()=>d,createAudioAddToPlaylistFx:()=>w,createAudioCreatePlaylistFx:()=>p,createAudioDeleteFx:()=>l,createAudioDeletePlaylistFx:()=>m,createAudioFollowRadioStationFx:()=>v,createAudioGetAudioIdsBySourceFx:()=>n,createAudioGetAudioPreviewFx:()=>u,createAudioGetByIdFx:()=>s,createAudioGetFx:()=>r,createAudioGetPlaylistByIdFx:()=>a,createAudioGetSearchSuggestionsFx:()=>y,createAudioGetSnippetsFx:()=>h,createAudioGetStreamMixAudiosFx:()=>f,createAudioRemoveDislikeFx:()=>g,createAudioRemoveFromPlaylistFx:()=>b,createAudioRestoreFx:()=>c,createAudioSearchFx:()=>_,createAudioUnfollowRadioStationFx:()=>A});var i=o(66044);const s=e=>(0,i.createApiEffect)("audio.getById",e),a=e=>(0,i.createApiEffect)("audio.getPlaylistById",e),n=e=>(0,i.createApiEffect)("audio.getAudioIdsBySource",e),r=e=>(0,i.createApiEffect)("audio.get",e),_=e=>(0,i.createApiEffect)("audio.search",e),u=e=>(0,i.createApiEffect)("audio.getAudioPreviewUrl",e),d=e=>(0,i.createApiEffect)("audio.add",e),l=e=>(0,i.createApiEffect)("audio.delete",e),c=e=>(0,i.createApiEffect)("audio.restore",e),p=e=>(0,i.createApiEffect)("audio.createPlaylist",e),m=e=>(0,i.createApiEffect)("audio.deletePlaylist",e),h=e=>(0,i.createApiEffect)("audio.getSnippets",e),y=e=>(0,i.createApiEffect)("audio.getSearchSuggestions",e),f=e=>(0,i.createApiEffect)("audio.getStreamMixAudios",e),E=e=>(0,i.createApiEffect)("audio.addDislike",e),g=e=>(0,i.createApiEffect)("audio.removeDislike",e),v=e=>(0,i.createApiEffect)("audio.followRadioStation",e),A=e=>(0,i.createApiEffect)("audio.unfollowRadioStation",e),w=e=>(0,i.createApiEffect)("audio.addToPlaylist",e),b=e=>(0,i.createApiEffect)("audio.removeFromPlaylist",e)},668882:(e,t,o)=>{"use strict";o.d(t,{createFaveAddGroupFx:()=>_,createFaveAddPodcastEpisodeFx:()=>d,createFaveAddProductFx:()=>n,createFaveAddVideoFx:()=>s,createFaveRemoveGroupFx:()=>u,createFaveRemovePodcastEpisodeFx:()=>l,createFaveRemoveProductFx:()=>r,createFaveRemoveVideoFx:()=>a});var i=o(66044);const s=e=>(0,i.createApiEffect)("fave.addVideo",e),a=e=>(0,i.createApiEffect)("fave.removeVideo",e),n=e=>(0,i.createApiEffect)("fave.addProduct",e),r=e=>(0,i.createApiEffect)("fave.removeProduct",e),_=e=>(0,i.createApiEffect)("fave.addGroup",e),u=e=>(0,i.createApiEffect)("fave.removeGroup",e),d=e=>(0,i.createApiEffect)("fave.addPodcastEpisode",e),l=e=>(0,i.createApiEffect)("fave.removePodcastEpisode",e)},149183:(e,t,o)=>{"use strict";o.d(t,{useEntitiesStore:()=>s,useNotNullEntitiesStore:()=>a});var i=o(293721);const s=(e,t)=>(0,i.useStoreMap)({store:e,keys:[t],fn:(e,[t])=>e[t],defaultValue:null}),a=(e,t)=>(0,i.useStoreMap)({store:e,keys:[t],fn:(e,[t])=>{const o=e[t];if(null==o)throw new Error("Empty value entity store");return o}})},826316:(e,t,o)=>{"use strict";o.d(t,{ensureAccountInfoService:()=>n});var i=o(32489),s=o(751230);let a;function n(){if(!a){const e=(0,i.createDomain)("global/account/info");a=(0,s.createAccountInfoService)({domain:e})}return a}},405139:(e,t,o)=>{"use strict";o.d(t,{ensureAudioPlaylistsService:()=>n});var i=o(32489),s=o(942451),a=o(693826);const n=(0,s.makeSharedState)("global/audio/playlists",(()=>(0,a.createAudioPlaylistsService)({domain:(0,i.createDomain)("global/audio/playlists"),name:"global/audio/playlists"})),{version:1})},398565:(e,t,o)=>{"use strict";o.d(t,{ensureAudioPreviewsService:()=>n});var i=o(32489),s=o(125731);let a;function n(){if(!a){const e=(0,i.createDomain)("global/audio/audioPreviews");a=(0,s.createAudioPreviewsService)({domain:e})}return a}},284353:(e,t,o)=>{"use strict";o.d(t,{ensureAudiosService:()=>n});var i=o(32489),s=o(269943);let a;function n(){if(!a){const e=(0,i.createDomain)("global/audio/audios");a=(0,s.createAudiosService)({domain:e})}return a}},611713:(e,t,o)=>{"use strict";o.d(t,{ensureGroupsMusicService:()=>n});var i=o(32489),s=o(942451),a=o(37512);const n=(0,s.makeSharedState)("global/audio/groupsMusic",(()=>(0,a.createGroupsMusicService)({domain:(0,i.createDomain)("global/audio/groupsMusic"),name:"global/audio/groupsMusic"})),{version:3})},23280:(e,t,o)=>{"use strict";o.d(t,{ensureMyAudioDislikesService:()=>n});var i=o(32489),s=o(942451),a=o(736446);const n=(0,s.makeSharedState)("global/audio/myDislikes",(()=>(0,a.createMyAudioDislikesService)({domain:(0,i.createDomain)("global/audio/myDislikes"),name:"global/audio/myDislikes"})),{version:1})},842225:(e,t,o)=>{"use strict";o.d(t,{ensureMyAudioPlaylistsService:()=>r});var i=o(32489),s=o(942451),a=o(25034),n=o(405139);const r=(0,s.makeSharedState)("global/audio/myPlaylists",(()=>(0,a.createMyAudioPlaylistsService)({config:{domain:(0,i.createDomain)("global/audio/myPlaylists"),name:"global/audio/myPlaylists"},audioPlaylistsService:(0,n.ensureAudioPlaylistsService)()})),{version:2})},515706:(e,t,o)=>{"use strict";o.d(t,{ensureMyAudioRadioStationsService:()=>n});var i=o(32489),s=o(942451),a=o(413618);const n=(0,s.makeSharedState)("global/audio/myRadioStations",(()=>(0,a.createMyAudioRadioStationsService)({domain:(0,i.createDomain)("global/audio/myRadioStations"),name:"global/audio/myRadioStations"})),{version:1})},332583:(e,t,o)=>{"use strict";o.d(t,{ensureMyMusicService:()=>n});var i=o(32489),s=o(942451),a=o(453888);const n=(0,s.makeSharedState)("global/audio/myMusic",(()=>(0,a.createMyMusicService)({domain:(0,i.createDomain)("global/audio/myMusic"),name:"global/audio/myMusic"})),{version:2})},401986:(e,t,o)=>{"use strict";o.d(t,{ensureAudioPodcastsFaveService:()=>n});var i=o(32489),s=o(942451),a=o(499617);const n=(0,s.makeSharedState)("global/fave/audio/podcasts",(()=>(0,a.createAudioPodcastsFaveService)({domain:(0,i.createDomain)("global/fave/audio/podcasts"),name:"global/fave/audio/podcasts"})),{version:1})},741531:(e,t,o)=>{"use strict";o.d(t,{ensureAccountHelpHintsService:()=>d});var i=o(32489),s=o(942451),a=o(958327),n=o(94359),r=o(614117),_=o(492243),u=o(679005);const d=(0,s.makeSharedState)("global/account/helpHints",(()=>(e=>{const t=(0,n.getEffectorServiceDomain)(e),o=t.createStore({}),s=t.createStore({viewerId:0}),d=t.createEvent("helpHints/initialize"),l=t.createEvent("helpHints/reload"),c=t.createEvent("helpHints/logError"),p=t.createEvent("helpHints/hide"),m=t.createEvent("helpHints/show"),h=(0,a.createAccountGetHelpHintsFx)({domain:t});let y=null;const f=async()=>{const{items:e}=await h({query:{}});return e.reduce(((e,t)=>(e[t.id]=t,e)),{})},E=(0,i.attach)({name:"helpHints/getHelpHintsFx",source:o,effect:t.createEffect((e=>Object.keys(e).length?Promise.resolve(e):y||(y=f().finally((()=>{y=null})),y)))}),g=t.createEffect("helpHints/reloadHelpHintsFx");g.use((()=>f()));const v=(0,i.attach)({name:"helpHints/hideHelpHintFx",effect:(0,a.createAccountHideHelpHintFx)({domain:t}),mapParams:({hintId:e})=>({query:{hint_id:e}})}),A=(0,i.attach)({name:"helpHints/showHelpHintFx",effect:(0,a.createAccountShowHelpHintFx)({domain:t}),mapParams:e=>({query:{hint_id:e}})}),w=t.createEffect("helpHints/logErrorFx");return w.use((({error:e,logErrorFn:t})=>{let o=null,i=null;t?((0,r.isNetworkError)(e)?o=e.error:(0,_.isApiError)(e)?(o=new Error(e.type),i=e.error):o=e,o&&t(o,{environment:"global/account/helpHints",data:i})):console.error(e)})),(0,i.sample)({clock:d,target:s}),(0,i.sample)({clock:d,source:E.pending,filter:e=>!e,target:E}),(0,i.sample)({clock:l,target:g}),(0,i.sample)({clock:[E.doneData,g.doneData],target:o}),(0,i.sample)({clock:p,target:v}),(0,i.sample)({clock:p,source:o,filter:(e,{isOptimistic:t})=>Boolean(t),fn:(e,{hintId:t})=>(0,u.produce)(e,(e=>{delete e[t]})),target:o}),(0,i.sample)({clock:m,target:A}),(0,i.sample)({clock:v.done,source:o,filter:(e,{params:{isOptimistic:t}})=>!t,fn:(e,{params:{hintId:t}})=>(0,u.produce)(e,(e=>{delete e[t]})),target:o}),(0,i.sample)({clock:A.done,target:l}),(0,i.sample)({clock:c,source:s,fn:({logErrorFn:e},t)=>({error:t,logErrorFn:e}),target:w}),(0,i.sample)({clock:[E.failData,g.failData,A.failData,v.failData],target:c}),{initialize:d,canShow:e=>Boolean(o.getState()[e]),getHelpHintsFx:E,$helpHints:o,hideHelpHint:p,showHelpHint:m}})({domain:(0,i.createDomain)("global/account/helpHints"),name:"global/account/helpHints"})),{version:1})},751230:(e,t,o)=>{"use strict";o.d(t,{createAccountInfoService:()=>n});var i,s=o(32489),a=o(958327);!function(e){e[e.Pending=0]="Pending",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"}(i||(i={}));const n=({domain:e})=>{const t=e.createStore({}),o=e.createStore(i.Pending),n=(0,a.createAccountGetInfoFx)({domain:e}),r=(0,a.createAccountSetInfoFx)({domain:e}),_=e.createEffect((()=>n({query:{}})));o.on(n,((e,t)=>t.query.fields?e:e<=i.Pending?i.Initializing:void 0)).on(n.finally,((e,t)=>t.params.query.fields||"done"!==t.status?e:i.Initializing)),t.on(n.finally,((e,t)=>"done"===t.status?{...e,...t.result}:e)).on(r.done,((e,t)=>{const{result:o,params:{query:{name:i,value:s}}}=t;return o&&i in e?{...e,[i]:s}:e}));const u=e.createEvent();return(0,s.sample)({clock:u,source:o,filter:e=>e!==i.Initialized,target:_}),{$accountInfo:t,getInfoFx:n,setInfoFx:r,initEvent:u}}},580334:(e,t,o)=>{"use strict";function i({id:e,ownerId:t,accessKey:o}){return`${t}_${e}${o?`_${o}`:""}`}o.d(t,{getAudioAccessId:()=>i})},255053:(e,t,o)=>{"use strict";function i({id:e,ownerId:t}){return`${t}_${e}`}o.d(t,{getAudioFullId:()=>i})},647923:(e,t,o)=>{"use strict";function i(e){const t={id:e.id,ownerId:e.owner_id,accessKey:e.access_key,releaseAudioId:e.release_audio_id};return{...t,identity:t,title:e.title,author:r(e),artwork:n(e.album?.thumb),duration:e.duration,url:e.url||null,isExplicit:e.is_explicit}}function s(e){if(!e.track_code)throw new Error("track_code is not defined");return{...i(e),trackCode:e.track_code}}o.d(t,{mapAPIAudioArtistToAudioDataArtistInfo:()=>_,mapAPIAudioToAudioData:()=>i,mapAPIAudioToAudioDataAuthor:()=>r,mapAPIAudioToTrackedAudioData:()=>s});const a=[["photo_34",34],["photo_68",68],["photo_135",135],["photo_270",270],["photo_300",300],["photo_600",600],["photo_1200",1200]];function n(e){const t=[];if(!e)return t;for(const[o,i]of a){const s=e[o];s&&t.push({src:s,size:i})}return t}function r(e){return{main:e?.main_artists?.map(u)??[],feat:e?.featured_artists?.map(u)??[],raw:e.artist}}function _(e){return{id:e.id,name:e.name}}function u(e){return{name:e.name}}},441914:(e,t,o)=>{"use strict";function i(e){const[t,o,i]=e.split("_");if(!o||!t)throw new Error(`Invalid audio_id: ${e}`);return{id:parseInt(o,10),ownerId:parseInt(t,10),accessKey:i}}o.d(t,{mapAPIRawIdToAudioIdentity:()=>i})},14308:(e,t,o)=>{"use strict";o.d(t,{mapAPIRawIdTrackedToTrackedAudioIdentity:()=>s});var i=o(441914);function s(e){return{...(0,i.mapAPIRawIdToAudioIdentity)(e.audio_id),trackCode:e.track_code}}},264544:(e,t,o)=>{"use strict";var i;o.d(t,{AudioType:()=>i}),function(e){e.MusicTrack="music_track",e.MusicSnippet="music_snippet",e.PodcastEpisode="podcast_episode",e.PodcastTrailer="podcast_trailer",e.Radio="radio"}(i||(i={}))},406245:(e,t,o)=>{"use strict";o.d(t,{mapAPIAudioToMusicAudioData:()=>a,mapAPIAudioToTrackedMusicAudioData:()=>n});var i=o(647923),s=o(281972);function a(e,t){return{...(0,i.mapAPIAudioToAudioData)(t),...r(e,t),...(0,s.mapAPIAudioToTrackedMusicAudioState)(t)}}function n(e,t){return{...(0,i.mapAPIAudioToTrackedAudioData)(t),...r(e,t),...(0,s.mapAPIAudioToTrackedMusicAudioState)(t)}}function r(e,t){return{type:e,hasLyrics:t.has_lyrics??!1,author:(o=t,{...(0,i.mapAPIAudioToAudioDataAuthor)(o),main:o?.main_artists?.map(_)??[],feat:o?.featured_artists?.map(_)??[]})};var o}function _(e){return{name:e.name,id:e.id}}},281972:(e,t,o)=>{"use strict";function i(e){return{disliked:e.dislike??!1}}o.d(t,{mapAPIAudioToTrackedMusicAudioState:()=>i})},303651:(e,t,o)=>{"use strict";function i({id:e,ownerId:t,podcastId:o}){return`${t}_${Number.isFinite(o)?o:e}`}o.d(t,{getPodcastAudioFullId:()=>i})},693826:(e,t,o)=>{"use strict";o.d(t,{createAudioPlaylistsService:()=>h});var i=o(32489),s=o(523430),a=o(991331),n=o(958955),r=o(918081),_=o(203619),u=o(14308),d=o(612934),l=o(716768),c=o(182008),p=o(719848),m=o(94359);function h(e){const t=(0,m.getEffectorServiceDomain)(e),o=(0,s.createAudioGetPlaylistByIdFx)({domain:t}),h=(0,s.createAudioGetAudioIdsBySourceFx)({domain:t}),y=(0,d.createAudioPlaylistsCreateFx)({domain:t}),f=(0,l.createAudioPlaylistsDeleteFx)({domain:t}),E=(0,c.createAddAudioFx)({domain:t}),g=(0,p.createDeleteAudioFx)({domain:t}),v=t.createStore({}),A=t.createStore({}),w=t.createEffect((async({id:e,ownerId:t})=>{const i=await o({query:{playlist_id:e,owner_id:t}});return(0,_.mapAPIPlaylistToAudioPlaylistData)(i)})),b=(0,i.attach)({source:v,async effect(e,t){const o=e[(0,a.getAudioPlaylistFullId)(t)];return o||w(t)}}),P=t.createEffect((async e=>(await h({query:{source:"playlist",entity_id:(0,a.getAudioPlaylistFullId)(e)}})).audios.map(u.mapAPIRawIdTrackedToTrackedAudioIdentity))),T=(0,i.attach)({source:A,async effect(e,t){const o=e[(0,a.getAudioPlaylistFullId)(t)];return o||P(t)}});return v.on(w.done,((e,{result:t})=>({...e,[(0,a.getAudioPlaylistFullId)(t)]:t}))),A.on(P.done,((e,{params:t,result:o})=>({...e,[(0,a.getAudioPlaylistFullId)(t)]:o}))),v.on(y.done,((e,{result:t})=>(0,n.addPairToMap)(e,{key:(0,a.getAudioPlaylistFullId)(t),value:t}))),v.on(f.done,((e,{params:t})=>(0,r.removePairFromMap)(e,(0,a.getAudioPlaylistFullId)({id:t.id,ownerId:t.ownerId})))),{$playlistDataEntities:v,$playlistAudioIdsEntities:A,createFx:y,deleteFx:f,addAudioFx:E,deleteAudioFx:g,fetchPlaylistFx:w,ensurePlaylistFx:b,fetchPlaylistAudioIdsFx:P,ensurePlaylistAudioIdsFx:T}}},182008:(e,t,o)=>{"use strict";o.d(t,{createAddAudioFx:()=>a});var i=o(523430),s=o(580334);function a({domain:e}){const t=(0,i.createAudioAddToPlaylistFx)({domain:e});return e.createEffect((async({ownerId:e,playlistId:o,audioIdentity:i})=>{const a=await t({query:{owner_id:e,playlist_id:o,audio_ids:(0,s.getAudioAccessId)(i)}}),n=a?.[0]?.audio_id;if(!n)throw new Error("Error when trying to add audio to a playlist");return{id:n,ownerId:e}}))}},612934:(e,t,o)=>{"use strict";o.d(t,{createAudioPlaylistsCreateFx:()=>n});var i=o(523430),s=o(203619),a=o(255053);function n({domain:e}){const t=(0,i.createAudioCreatePlaylistFx)({domain:e});return e.createEffect((async({ownerId:e,audios:o,title:i,description:n})=>{const r=o.map(a.getAudioFullId).join(","),_=await t({query:{owner_id:e,audio_ids:r,title:i,description:n}});return(0,s.mapAPIPlaylistToAudioPlaylistData)(_)}))}},716768:(e,t,o)=>{"use strict";o.d(t,{createAudioPlaylistsDeleteFx:()=>s});var i=o(523430);function s({domain:e}){const t=(0,i.createAudioDeletePlaylistFx)({domain:e});return e.createEffect((async({ownerId:e,id:o})=>{await t({query:{owner_id:e,playlist_id:o}})}))}},719848:(e,t,o)=>{"use strict";o.d(t,{createDeleteAudioFx:()=>a});var i=o(523430),s=o(255053);function a({domain:e}){const t=(0,i.createAudioRemoveFromPlaylistFx)({domain:e});return e.createEffect((async({ownerId:e,playlistId:o,audioIdentity:i})=>{await t({query:{owner_id:e,playlist_id:o,audio_ids:(0,s.getAudioFullId)(i)}})}))}},125731:(e,t,o)=>{"use strict";o.d(t,{createAudioPreviewsService:()=>r});var i=o(32489),s=o(523430),a=o(431741),n=o(255053);function r({domain:e}){const t=(0,s.createAudioGetAudioPreviewFx)({domain:e}),o=e.createStore({}),r=e.createEffect((async({identity:e})=>{const o=await t({query:{audio_id:(0,n.getAudioFullId)(e),preview_type:"longtap"}});return(0,a.mapApiAudioPreviewToAudioPreviewData)(o)}));return(0,i.sample)({clock:r.done,source:o,fn:(e,{params:t,result:o})=>{const{id:i,ownerId:s}=t.identity,a=(0,n.getAudioFullId)({id:i,ownerId:s});return{...e,[a]:o}},target:o}),{fetchAudioPreviewFx:r,$audioPreviewEntities:o}}},249814:(e,t,o)=>{"use strict";o.d(t,{createAudioVkMixService:()=>s});var i=o(1674);function s(e){const t=e.createStore([]),o=(0,i.createAudioVkMixFetchNextFx)(e);return t.on(o.doneData,((e,t)=>t.length?[...e,...t]:e)),{$lists:t,fetchNextFx:o}}},1674:(e,t,o)=>{"use strict";o.d(t,{createAudioVkMixFetchNextFx:()=>s});var i=o(523430);function s(e){const t=(0,i.createAudioGetStreamMixAudiosFx)({domain:e});return e.createEffect((async({id:e,count:o=1,isSessionLaunched:i=!1,isSessionFeatureEnabled:s=!1})=>await t({query:{mix_id:e,count:o,...s?{append:i?1:0}:{}}})))}},269943:(e,t,o)=>{"use strict";o.d(t,{createAudiosService:()=>u});var i=o(32489),s=o(523430),a=o(580334),n=o(406245),r=o(264544),_=o(255053);function u({domain:e}){const t=(0,s.createAudioGetByIdFx)({domain:e}),o=(0,s.createAudioGetFx)({domain:e}),u=(0,s.createAudioSearchFx)({domain:e}),l=e.createStore({}),c=e.createEffect((async e=>{if(!e.length)return[];return(await t({query:{audios:e.map(a.getAudioAccessId).join(",")}})).map((e=>(0,n.mapAPIAudioToMusicAudioData)(r.AudioType.MusicTrack,e)))})),p=e.createEffect((async e=>{let t;t=e.q?await u({query:{owner_id:e.ownerId,count:e.count,offset:e.offset,q:e.q}}):await o({query:{owner_id:e.ownerId,count:e.count,offset:e.offset}});const i=t.items.map((e=>(0,n.mapAPIAudioToMusicAudioData)(r.AudioType.MusicTrack,e)));return{count:t.count,audios:i}})),m=(0,i.attach)({source:l,async effect(e,t){if(!t.length)return[];let o=[],i=[];for(const s of t){const t=e[(0,_.getAudioFullId)(s)];t?o.push(t):i.push(s)}if(!i.length)return o;const s=await c(i),a=d(s);o=[];for(const n of t){const r=(0,_.getAudioFullId)(n),u=a[r]??e[r];if(!u)throw console.error("AudioData not found in entities",{identity:n,fullId:r,audio:u,fetched:s,fetchedEntities:a,entities:e,identities:t,missing:i,result:o}),new Error("AudioData not found in entities");o.push(u)}return o}});return l.on(c.done,((e,{result:t})=>({...e,...d(t)}))),l.on(p.done,((e,{result:t})=>({...e,...d(t.audios)}))),{$audioEntities:l,fetchAudiosFx:c,ensureAudiosFx:m,searchAudiosFx:p}}function d(e){return e.reduce(((e,t)=>(e[(0,_.getAudioFullId)(t)]=t,e)),{})}},37512:(e,t,o)=>{"use strict";o.d(t,{createGroupsMusicService:()=>c});var i=o(32489),s=o(645074),a=o(632666),n=o(57082),r=o(817261),_=o(583768),u=o(94359),d=o(156693),l=o(248251);function c(e){const t=(0,u.getEffectorServiceDomain)(e),o=(0,s.createGroupsMusicAddFx)({domain:t}),c=(0,a.createGroupsMusicRestoreFx)({domain:t}),p=(0,n.createGroupsMusicDeleteFx)({domain:t}),{$addedIdentitiesMap:m,$removedIdentitiesMap:h,$identitiesMap:y,removeFromAllIdentitiesMaps:f,removedIdentitiesMapApi:E,addedIdentitiesMapApi:g}=(0,_.createIdentitiesMaps)({domain:t}),v=(0,i.attach)({source:(0,i.combine)({addedIdentitiesMap:m,removedIdentitiesMap:h}),mapParams:(e,t)=>({...e,...t}),effect:(0,i.createEffect)((async({groupId:e,trackedIdentity:t,addedIdentitiesMap:i,removedIdentitiesMap:s})=>{let a,n;const _=(0,l.convertToGroupMusicId)(e);if(_===t.ownerId)a=t,n=(0,d.getGroupAudioFullId)({id:t.id,ownerId:_},_);else{const e=(0,d.getGroupAudioFullId)({id:t.id,ownerId:t.ownerId},_);if(!(e in i))return await o({trackedIdentity:t,groupId:_});if(a=i[e],n=(0,d.getGroupAudioFullId)({id:a.id,ownerId:_},_),!(n in s))return await o({trackedIdentity:t,groupId:_})}const u=(0,d.getGroupAudioFullId)({id:t.id,ownerId:t.ownerId},_);try{return await c({audioId:a.id,groupId:_}),{id:a.id,ownerId:_}}catch(e){const i=e;if(i?.error?.error_code===r.GROUPS_MUSIC_RESTORE_FX_EXPIRED_ERROR_CODE)return f({addedGroupAudioFullId:u,removedGroupAudioFullId:n}),await o({trackedIdentity:t,groupId:_});throw i}}))});return(0,i.sample)({clock:v.done,source:m,filter:(e,{params:{groupId:t,trackedIdentity:o}})=>t===o.ownerId&&!((0,d.getGroupAudioFullId)(o,t)in e),fn:(e,{params:{groupId:t,trackedIdentity:o},result:i})=>({groupAudioFullId:(0,d.getGroupAudioFullId)(o,t),identity:i}),target:g.add}),(0,i.sample)({clock:o.done,fn:({params:{groupId:e,trackedIdentity:{id:t,ownerId:o}},result:i})=>{const s=(0,l.convertToGroupMusicId)(e);return{groupAudioFullId:(0,d.getGroupAudioFullId)({id:t,ownerId:o},s),identity:i}},target:g.add}),(0,i.sample)({clock:c.done,fn:({params:{groupId:e,audioId:t}})=>{const o=(0,l.convertToGroupMusicId)(e);return(0,d.getGroupAudioFullId)({id:t,ownerId:o},o)},target:E.remove}),(0,i.sample)({clock:p.done,fn:({params:{groupId:e,audioId:t}})=>{const o=(0,l.convertToGroupMusicId)(e);return(0,d.getGroupAudioFullId)({id:t,ownerId:o},o)},target:E.add}),{addFx:v,deleteFx:p,$identitiesMap:y}}},645074:(e,t,o)=>{"use strict";o.d(t,{createGroupsMusicAddFx:()=>n});var i=o(523430),s=o(847891),a=o(248251);function n({domain:e}){const t=(0,i.createAudioAddFx)({domain:e});return e.createEffect((async({trackedIdentity:e,groupId:o})=>{const{id:i,ownerId:n,accessKey:r,trackCode:_}=e,u=(0,a.convertToGroupMusicId)(o),d=await t({query:{audio_id:i,owner_id:n,access_key:r,track_code:_,group_id:s.Ranges.convertOwnerIdToGroupId(u)}}),l=d.items?.[0]?.new_audio_id;if(null==l)throw new Error("[GroupsMusicAddFx] addFx - missing audio ID in response from audio.add api method");return{id:l,ownerId:u}}))}},57082:(e,t,o)=>{"use strict";o.d(t,{createGroupsMusicDeleteFx:()=>a});var i=o(523430),s=o(248251);function a({domain:e}){const t=(0,i.createAudioDeleteFx)({domain:e});return e.createEffect((async({audioId:e,groupId:o})=>{await t({query:{audio_id:e,owner_id:(0,s.convertToGroupMusicId)(o)}})}))}},817261:(e,t,o)=>{"use strict";o.d(t,{GROUPS_MUSIC_RESTORE_FX_EXPIRED_ERROR_CODE:()=>i});const i=15},632666:(e,t,o)=>{"use strict";o.d(t,{createGroupsMusicRestoreFx:()=>s});var i=o(523430);function s({domain:e}){const t=(0,i.createAudioRestoreFx)({domain:e});return e.createEffect((async({audioId:e,groupId:o})=>{await t({query:{audio_id:e,owner_id:o}})}))}},248251:(e,t,o)=>{"use strict";o.d(t,{convertToGroupMusicId:()=>s});var i=o(847891);function s(e){return i.Ranges.isGroupId(e)?e:i.Ranges.convertGroupIdToOwnerId(e)}},14846:(e,t,o)=>{"use strict";function i(e){return+e.split("_")?.[0]}o.d(t,{extractGroupIdFromGroupAudioFullId:()=>i})},156693:(e,t,o)=>{"use strict";o.d(t,{getGroupAudioFullId:()=>a});var i=o(255053),s=o(248251);function a({id:e,ownerId:t},o){return`${(0,s.convertToGroupMusicId)(o)}_${(0,i.getAudioFullId)({id:e,ownerId:t})}`}},583768:(e,t,o)=>{"use strict";o.d(t,{createIdentitiesMaps:()=>u});var i=o(32489),s=o(810780),a=o(958955),n=o(918081),r=o(156693),_=o(14846);const u=({domain:e})=>{const t=e.createStore({}),o=e.createStore({}),u=(0,i.createEvent)(),d=(0,i.combine)(t,o,((e,t)=>Object.entries(e).reduce(((e,[o,i])=>((0,r.getGroupAudioFullId)(i,(0,_.extractGroupIdFromGroupAudioFullId)(o))in t||(e[o]=i),e)),{}))),l=(0,i.createApi)(t,{add:(e,{groupAudioFullId:t,identity:o})=>(0,a.addPairToMap)(e,{key:t,value:o}),remove:(e,t)=>(0,n.removePairFromMap)(e,t)}),c=(0,i.createApi)(o,{add:(e,t)=>(0,a.addPairToMap)(e,{key:t,value:!0}),remove:(e,t)=>(0,n.removePairFromMap)(e,t)});return(0,i.sample)({clock:u,target:(0,s.spread)({targets:{addedGroupAudioFullId:l.remove,removedGroupAudioFullId:c.remove}})}),{$addedIdentitiesMap:t,$removedIdentitiesMap:o,$identitiesMap:d,addedIdentitiesMapApi:l,removedIdentitiesMapApi:c,removeFromAllIdentitiesMaps:u}}},736446:(e,t,o)=>{"use strict";o.d(t,{createMyAudioDislikesService:()=>u});var i=o(94359),s=o(72491),a=o(977945),n=o(32489),r=o(255053),_=o(471027);function u(e){const t=(0,i.getEffectorServiceDomain)(e),o=(0,s.createAddFx)({domain:t}),u=(0,a.createRemoveFx)({domain:t}),{fullIdsMapApi:d,$fullIdsMap:l}=(0,_.createFullIdsMap)(t);return(0,n.sample)({clock:o.done,fn:({params:{identity:e}})=>(0,r.getAudioFullId)(e),target:d.add}),(0,n.sample)({clock:u.done,fn:({params:{identity:e}})=>(0,r.getAudioFullId)(e),target:d.remove}),{addFx:o,removeFx:u,$identitiesMap:l}}},72491:(e,t,o)=>{"use strict";o.d(t,{createAddFx:()=>a});var i=o(523430),s=o(255053);function a({domain:e}){const t=(0,i.createAudioAddDislikeFx)({domain:e});return e.createEffect((async({identity:e})=>{await t({query:{audio_ids:(0,s.getAudioFullId)(e)}})}))}},977945:(e,t,o)=>{"use strict";o.d(t,{createRemoveFx:()=>a});var i=o(523430),s=o(255053);function a({domain:e}){const t=(0,i.createAudioRemoveDislikeFx)({domain:e});return e.createEffect((async({identity:e})=>{await t({query:{audio_ids:(0,s.getAudioFullId)(e)}})}))}},25034:(e,t,o)=>{"use strict";o.d(t,{createMyAudioPlaylistsService:()=>_});var i=o(32489),s=o(94359),a=o(930996),n=o(348528),r=o(562984);function _({config:e,audioPlaylistsService:t}){const o=(0,s.getEffectorServiceDomain)(e),{$addedAudiosMap:_,addedAudiosMapApi:u}=(0,n.createAddedAudiosMap)(o),d=o.createEvent(),l=(0,i.restore)(d,null),c=o.createStore({},{updateFilter:(e,t)=>!(0,a.shallowEqual)(e,t),serialize:"ignore"}),p=(0,i.attach)({source:l,async effect(e,o){if(!e)throw new Error("[MyAudioPlaylistsService] UserId not set. To create a playlist, set the userId using setUserId.");return t.createFx({...o,ownerId:e})}}),m=(0,i.attach)({source:l,async effect(e,o){if(!e)throw new Error("[MyAudioPlaylistsService] UserId not set. To delete a playlist, set the userId using setUserId.");return t.deleteFx({...o,ownerId:e})}}),h=(0,i.attach)({source:l,async effect(e,o){if(!e)throw new Error("[MyAudioPlaylistsService] UserId not set. To add audio to playlist, set the userId using setUserId.");return t.addAudioFx({...o,ownerId:e})}}),y=(0,i.attach)({source:l,async effect(e,o){if(!e)throw new Error("[MyAudioPlaylistsService] UserId not set. To delete audio from playlist, set the userId using setUserId.");return t.deleteAudioFx({...o,ownerId:e})}});return(0,i.sample)({clock:(0,i.combine)({playlistDataEntities:t.$playlistDataEntities,userId:l}),fn:({playlistDataEntities:e,userId:t})=>t?Object.entries(e).reduce(((e,[o,i])=>(i.ownerId===t&&(e[o]=i),e)),{}):{},target:c}),(0,i.sample)({clock:h.done,source:l,fn:(e,{params:t,result:o})=>({originalPlaylistAudioFullId:(0,r.getPlaylistAudioFullId)({originalAudio:t.audioIdentity,playlist:{id:t.playlistId,ownerId:e}}),addedIdentity:o}),target:u.add}),(0,i.sample)({clock:y.done,source:l,fn:(e,{params:t})=>(0,r.getPlaylistAudioFullId)({originalAudio:t.originalAudioIdentity,playlist:{id:t.playlistId,ownerId:e}}),target:u.remove}),{createFx:p,deleteFx:m,addAudioFx:h,deleteAudioFx:y,setUserId:d,$myAudioPlaylistsIdentitiesMap:c,$addedAudiosMap:_}}},348528:(e,t,o)=>{"use strict";o.d(t,{createAddedAudiosMap:()=>n});var i=o(32489),s=o(958955),a=o(918081);function n(e){const t=e.createStore({});return{$addedAudiosMap:t,addedAudiosMapApi:(0,i.createApi)(t,{add:(e,{originalPlaylistAudioFullId:t,addedIdentity:o})=>(0,s.addPairToMap)(e,{key:t,value:o}),remove:(e,t)=>(0,a.removePairFromMap)(e,t)})}}},562984:(e,t,o)=>{"use strict";o.d(t,{getPlaylistAudioFullId:()=>a});var i=o(580334),s=o(991331);function a({playlist:e,originalAudio:t}){return`PLAYLIST_${(0,s.getAudioPlaylistFullId)(e)}AUDIO_${(0,i.getAudioAccessId)(t)}`}},413618:(e,t,o)=>{"use strict";o.d(t,{createMyAudioRadioStationsService:()=>u});var i=o(94359),s=o(872953),a=o(875291),n=o(32489),r=o(255053),_=o(471027);function u(e){const t=(0,i.getEffectorServiceDomain)(e),o=(0,s.createFollowFx)({domain:t}),u=(0,a.creatUnfollowFx)({domain:t}),{fullIdsMapApi:d,$fullIdsMap:l}=(0,_.createFullIdsMap)(t);return(0,n.sample)({clock:o.done,fn:({params:{identity:e}})=>(0,r.getAudioFullId)(e),target:d.add}),(0,n.sample)({clock:u.done,fn:({params:{identity:e}})=>(0,r.getAudioFullId)(e),target:d.remove}),{followFx:o,unfollowFx:u,$identitiesMap:l}}},872953:(e,t,o)=>{"use strict";o.d(t,{createFollowFx:()=>s});var i=o(523430);function s({domain:e}){const t=(0,i.createAudioFollowRadioStationFx)({domain:e});return e.createEffect((async({identity:e})=>{await t({query:{station_id:e.id}})}))}},875291:(e,t,o)=>{"use strict";o.d(t,{creatUnfollowFx:()=>s});var i=o(523430);function s({domain:e}){const t=(0,i.createAudioUnfollowRadioStationFx)({domain:e});return e.createEffect((async({identity:e})=>{await t({query:{station_id:e.id}})}))}},453888:(e,t,o)=>{"use strict";o.d(t,{createMyMusicService:()=>l});var i=o(32489),s=o(884100),a=o(609812),n=o(494604),r=o(845231),_=o(255053),u=o(637382),d=o(94359);function l(e){const t=(0,d.getEffectorServiceDomain)(e),o=(0,s.createAddFx)({domain:t}),l=(0,a.createRestoreFx)({domain:t}),c=(0,n.createDeleteFx)({domain:t}),{$addedIdentitiesMap:p,$removedIdentitiesMap:m,$identitiesMap:h,addedIdentitiesMapApi:y,removedIdentitiesMapApi:f,addToStore:E,removeFromStore:g,removeFromAllIdentitiesMaps:v}=(0,u.createIdentitiesMaps)({domain:t}),A=(0,i.attach)({source:(0,i.combine)({addedIdentitiesMap:p,removedIdentitiesMap:m}),mapParams:(e,t)=>({...e,...t}),effect:(0,i.createEffect)((async({userId:e,trackedIdentity:t,addedIdentitiesMap:i,removedIdentitiesMap:s})=>{let a,n;if(e===t.ownerId)a=t,n=(0,_.getAudioFullId)({id:t.id,ownerId:e});else{const r=(0,_.getAudioFullId)({id:t.id,ownerId:t.ownerId});if(!(r in i))return await o({trackedIdentity:t,userId:e});if(a=i[r],n=(0,_.getAudioFullId)({id:a.id,ownerId:e}),!(n in s))return await o({trackedIdentity:t,userId:e})}const u=(0,_.getAudioFullId)({id:t.id,ownerId:t.ownerId});try{return await l({identity:{id:a.id,ownerId:e}}),{id:a.id,ownerId:e}}catch(i){const s=i;if(s?.error?.error_code===r.MY_MUSIC_RESTORE_FX_EXPIRED_ERROR_CODE)return v({addedFullId:u,removedFullId:n}),await o({trackedIdentity:t,userId:e});throw s}}))});return(0,i.sample)({clock:A.done,source:p,filter:(e,{params:{userId:t,trackedIdentity:o}})=>t===o.ownerId&&!((0,_.getAudioFullId)(o)in e),fn:(e,{params:{trackedIdentity:t},result:o})=>({fullId:(0,_.getAudioFullId)(t),identity:o}),target:y.add}),(0,i.sample)({clock:o.done,fn:({params:{trackedIdentity:{id:e,ownerId:t}},result:o})=>({fullId:(0,_.getAudioFullId)({id:e,ownerId:t}),identity:o}),target:y.add}),(0,i.sample)({clock:l.done,fn:({params:{identity:e}})=>(0,_.getAudioFullId)(e),target:f.remove}),(0,i.sample)({clock:c.done,fn:({params:{identity:e}})=>(0,_.getAudioFullId)(e),target:f.add}),{addFx:A,deleteFx:c,addToStore:E,removeFromStore:g,$identitiesMap:h}}},884100:(e,t,o)=>{"use strict";o.d(t,{createAddFx:()=>s});var i=o(523430);function s({domain:e}){const t=(0,i.createAudioAddFx)({domain:e});return e.createEffect((async({trackedIdentity:e,userId:o})=>{const{id:i,ownerId:s,accessKey:a,trackCode:n,ref:r}=e,_=await t({query:{audio_id:i,owner_id:s,access_key:a,track_code:n,ref:r}}),u=_.items?.[0]?.new_audio_id;if(null==u)throw new Error("[MyMusicService] addFx - missing audio ID in response from audio.add api method");return{id:u,ownerId:o}}))}},494604:(e,t,o)=>{"use strict";o.d(t,{createDeleteFx:()=>s});var i=o(523430);function s({domain:e}){const t=(0,i.createAudioDeleteFx)({domain:e});return e.createEffect((async({identity:e})=>{const{id:o,ownerId:i}=e;await t({query:{audio_id:o,owner_id:i}})}))}},845231:(e,t,o)=>{"use strict";o.d(t,{MY_MUSIC_RESTORE_FX_EXPIRED_ERROR_CODE:()=>i});const i=15},609812:(e,t,o)=>{"use strict";o.d(t,{createRestoreFx:()=>s});var i=o(523430);function s({domain:e}){const t=(0,i.createAudioRestoreFx)({domain:e});return e.createEffect((async({identity:e})=>{const{id:o,ownerId:i}=e;await t({query:{audio_id:o,owner_id:i}})}))}},637382:(e,t,o)=>{"use strict";o.d(t,{createIdentitiesMaps:()=>_});var i=o(32489),s=o(255053),a=o(810780),n=o(958955),r=o(918081);const _=({domain:e})=>{const t=e.createStore({}),o=e.createStore({}),_=(0,i.createEvent)(),u=(0,i.createEvent)(),d=(0,i.createEvent)(),l=(0,i.combine)(t,o,((e,t)=>Object.entries(e).reduce(((e,[o,i])=>((0,s.getAudioFullId)(i)in t||(e[o]=i),e)),{}))),c=(0,i.createApi)(t,{add:(e,{fullId:t,identity:o})=>(0,n.addPairToMap)(e,{key:t,value:o}),remove:(e,t)=>(0,r.removePairFromMap)(e,t)}),p=(0,i.createApi)(o,{add:(e,t)=>(0,n.addPairToMap)(e,{key:t,value:!0}),remove:(e,t)=>(0,r.removePairFromMap)(e,t)});return(0,i.sample)({clock:_,source:t,fn:(e,{oldIdentity:t,newIdentity:o})=>{const i=(0,s.getAudioFullId)(t),a=(0,s.getAudioFullId)(o);return{addToStoreParams:{identity:o,fullId:i},removeFromStoreFullId:e[i]?(0,s.getAudioFullId)(e[i]):a}},target:(0,a.spread)({targets:{addToStoreParams:c.add,removeFromStoreFullId:p.remove}})}),(0,i.sample)({clock:u,filter:({newIdentity:e})=>Boolean(e),target:(0,a.spread)({targets:{oldIdentity:c.remove.prepend((e=>(0,s.getAudioFullId)(e))),newIdentity:p.remove.prepend((e=>(0,s.getAudioFullId)(e)))}})}),(0,i.sample)({clock:d,target:(0,a.spread)({targets:{addedFullId:c.remove,removedFullId:p.remove}})}),{$addedIdentitiesMap:t,$removedIdentitiesMap:o,$identitiesMap:l,addedIdentitiesMapApi:c,removedIdentitiesMapApi:p,addToStore:_,removeFromStore:u,removeFromAllIdentitiesMaps:d}}},471027:(e,t,o)=>{"use strict";o.d(t,{createFullIdsMap:()=>n});var i=o(32489),s=o(958955),a=o(918081);function n(e){const t=e.createStore({});return{$fullIdsMap:t,fullIdsMapApi:(0,i.createApi)(t,{add:(e,t)=>(0,s.addPairToMap)(e,{key:t,value:!0}),remove:(e,t)=>(0,a.removePairFromMap)(e,t)})}}},958955:(e,t,o)=>{"use strict";function i(e,t){return t.key in e?e:{...e,[t.key]:t.value}}o.d(t,{addPairToMap:()=>i})},991331:(e,t,o)=>{"use strict";function i({id:e,ownerId:t}){return`${t}_${e}`}o.d(t,{getAudioPlaylistFullId:()=>i})},918081:(e,t,o)=>{"use strict";function i(e,t){if(!(t in e))return e;const{[t]:o,...i}=e;return i}o.d(t,{removePairFromMap:()=>i})},203619:(e,t,o)=>{"use strict";function i(e){return{id:e.id,ownerId:e.owner_id,title:e.title,description:e.description,length:e.count}}o.d(t,{mapAPIPlaylistToAudioPlaylistData:()=>i})},431741:(e,t,o)=>{"use strict";o.d(t,{mapApiAudioPreviewToAudioPreviewData:()=>i});const i=e=>{const{url:t,clip_from:o,clip_to:i}=e;return{url:t||"",clip:{from:o||0,to:i||0}}}},499617:(e,t,o)=>{"use strict";o.d(t,{createAudioPodcastsFaveService:()=>u});var i=o(94359),s=o(360301),a=o(487641),n=o(32489),r=o(471027),_=o(303651);function u(e){const t=(0,i.getEffectorServiceDomain)(e),o=(0,s.createAddFx)({domain:t}),u=(0,a.createDeleteFx)({domain:t}),{fullIdsMapApi:d,$fullIdsMap:l}=(0,r.createFullIdsMap)(t);return(0,n.sample)({clock:o.done,fn:({params:{identity:e}})=>(0,_.getPodcastAudioFullId)(e),target:d.add}),(0,n.sample)({clock:u.done,fn:({params:{identity:e}})=>(0,_.getPodcastAudioFullId)(e),target:d.remove}),{addFx:o,deleteFx:u,$identitiesMap:l}}},360301:(e,t,o)=>{"use strict";o.d(t,{createAddFx:()=>s});var i=o(668882);function s({domain:e}){const t=(0,i.createFaveAddPodcastEpisodeFx)({domain:e});return e.createEffect((async({identity:e})=>{await t({query:{owner_id:e.ownerId,episode_id:e.podcastId}})}))}},487641:(e,t,o)=>{"use strict";o.d(t,{createDeleteFx:()=>s});var i=o(668882);function s({domain:e}){const t=(0,i.createFaveRemovePodcastEpisodeFx)({domain:e});return e.createEffect((async({identity:e})=>{await t({query:{owner_id:e.ownerId,episode_id:e.podcastId}})}))}},66044:(e,t,o)=>{"use strict";o.d(t,{createApiEffect:()=>s});var i=o(933052);const s=(e,{domain:t})=>t.createEffect((({query:t,controller:o,config:s,options:a})=>{const n=o?.signal;return(0,i.api)(e,t,s,{signal:n,...a})}))},492243:(e,t,o)=>{"use strict";o.d(t,{isApiError:()=>i});const i=e=>!!e&&"type"in e&&"api_error"===e.type},614117:(e,t,o)=>{"use strict";o.d(t,{isNetworkError:()=>i});const i=e=>"network_error"===e?.type},165753:(e,t,o)=>{"use strict";var i;o.d(t,{AvailableHelpHints:()=>i}),function(e){e.ACCOUNT_HINT_MINI_APPS_BUTTON_MVK_PROFILE="mini_apps:button_mvk_profile",e.ACCOUNT_HINT_MINI_APPS_BUTTON_MVK_APP_MENU="mini_apps:button_mvk_app_menu",e.ACCOUNT_HINT_MINI_APPS_COUNTER_TOGGLE_IN_ACTION_MENU="mini_apps:counter_toggle_in_action_menu",e.ACCOUNT_HINT_MINI_APPS_COUNTER_TOGGLE_IN_ACTION_MENU_INTRO="mini_apps:counter_toggle_in_action_menu_intro",e.ACCOUNT_HINT_MINI_APPS_OPEN_CATALOG_WITH_BADGES="mini_apps:open_catalog_with_badges",e.ACCOUNT_HINT_MINI_APPS_CATALOG_SECTION_WITH_BADGES="mini_apps:catalog_section_with_badges",e.ACCOUNT_HINT_SUPERAPP_RECOMMEND_ACTION_IN_MENU="superapp:recommend_action_in_menu",e.ACCOUNT_HINT_SUPERAPP_SHOW_RECOMMEND_ACTION="superapp:show_recommend_action",e.ACCOUNT_HINT_MINI_APPS_NAV_BUTTONS_THIRD_PARTY_BUTTONS="mini_apps:nav_buttons_third_party_buttons",e.ACCOUNT_HINT_POSTING_EDITOR_ONLINE_BOOKING="posting:editor_online_booking",e.ACCOUNT_HINT_PROFILE_SERVICES_MENU_BANNER="profile:services_menu_banner",e.ACCOUNT_HINT_PROFILE_SERVICES_ONBOARDING="profile:services_onboarding",e.ACCOUNT_HINT_MVK_PWA_TABBAR="mvk:pwa_tabbar",e.ACCOUNT_HINT_SUPERAPP_MVK_SHOWCASE="superapp:mvk_showcase",e.ACCOUNT_HINT_IM_INTEGRATION_APPS_TOOLTIP_ON_PICKER="superapp:im_integration_apps_tooltip_on_picker",e.ACCOUNT_HINT_IM_INTEGRATION_PICKER_APPS_BANNER="superapp:im_integration_picker_apps_banner",e.ACCOUNT_HINT_IM_INTEGRATION_PICKER_GAMES_BANNER="superapp:im_integration_picker_games_banner",e.ACCOUNT_HINT_FRIENDS_FOLLOWERS_MODE_FORCIBLY_ENABLED_ONBOARDING="friends:followers_mode_forcibly_enabled_onboarding",e.ACCOUNT_HINT_FRIENDS_FOLLOWERS_MODE_CAN_BE_ENABLED_ONBOARDING="friends:followers_mode_can_be_enabled_onboarding",e.ACCOUNT_HINT_FRIENDS_FOLLOWERS_MODE_ABOUT_MODAL_IMAGES="friends:followers_mode_about_modal_images",e.ACCOUNT_HINT_IM_INTEGRATION_CATALOG_ONBOARDING="superapp:im_integration_catalog_onboarding",e.ACCOUNT_HINT_PROFILE_PASSKEY_ONBOARDING_WEB="profile:passkey_onboarding_web",e.ACCOUNT_HINT_VIDEO_INTERACTIVE_VIDEO_ONBOARDING="video:interactive_video_onboarding",e.ACCOUNT_HINT_VIDEO_INTERACTIVE_INTERACTIVE_TIME_INDICATOR="video:interactive_time_indicator",e.ACCOUNT_HINT_CLIPS_WEB_UPLOAD_VIDEO_AS_CLIP="clips:upload_video_as_clip_web",e.AUTHOR_LIKE_ONBOARDING_HINT="feed:author_like_onboarding",e.GROUP_LIKE_ONBOARDING_HINT="feed:group_like_onboarding",e.ACCOUNT_HINT_COMMUNITY_REVIEW_TOOLTIP_MVK="community:review:tooltip_mvk",e.ACCOUNT_HINT_GROUPS_EDIT_MARKET_EXTRACTED_SETTINGS_HINT="groups:edit:market_extracted_settings_checkbox_hint",e.ACCOUNT_HINT_GROUPS_MAIN_MARKET_ACTION_EXTRACTED_SETTINGS_HINT="groups:main:market_action_extracted_settings_hint",e.ACCOUNT_HINT_VIDEO_PIN="video:pin",e.ACCOUNT_HINT_VIDEO_WATCH_LATER_BUTTON="video:watch_later_button",e.ACCOUNT_HINT_VIDEO_WATCH_LATER_ACTION="video:watch_later_action",e.ACCOUNT_HINT_VIDEO_WATCH_LATER_MENU="video:watch_later_menu",e.ACCOUNT_HINT_VIDEO_GROUP_CROP_COVER="video:group_crop_cover",e.ACCOUNT_HINT_VIDEO_MULTIPLE_VOLUME="video:multiple_volume",e.ACCOUNT_HINT_VIDEO_SUBTITLES_KAZ_LANG="video:subtitles_kaz_lang",e.ACCOUNT_HINT_MVK_VIDEO_FILTERS="mvk:video_filters",e.ACCOUNT_HINT_PROFILE_PHOTO_FLOW_ONBOARDING_BANNER_PROFILE_MVK="profile:photo_flow_onboarding_banner_profile_mvk",e.ACCOUNT_HINT_PROFILE_PHOTO_FLOW_ONBOARDING_BANNER_SHOW_ALL_MVK="profile:photo_flow_onboarding_banner_show_all_mvk",e.ACCOUNT_HINT_PROFILE_PHOTO_FLOW_ONBOARDING_BANNER_PHOTO__MVK="profile:photo_flow_onboarding_banner_photo__mvk",e.ACCOUNT_HINT_PROFILE_PHOTO_FLOW_ONBOARDING_BANNER_MOBILE_QUESTION_MVK="profile:photo_flow_onboarding_banner_mobile_question_mvk",e.ACCOUNT_HINT_PROFILE_OWNER_CONTENT_TABS_SETTINGS="profile:redesign_owner_content_tabs_settings",e.ACCOUNT_HINT_PROFILE_SERVICES_ONBOARDING_WEB="profile:services_onboarding_web",e.ACCOUNT_HINT_PROFILE_PHOTO_FLOW_ONBOARDING_BANNER_PROFILE_WEB="profile:photo_flow_onboarding_banner_profile_web",e.ACCOUNT_HINT_PROFILE_PHOTO_FLOW_ONBOARDING_BANNER_SHOW_ALL_WEB="profile:photo_flow_onboarding_banner_show_all_web",e.ACCOUNT_HINT_PROFILE_PHOTO_FLOW_ONBOARDING_BANNER_PHOTO__WEB="profile:photo_flow_onboarding_banner_photo__web",e.ACCOUNT_HINT_PROFILE_PHOTO_FLOW_ONBOARDING_BANNER_MOBILE_QUESTION_WEB="profile:photo_flow_onboarding_banner_mobile_question_web",e.ACCOUNT_HINT_PROFILE_PHOTO_FLOW_ONBOARDING_TOOLTIP_MOVE_PHOTO="profile:photo_flow_onboarding_tooltip_move_photo",e.ACCOUNT_HINT_ARTICLES_MOBILE_EDITOR="articles:mobile_editor",e.ACCOUNT_HINT_ADSEDIT_SITE_REMOVAL_POPUP="adsedit:site_removal_popup",e.ACCOUNT_HINT_ADSEDIT_COMMUNITY_REMOVAL_POPUP="adsedit:community_removal_popup",e.ACCOUNT_HINT_ADSEDIT_COMMUNITY_AND_SITE_REMOVAL_POPUP="adsedit:community_and_site_removal_popup",e.ACCOUNT_HINT_STICKERS_UGC_SETTINGS_UNSEEN="stickers:ugc_settings_unseen",e.ACCOUNT_HINT_AUDIO_STUDIO_SHOW_PRESENT_MINIAPP_MODAL="audio_studio:show_present_miniapp_modal",e.ACCOUNT_HINT_AUDIO_STUDIO_SHOW_ANNUAL_RESULT_BANNER="audio_studio:show_annual_result_banner",e.ACCOUNT_HINT_AUDIO_LONG_TAP_PREVIEW_WEB="audio:longtap_preview_web",e.ACCOUNT_HINT_CLIPS_SYNCING_CLIPS_WITH_POSTS_WEB="clips:syncing_clips_with_posts_web",e.ACCOUNT_HINT_BANNED_RESET_SESSIONS="banned:can_not_reset_sessions",e.ACCOUNT_HINT_CLIPS_FORCE_UPLOAD_VIDEO_AS_CLIP="clips:force_upload_video_as_clip",e.ACCOUNT_HINT_CLIPS_SYNCING_CLIPS_WITH_POSTS_MVK="clips:syncing_clips_with_posts_mvk",e.ACCOUNT_HINT_POSTING_EDITOR_PHOTO_ATTACHMENTS_CROP="posting:editor_photo_attachements_crop",e.ACCOUNT_HINT_POSTING_EDITOR_PHOTO_ATTACHMENTS_CROP_ZOOM="posting:editor_photo_attachements_crop_zoom",e.ACCOUNT_HINT_SMB_YCLIENTS_ONLINE_BOOKING="smb:yclients:online_booking",e.UNBAN_SECURITY_RECOMMENDATION_HINT="feed:after_auth:unban_security_recommendation",e.ACCOUNT_HINT_SETTINGS_BOOKING="smb:yclients:group_settings_online_booking",e.ACCOUNT_HINT_VIDEO_ATTACH_SHORT_VIDEO="video:attach_short_video",e.ACCOUNT_HINT_STORIES_EDITOR_TEXT_CREATING_WEB="stories:editor_text_creating_web"}(i||(i={}))},94359:(e,t,o)=>{"use strict";o.d(t,{getEffectorServiceDomain:()=>a});var i=o(32489),s=o(418562);const a=e=>{const t=e?.name||(0,s.default)();return e?.domain?e.domain.createDomain(t):(0,i.createDomain)(t)}},415096:(e,t,o)=>{"use strict";function i(e,t){return t<0?e+t:t}o.d(t,{indexAbs:()=>i})},760325:(e,t,o)=>{"use strict";function i(e){return"number"==typeof e&&!Number.isNaN(e)}o.d(t,{isNumber:()=>i})},112268:(e,t,o)=>{"use strict";o.d(t,{joinFullId:()=>i,joinRawId:()=>s});const i=(e,t)=>`${e}_${t}`,s=({ownerId:e,itemId:t,externalId:o})=>[e,t,o].filter(Boolean).join("_")},930996:(e,t,o)=>{"use strict";function i(e,t){if(e===t)return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;const o=Object.keys(e),i=Object.keys(t);if(o.length!==i.length)return!1;for(let i=0;i<o.length;i++)if(!Object.prototype.hasOwnProperty.call(t,o[i])||e[o[i]]!==t[o[i]])return!1;return!0}o.d(t,{shallowEqual:()=>i})},962954:(e,t,o)=>{"use strict";o.d(t,{OwnedIdentity:()=>a});var i=o(470297),s=o(643010);class a{static fromRawId(e){const t=(0,i.parseRawId)(e);return new a(t)}get rawId(){return(0,s.getIdentityRawId)(this)}get accessRawId(){return(0,s.getIdentityAccessRawId)(this)}get fullId(){return this.rawId}constructor(e){this.id=e.id,this.ownerId=e.ownerId,this.accessKey=e.accessKey}}},643010:(e,t,o)=>{"use strict";function i({id:e,ownerId:t}){return`${t}_${e}`}function s(e){const{accessKey:t}=e,o=i(e);return t?`${o}_${t}`:o}o.d(t,{getIdentityAccessRawId:()=>s,getIdentityRawId:()=>i})},470297:(e,t,o)=>{"use strict";o.d(t,{parseRawId:()=>s});var i=o(8520);function s(e){const t=e.split("_"),o=t[0]&&parseInt(t[0],10),s=t[1]&&parseInt(t[1],10);if(!(0,i.isNumber)(s)||!(0,i.isNumber)(o))throw new Error(`Invalid rawId: ${e}`);return{id:s,ownerId:o,accessKey:t[2]}}},901219:(e,t,o)=>{"use strict";o.d(t,{getOwnerFullName:()=>r,getOwnerHref:()=>n,getOwnerShortName:()=>_,isOwnerGroup:()=>a,isOwnerUser:()=>s});var i=o(451694);const s=e=>!!e&&"first_name"in e,a=e=>!!e&&"name"in e;function n(e,t=!1){let o="/";return e&&(a(e)?o+=e.screen_name||`club${e.id}`:o+=e.screen_name||e.domain||`id${e.id}`),t?window.location.origin+o:o}function r(e){let t="";return e?(e.first_name&&(t+=e.first_name.trim()),e.last_name&&(t+=` ${e.last_name.trim()}`),e.maiden_name&&e.sex===i.BaseSexEnumNames.FEMALE&&(t+=` (${e.maiden_name.trim()})`),t):t}function _(e){let t="";return e.first_name&&(t+=e.first_name.trim()),e.last_name&&(t+=` ${e.last_name.trim().slice(0,1)}.`),t}},333258:(e,t,o)=>{"use strict";o.d(t,{AccountSecurityLevelEnumNames:()=>i});const i={NOTHING_TO_SAY:0,HAVE_ISSUES:1,HAVE_RECOMMENDATIONS:10,GOOD:20}},451694:(e,t,o)=>{"use strict";o.d(t,{BaseSexEnumNames:()=>i});const i={UNKNOWN:0,FEMALE:1,MALE:2}},778419:(e,t,o)=>{"use strict";o.d(t,{AudioHlsNode:()=>c});var i=o(761396),s=o(493810),a=o(243113),n=o(812140),r=o(826046),_=o(723919),u=o(72882),d=o(250682),l=o(476726);class c{get isFullyLoaded(){return this.fullyLoaded}get error(){return this.audioElement.error||null}get played(){return this.audioElement.played}get src(){return this.url}get hls(){return this.hlsInstance||null}get duration(){return isFinite(this.audioElement.duration)?this.audioElement.duration:0}get readyState(){return this.audioElement.readyState}get currentTime(){return this.audioElement.currentTime}set currentTime(e){this.audioElement.currentTime=e}get volume(){return this.audioElement.volume}set volume(e){this.audioElement.volume=e}set playbackRate(e){this.audioElement.playbackRate=e}get currentProgress(){return isNaN(this.audioElement.duration)?0:Math.max(0,Math.min(1,this.audioElement.currentTime/this.audioElement.duration))}get currentBuffered(){return this.audioElement.buffered.length?Math.min(1,this.audioElement.buffered.end(0)/this.audioElement.duration):0}play(){return(0,u.wrapAudioPlay)(this.audioElement).catch((e=>{switch(e.code){case e.NOT_SUPPORTED_ERR:case e.ABORT_ERR:break;default:throw e}}))}pause(){this.audioElement.pause()}addEventListeners(e){this.audioElement.addEventListener("pause",(()=>e.onPause())),this.audioElement.addEventListener("play",(()=>e.onPlay())),this.audioElement.addEventListener("progress",(()=>{if(e.onBufferUpdate(),!this.hlsInstance){const e=this.audioElement.buffered;e.length&&Math.abs(e.end(e.length-1)-this.audioElement.duration)<1&&(this.fullyLoaded=!0)}})),this.audioElement.addEventListener("timeupdate",(()=>{e.onProgressUpdate&&e.onProgressUpdate()})),this.audioElement.addEventListener("ended",(()=>{e.onEnd&&e.onEnd()})),this.onFail=e.onFail||(()=>{}),this.audioElement.addEventListener("error",(()=>{this.onFail()})),this.audioElement.addEventListener("canplay",(()=>{e.onCanPlay&&e.onCanPlay()})),this.audioElement.addEventListener("durationchange",(()=>{e.onDurationChange&&e.onDurationChange()}))}static isHlsUrl(e){const t=(0,s.audioUnmaskSource)(e).includes(".m3u8");if(!(0,i.isAudioPWAFeature)())return t;const o=(0,n.checkIsDownloadedUrl)(e);return t||o}setUrl(e){if(this.url=e,c.isHlsUrl(this.url)&&!c.shouldUseNativeHls()&&"function"==typeof window.MediaSource)return this.initHls(this.url).catch((()=>this.onFail()));this.hlsInstance&&this.hlsInstance.destroy();const t=this.audioElement.firstElementChild;return t.src=this.url,c.isHlsUrl(this.url)?t.type="application/vnd.apple.mpegurl":(0,l.partConfigEnabled)("music_clear_media_type")&&t.removeAttribute("type"),this.audioElement.load(),Promise.resolve()}static shouldUseNativeHls(){const[e]=window.browser.version.split("."),t=parseInt(e);return window.browser.safari||window.browser.msie_edge&&t>11&&t<78}initHls(e){return c.loadHls().then((({default:t})=>new Promise((o=>{let i=!1;const s=!!d.ls.get("_audio_hls_debug");this.hlsInstance&&this.hlsInstance.destroy();const n=new t({debug:s,maxBufferHole:3,nudgeOffset:.5,nudgeMaxRetry:5,maxFragLookUpTolerance:.2});n.on(t.Events.BUFFER_EOS,(()=>this.fullyLoaded=!0)),n.on(t.Events.ERROR,((e,o)=>{(s||o.fatal)&&console.log("audio hls error",e,o),o.details===t.ErrorDetails.BUFFER_STALLED_ERROR&&(i=!0,n.stopLoad(),n.startLoad()),o.fatal&&this.onFail({type:o.type,details:o.details,url:o.frag&&o.frag.url||o.context&&o.context.url,code:o.networkDetails?o.networkDetails.status:0})})),n.on(t.Events.FRAG_BUFFERED,((e,t)=>{const o=(0,a.getCurrentAudio)(),s={owner_id:o.ownerId,audio_id:o.id,fragment_id:t.frag.sn.toString(),fragment_duration:Math.ceil(1e3*t.frag.duration).toString(),time_to_first_byte:Math.ceil(t.stats.loading.first-t.stats.loading.start).toString(),time_to_first_frame:Math.ceil(t.stats.loading.end-t.stats.loading.start).toString(),buffering_time:Math.ceil(t.stats.buffering.end-t.stats.buffering.start).toString(),http_request_host:new URL(t.frag.baseurl).host};i&&(i=!1,this.audioNetworkStatCollector.logEvent({...s,event_type:r.AudioNetworkType.FRAGMENT_STALLED},_.default.getConnectionType(),_.default.getConnectionEffectiveType())),this.audioNetworkStatCollector.logEvent({...s,event_type:r.AudioNetworkType.FRAGMENT_LOADED},_.default.getConnectionType(),_.default.getConnectionEffectiveType())})),n.loadSource(e),n.attachMedia(this.audioElement),this.hlsInstance=n,o()}))))}static loadHls(){return o.e(45458).then(o.bind(o,164945))}constructor(e,t){this.fullyLoaded=!1,this.url="",this.audioElement=new Audio,this.audioElement.appendChild(document.createElement("source")),this.audioElement.crossOrigin="anonymous",this.audioElement.preload="auto",this.volume=e.volume,this.addEventListeners(e),t&&this.setUrl(t).then((()=>{this.audioElement.load()}));const o=new r.NetworkStatCollector;this.audioNetworkStatCollector=new r.AudioNetworkStatCollector(o)}}},609116:(e,t,o)=>{"use strict";o.d(t,{AudioMediaSession:()=>u});var i=o(514640),s=o(735477),a=o(944762),n=o(8520),r=o(490712),_=o(269315);class u{init(){this.mediaSession&&(this.player.subscribe(i.AudioPlayerEventType.PLAY,this.handlePlay),this.player.subscribe(i.AudioPlayerEventType.PLAYLIST_CHANGED,this.handlePlaylistChange))}async updateMediaSessionControls(){const{mediaSession:e}=this;if(e)if(this.player.ads?.isActive)e.setActionHandler("play",this.play),e.setActionHandler("pause",this.pause),e.setActionHandler("seekbackward",null),e.setActionHandler("seekforward",null),e.setActionHandler("previoustrack",null),e.setActionHandler("nexttrack",null);else{e.setActionHandler("play",this.play),e.setActionHandler("pause",this.pause);const t=this.player.getCurrentAudio();if(this.player.isPlaying()?(e.setActionHandler("seekbackward",this.seekBackward),e.setActionHandler("seekforward",this.seekForward)):(e.setActionHandler("seekbackward",null),e.setActionHandler("seekforward",null)),t&&!(0,a.isPodcast)(t))try{const[t,o]=await this.getPrevAndNextAudio();t?e.setActionHandler("previoustrack",this.previousTrack):e.setActionHandler("previoustrack",null),o?e.setActionHandler("nexttrack",this.nextTrack):e.setActionHandler("nexttrack",null)}catch(t){e.setActionHandler("previoustrack",null),e.setActionHandler("nexttrack",null)}else e.setActionHandler("previoustrack",null),e.setActionHandler("nexttrack",null)}}getPrevAndNextAudio(){return Promise.all([this.player.getPrevAudio().catch((()=>null)),this.player.getNextAudio().catch((()=>null))])}constructor(e,t){this.handlePlay=()=>{const{mediaSession:e}=this;if(!e)return;const t=this.player.getCurrentAudio(),o=(0,s.audioTupleToAudioObject)(t);if(!o)return;const i=(0,n.decodeHTMLEntities)(o.title+(o.subTitle?` (${o.subTitle})`:"")).replace(/<[^>]*>?/gm,""),a=(0,n.decodeHTMLEntities)(o.performer||"").replace(/<[^>]*>?/gm,""),r=this.player.getCurrentPlaylist(),u=r?(0,n.decodeHTMLEntities)(r.getTitle&&r.getTitle()||"").replace(/<[^>]*>?/gm,""):"",d=o.coverUrl_p||o.coverUrl_l,l=d?[{sizes:"160x160",src:d}]:[];this.updateMediaSessionControls(),(0,_.updateMediaSessionMetadata)({title:i,artist:a,album:u,artwork:l},e)},this.handlePlaylistChange=()=>{this.player&&!this.player.getCurrentAudio()&&(0,_.clear)()},this.play=()=>{this.player.play(),(0,r.statlogsValueEvent)("global_media_controls","audio_player","play")},this.pause=()=>{this.player.pause(),(0,r.statlogsValueEvent)("global_media_controls","audio_player","pause")},this.previousTrack=()=>{this.player.prev(),(0,r.statlogsValueEvent)("global_media_controls","audio_player","previous_track")},this.nextTrack=()=>{this.player.next(),(0,r.statlogsValueEvent)("global_media_controls","audio_player","next_track")},this.seekBackward=()=>{const e=(0,s.audioTupleToAudioObject)(this.player.getCurrentAudio()),t=e?.duration||0,o=(this.player.getCurrentProgress()||0)*t,i=Math.max(0,(o-10)/t);i>0?this.player.seek(i):this.player.prev(),(0,r.statlogsValueEvent)("global_media_controls","audio_player","seek_backward")},this.seekForward=()=>{const e=(0,s.audioTupleToAudioObject)(this.player.getCurrentAudio()),t=e?.duration||0,o=(this.player.getCurrentProgress()||0)*t,i=Math.min(1,(o+10)/t);i<1?this.player.seek(i):this.player.next(),(0,r.statlogsValueEvent)("global_media_controls","audio_player","seek_forward")},this.player=e,this.mediaSession=t??_.DEFAULT_MEDIA_SESSION}}},514640:(e,t,o)=>{"use strict";var i;o.d(t,{AudioPlayerEventType:()=>i,events:()=>s}),function(e){e.CURRENT_CHANGED="curr",e.PLAY="start",e.PLAY_REQUESTED="request_play",e.IMPL_PLAY="impl_play",e.PAUSE="pause",e.STOP="stop",e.UPDATE="update",e.LOADED="loaded",e.ENDED="ended",e.FAILED="failed",e.BUFFERED="buffered",e.PROGRESS="progress",e.VOLUME="volume",e.PLAYLIST_CHANGED="plchange",e.PLAYLIST_CLEAR_REQUESTED="playlist_clear_requested",e.PLAYLIST_CLEARED="playlist_cleared",e.ADDED="added",e.REMOVED="removed",e.FREQ_UPDATE="freq",e.SEEK="seek",e.PLAY_NEXT="play_next",e.AD_READY="ad_ready",e.AD_DEINITED="ad_deinit",e.AD_STARTED="ad_started",e.AD_COMPLETED="ad_completed",e.PLAYER_IS_AD_CHANGED="player_is_ad_changed",e.PLAYER_IS_PLAYING_CHANGED="player_is_playing_changed",e.START_LOADING="start_load",e.CAN_PLAY="actual_start",e.SELECT="select",e.DESELECT="deselect",e.EMPTY_PLAYLIST="empty_playlist",e.NOT_FOUND_PLAYLIST="not_found_playlist",e.INIT="init",e.REQUEST_EXPANDED="request_expanded",e.PLAYLIST_START_LOADING="playlist_start_loading",e.MUSIC_AUDIOS_ADD="music_audios_add",e.MUSIC_AUDIOS_DELETE="music_audios_delete",e.MUSIC_PLAYLISTS_ADD="music_playlists_add",e.MUSIC_OWNERS_FOLLOW="music_owners_follow",e.MUSIC_OWNERS_UNFOLLOW="music_owners_unfollow",e.CURATOR_FOLLOW="curator_follow",e.CURATOR_UNFOLLOW="curator_unfollow",e.RADIOSTATION_FOLLOW="radiostation_follow",e.RADIOSTATION_UNFOLLOW="radiostation_unfollow",e.CURRENT_RADIOSTATION_FOLLOW_STATUS_UPDATE="current_radiostation_update",e.CURRENT_AUDIO_DISLIKE_STATUS_UPDATE="current_audio_dislike_status_update",e.AUDIO_RESTORE_BY_DISLIKE_ACTION="audio_restore_by_dislike_action",e.AUDIO_DELETE_BY_DISLIKE_ACTION="audio_delete_by_dislike_action",e.PLACEHOLDER_REMOVE="placeholder_remove",e.PLAY_TRACK_FROM_AUTOPLAY="play_track_from_autoplay",e.CLEAN_AUTOPLAY_QUEUE="clean_autoplay_queue",e.PLAY_PREVIEW="play_preview",e.STOP_PREVIEW="stop_preview",e.END_PREVIEW="end_preview",e.PROGRESS_PREVIEW="progress_preview",e.PREVIEW_BUFFERED="preview_buffered",e.PLAY_SNIPPET="play_snippet",e.STOP_SNIPPET="stop_snippet",e.PROGRESS_SNIPPET="progress_snippet",e.SNIPPET_BUFFERED="snippet_buffered",e.SNIPPET_PLAYER_STATE_CHANGED="snippet_player_state_changed",e.SNIPPET_PLAYER_FAIL="snippet_player_fail",e.SNIPPET_PLAYER_PLAY_NEXT_SNIPPET="snippet_player_play_next_snippet",e.SNIPPET_PLAYER_PLAY_PREV_SNIPPET="snippet_player_play_prev_snippet",e.SNIPPET_PLAYER_SNIPPET_PLAYING_END="snippet_player_snippet_playing_end",e.SNIPPET_PLAYER_CHANGE_SOURCE="snippet_player_change_source",e.SNIPPET_PLAYER_PAUSED_BY_INCOMING_CALL="snippet_player_paused_by_incoming_call",e.SNIPPET_PLAYER_PAUSED_BY_VISIBILITY="snippet_player_paused_by_visibility"}(i||(i={}));const s=i},121775:(e,t,o)=>{"use strict";o.d(t,{AudioMixPlaylist:()=>m,PLAYLIST_CONTEXT_VKMIX:()=>l,PLAYLIST_TYPE_VKMIX:()=>d});var i=o(434518),s=o(763812),a=o(406245),n=o(264544),r=o(555282),_=o(722239),u=o(476726);const d="vkmix",l="vkmix:vk_mix";var c=(0,s._)("_items"),p=(0,s._)("_isSessionLaunched");class m extends r.AudioList{get isSessionLaunched(){return(0,i._)(this,p)[p]}get infinite(){return!0}get items(){return(0,i._)(this,c)[c]}get length(){return this.items.length}audioAt(e){return this.items.at(e)}async fetchAt(e,{range:t=0}={}){const o=this.ensureAbsIndex(e),i=this.audioAt(o),s=o+t+1-this.length;if(i&&s<=0)return i;const[a]=await this.fetchNext(s);if(!a)throw new Error("fetchNext have not return audios");return a}async fetchNext(e=1){const t=(0,u.partConfigEnabled)("audio_recom_playlists_starts_with_last_played_audio_web"),{id:o,isSessionLaunched:i}=this,s=(await this.service.fetchNextFx({id:o,count:e,isSessionLaunched:i,isSessionFeatureEnabled:t})).map((e=>function(e){return{mediaMetadata:{},...(0,a.mapAPIAudioToMusicAudioData)(n.AudioType.MusicTrack,e),apiAudio:e}}(e)));return this.items.push(...s),s}launchSession(){if(0===this.length)throw new Error("Music mix session cannot be launched if there are no tracks in the mix");(0,i._)(this,p)[p]=!0}breakSession(){this.items.length=0,(0,i._)(this,p)[p]=!1}constructor({id:e,title:t,items:o=[],context:s}){super(),Object.defineProperty(this,c,{writable:!0,value:void 0}),Object.defineProperty(this,p,{writable:!0,value:void 0}),(0,i._)(this,p)[p]=!1,this.fetchable=null,this.service=(0,_.createAudioVkMixPlaylistService)(),(0,i._)(this,c)[c]=[...o],this.type=d,this.title=t,this.id=e,this.context=s}}},722239:(e,t,o)=>{"use strict";o.d(t,{createAudioVkMixPlaylistService:()=>a});var i=o(32489),s=o(249814);function a(){const e=(0,i.createDomain)("audio/playlist/vkmix"),{$lists:t,fetchNextFx:o}=(0,s.createAudioVkMixService)(e);return{$lists:t,$loading:o.pending,fetchNextFx:o}}},539217:(e,t,o)=>{"use strict";o.d(t,{AudioMixPlaylist:()=>i.AudioMixPlaylist,PLAYLIST_CONTEXT_VKMIX:()=>i.PLAYLIST_CONTEXT_VKMIX,PLAYLIST_TYPE_VKMIX:()=>i.PLAYLIST_TYPE_VKMIX});var i=o(121775)},280357:(e,t,o)=>{"use strict";o.d(t,{AudioStats:()=>j,SUBTYPE_OFF:()=>x,SUBTYPE_ON:()=>R,SUBTYPE_PLAYLIST:()=>U,SUBTYPE_UPLOAD:()=>B,TYPE_ADDED:()=>c,TYPE_BROADCASTING:()=>w,TYPE_REMOVED:()=>p,TYPE_SHARE_AUDIO:()=>y,TYPE_SHOW_ALBUM:()=>h});var i=o(888610),s=o(248782),a=o(490712),n=o(418562),r=o(250682),_=o(970577),u=o(581903),d=o(476726),l=o(695290);const c="added",p="removed",m="recommendation_removed",h="show_album",y="share_audio",f="start",E="stop",g="volume",v="rewind",A="play_further",w="broadcast",b="curator",P="default",T="next_track",I="prev_track",O="auto",C="interruption",M="continue_from_pause",D="new",S="close_app",k="queue",L="pause",B="upload",R="on",x="off",F="follow",N="unfollow",U="playlist",W="session_end",K={[f]:1,[E]:2,[g]:3,[v]:4,[A]:5,[c]:6,[p]:7,[m]:8,[h]:9,[y]:10,[w]:11,[b]:12,[l.RADIO_STATION_EVENT_ITEM]:13},V={[P]:1,[T]:2,[I]:3,[O]:4,[C]:5,[M]:6,[D]:7,[S]:8,[k]:9,[L]:10,[B]:11,[R]:12,[x]:13,[F]:14,[N]:15},H="audio_unique_unauth_id";class j{listenOnBeforeUnload(){window.addEvent(window,"beforeunload",this.onPageClose)}stopListenOnBeforeUnload(){window.removeEvent(window,"beforeunload",this.onPageClose)}logEvent(e){return this.actionStatCollector.logEvent(e)}canOperate(){return null!==this.playerAdapter&&!(this.playerAdapter.isPodcast()||this.playerAdapter.isExternalStream()||this.playerAdapter.isAdPlaying()||this.playerAdapter.isMarusiaTrack())}getCurrentAudioParams(){if(!this.playerAdapter)return{};const e=this.currentAudioId||this.playerAdapter.getAudioId();if(e){const[t,o]=e.split("_");return{ownerId:t,audioId:o,trackCode:this.currentAudioTrackCode||this.playerAdapter.getAudioTrackCode()}}return{}}getEnvParams(){if(this.playerAdapter)return{state:this.playerAdapter.getState(),context:this.playerAdapter.getContext(),ref:window.cur&&window.vk.widget?String(window.cur.widgetReferrer||"").substring(0,20):""}}getListenedTime(){return this.playerAdapter&&Math.round(this.playerAdapter.getListenedTime())||0}getPlaySubtype(){if(!this.playerAdapter)return"";if(this.playerAdapter.isAutoPlayed())return O;const e=this.playerAdapter.getSequence();if(e)return e>0?T:I;const t=this.pausedAudioId,o=this.playerAdapter.getAudioId();return t&&o===t?M:D}onRadioOn(e){(0,d.partConfigEnabled)("audioRadioActionStatCollectorEnabled")?this.actionStatCollector.logEvent({type:l.RADIO_STATION_EVENT_ITEM,[l.RADIO_STATION_EVENT_ITEM]:{event_type:R,radio_station_id:e.id,track_code:e.trackCode}}):this.sendAudioEvent({type:l.RADIO_STATION_EVENT_ITEM,subtype:R,playlistId:e.id,trackCode:e.trackCode})}onRadioOff(e){(0,d.partConfigEnabled)("audioRadioActionStatCollectorEnabled")?this.actionStatCollector.logEvent({type:l.RADIO_STATION_EVENT_ITEM,[l.RADIO_STATION_EVENT_ITEM]:{event_type:x,radio_station_id:e.id,duration:this.getListenedTime(),track_code:e.trackCode}}):this.sendAudioEvent({type:l.RADIO_STATION_EVENT_ITEM,subtype:x,playlistId:e.id,listened:this.getListenedTime(),trackCode:e.trackCode})}onTrackSwitch(e,t){if(!e||!this.playerAdapter)return;let o=D;const i=this.playerAdapter.getSequence(),[s,a]=e.fullId.split("_");this.playerAdapter.isAutoPlayed()?o=O:i&&(o=i>0?T:I),this.sendCurrentAudioEvent({type:E,subtype:o,position:this.currentPosition,listened:this.currentListened,trackCode:e.trackCode,playlistId:t,ownerId:Number(s),audioId:Number(a)}),this.wasEnded=!0,this.collectListenedData(e),this.collectListenedDataSwitch();const n=this.listenedData;this.listenedData=null,this.sendListenedData(n)}onPageClose(){this.playerAdapter&&this.playerAdapter.isPlaying()&&(this.sendCurrentAudioEvent({type:E,subtype:S}),this.sendListenedData())}collectListenedDataSwitch(){if(this.listenedData){if(this.listenedData.end_stream_reason===W||!this.playerAdapter)return;const e=this.playerAdapter.isAutoPlayed(),t=this.getListenedTime(),o=this.playerAdapter.getSequence();let i=null;o&&!e?i=o>0?"next_btn":"prev":this.playlistChanged&&(i="playlist_change"),!i&&e&&(i="playlist_next"),this.listenedData.end_stream_reason=i||"new",t&&(this.listenedData.listened=t)}}collectListenedData(e=null){const t=e||this.currentAudio;if(!this.canOperate()||!t||!this.playerAdapter)return null;const o=t.fullId,i=t.trackCode||this.playerAdapter.getAudioTrackCode(),s=this.getListenedTime(),a=t.urlHash;if(a||console.log("no url hash"),!s||!a)return null;let n={audio_id:o,listened:s,context:this.playerAdapter.getContext(),hash:a};return window.cur&&window.vk.widget&&(n.ref=window.cur.widgetReferrer||""),this.playerAdapter.hasSearchParams()&&(n.search_params=JSON.stringify(this.playerAdapter.getSearchParams())),this.playerAdapter.hasPlaylist()&&(this.playerAdapter.isRealPlaylist()&&(n.playlist_id=this.playerAdapter.getPlaylistId()),this.playerAdapter.isShuffledPlaylist()&&(n.shuffled=1)),i&&(n.track_code=i),this.playerAdapter.isRepeatCurrentAudio()?n.repeat="one":this.playerAdapter.isRepeatAll()&&(n.repeat="all"),this.playerAdapter.isAutoPlayed()&&(n.auto=1),this.playerAdapter.hasPrevAudio()&&(n.prev_audio_id=this.playerAdapter.getPrevAudioId()),this.playerAdapter.hasPrevPlaylist()&&this.playerAdapter.isRealPrevPlaylist()&&(n.prev_playlist_id=this.playerAdapter.getPrevPlaylistId()),this.playerAdapter.isPlaying()||(n.end_stream_reason="stop_btn"),n.state=document.hidden?"background":"app",this.listenedData=n,this.sendListenedDataDelayed(1e4,n),n}sendListenedData(e=null){null!==this.sendTimeout&&clearTimeout(this.sendTimeout);const t=e||this.listenedData;this.listenedData=null,t&&t.listened&&this.playerAdapter&&(this.uniqueUserId&&(t.unique_id=this.uniqueUserId),this.playerAdapter.sendListenedData(t))}sendListenedDataDelayed(e=0,t=null){null!==this.sendTimeout&&clearTimeout(this.sendTimeout),this.sendTimeout=setTimeout((()=>this.sendListenedData(t)),e)}serializeEvent(e){const t=[K[e.type],V[e.subtype],1];return e.audioId?t.push(e.ownerId+"_"+e.audioId):t.push(0),e.trackCode?t.push(e.trackCode):t.push(0),e.state?t.push(e.state):t.push(i.UNKNOWN_STATE),e.ref?t.push(e.ref):t.push(""),e.context?t.push(e.context):t.push("other"),e.volume||0===e.volume?t.push(e.volume):t.push(this.playerAdapter&&this.playerAdapter.getVolume()),e.position||0===e.position?t.push(e.position):t.push(this.playerAdapter&&this.playerAdapter.getProgressInSeconds()),e.shuffle?t.push(e.shuffle?1:0):t.push(0),e.repeat?t.push(e.repeat):t.push(0),e.listened?t.push(Math.max(e.listened,0)):t.push(0),e.playlistId?t.push(e.playlistId):t.push(""),e.targetOwnerId?t.push(e.targetOwnerId):t.push(0),this.uniqueUserId?t.push(this.uniqueUserId):t.push(""),e.positionTo?t.push(e.positionTo):t.push(null),t}sendEvent(e){this.debug&&(console.log("[audio stats event]",e.type,e.subtype,e),window._statForTest||(window._statForTest=[]),window._statForTest.push(e)),(0,a.statlogsValueEvent)("audio_sts",...this.serializeEvent(e))}sendCurrentAudioEvent(e){if(!this.playerAdapter)return;const t=this.playerAdapter.isRepeatCurrentAudio()?1:this.playerAdapter.isRepeatAll()?2:0;this.sendEvent({shuffle:this.playerAdapter.isShuffledPlaylist(),repeat:t,volume:this.playerAdapter.getVolume(),position:this.playerAdapter.getProgressInSeconds(),listened:this.getListenedTime(),playlistId:this.playerAdapter.getPlaylistId(),...this.getEnvParams(),...this.getCurrentAudioParams(),...e})}sendAudioEvent(e){const t={...e,...this.getEnvParams()};!window.vk.id&&this.uniqueUserId&&(t.uniqueUnauthId=this.uniqueUserId),this.sendEvent(t)}destroy(){this.playerAdapter.events.off("play",this.handlePlay).off("pause",this.handlePause).off("stop",this.handlePause).off("progress",this.handleProgress).off("volume",this.handleVolume).off("seekLegacy",this.handleSeek).off("playlistChanged",this.handlePlaylistChanged).off("ended",this.handleEnded).off("playNext",this.handlePlayNext).off("adCompleted",this.handleAdCompleted),this.stopListenOnBeforeUnload(),this.listenedData=null,null!==this.sendTimeout&&clearTimeout(this.sendTimeout)}constructor(e){if(this.handlePlay=()=>{if(!this.playerAdapter)return;if(this.playerAdapter.isRadio()&&!this.playerAdapter.isMarusiaTrack())return void this.onRadioOn(this.playerAdapter.getAudio());if(this.playerAdapter.isMarusiaTrack())return void _.marusiaAudioStats.onPlay(this.playerAdapter);if(!this.canOperate())return;const e=this.playerAdapter.getAudio();if(!e)return;const t=e.fullId,o=this.currentAudioId===t||!this.currentAudioId,i=this.currentAudioId!==this.pausedAudioId;let s=this.playerAdapter.getListenedTime();!o&&i&&this.onTrackSwitch(this.currentAudio,this.currentPlaylistId),this.playedTime=Date.now(),this.currentAudioId=t,this.currentAudio=e,this.currentAudioTrackCode=this.playerAdapter.getAudioTrackCode(),this.currentPlaylistId=this.playerAdapter.getPlaylistId(),this.wasEnded||this.playerAdapter.hasPrevAudio()&&(!this.pausedAudioId||this.playerAdapter.isAutoPlayed())?(this.currentPosition=0,s=0):this.currentPosition=this.playerAdapter.getProgressInSeconds(),this.currentListened=s,this.sendCurrentAudioEvent({type:f,subtype:this.getPlaySubtype(),position:this.currentPosition,listened:s}),this.pausedAudioId=null,this.playlistChanged=!1,this.wasEnded=!1,this.listenOnBeforeUnload()},this.handlePause=()=>{if(!this.playerAdapter)return;if(this.playerAdapter.isRadio()&&!this.playerAdapter.isMarusiaTrack())return void this.onRadioOff(this.playerAdapter.getAudio());if(this.playerAdapter.isMarusiaTrack())return void _.marusiaAudioStats.onPause(this.playerAdapter);const e=this.playerAdapter.getAudioId();if(!this.canOperate()||!e)return;const t=this.collectListenedData();this.sendListenedDataDelayed(1e3,t),setTimeout((()=>{if(this.currentAudio&&e!==this.currentAudio.fullId)return;if(Date.now()-this.playedTime<150)return;if(!this.playerAdapter)return;this.pausedAudioId=e;const t=this.playerAdapter.getPausedBy();this.sendCurrentAudioEvent({type:E,subtype:t?t===k?k:C:L})}),100),this.stopListenOnBeforeUnload()},this.handleProgress=()=>{this.playerAdapter&&(this.playerAdapter.getProgress()<.01||!this.playerAdapter.isPlaying()||(this.currentPosition=this.playerAdapter.getProgressInSeconds(),this.currentListened=this.playerAdapter.getListenedTime(),!this.pausedAudioId&&Date.now()-this.playedTime>150&&this.collectListenedData(),this.adsCompleted&&(this.sendCurrentAudioEvent({type:f,subtype:this.getPlaySubtype(),position:this.currentPosition}),this.adsCompleted=!1)))},this.handleVolume=(0,s.debounce)((()=>{this.canOperate()&&this.sendCurrentAudioEvent({type:g,subtype:P})}),300),this.handleSeek=()=>{if(!this.canOperate()||!this.playerAdapter)return;const e={position:this.currentPosition,positionTo:this.playerAdapter.getProgressInSeconds()};e.position!==e.positionTo&&this.sendCurrentAudioEvent({type:v,subtype:P,...e})},this.handlePlaylistChanged=()=>{this.canOperate()&&(this.playlistChanged=!0)},this.handleEnded=()=>{this.listenedData&&this.playerAdapter.isLastTrack()&&(this.listenedData.end_stream_reason=W),this.wasEnded=!0,this.playerAdapter.isRepeatCurrentAudio()?(this.sendCurrentAudioEvent({type:E,subtype:O}),this.collectListenedData(),this.sendListenedData()):this.sendListenedDataDelayed(150)},this.handlePlayNext=({audioFullId:e})=>{if(!this.canOperate()||!e)return;const[t,o]=e.split("_");this.sendAudioEvent({type:A,subtype:P,ownerId:Number(t),audioId:Number(o)})},this.handleAdCompleted=()=>{this.adsCompleted=!0},this.handleBroadcastStatusToggled=({status:e,targetOwnerId:t})=>{this.sendCurrentAudioEvent({type:w,subtype:e?R:x,targetOwnerId:t.toString()})},this.playerAdapter=e,this.listenedData=null,this.sendTimeout=null,this.currentAudioId=null,this.currentAudio=null,this.currentAudioTrackCode=null,this.pausedAudioId=null,this.playlistChanged=!1,this.currentPosition=0,this.currentListened=0,this.playedTime=0,this.adsCompleted=!1,this.wasEnded=!1,window.vk.id)this.uniqueUserId=null;else{const e=r.ls.get(H);e?this.uniqueUserId=e:(this.uniqueUserId=(0,n.default)(),r.ls.set(H,this.uniqueUserId))}this.debug=e.isDebug(),this.playerAdapter.events.on("play",this.handlePlay).on("pause",this.handlePause).on("stop",this.handlePause).on("progress",this.handleProgress).on("volume",this.handleVolume).on("seekLegacy",this.handleSeek).on("playlistChanged",this.handlePlaylistChanged).on("ended",this.handleEnded).on("playNext",this.handlePlayNext).on("adCompleted",this.handleAdCompleted).on("broadcastStatusToggled",this.handleBroadcastStatusToggled),this.onPageClose=this.onPageClose.bind(this),this.productionStatCollector=new u.ProductionStatCollector,this.actionStatCollector=new u.ActionStatCollector(this.productionStatCollector)}}},769981:(e,t,o)=>{"use strict";o.d(t,{AudioStatsPlayerAdapter:()=>r,FULL_SCREEN_STATE:()=>n,UNKNOWN_STATE:()=>a});var i=o(514640),s=o(122611);const a=0,n=2;class r{destory(){this.unlistenPlayer()}get events(){return this.emitter.listenable}getPausedBy(){return null}getState(){return document.hidden?1:3}getProgress(){return this.player.playerGetProgress()}getProgressInSeconds(){return this.player.getProgressInSeconds()}getVolume(){return this.player.getVolume()}getAudioId(){return this.player.getAudioId()}getAudio(){return this.player.getAudio()}getAudioTrackCode(){return this.player.getAudioTrackCode()}getPrevAudioId(){return this.player.getPrevAudioId()}getPrevPlaylistId(){return this.player.getPrevPlaylistId()}getPlaylistId(){return this.player.getPlaylistId()}getContext(){return this.player.getContext()}getSequence(){return this.player.getSequence()}getType(){return this.player.getType()}getListenedTime(){return isNaN(this.player.getListenedTime())?0:Math.round(this.player.getListenedTime())}getSearchParams(){return this.player.getSearchParams()}isPlaying(){return this.player.isPlaying()}isPaused(){return this.player.isPaused()}isAutoPlayed(){return this.player.isAutoPlayed()}isRepeatCurrentAudio(){return this.player.isRepeatCurrentAudio()}isRepeatAll(){return this.player.isRepeatAll()}isShuffledPlaylist(){return this.player.isShuffledPlaylist()}isRealPlaylist(){return this.player.isRealPlaylist()}isRealPrevPlaylist(){return this.player.isRealPrevPlaylist()}isPodcast(){return this.player.isPodcast()}isExternalStream(){return this.player.isExternalStream()}isRadio(){return this.player.isRadio()}isMarusiaTrack(){return this.player.isMarusiaTrack()}isAdPlaying(){return this.player.ads.isActive}isLastTrack(){return this.player.isLastTrack()}getTrackPosition(){return this.player.getTrackPosition()}hasPrevAudio(){return this.player.hasPrevAudio()}hasPrevPlaylist(){return this.player.hasPrevPlaylist()}hasPlaylist(){return this.player.hasPlaylist()}hasSearchParams(){return this.player.hasSearchParams()}isDebug(){return!1}sendListenedData(e){return this.player.sendListenedData(e)}getPlaylistQueue(){return null}getCurrentAudio(){return this.player.getCurrentAudioData()}getPlayingAudio(){return this.isPlaying()||this.isPaused()?this.getCurrentAudio():null}listenPlayer(){this.player.subscribe(i.AudioPlayerEventType.PLAY,this.handlePlayerPlay),this.player.subscribe(i.AudioPlayerEventType.PAUSE,this.handlePlayerPause),this.player.subscribe(i.AudioPlayerEventType.STOP,this.handlePlayerStop),this.player.subscribe(i.AudioPlayerEventType.PROGRESS,this.handlePlayerProgress),this.player.subscribe(i.AudioPlayerEventType.VOLUME,this.handlePlayerVolume),this.player.subscribe(i.AudioPlayerEventType.SEEK,this.handlePlayerSeekLegacy),this.player.subscribe(i.AudioPlayerEventType.PLAYLIST_CHANGED,this.handlePlayerPlaylistChanged),this.player.subscribe(i.AudioPlayerEventType.ENDED,this.handlePlayerEnded),this.player.subscribe(i.AudioPlayerEventType.PLAY_NEXT,this.handlePlayerPlayNext),this.player.subscribe(i.AudioPlayerEventType.AD_COMPLETED,this.handlePlayerAdCompleted);const e=this.player.nextEvents;e?.on&&(e.on("playAudio",this.handlePlayerPlayMarked),e.on("pauseAudio",this.handlePlayerPauseMarked),e.on("stopAudio",this.handlePlayerStopMarked),e.on("playAdv",this.handlePlayerPlayAdv),e.on("pauseAdv",this.handlePlayerPauseAdv),e.on("stopAdv",this.handlePlayerStopAdv),e.on("seek",this.handlePlayerSeek),e.on("stateRestore",this.handlePlayerStateRestore),e.on("broadcastStatusToggled",this.handlePlayerBroadcastStatusToggled))}unlistenPlayer(){this.player.unsubscribe(i.AudioPlayerEventType.PLAY,this.handlePlayerPlay),this.player.unsubscribe(i.AudioPlayerEventType.PAUSE,this.handlePlayerPause),this.player.unsubscribe(i.AudioPlayerEventType.STOP,this.handlePlayerStop),this.player.unsubscribe(i.AudioPlayerEventType.PROGRESS,this.handlePlayerProgress),this.player.unsubscribe(i.AudioPlayerEventType.VOLUME,this.handlePlayerVolume),this.player.unsubscribe(i.AudioPlayerEventType.SEEK,this.handlePlayerSeekLegacy),this.player.unsubscribe(i.AudioPlayerEventType.PLAYLIST_CHANGED,this.handlePlayerPlaylistChanged),this.player.unsubscribe(i.AudioPlayerEventType.ENDED,this.handlePlayerEnded),this.player.unsubscribe(i.AudioPlayerEventType.PLAY_NEXT,this.handlePlayerPlayNext),this.player.unsubscribe(i.AudioPlayerEventType.AD_COMPLETED,this.handlePlayerAdCompleted);const e=this.player.nextEvents;e?.off&&(e.off("playAudio",this.handlePlayerPlayMarked),e.off("pauseAudio",this.handlePlayerPauseMarked),e.off("stopAudio",this.handlePlayerStopMarked),e.off("playAdv",this.handlePlayerPlayAdv),e.off("pauseAdv",this.handlePlayerPauseAdv),e.off("stopAdv",this.handlePlayerStopAdv),e.off("seek",this.handlePlayerSeek),e.off("stateRestore",this.handlePlayerStateRestore))}constructor(e,t){this.emitterFactory=t,this.emitter=this.emitterFactory.create(),this.handlePlayerPlay=()=>{this.emitter.emit("play")},this.handlePlayerPlayMarked=e=>{const{audio:t,reason:o,progressTime:i}=e;c(t),function(e){if(!_.includes(e))throw new Error(`Invalid play reason: ${e}`)}(o),p(i),this.emitter.emit("playAudio",{audio:t,reason:o,progressTime:i})},this.handlePlayerPause=()=>{this.emitter.emit("pause")},this.handlePlayerPauseMarked=e=>{const{audio:t,reason:o,progressTime:i}=e;c(t),function(e){if(!u.includes(e))throw new Error(`Invalid pause reason: ${e}`)}(o),p(i),this.emitter.emit("pauseAudio",{audio:t,reason:o,progressTime:i})},this.handlePlayerStop=()=>{this.emitter.emit("stop")},this.handlePlayerStopMarked=e=>{const{audio:t,reason:o,progressTime:i}=e;c(t),function(e){if(!d.includes(e))throw new Error(`Invalid stop reason: ${e}`)}(o),p(i),this.emitter.emit("stopAudio",{audio:t,reason:o,progressTime:i})},this.handlePlayerProgress=()=>{this.emitter.emit("progress")},this.handlePlayerVolume=()=>{this.emitter.emit("volume")},this.handlePlayerSeekLegacy=()=>{this.emitter.emit("seekLegacy")},this.handlePlayerSeek=e=>{const{audio:t,reason:o,progressTime:i,fromTime:s}=e;c(t),function(e){if(!l.includes(e))throw new Error(`Invalid seek reason: ${e}`)}(o),p(i),p(s),this.emitter.emit("seek",{audio:t,reason:o,progressTime:i,fromTime:s})},this.handlePlayerPlaylistChanged=()=>{this.emitter.emit("playlistChanged")},this.handlePlayerEnded=()=>{this.emitter.emit("ended")},this.handlePlayerPlayNext=(e,t)=>{this.emitter.emit("playNext",{currentAudio:e,audioFullId:t})},this.handlePlayerAdCompleted=()=>{this.emitter.emit("adCompleted")},this.handlePlayerPlayAdv=e=>{this.emitter.emit("playAdv",e)},this.handlePlayerPauseAdv=e=>{this.emitter.emit("pauseAdv",e)},this.handlePlayerStopAdv=e=>{this.emitter.emit("stopAdv",e)},this.handlePlayerStateRestore=e=>{const{audio:t,progressTime:o}=e;t&&c(t),p(o),this.emitter.emit("stateRestore",{audio:t,progressTime:o})},this.handlePlayerBroadcastStatusToggled=e=>{this.emitter.emit("broadcastStatusToggled",e)},this.player=e,this.listenPlayer()}}const _=Object.values(s.AudioPlayerPlayAudioEventReason),u=Object.values(s.AudioPlayerPauseAudioEventReason),d=Object.values(s.AudioPlayerStopAudioEventReason),l=Object.values(s.AudioPlayerSeekEventReason);function c(e){if(!e||"object"!=typeof e)throw new Error(`Invalid TrackedAudioData: ${e}`);if(!Number.isFinite(e.id))throw new Error(`Invalid TrackedAudioData (id is not finite): ${e.id}`);if(!Number.isFinite(e.ownerId))throw new Error(`Invalid TrackedAudioData (ownerId is not finite): ${e.ownerId}`);if("string"!=typeof e.trackCode)throw new Error("Invalid TrackedAudioData (trackCode is not string): "+typeof e.trackCode)}function p(e){if("number"!=typeof e)throw new Error(`Value is not number (given: ${typeof e})`)}},888610:(e,t,o)=>{"use strict";o.d(t,{AudioStatsPlayerAdapter:()=>i.AudioStatsPlayerAdapter,FULL_SCREEN_STATE:()=>i.FULL_SCREEN_STATE,UNKNOWN_STATE:()=>i.UNKNOWN_STATE});var i=o(769981)},625330:(e,t,o)=>{"use strict";o.d(t,{AudioTaskManager:()=>a,TaskName:()=>i});var i,s=o(836901);!function(e){e.URL="url",e.PLAYBACK_RATE="playback_rate",e.DELAY="delay",e.SEEK="seek",e.PAUSE="pause",e.PLAY="play",e.VOL_SET="vol_set",e.VOL_UP="vol_up",e.VOL_DOWN="vol_down"}(i||(i={}));class a{newTask(e,t){let o,i;const s=new Promise(((e,t)=>{o=e,i=t}));return this.tasks.push({name:e,fn:()=>t().then(o).catch(i),id:`${e}_${this.taskIDCounter++}`}),this.doTasks(),s}clearAllTasks(){this.taskAbort=this.taskInProgress,this.taskInProgress=null,this.tasks=[]}clearTask(e){this.tasks=this.tasks||[],this.tasks=this.tasks.filter((t=>t.name!==e))}doTasks(){if(this.taskInProgress)return;const e=this.tasks.shift();e&&(this.taskInProgress=e.id,this.ensureImplReady().then((()=>e.fn())).then((()=>{this.taskAbort!==e.id?(this.taskInProgress=null,this.doTasks()):this.taskAbort=null})))}ensureImplReady(){return new Promise((e=>this.impl.onReady(e)))}delay(e){return this.newTask("delay",(()=>new Promise((t=>(0,s.setWorkerTimeout)(t,e)))))}setUrl(e){return this.newTask("url",(()=>new Promise((t=>this.impl.setUrl(e,t)))))}seekImmediate(e){this.impl.seek(e)}seek(e){return this.clearTask("seek"),this.newTask("seek",(()=>new Promise((t=>{this.seekImmediate(e),t()}))))}pause(){return this.newTask("pause",(()=>new Promise((e=>{this.impl.pause(),e()}))))}play(){return window.browser.safari&&this.impl.play(),this.newTask("play",(()=>new Promise(((e,t)=>{this.impl.play().then(e).catch(t)}))))}setVolume(e,t,o=null){if(t){const t=e?"vol_up":"vol_down";return this.newTask(t,(()=>new Promise((t=>this.impl.fadeVolume(e,o,(()=>t()))))))}return this.newTask("vol_set",(()=>new Promise((t=>{this.impl.setVolume(e),t()}))))}updatePlaybackRate(e){return this.newTask("playback_rate",(()=>new Promise((t=>{this.impl.setPlaybackRate(e),t()}))))}constructor(e){this.impl=e,this.taskIDCounter=1,this.tasks=[],this.taskInProgress=null,this.taskAbort=null}}},78362:(e,t,o)=>{"use strict";o.d(t,{AutoplayQueue:()=>u});var i=o(8520),s=o(59052),a=o(514640),n=o(365224),r=o(486848),_=o(712982);class u{get list(){return this._list}get length(){return this._list.length}get enabled(){return this.service.$enabled.getState()}hasSource(e){const t=(0,_.clearObject)({...e,offset:void 0});return this.sources.some((e=>(0,i.isEqual)(t,(0,_.clearObject)({...e,offset:void 0}))))}setSource(e){this.hasSource(e)||(this.sources=[(0,_.clearObject)(e)],this.nextFrom=null,this._list=[],this.hasMore=!0,this.fetchNextAudios())}async fetchNextAudios(){try{const e=this.nextFrom??this.sources[0];if(!e)return[];const t=await this.fetchService.getAutoplayAudioIdsBySource(e);if(!t)return[];const{next_from:o,audios:i}=t;if(this.nextFrom=o,this.hasSource(o)||this.sources.push(o),!i||!i.length)return this.hasMore=!1,[];const a=i.map((e=>e.audio_raw_id)).join(","),r=await this.fetchService.reloadAudios(a),_=this.getCurrentQueueAudioIds(),u=r.map(((e,t)=>(e[s.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_ACCESS_KEY]=i[t]?.access_key||"",e[s.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_TRACK_CODE]=i[t]?.track_code||"",e[s.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_CONTEXT]="autoplay",e))).filter((e=>!_.some((t=>t.includes((0,n.getAudioFullId)(e))))));return this._list.push(...u),u}catch(e){console.log(e)}}async getNextAudios(e=0){const t=Math.min(e+10,this._list.length);if(e>this._list.length-1){const t=await this.fetchNextAudios();return t&&t.length>0?this.getNextAudios(e):[]}return this._list.slice(e,t)}getAudioById(e){return this._list.find((t=>e.includes((0,n.getAudioFullId)(t))))}indexOf(e){const t=(0,n.getAudioFullId)(e);return this._list.findIndex((e=>(0,n.getAudioFullId)(e)===t))}spliceHead(e){return this._list.splice(0,e+1)}clean(){this._list=[],this.sources=[],this.nextFrom=null,this.hasMore=!1,this.eventBus.emit(a.AudioPlayerEventType.CLEAN_AUTOPLAY_QUEUE)}constructor(e,t,o){this._list=[],this.sources=[],this.nextFrom=null,this.service=(0,r.ensureAutoplayService)(),this.hasMore=!0,this.fetchService=e,this.getCurrentQueueAudioIds=o,this.eventBus=t,this.service.init()}}},561418:(e,t,o)=>{"use strict";o.d(t,{EventBus:()=>i});class i{subscribe(e,t){return Array.isArray(e)&&e.forEach((e=>this.subscribe(e,t))),this.subscriptions[e]||(this.subscriptions[e]=[]),this.subscriptions[e].push(t),{unsubscribe:()=>this.unsubscribe(e,t)}}unsubscribe(e,t){if(this.subscriptions[e]){const o=this.subscriptions[e].indexOf(t);o>=0&&this.subscriptions[e].splice(o,1)}}emit(e,...t){this.precheck&&!this.precheck(e,...t)||(this.onAnyCallBack&&setTimeout((()=>this.onAnyCallBack(e,...t))),this.subscriptions[e]&&this.subscriptions[e].forEach((e=>setTimeout((()=>e(...t))))))}constructor(){this.subscriptions={}}}},522766:(e,t,o)=>{"use strict";var i,s;o.d(t,{PlaylistSourceType:()=>i,isAutoplayEnabledForPlaylist:()=>n}),function(e){e.CATALOG="catalog",e.MESSAGE="im",e.FEED="feed",e.WALL="wall",e.ALBUM="album",e.CURATOR="curator",e.PLAYLIST="playlist",e.VKMIX="vkmix",e.PODCAST="podcast"}(i||(i={})),function(e){e.TYPE_CURRENT="current",e.TYPE_PLAYLIST="playlist",e.TYPE_MY="my",e.TYPE_ALBUM="album",e.TYPE_TEMP="temp",e.TYPE_RECOM="recoms",e.TYPE_SEARCH="search",e.TYPE_LIVE="live",e.TYPE_WALL="wall",e.TYPE_RECENT="recent",e.TYPE_RADIO="radio",e.TYPE_ARTICLE_TTS="article_tts",e.TYPE_VKMIX="vkmix"}(s||(s={}));const a=["radio","article_tts"],n=e=>!a.includes(e.getType())},260007:(e,t,o)=>{"use strict";o.d(t,{PlaylistQueue:()=>S});var i=o(327813),s=o(8520),a=o(476726),n=o(7144),r=o(57599),_=o(59052),u=o(735477),d=o(78362),l=o(514640),c=o(522766),p=o(632371),m=o(213347),h=o(805854),y=o(705744),f=o(365224),E=o(668592),g=o(746964),v=o(470297);const{AUDIO_ITEM_INDEX_OWNER_ID:A,AUDIO_ITEM_INDEX_TRACK_CODE:w,AUDIO_ITEM_INDEX_ID:b,AUDIO_QUEUE_MAX_AUDIOS_COUNT:P,AUDIO_ITEM_INDEX_URL:T,AUDIO_ITEM_INDEX_TITLE:I,AUDIO_ITEM_INDEX_PERFORMER:O,AUDIO_ITEM_INDEX_EXTRA:C,AUDIO_ITEM_ACCESS_KEY:M,AUDIO_ITEM_INDEX_CONTEXT:D}=_.AUDIO_PLAYER_ENUMS;class S{get isAutoplayEnabled(){return this._autoplayQueue?.enabled??!1}get list(){return this._list}get shuffled(){return this._shuffled}get eventBus(){return this._eventBus}get source(){return this._source}get autoplayQueue(){return this.isAutoplaySupported?this._autoplayQueue:null}setSortedQueue(e,t){Array.isArray(e)&&(this._shuffled=!1,this._list=[],this.originalList=[],this.addToList(e),t&&this.setSource(t))}async setSortedQueueByPlaylist(e){return this.clean(),this.addPlaylist(e)}setSource(e){this._source=e}setAutoplaySourceFromPlaylist(e){if(!this.isAutoplaySupported)return;const t=(0,p.getPlaylistRawSource)(e),o=(0,h.getAutoplayPlaylistSource)(t);this.setAutoplaySource(o)}setAutoplaySource(e){this._autoplayQueue?.setSource({...e,offset:0})}getAudioIds(e){return"string"==typeof e?e.split("_"):"object"!=typeof e||Array.isArray(e)?[e[A],e[b]]:[e.ownerId,e.id]}compareAudiosIds(e,t){return!(!Array.isArray(e)||e.length<2||!t)&&(e[0]==t[A]&&e[1]==t[b])}fetchAudios(e){let t=e;return Array.isArray(t)&&(t=t.join(",")),this.fetchService.reloadAudios(t)}findAndFetchEmptyAudiosFrom(e){const t=[],o=[],i=this._list;let s=e+P;s=s<i.length?s:i.length-1;for(let a=e;a<=s;a++){const e=i[a];if(this.isEmptyAudio(e)&&e){const i=`${e[A]}_${e[b]}_${e[M]}`;t.push(i),o.push(a)}}return t.length<1?Promise.resolve({counter:0,successful:!0}):this.fetchAudios(t).then((e=>{if(e){let s=0;return(0,a.partConfigEnabled)("audio_sync_unmatched_audios")&&(s=this.syncAndRemoveUnmatchedAudios(t,e,i),this.truncateArray(o,s)),o.forEach(((t,o)=>{if(e[o]){const s=(0,E.getAudioExtra)(e[o]);if(s){const a=(0,E.getAudioExtra)(i[t]);if(a){const t=(0,g.mergeAudioExtra)(a,s);t&&(e[o][C]=t)}else e[o][C]=i[t][C]}else e[o][C]=i[t][C];e[o][w]=i[t][w],i[t]=e[o]}})),{counter:s,successful:!0}}return{counter:0,successful:!1}})).catch((()=>({counter:0,successful:!1})))}truncateArray(e,t){return e.length=Math.max(e.length-t,0),e}syncAndRemoveUnmatchedAudios(e,t,o){if(e.length===t.length)return 0;let i=0;const s=t.map((e=>e[b]));return e.forEach((e=>{const t=Number(e.split("_")[1]);if(!s.includes(t)){const[t,s]=e.split("_"),a=o.find((e=>Number(e[b])===Number(s)&&Number(e[A])===Number(t)));a&&(i++,this.removeAudio(a))}})),i}getAudio(e){if(!e)return Promise.resolve(null);let t=null,o=null;const i=this.getAudioIds(e);return this._list.find(((e,s)=>!!this.compareAudiosIds(i,e)&&(o=s,t=e,!0))),t&&null!==o?this.isEmptyAudio(t)?this.findAndFetchEmptyAudiosFrom(o).then((({successful:e})=>e&&null!==o?Promise.resolve(this._list[o]):Promise.resolve(null))).catch((()=>Promise.resolve(null))):Promise.resolve(t):Promise.resolve(null)}async getFirstAudio(e){const t=await this.getAudioAt(0);return t&&e&&(0,u.audioTupleToAudioObject)(t).isClaimed?this.getNextAudio(t,{repeat:!1,ignoreClaimed:e}):t}async getLastAudio(e){const t=this.length-1;if(t<0)return null;const o=await this.getAudioAt(t);return o&&e&&(0,u.audioTupleToAudioObject)(o).isClaimed?this.getPrevAudio(o,{repeat:!1,ignoreClaimed:e}):o}async getPrevAudio(e,t={}){const{ignoreClaimed:o}=t,i=this.indexOfAudio(e);if(i<0)return null;const s=i-1;if(s<0)return t.repeat?this.getLastAudio(o):null;const a=await this.getAudioAt(s);return a&&o&&(0,u.audioTupleToAudioObject)(a).isClaimed?this.getPrevAudio(a,t):a}async getNextAudio(e,t={}){const{autoplayQueue:o}=this,{ignoreClaimed:i}=t,s=this.indexOfAudio(e);if(s<0)return null;const a=s+1;if(a>=this.length){if(t.repeat)return this.getFirstAudio(i);if(o?.enabled){const e=o.list;if(e.length>0)return e[0]}return null}const n=await this.getAudioAt(a);return n&&i&&(0,u.audioTupleToAudioObject)(n).isClaimed?this.getNextAudio(n,t):n}indexOfAudio(e){if(!e)return-1;let t=this.getAudioIds(e);return this._list?this._list.findIndex((e=>this.compareAudiosIds(t,e))):-1}getAudioAt(e){return!Array.isArray(this._list)||this._list.length<=e?Promise.resolve(null):e<0?this.findAndFetchEmptyAudiosFrom(0).then((()=>this._list[0])):this.findAndFetchEmptyAudiosFrom(e).then((()=>this._list[e]))}async getPrevAndNextAudios(e){if(!e)return[null,null];let t=null,o=null;const i=this._list.findIndex((t=>t[w]===e[w]));let s=i-1,a=i+1;if(s>=0&&(t=this._list[s]),a<this._list.length&&(o=this._list[a]),t&&this.isEmptyAudio(t)||o&&this.isEmptyAudio(o))try{await this.findAndFetchEmptyAudiosFrom(s>0?s:i)}catch(e){}return[t,o]}getAudios(e,t){return Number.isInteger(e)&&Number.isInteger(t)?(e<0&&(e=0),e>this._list.length?Promise.resolve(null):(t-e>P&&(t=e+P),t>this._list.length&&(t=this._list.length),this.findAndFetchEmptyAudiosFrom(e).then((({counter:o})=>this._list.slice(e,t+1-o))))):Promise.resolve(null)}removeAudio(e){let t=this.indexOfAudio(e);return t>=0?(this._list.splice(t,1),t):-1}addToList(e,t,o){const i=this._list;let s=e;void 0!==t||o?s.forEach((e=>{const t=this.indexOfAudio(e);t>=0&&i.splice(t,1)})):s=s.filter((e=>-1===this.indexOfAudio(e))),s.forEach((e=>{null===e[C]&&(e[C]="[]"),e[I]=(0,n.clean)((0,n.replaceEntities)(e[I]).replace(/(<em>|<\/em>)/g,"")),e[O]=(0,n.clean)((0,n.replaceEntities)(e[O]).replace(/(<em>|<\/em>)/g,""))})),void 0===t?(this.shuffled&&this.originalList.push(...s),i.push(...s)):(this.shuffled&&this.originalList.push(...s),i.splice(t,0,...s))}addAudio(e,t){this.isArrayOfAudioTuples(e)?this.addToList(e,t):e?.length&&this.addToList([e],t)}isArrayOfAudioTuples(e){return Array.isArray(e)&&Array.isArray(e[0])}addEmptyAudios(e){const t=e.map((e=>{const{audio_raw_id:t,access_key:o,track_code:i}=e,{ownerId:s,id:a}=(0,v.parseRawId)(t),n=[];return n[A]=s,n[b]=a,n[M]=o,n[w]=i,n}));this.addToList(t,void 0,!0)}async addNoConsecutivePlaylist(e,t){const o=(0,p.getPlaylistRawSource)(e),i=(0,m.getPlaylistSource)(o),s=(0,h.getAutoplayPlaylistSource)(o,(0,f.getAudioFullId)(t));return"autoplay"===t[D]||this._autoplayQueue?.hasSource(s)||(this.setSource(i),this.setAutoplaySource(s),this._list=[],this.addToList([t])),!0}async addPlaylist(e){if(this.isAutoplayEnabledForPlaylist=(0,c.isAutoplayEnabledForPlaylist)(e),!this.isAutoplayEnabledForPlaylist){this.clean();const t=e.getAudiosList();return this.addToList(t),this._autoplayQueue?.clean(),!0}const{isAutoplaySupported:t}=this,o=(0,p.getPlaylistRawSource)(e),i=(0,m.getPlaylistSource)(o);if((0,s.isEqual)(i,this._source)){if(t&&this.length){const e=(0,h.getAutoplayPlaylistSource)(o);this.setAutoplaySource(e)}return!0}if(this.setSource(i),i.source===c.PlaylistSourceType.VKMIX){this.clean();const t=e.getAudiosList();return this.addToList(t),this._autoplayQueue?.clean(),!0}if(e.isLive()||e?.isLoadable())return this._autoplayQueue?.clean(),!0;if(t){const t=(0,h.getAutoplayPlaylistSource)(o);if(!this._source)return!1;try{const{audioIds:o}=await this.fetchService.getAudioIdsBySource(i);if(!Array.isArray(o)||0===o.length){const t=e.getAudiosList();return this.addToList(t),!0}return this.addEmptyAudios(o),this.setAutoplaySource(t),!0}catch{return!1}}try{const t=await e.getAudioIds();if(!Array.isArray(t)||0===t.length){const t=e.getAudiosList();return this.addToList(t),!0}return this.addEmptyAudios(t),!0}catch{return!1}}moveAudio(e,t){let o=this._list.splice(e,1);e<t&&(t-=1),this._list.splice(t,0,o[0])}clean(){this._list=[],this.originalList=[],this._shuffled=!1,this._source=null}moveAudioAtFirstPosition(e){let t=this.indexOfAudio(e);-1!==t?(this._list.splice(t,1),this._list.unshift(e)):this._list.unshift(e)}removeSortedList(){this.originalList&&(this._list=[].concat(this.originalList)),this._shuffled=!1}get length(){return this.list.length}isEmpty(){return!this.length}shuffle(e,t){if(!(e&&this.shuffled||!e&&!this.shuffled)){if(e){const[e]=this._list;this.originalList=[...this._list],this._list=function(e){let t=e.length;for(;t>0;){const o=Math.floor(Math.random()*t);t--;const i=e[t];e[t]=e[o],e[o]=i}return e}([...this._list]),!t&&e&&this.moveAudioAtFirstPosition(e),this._shuffled=!0}else this._list=[...this.originalList],this._shuffled=!1;return!0}}resetShuffle(){this.shuffle(!1)}constructor(e,t){if(this._autoplayQueue=null,this.isAutoplaySupported=(0,a.partConfigEnabled)("autoplay_web")&&!(0,y.isMvk)(),this.isEmptyAudio=e=>!(e&&(e[T]||(0,r.isClaimedAudio)(e))),S.instance)return S.instance;if(this.fetchService=e,this._list=[],this.originalList=[],this._source=null,this._shuffled=!1,this._eventBus=t,this.isAutoplaySupported){const o=new d.AutoplayQueue(e,t,(()=>this._list.map(f.getAudioFullId)));this._autoplayQueue=o,this.isAutoplayEnabledForPlaylist=!0,this._eventBus.subscribe(l.AudioPlayerEventType.PLAY_TRACK_FROM_AUTOPLAY,(e=>{const t=o.indexOf(e);if(t>=0){const e=o.spliceHead(t);this.addToList(e)}}))}S.instance=this,(0,a.partConfigEnabled)("audio_mobx")&&(0,i.makeObservable)(this,{_list:i.observable,_shuffled:i.observable,setSortedQueue:i.action,setSortedQueueByPlaylist:i.action,shuffle:i.action,resetShuffle:i.action,clean:i.action,removeAudio:i.action,addPlaylist:i.action,moveAudio:i.action,removeSortedList:i.action})}}},624107:(e,t,o)=>{"use strict";o.d(t,{SpecialProjectController:()=>_});var i,s=o(640434),a=o(587382),n=o(509744);let r;!function(e){e.Opened="opened",e.Closed="closed"}(i||(i={}));class _{static get(){if(!r)throw new Error("SpecialProjectController must be initialized.");return r}static init(e){if(!e)throw new Error("SpecialProjectController must be initialized with showModal.");return r||(r=new _(e),r)}showModal(e,t){this.showCurrentModal&&this.showCurrentModal(t,this.tryToSendCloseReason(e))}constructor(e){this.projects={},this.statCollector=null,this.wasProjectShown=e=>!!this.projects[e],this.tryModal=async(e,t)=>{if(!this.wasProjectShown(e))try{const o=await this.getSpecialProject(e);this.showModal(e,o),this.statCollector?.open(+e,t)}catch(e){}finally{this.projects[e]="opened"}},this.tryToSendCloseReason=e=>t=>{"closed"!==this.projects[e]&&(this.consumeSpecialProject(e,t),this.statCollector?.close(),this.projects[e]="closed")},this.getSpecialProject=async e=>{const t=await(0,s.getSpecialProject)({special_project_id:e});return(0,n.mapSpecialProjectData)(t)},this.consumeSpecialProject=(e,t)=>(0,s.consumeSpecialProject)({special_project_id:e,reason:t}),this.statCollector=new a.SpecialProjectStatCollector,this.showCurrentModal=e}}},587382:(e,t,o)=>{"use strict";o.d(t,{SpecialProjectStatCollector:()=>a});var i=o(695290),s=o(581903);class a{open(e,t){if(this.openedModal)throw new Error("Modal must be closed before opening");this.openedModal={id:e,trackCode:t,startView:this.productCollector.getCurrentTime()}}close(){const{openedModal:e}=this;if(!e)throw new Error("Modal must be open before closing");this.sendView(e),this.openedModal=null}sendView(e){const t={end_view:this.productCollector.getCurrentTime(),start_view:e.startView,type:i.ViewProductionStatEventTypes.TYPE_CATALOG_SPECIAL_PROJECT_ITEM},o={type:i.EventItemType.AUDIO_SPECIAL_PROGECT_MODAL,id:e.id,track_code:e.trackCode};this.viewCollector.logEvent(t,o)}constructor(){this.openedModal=null,this.productCollector=new s.ProductionStatCollector,this.viewCollector=new s.ViewStatCollector(this.productCollector)}}},102629:(e,t,o)=>{"use strict";o.d(t,{SpecialProjectHeader:()=>u});var i=o(474848),s=o(296540),a=o(414698),n=o(8520),r=o(627338);const _=e=>{const[t]=e.filter((e=>!!e&&!!e.url)).map((e=>e.url));return t},u=(0,s.memo)((({style:e,image:t=[],className:o,backgroundImage:s=[]})=>{const u=_(s),d=_(t);return(0,i.jsx)("div",{className:(0,n.classNames)(r.default.root,o,{[r.default.singleImage]:"image"===e}),style:{backgroundImage:`url(${"avatar"===e?u:d})`},children:"avatar"===e&&(0,i.jsx)(a.Avatar,{src:d,size:72})})}))},509744:(e,t,o)=>{"use strict";o.d(t,{mapSpecialProjectData:()=>i});const i=e=>({...e,backgroundImage:e.background_image})},804179:(e,t,o)=>{"use strict";function i(e){const t=e?.options;if(!t)return[];const o=[];for(const e of t)switch(e.type){case"copy":{const{name:t,copyText:i}=e;if(!t||!i)break;const s=()=>{navigator.clipboard.writeText(i)};o.push({type:"action",label:t,action:s});break}case"default":{const{name:t,clickLink:i}=e;if(!t)break;if(i){o.push({type:"link",label:t,href:i});break}break}}return o}o.d(t,{makeChoicesFromAdman:()=>i})},981188:(e,t,o)=>{"use strict";o.d(t,{makeAudioAdFromAdman:()=>s});var i=o(804179);function s(e){return{id:e.banner_id,choices:(0,i.makeChoicesFromAdman)(e.adChoices)}}},542703:(e,t,o)=>{"use strict";function i(e){return new Promise(((t,o)=>{window.ajax.post("al_audio.php",{act:"get_lyrics",aid:e.audio_id},{onDone:t,onFail:e=>(o(e),!0)})}))}o.d(t,{getLyrics:()=>i})},640434:(e,t,o)=>{"use strict";o.d(t,{consumeSpecialProject:()=>a,getSpecialProject:()=>s});var i=o(385608);const s=(0,i.createMethod)("audio.getSpecialProject"),a=(0,i.createMethod)("audio.consumeSpecialProject")},385608:(e,t,o)=>{"use strict";o.d(t,{createMethod:()=>s});var i=o(933052);function s(e){return t=>(0,i.api)(e,t)}},59052:(e,t,o)=>{"use strict";var i,s;o.d(t,{AUDIO_PLAYER_ENUMS:()=>a,AudioPlaylistContext:()=>n,EAudioFlagBit:()=>s,EAudioTupleIndex:()=>i}),function(e){e[e.ID=0]="ID",e[e.OWNER_ID=1]="OWNER_ID",e[e.URL=2]="URL",e[e.TITLE=3]="TITLE",e[e.PERFORMER=4]="PERFORMER",e[e.DURATION=5]="DURATION",e[e.ALBUM_ID=6]="ALBUM_ID",e[e.AUTHOR_LINK=8]="AUTHOR_LINK",e[e.LYRICS=9]="LYRICS",e[e.FLAGS=10]="FLAGS",e[e.CONTEXT=11]="CONTEXT",e[e.EXTRA=12]="EXTRA",e[e.HASHES=13]="HASHES",e[e.COVER_URL=14]="COVER_URL",e[e.ADS=15]="ADS",e[e.SUBTITLE=16]="SUBTITLE",e[e.MAIN_ARTISTS=17]="MAIN_ARTISTS",e[e.FEAT_ARTISTS=18]="FEAT_ARTISTS",e[e.ALBUM=19]="ALBUM",e[e.TRACK_CODE=20]="TRACK_CODE",e[e.RESTRICTION=21]="RESTRICTION",e[e.ALBUM_PART=22]="ALBUM_PART",e[e.IS_NEW_STATS=23]="IS_NEW_STATS",e[e.ACCESS_KEY=24]="ACCESS_KEY",e[e.CHART_INFO=25]="CHART_INFO",e[e.TRACK_PAGE_ID=26]="TRACK_PAGE_ID",e[e.IS_ORIGINAL_SOUND=27]="IS_ORIGINAL_SOUND",e[e.ADMIN_URL=28]="ADMIN_URL",e[e.UMA_QUERY_URL=29]="UMA_QUERY_URL"}(i||(i={})),function(e){e[e.HAS_LYRICS=1]="HAS_LYRICS",e[e.CAN_ADD=2]="CAN_ADD",e[e.CLAIMED=4]="CLAIMED",e[e.QUEUE=8]="QUEUE",e[e.HQ=16]="HQ",e[e.LONG_PERFORMER=32]="LONG_PERFORMER",e[e.UMA=128]="UMA",e[e.REPLACEABLE=512]="REPLACEABLE",e[e.EXPLICIT=1024]="EXPLICIT",e[e.SHOW_INFO=8192]="SHOW_INFO"}(s||(s={}));const a={AUDIO_ITEM_INDEX_ID:0,AUDIO_ITEM_INDEX_OWNER_ID:1,AUDIO_ITEM_INDEX_URL:2,AUDIO_ITEM_INDEX_TITLE:3,AUDIO_ITEM_INDEX_PERFORMER:4,AUDIO_ITEM_INDEX_DURATION:5,AUDIO_ITEM_INDEX_ALBUM_ID:6,AUDIO_ITEM_INDEX_AUTHOR_LINK:8,AUDIO_ITEM_INDEX_LYRICS:9,AUDIO_ITEM_INDEX_FLAGS:10,AUDIO_ITEM_INDEX_CONTEXT:11,AUDIO_ITEM_INDEX_EXTRA:12,AUDIO_ITEM_INDEX_HASHES:13,AUDIO_ITEM_INDEX_COVER_URL:14,AUDIO_ITEM_INDEX_ADS:15,AUDIO_ITEM_INDEX_SUBTITLE:16,AUDIO_ITEM_INDEX_MAIN_ARTISTS:17,AUDIO_ITEM_INDEX_FEAT_ARTISTS:18,AUDIO_ITEM_INDEX_ALBUM:19,AUDIO_ITEM_INDEX_TRACK_CODE:20,AUDIO_ITEM_INDEX_RESTRICTION:21,AUDIO_ITEM_INDEX_ALBUM_PART:22,AUDIO_ITEM_ACCESS_KEY:24,AUDIO_ITEM_CHART_INFO_INDEX:25,AUDIO_ITEM_INDEX_TRACK_PAGE_ID:26,AUDIO_ITEM_INDEX_IS_ORIGINAL_SOUND:27,AUDIO_ITEM_INDEX_ADMIN_URL:28,AUDIO_ITEM_INDEX_UMA_QUERY_URL:29,AUDIO_ITEM_HAS_LYRICS_BIT:1,AUDIO_ITEM_CAN_ADD_BIT:2,AUDIO_ITEM_CLAIMED_BIT:4,AUDIO_ITEM_QUEUE_BIT:8,AUDIO_ITEM_HQ_BIT:16,AUDIO_ITEM_LONG_PERFORMER_BIT:32,AUDIO_ITEM_UMA_BIT:128,AUDIO_ITEM_REPLACEABLE:512,AUDIO_ITEM_EXPLICIT_BIT:1024,AUDIO_ITEM_SHOW_INFO_BIT:8192,AUDIO_ENOUGH_LOCAL_SEARCH_RESULTS:500,AUDIO_RECOMS_TYPE_LISTENED:"recoms6",AUDIO_PLAYING_CLS:"audio_row__playing",AUDIO_CURRENT_CLS:"audio_row__current",AUDIO_DURATION_CLS:"audio_row__duration",AUDIO_LAYER_HEIGHT:550,AUDIO_LAYER_MIN_WIDTH:400,AUDIO_LAYER_MAX_WIDTH:1e3,AUDIO_HQ_LABEL_CLS:"audio_hq_label_show",AUDIO_MAX_AUDIOS_IN_SNIPPET:5,AUDIO_ROW_COVER_SIZE:40,AUDIO_ROW_PLAY_SIZE:24,AUDIO_ROW_ACTION_ROW_ITEM:'<button class="audio_row__more_action audio_row__more_action_%0% _audio_row__more_action_%0% %3%">%2%</button>',AUDIO_QUEUE_MAX_AUDIOS_COUNT:35,LOG_LS_KEY:"audiolog",ONBOARDING_ARTISTS_LS_KEY:"artists_onboarding",AUDIO_RECOMS_ONBOARDING_NEED_SKIP_LS_KEY:"audio_recoms_onboarding_need_skip"};var n;!function(e){e.USER_WALL="user_wall",e.GROUP_WALL="group_wall",e.WALL="wall",e.FEED="feed"}(n||(n={}))},895749:(e,t,o)=>{"use strict";o.d(t,{parseAudioPlaylistIdentityFromHref:()=>i.parseAudioPlaylistIdentityFromHref,setAudioLastListRefCookie:()=>s.setAudioLastListRefCookie,setAudioLastListRefCookieDebounced:()=>s.setAudioLastListRefCookieDebounced});var i=o(618275),s=o(291244)},618275:(e,t,o)=>{"use strict";o.d(t,{parseAudioPlaylistIdentityFromHref:()=>a});var i=o(962954);const s=/\/music\/(playlist|album)\/(-?\d+_\d+)/i;function a(e){if(!e)return;const t=e.match(s);if(!t)return;const{2:o}=t;if(o)try{return i.OwnedIdentity.fromRawId(o)}catch{return}}},291244:(e,t,o)=>{"use strict";o.d(t,{setAudioLastListRefCookie:()=>u,setAudioLastListRefCookieDebounced:()=>d});var i=o(8520),s=o(643010),a=o(772546),n=o(476726);const r="remixaudio_last_list_ref",_=1/24/60;function u({ref:e,list:t}){if(!(0,n.partConfigEnabled)("audio_player_stats_ref_web"))return;const o=JSON.stringify({list_id:(0,s.getIdentityRawId)(t),ref:e});(0,a.setCookie)(r,o,_)}const d=(0,i.debounce)(u,50)},486848:(e,t,o)=>{"use strict";o.d(t,{ensureAutoplayService:()=>r});var i=o(32489),s=o(826316),a=o(476726);let n;function r(){return n||(n=function(){const e=(0,i.createDomain)("audio/autoplay"),t=(0,s.ensureAccountInfoService)(),{$accountInfo:o,setInfoFx:n}=t,r=(0,a.partConfigEnabled)("autoplay_web_toggle"),_=e.createStore(r),u=e.createStore(!1),d=e.createEffect((e=>n({query:{name:"audio_autoplay",value:e}})));return{$toggleSupported:_,$enabled:u,setEnabledFx:d,init:function(){_.on(o,((e,{audio_autoplay:t})=>r&&void 0!==t)),(0,i.sample)({source:{accountInfo:o,toggleSupported:_},fn:({accountInfo:e,toggleSupported:t})=>!t||(e.audio_autoplay??!1),target:u}),t.initEvent()}}}()),n}},812140:(e,t,o)=>{"use strict";o.d(t,{checkIsDownloadedUrl:()=>s});var i=o(493810);function s(e){return(0,i.audioUnmaskSource)(e).includes("blob:http")}},712982:(e,t,o)=>{"use strict";o.d(t,{clearObject:()=>a});var i=o(596034),s=o(269592);function a(e){return(0,i.default)(e,s.default)}},287013:(e,t,o)=>{"use strict";o.d(t,{decodeHTML:()=>a});var i=o(8520);const s={"amp;":"&","#38;":"&","lt;":"<","#60;":"<","gt;":">","#62;":">","apos;":"'","#39;":"'","quot;":'"',"#34;":'"',"copy;":"©"};function a(e){return(0,i.decodeHTMLEntities)(e,s)}},668592:(e,t,o)=>{"use strict";o.d(t,{getAudioExtra:()=>a});var i=o(7144),s=o(59052);function a(e){if(!e)return null;let t;if((0,i.isObject)(e)){t=e.extra}else{t=e[s.EAudioTupleIndex.EXTRA]}if((0,i.isObject)(t))return t;try{return JSON.parse(t||"{}")}catch(e){return null}}},365224:(e,t,o)=>{"use strict";o.d(t,{getAudioFullId:()=>s});var i=o(59052);const s=e=>e[i.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_OWNER_ID]+"_"+e[i.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ID]},805854:(e,t,o)=>{"use strict";o.d(t,{getAutoplayPlaylistSource:()=>i});const i=(e,t="")=>{const{entity_id:o,...i}=e;return{...i,audio_id:t}}},243113:(e,t,o)=>{"use strict";o.d(t,{getCurrentAudio:()=>a});var i=o(735477),s=o(705744);function a(){const e={id:0,ownerId:0};try{return(0,s.isMvk)()?window.audio.getCurrent()||e:(0,i.audioTupleToAudioObject)(window.getAudioPlayer().getCurrentAudio())||e}catch(t){return e}}},632371:(e,t,o)=>{"use strict";o.d(t,{getPlaylistRawSource:()=>s});var i=o(522766);const s=e=>{const t=e.getContext(),o=e.getBlockId(),s=e.getFullId();if(o)return{source:i.PlaylistSourceType.CATALOG,section_id:o,entity_id:o,playlist_id:s};if(e.getType()===i.PlaylistSourceType.CURATOR)return{source:i.PlaylistSourceType.CURATOR,section_id:o,entity_id:o,playlist_id:s};const{sourceType:a,id:n}=(e=>{if(e){const[t,o]=e.split(":");return{sourceType:t,id:o}}return{sourceType:"",id:""}})(t);if(a.includes("wall"))return{source:i.PlaylistSourceType.WALL,entity_id:n,owner_id:n};switch(a){case i.PlaylistSourceType.CATALOG:return{source:i.PlaylistSourceType.CATALOG,section_id:n,entity_id:n,playlist_id:s,block_id:o};case i.PlaylistSourceType.MESSAGE:return{source:i.PlaylistSourceType.MESSAGE,entity_id:`_${n}`};case i.PlaylistSourceType.FEED:return{source:i.PlaylistSourceType.FEED,entity_id:n,owner_id:n};case i.PlaylistSourceType.ALBUM:return{source:i.PlaylistSourceType.ALBUM,entity_id:n};case i.PlaylistSourceType.VKMIX:return{source:i.PlaylistSourceType.VKMIX,entity_id:n};default:return{source:i.PlaylistSourceType.PLAYLIST,entity_id:s,playlist_id:s}}}},213347:(e,t,o)=>{"use strict";o.d(t,{getPlaylistSource:()=>s});var i=o(522766);const s=e=>{let t;return t=e.source===i.PlaylistSourceType.CATALOG&&!1===e.block_id?{source:i.PlaylistSourceType.PLAYLIST,entity_id:e.playlist_id}:{source:e.source||"",entity_id:e.entity_id||""},t}},777725:(e,t,o)=>{"use strict";o.d(t,{getSpecialProjectId:()=>s});var i=o(668592);function s(e){const t=(0,i.getAudioExtra)(e);return t?.specialProjectId??null}},668089:(e,t,o)=>{"use strict";o.d(t,{isArticleTts:()=>s});var i=o(668592);function s(e){const t=(0,i.getAudioExtra)(e);return!!t&&!!t.articleTts}},761396:(e,t,o)=>{"use strict";o.d(t,{isAudioPWAFeature:()=>s});var i=o(476726);function s(){return(0,i.partConfigEnabled)("mvk_music_pwa")}},57599:(e,t,o)=>{"use strict";o.d(t,{isClaimedAudio:()=>a});var i=o(735477),s=o(59052);function a(e){return!!e&&!!((e=(0,i.audioTupleToAudioObject)(e)).flags&s.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_CLAIMED_BIT)}},866953:(e,t,o)=>{"use strict";o.d(t,{isExternalStream:()=>s});var i=o(668592);function s(e){const t=(0,i.getAudioExtra)(e);return!!t&&!!t.externalStream}},339330:(e,t,o)=>{"use strict";o.d(t,{isMarusiaTale:()=>s});var i=o(668592);function s(e){const t=(0,i.getAudioExtra)(e);return!!t&&!!t.marusiaTale}},950911:(e,t,o)=>{"use strict";o.d(t,{isMarusiaTrack:()=>s});var i=o(668592);function s(e){const t=(0,i.getAudioExtra)(e);return!!t&&!!t.voiceAssistant}},391111:(e,t,o)=>{"use strict";o.d(t,{isRadio:()=>s});var i=o(668592);function s(e){const t=(0,i.getAudioExtra)(e);return!!t&&!!t.radio}},746964:(e,t,o)=>{"use strict";function i(e,t){return e&&t?{...e,...t}:null}o.d(t,{mergeAudioExtra:()=>i})},244579:(e,t,o)=>{"use strict";o.d(t,{mergeAudioTupleWithoutContext:()=>s});var i=o(59052);function s(e,t){const o=[...e];return Object.assign(o,t),o[i.EAudioTupleIndex.CONTEXT]=e[i.EAudioTupleIndex.CONTEXT],o}},504952:(e,t,o)=>{"use strict";o.d(t,{AudioLyricsProvider:()=>d});var i=o(678751),s=o(969621),a=o(542703),n=o(651927),r=o(735477),_=o(955107),u=o(271034);class d{get(e){return this.lyrics.get(e)||{status:u.EAudioLyricsStatus.Pending}}listen(e,t){return this.eventEmitter.on(e,t),()=>{this.eventEmitter.off(e,t)}}setLoading(e){const t={status:u.EAudioLyricsStatus.Loading};this.lyrics.set(e,t),this.eventEmitter.emit(e,t)}setLoaded(e,t){const o={status:u.EAudioLyricsStatus.Loaded,data:t};this.lyrics.set(e,o),this.eventEmitter.emit(e,o)}setError(e,t){const o={status:u.EAudioLyricsStatus.Error,errorMessage:t};this.lyrics.set(e,o),this.eventEmitter.emit(e,o)}constructor(){this.lyrics=new Map,this.eventEmitter=new i.default,this.fetch=(0,s.dedupeAsyncCallback)((async e=>{const t=(0,r.audioTupleToAudioObject)(e),{fullId:o,hasLyrics:i}=t;try{const e=this.lyrics.get(o);if(e&&e.status===u.EAudioLyricsStatus.Loaded)return e.data||null;if(!i)return this.setLoaded(o,null),null;this.setLoading(o);const t=await(0,a.getLyrics)({audio_id:o}),s=(0,_.mapLyricsResponse)(t);return this.setLoaded(o,s),s}catch(e){throw this.setError(o,e.message||"unknown"),e}}),(e=>(0,n.getAudioTupleFullId)(e)))}}},955107:(e,t,o)=>{"use strict";o.d(t,{mapLyricsResponse:()=>s});var i=o(287013);function s(e){if(Array.isArray(e))return null;const{credits:t,lyrics:o}=e;if(!o)return null;const{text:s,timestamps:a,ugc:n}=o||{},r={};return a&&(r.karaoke=function(e){return e.map((e=>{const{line:t,...o}=e;return t?{...o,text:(0,i.decodeHTML)(t)}:o}))}(a)),s&&(r.static=s.map((e=>({text:(0,i.decodeHTML)(e)})))),n&&(r.ugc=n.map((e=>({text:(0,i.decodeHTML)(e)})))),r.karaoke?.length||r.static?.length||r.ugc?.length?{lines:r,credits:t&&(0,i.decodeHTML)(t)}:null}},271034:(e,t,o)=>{"use strict";var i;o.d(t,{EAudioLyricsStatus:()=>i}),function(e){e[e.Pending=0]="Pending",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded",e[e.Error=3]="Error"}(i||(i={}))},748690:(e,t,o)=>{"use strict";o.d(t,{audioObjectToApiAudio:()=>a});var i=o(7144),s=o(668592);const a=e=>{if(!e)return null;const{id:t,owner_id:o,ads:a,url:r,title:_,duration:u,subTitle:d,albumId:l,album:c,trackCode:p,restrictionStatus:m,albumPart:h,accessKey:y="",mainArtists:f,featArtists:E,performer:g="",urlHash:v="",chartInfo:A,coverUrl_l:w,coverUrl_p:b}=e,P=(0,s.getAudioExtra)(e);return{access_key:y||v||"",ads:a,artist:(0,i.unclean)(g||""),id:t,owner_id:o,url:r,title:(0,i.unclean)(_),performer:(0,i.unclean)(g),duration:u,album_id:l,subtitle:(0,i.unclean)(d),main_artists:f||void 0,featured_artists:E||void 0,album:c?{owner_id:c[0],id:c[1],access_key:c[2],title:"",thumb:n(w??b)}:void 0,track_code:p,content_restricted:m,album_part_number:h,audio_chart_info:A||void 0,dislike:P?.dislike}};function n(e){const t=e.match(/size=(\d+)x(\d+)/);if(t){const o=parseInt(t[1],10);return{width:o,height:parseInt(t[2],10),[`photo_${o}`]:e}}}},735477:(e,t,o)=>{"use strict";o.d(t,{audioTupleToAudioObject:()=>d});var i=o(7144),s=o(59052),a=o(694581),n=o(651927),r=o(476726),_=o(391111);const u=Symbol("audioObjectSymbol");function d(e){if(!e)return null;if("string"==typeof e)return{id:e};if(!Array.isArray(e))return e.__audioObject!==u&&console.warn("audioTupleToAudioObject get audio object that not marked as audioObjectSymbol",{audio:e}),e;const t=e[s.EAudioTupleIndex.FLAGS],o=(e[s.EAudioTupleIndex.HASHES]||"").split("/"),d=(e[s.EAudioTupleIndex.COVER_URL]||"").split(/(,(?!\d))/g).filter((e=>","!==e));return d.length<2&&(0,_.isRadio)(e)&&d.push(e[s.EAudioTupleIndex.COVER_URL],e[s.EAudioTupleIndex.COVER_URL]),{id:(0,i.intval)(e[s.EAudioTupleIndex.ID]),owner_id:(0,i.intval)(e[s.EAudioTupleIndex.OWNER_ID]),ownerId:(0,i.intval)(e[s.EAudioTupleIndex.OWNER_ID]),fullId:(0,n.getAudioTupleFullId)(e),title:e[s.EAudioTupleIndex.TITLE]||"",subTitle:e[s.EAudioTupleIndex.SUBTITLE],performer:(0,a.getAudioPerformers)(e,!1),mainArtists:e[s.EAudioTupleIndex.MAIN_ARTISTS],featArtists:e[s.EAudioTupleIndex.FEAT_ARTISTS],authorLink:e[s.EAudioTupleIndex.AUTHOR_LINK],duration:(0,i.intval)(e[s.EAudioTupleIndex.DURATION]),lyrics:e[s.EAudioTupleIndex.LYRICS],url:e[s.EAudioTupleIndex.URL],context:e[s.EAudioTupleIndex.CONTEXT],extra:e[s.EAudioTupleIndex.EXTRA],accessKey:e[s.EAudioTupleIndex.ACCESS_KEY],addHash:o[0]||"",editHash:o[1]||"",actionHash:o[2]||"",deleteHash:o[3]||"",replaceHash:o[4]||"",urlHash:o[5]||"",restoreHash:o[6]||"",canEdit:!!o[1],canDelete:o[3]===e[s.EAudioTupleIndex.ACCESS_KEY]?window.vk.id===e[s.EAudioTupleIndex.OWNER_ID]:Boolean(o[3]),flags:t,isOriginalSound:e[s.EAudioTupleIndex.IS_ORIGINAL_SOUND],hasLyrics:!!(t&s.EAudioFlagBit.HAS_LYRICS),isLongPerformer:!!(t&s.EAudioFlagBit.LONG_PERFORMER),isClaimed:!!(t&s.EAudioFlagBit.CLAIMED),isFromQueue:!!(t&s.EAudioFlagBit.QUEUE),isExplicit:!!(t&s.EAudioFlagBit.EXPLICIT),isUMA:!!(t&s.EAudioFlagBit.UMA),isReplaceable:!!(t&s.EAudioFlagBit.REPLACEABLE),canAdd:!!(t&s.EAudioFlagBit.CAN_ADD),showInfo:!!(t&s.EAudioFlagBit.SHOW_INFO),coverUrl_s:(0,r.partConfigEnabled)("audio_longtap_web")?d[1]:d[0],coverUrl_p:d[1],coverUrl_l:d[0],hasTrackPage:!!e[s.EAudioTupleIndex.TRACK_PAGE_ID],trackPageId:e[s.EAudioTupleIndex.TRACK_PAGE_ID],ads:e[s.EAudioTupleIndex.ADS],album:e[s.EAudioTupleIndex.ALBUM],albumId:(0,i.intval)(e[s.EAudioTupleIndex.ALBUM_ID]),albumPart:(0,i.intval)(e[s.EAudioTupleIndex.ALBUM_PART]),trackCode:e[s.EAudioTupleIndex.TRACK_CODE],restrictionStatus:e[s.EAudioTupleIndex.RESTRICTION],chartInfo:e[s.EAudioTupleIndex.CHART_INFO],adminUrl:e[s.EAudioTupleIndex.ADMIN_URL]||"",umaQueryUrl:e[s.EAudioTupleIndex.UMA_QUERY_URL]||"",__audioObject:u}}},651927:(e,t,o)=>{"use strict";o.d(t,{getAudioTupleFullId:()=>s});var i=o(59052);function s(e){return`${e[i.EAudioTupleIndex.OWNER_ID]}_${e[i.EAudioTupleIndex.ID]}`}},188143:(e,t,o)=>{"use strict";o.d(t,{toSnippetAudioData:()=>i.toSnippetAudioData,toTrackedAudioData:()=>i.toTrackedAudioData});var i=o(373890);o(190228)},373890:(e,t,o)=>{"use strict";o.d(t,{toSnippetAudioData:()=>r,toTrackedAudioData:()=>n});var i=o(264544),s=o(735477),a=o(668592);function n(e){if(!e||"object"!=typeof e)return;const t=Array.isArray(e)?(0,s.audioTupleToAudioObject)(e):e;return t?function(e){const t=e.extra??"{}",o="string"==typeof t?JSON.parse(t):t,s={id:e.id,ownerId:e.ownerId,accessKey:e.accessKey};let n={...s,identity:s,title:e.title,author:{raw:e.performer,main:[],feat:[]},url:e.url,duration:e.duration,isExplicit:e.isExplicit,trackCode:e.trackCode??"",artwork:[]};if(o.podcast)return{...n,type:i.AudioType.PodcastEpisode,podcastId:n.ownerId};if(o.radio)return{...n,type:i.AudioType.Radio};return{...n,type:i.AudioType.MusicTrack,hasLyrics:e.hasLyrics??!1,disliked:(0,a.getAudioExtra)(e)?.dislike??!1}}(t):void 0}function r(e,t){if(e&&"object"==typeof e)return{...e,artwork:[...e.artwork],id:e.identity.id,ownerId:e.identity.ownerId,author:e.authors,hasLyrics:e.hasLyrics,trackCode:t??"",disliked:!1}}},190228:(e,t,o)=>{"use strict";o(441914),o(59052)},398128:(e,t,o)=>{"use strict";o.d(t,{QueueListener:()=>i});class i{constructor(e){this.queueHandler=e}}},311006:(e,t,o)=>{"use strict";var i,s,a,n;o.d(t,{AudioPlayerPauseAudioEventReason:()=>s,AudioPlayerPlayAudioEventReason:()=>i,AudioPlayerSeekEventReason:()=>n,AudioPlayerStopAudioEventReason:()=>a}),function(e){e.PlayButton="PLAY_BUTTON",e.NextButton="NEXT_BUTTON",e.PrevButton="PREV_BUTTON",e.NextMediaSession="NEXT_MEDIA_SESSION",e.PrevMediaSession="PREV_MEDIA_SESSION",e.MixAndPlayButton="MIX_AND_PLAY_BUTTON",e.ListButton="LIST_BUTTON",e.AudioButton="AUDIO_BUTTON",e.QueueContinuation="QUEUE_CONTINUATION",e.QueueContinuationAfterError="QUEUE_CONTINUATION_AFTER_ERROR",e.Autoplay="AUTOPLAY",e.Repeat="REPEAT",e.Voice="VOICE",e.NextVoice="NEXT_VOICE",e.PrevVoice="PREV_VOICE",e.ChannelAutoResume="CHANNEL_AUTO_RESUME",e.Unknown="UNKNOWN"}(i||(i={})),function(e){e.PauseButton="PAUSE_BUTTON",e.MediaSession="MEDIA_SESSION",e.ChannelAutoPause="CHANNEL_AUTO_PAUSE",e.Voice="VOICE",e.Paywall="PAYWALL",e.Unknown="UNKNOWN"}(s||(s={})),function(e){e.NextButton="NEXT_BUTTON",e.PrevButton="PREV_BUTTON",e.QueueContinuation="QUEUE_CONTINUATION",e.Adv="ADV",e.Repeat="REPEAT",e.ChangeQueue="CHANGE_QUEUE",e.Clear="CLEAR",e.Error="ERROR",e.Unknown="UNKNOWN"}(a||(a={})),function(e){e.SliderForward="SLIDER_FORWARD",e.SliderBack="SLIDER_BACK",e.TapForward="TAP_FORWARD",e.TapBack="TAP_BACK",e.DoubleTapForward="DOUBLE_TAP_FORWARD",e.DoubleTapBack="DOUBLE_TAP_BACK",e.Unknown="UNKNOWN"}(n||(n={}))},953872:(e,t,o)=>{"use strict";o.d(t,{createAudioPlayerEventEmitter:()=>s});var i=o(572466);function s(e){return e.resolve(i.EmitterFactory).create()}},37380:(e,t,o)=>{"use strict";o.d(t,{getStopReasonForPlayReason:()=>s});var i=o(311006);function s(e){switch(e){case i.AudioPlayerPlayAudioEventReason.QueueContinuation:return i.AudioPlayerStopAudioEventReason.QueueContinuation;case i.AudioPlayerPlayAudioEventReason.QueueContinuationAfterError:return i.AudioPlayerStopAudioEventReason.Error;case i.AudioPlayerPlayAudioEventReason.NextButton:case i.AudioPlayerPlayAudioEventReason.NextMediaSession:case i.AudioPlayerPlayAudioEventReason.NextVoice:return i.AudioPlayerStopAudioEventReason.NextButton;case i.AudioPlayerPlayAudioEventReason.PrevButton:case i.AudioPlayerPlayAudioEventReason.PrevMediaSession:case i.AudioPlayerPlayAudioEventReason.PrevVoice:return i.AudioPlayerStopAudioEventReason.PrevButton;case i.AudioPlayerPlayAudioEventReason.MixAndPlayButton:case i.AudioPlayerPlayAudioEventReason.ListButton:case i.AudioPlayerPlayAudioEventReason.AudioButton:case i.AudioPlayerPlayAudioEventReason.Voice:return i.AudioPlayerStopAudioEventReason.ChangeQueue;case i.AudioPlayerPlayAudioEventReason.Repeat:return i.AudioPlayerStopAudioEventReason.Repeat;case i.AudioPlayerPlayAudioEventReason.Unknown:return i.AudioPlayerStopAudioEventReason.Unknown;default:return}}},460017:(e,t,o)=>{"use strict";o.d(t,{createAudioPlayerEventEmitter:()=>i.createAudioPlayerEventEmitter,getStopReasonForPlayReason:()=>s.getStopReasonForPlayReason});var i=o(953872),s=o(37380)},122611:(e,t,o)=>{"use strict";o.d(t,{AudioPlayerPauseAudioEventReason:()=>i.AudioPlayerPauseAudioEventReason,AudioPlayerPlayAudioEventReason:()=>i.AudioPlayerPlayAudioEventReason,AudioPlayerSeekEventReason:()=>i.AudioPlayerSeekEventReason,AudioPlayerStopAudioEventReason:()=>i.AudioPlayerStopAudioEventReason,createAudioPlayerEventEmitter:()=>s.createAudioPlayerEventEmitter,getStopReasonForPlayReason:()=>s.getStopReasonForPlayReason});var i=o(311006),s=o(460017)},135401:(e,t,o)=>{"use strict";o.d(t,{AudioPlayerStatsListener:()=>O});var i=o(434518),s=o(763812),a=o(264544),n=o(330690),r=o(504831),_=o(134292),u=o(419822),d=(0,s._)("_stats"),l=(0,s._)("_handlePlayAudio"),c=(0,s._)("_handlePlayAdv"),p=(0,s._)("_handlePauseAudio"),m=(0,s._)("_handlePauseAdv"),h=(0,s._)("_handleStopAudio"),y=(0,s._)("_handleStopAdv"),f=(0,s._)("_handleSeek"),E=(0,s._)("_handleStateRestore"),g=(0,s._)("_handlePageClose"),v=(0,s._)("_makeAdvEventData"),A=(0,s._)("_makeAudioEventData"),w=(0,s._)("_makeEventData"),b=(0,s._)("_canOperate"),P=(0,s._)("_getPlayedTime"),T=(0,s._)("_handleRadioHeartbeat"),I=(0,s._)("_radioHeartbeat");class O{destroy(){window.removeEventListener("beforeunload",(0,i._)(this,g)[g]),this.playerAdapter.events.off("playAudio",(0,i._)(this,l)[l]).off("pauseAudio",(0,i._)(this,p)[p]).off("stopAudio",(0,i._)(this,h)[h]).off("playAdv",(0,i._)(this,c)[c]).off("pauseAdv",(0,i._)(this,m)[m]).off("stopAdv",(0,i._)(this,y)[y]).off("seek",(0,i._)(this,f)[f]).off("stateRestore",(0,i._)(this,E)[E])}constructor(e){Object.defineProperty(this,v,{value:C}),Object.defineProperty(this,A,{value:M}),Object.defineProperty(this,w,{value:D}),Object.defineProperty(this,b,{value:S}),Object.defineProperty(this,P,{value:k}),Object.defineProperty(this,d,{writable:!0,value:void 0}),Object.defineProperty(this,l,{writable:!0,value:void 0}),Object.defineProperty(this,c,{writable:!0,value:void 0}),Object.defineProperty(this,p,{writable:!0,value:void 0}),Object.defineProperty(this,m,{writable:!0,value:void 0}),Object.defineProperty(this,h,{writable:!0,value:void 0}),Object.defineProperty(this,y,{writable:!0,value:void 0}),Object.defineProperty(this,f,{writable:!0,value:void 0}),Object.defineProperty(this,E,{writable:!0,value:void 0}),Object.defineProperty(this,g,{writable:!0,value:void 0}),Object.defineProperty(this,T,{writable:!0,value:void 0}),Object.defineProperty(this,I,{writable:!0,value:void 0}),this.playerAdapter=e,(0,i._)(this,d)[d]=new r.AudioPlayerStatsCollector(new n.AudioNavScreenProvider),(0,i._)(this,l)[l]=({reason:e,audio:t,progressTime:o})=>{if(!(0,i._)(this,b)[b]())return;const s=(0,i._)(this,A)[A](t,o);(0,i._)(this,d)[d].play((0,_.mapPlayReasonToSubtype)(e),s),t.type===a.AudioType.Radio&&(0,i._)(this,I)[I].start(t)},(0,i._)(this,c)[c]=({reason:e,advId:t,progressTime:o})=>{if(!(0,i._)(this,b)[b]())return;const s=(0,i._)(this,v)[v](t,o);(0,i._)(this,d)[d].play((0,_.mapPlayReasonToSubtype)(e),s)},(0,i._)(this,p)[p]=({reason:e,audio:t,progressTime:o})=>{if(!(0,i._)(this,b)[b]())return;const s=(0,i._)(this,A)[A](t,o);(0,i._)(this,d)[d].pause((0,_.mapPauseReasonToSubtype)(e),s),t.type===a.AudioType.Radio&&(0,i._)(this,I)[I].stop(t)},(0,i._)(this,m)[m]=({reason:e,advId:t,progressTime:o})=>{if(!(0,i._)(this,b)[b]())return;const s=(0,i._)(this,v)[v](t,o);(0,i._)(this,d)[d].pause((0,_.mapPauseReasonToSubtype)(e),s)},(0,i._)(this,h)[h]=({reason:e,audio:t,progressTime:o})=>{if(!(0,i._)(this,b)[b]())return;const s=(0,i._)(this,A)[A](t,o);(0,i._)(this,d)[d].end((0,_.mapStopReasonToSubtype)(e),s),t.type===a.AudioType.Radio&&(0,i._)(this,I)[I].stop(t)},(0,i._)(this,y)[y]=({reason:e,advId:t,progressTime:o})=>{if(!(0,i._)(this,b)[b]())return;const s=(0,i._)(this,v)[v](t,o);(0,i._)(this,d)[d].end((0,_.mapStopReasonToSubtype)(e),s)},(0,i._)(this,f)[f]=({reason:e,audio:t,progressTime:o,fromTime:s})=>{if(!(0,i._)(this,b)[b]())return;const a=(0,i._)(this,A)[A](t,s);(0,i._)(this,d)[d].pause((0,_.mapSeekPauseReasonToSubtype)(e),a);const n=(0,i._)(this,A)[A](t,o);(0,i._)(this,d)[d].play((0,_.mapSeekPlayReasonToSubtype)(e),n)},(0,i._)(this,E)[E]=({audio:e,progressTime:t})=>{if(!e||!(0,i._)(this,b)[b]())return;const o=(0,i._)(this,A)[A](e,t);(0,i._)(this,d)[d].pause(r.PauseEventSubtype.StateRestore,o),(0,i._)(this,I)[I].clear()},(0,i._)(this,g)[g]=()=>{const e=this.playerAdapter.getPlayingAudio();if(!e||!(0,i._)(this,b)[b]())return;const t=(0,i._)(this,A)[A](e,(0,i._)(this,P)[P]());(0,i._)(this,d)[d].end(r.StopEventSubtype.Close,t),(0,i._)(this,I)[I].clear()},(0,i._)(this,T)[T]=e=>{const t=(0,i._)(this,A)[A](e,(0,i._)(this,P)[P]());(0,i._)(this,d)[d].play(r.PlayEventSubtype.Heartbeat,t)},(0,i._)(this,I)[I]=new u.AudioHeartbeatTimer({ms:1e4,onBeat:(0,i._)(this,T)[T]}),this.playerAdapter=e,window.addEventListener("beforeunload",(0,i._)(this,g)[g]),this.playerAdapter.events.on("playAudio",(0,i._)(this,l)[l]).on("pauseAudio",(0,i._)(this,p)[p]).on("stopAudio",(0,i._)(this,h)[h]).on("playAdv",(0,i._)(this,c)[c]).on("pauseAdv",(0,i._)(this,m)[m]).on("stopAdv",(0,i._)(this,y)[y]).on("seek",(0,i._)(this,f)[f]).on("stateRestore",(0,i._)(this,E)[E])}}function C(e,t){const o=(0,r.makeAdvListeningData)(e),s=Math.round(t/1e3);return{...(0,i._)(this,w)[w](),timeline:s,trackCode:"",...o}}function M(e,t){const o=(0,_.mapAudioDataToListeningData)(e),s=Math.round(t/1e3);return{...(0,i._)(this,w)[w](),trackCode:e.trackCode,timeline:s,...o}}function D(){return{shuffle:Boolean(this.playerAdapter.isShuffledPlaylist()),repeatMode:this.playerAdapter.isRepeatCurrentAudio()?r.RepeatMode.One:this.playerAdapter.isRepeatAll()?r.RepeatMode.All:r.RepeatMode.Off,volume:this.playerAdapter.getVolume(),speed:100,streamingType:r.StreamingType.Online,playerInitId:null,layer:!0,autorecoms:!0}}function S(){return!this.playerAdapter.isMarusiaTrack()}function k(){return 1e3*Math.round(this.playerAdapter.getListenedTime())||0}},926374:(e,t,o)=>{"use strict";o.d(t,{AudioPlayerStatsCollector:()=>f});var i=o(434518),s=o(763812),a=o(581903),n=o(476726),r=o(613100),_=o(705684),u=o(300760);const d=["audio","podcast"];var l=(0,s._)("_eventTimelines"),c=(0,s._)("_actionCollector"),p=(0,s._)("_audioNavScreenProvider"),m=(0,s._)("_log"),h=(0,s._)("_debug"),y=(0,s._)("_getNavScreen");class f{play(e,t){(0,i._)(this,m)[m]({category:r.EventCategory.Play,type:r.PlayEventType.Start,subtype:e},t)}pause(e,t){(0,i._)(this,m)[m]({category:r.EventCategory.Stop,type:r.StopEventType.Pause,subtype:e},t)}end(e,t){(0,i._)(this,m)[m]({category:r.EventCategory.Stop,type:r.StopEventType.End,subtype:e},t)}constructor(e){Object.defineProperty(this,m,{value:E}),Object.defineProperty(this,h,{get:g,set:void 0}),Object.defineProperty(this,y,{value:v}),Object.defineProperty(this,l,{writable:!0,value:void 0}),Object.defineProperty(this,c,{writable:!0,value:void 0}),Object.defineProperty(this,p,{writable:!0,value:void 0}),(0,i._)(this,l)[l]=new Map,(0,i._)(this,c)[c]=new a.ActionStatCollector(new a.ProductionStatCollector),(0,i._)(this,p)[p]=e}}function E(e,t){const o=(0,i._)(this,y)[y](),s=(0,u.getEventDataKey)(t),a=(0,_.makeEventItem)(e,t,(0,i._)(this,l)[l].get(s)??0,o);if((0,i._)(this,c)[c].logEvent({type:r.EVENT_ITEM_TYPE,[r.EVENT_ITEM_TYPE]:a},{screen:o.screen}),(0,i._)(this,h)[h]){const e=a.event.type,t=a.event[e];console.log([["event_category",e],["event_type",t.type],["event_subtype",t.subtype],["screen",o.screen]].map((([e,t])=>`${e}: ${t}`)).join("\n"),a)}e.category===r.EventCategory.Stop&&e.type===r.StopEventType.End?(0,i._)(this,l)[l].delete(s):(0,i._)(this,l)[l].set(s,t.timeline)}function g(){return(0,n.partConfigEnabled)("audio_player_stats_debug")}function v(){let e=window.cur.module,t=null;return d.includes(e)?((0,n.partConfigEnabled)("audio_player_stats_extra_screens")&&(e=(0,i._)(this,p)[p].screen??e),t=(0,i._)(this,p)[p].catalogSectionId):(0,i._)(this,p)[p].clearPage(),{screen:e,catalogSectionId:t}}},845434:(e,t,o)=>{"use strict";var i,s,a,n,r,_,u,d;o.d(t,{ListeningType:()=>i,MusicContentType:()=>s,PauseEventSubtype:()=>u,PlayEventSubtype:()=>_,PodcastContentType:()=>a,RepeatMode:()=>n,StopEventSubtype:()=>d,StreamingType:()=>r}),function(e){e.Music="type_audio_audio_listening_item",e.Podcast="type_audio_podcast_listening_item",e.Book="type_audio_book_listening_item",e.Adv="type_audio_adv_listening_item",e.Radio="type_audio_radio_listening_item"}(i||(i={})),function(e){e.Track="music_track",e.Snippet="music_snippet"}(s||(s={})),function(e){e.Episode="podcast_episode",e.Trailer="podcast_trailer"}(a||(a={})),function(e){e.Off="off",e.One="one",e.All="all"}(n||(n={})),function(e){e.Online="online",e.OnlineCache="online_cache"}(r||(r={})),function(e){e.PlayButton="play_btn",e.NextButton="next_btn",e.PrevButton="prev_btn",e.NextMediaSession="next_by_system",e.PrevMediaSession="prev_by_system",e.MixAndPlayButton="mix_and_play_btn",e.FastplayListButton="fastplay_list_btn",e.FastplayAudioButton="fastplay_audio_btn",e.QueueContinuation="autoplay",e.QueueContinuationAfterError="autoplay_error",e.Autoplay="autoplay",e.Repeat="repeat",e.Voice="voice",e.NextVoice="next_voice",e.PrevVoice="prev_voice",e.PullSliderForward="pull_slider_forward",e.PullSliderBack="pull_slider_back",e.SeekTapForward="seek_tap_forward",e.SeekTapBack="seek_tap_back",e.NextDoubleTap="next_double_tap",e.PrevDoubleTap="prev_double_tap",e.ChannelAutoResume="session_terminated_autostart",e.Heartbeat="heartbeat",e.Unknown="unhandled_on_client"}(_||(_={})),function(e){e.PauseButton="pause_btn",e.MediaSession="pause_by_system",e.ChannelAutoPause="session_terminated",e.PullSliderForward="pull_slider_forward",e.PullSliderBack="pull_slider_back",e.SeekTapForward="seek_tap_forward",e.SeekTapBack="seek_tap_back",e.NextDoubleTap="next_double_tap",e.PrevDoubleTap="prev_double_tap",e.Voice="voice",e.Paywall="paywall_pause",e.StateRestore="client_restore",e.Error="error",e.Unknown="unhandled_on_client"}(u||(u={})),function(e){e.NextButton="next",e.PrevButton="prev",e.Autoplay="autoplay",e.Adv="adv",e.Repeat="repeat",e.ChangeSource="change_source",e.Close="close",e.Error="error",e.Unknown="unhandled_on_client"}(d||(d={}))},480109:(e,t,o)=>{"use strict";o.d(t,{makeAdvListeningData:()=>i.makeAdvListeningData});var i=o(587133)},587133:(e,t,o)=>{"use strict";o.d(t,{makeAdvListeningData:()=>s});var i=o(845434);function s(e){return{listeningType:i.ListeningType.Adv,contentType:"audio_adv",advId:e}}},504831:(e,t,o)=>{"use strict";o.d(t,{AudioPlayerStatsCollector:()=>i.AudioPlayerStatsCollector,ListeningType:()=>s.ListeningType,MusicContentType:()=>s.MusicContentType,PauseEventSubtype:()=>s.PauseEventSubtype,PlayEventSubtype:()=>s.PlayEventSubtype,PodcastContentType:()=>s.PodcastContentType,RepeatMode:()=>s.RepeatMode,StopEventSubtype:()=>s.StopEventSubtype,StreamingType:()=>s.StreamingType,makeAdvListeningData:()=>a.makeAdvListeningData});var i=o(926374),s=o(845434),a=o(480109)},613100:(e,t,o)=>{"use strict";o.d(t,{AppState:()=>p,AudioEventLayer:()=>d,Autorecoms:()=>c,EVENT_ITEM_TYPE:()=>n,EventCategory:()=>r,PLAYER_INIT_ID:()=>a,PlayEventType:()=>_,Shuffle:()=>l,StopEventType:()=>u});var i=o(418562),s=o(623702);const a=(()=>{const e="AUDIO_PLAYER_INIT_ID",t=(0,s.getSessionStorage)();let o=t.getItem(e);return o||(o=(0,i.default)(),t.setItem(e,o)),o})(),n="type_audio_listening_item";var r,_,u,d,l,c,p;!function(e){e.Play="play",e.Stop="stop"}(r||(r={})),function(e){e.Start="start"}(_||(_={})),function(e){e.Pause="pause",e.End="end"}(u||(u={})),function(e){e.Not="not",e.Layer="layer"}(d||(d={})),function(e){e.Off="off",e.On="on"}(l||(l={})),function(e){e.Off="off",e.On="on"}(c||(c={})),function(e){e.Active="active",e.Inactive="inactive"}(p||(p={}))},300760:(e,t,o)=>{"use strict";o.d(t,{getEventDataKey:()=>s});var i=o(845434);function s(e){return`${function(e){switch(e.listeningType){case i.ListeningType.Music:{const{contentType:t,audioId:o,ownerId:i}=e;return`${t}/${i}_${o}`}case i.ListeningType.Adv:{const{contentType:t,advId:o}=e;return`${t}/${o}`}case i.ListeningType.Podcast:{const{contentType:t,podcastId:o,ownerId:i,episodeId:s}=e;return`${t}/${i}_${o}_${s}`}case i.ListeningType.Book:{const{contentType:t,bookId:o,chapterId:i}=e;return`${t}/${o}${i?"_":""}${i}`}case i.ListeningType.Radio:{const{contentType:t,radioId:o}=e;return`${t}/${o}`}}}(e)}/${e.trackCode}`}},705684:(e,t,o)=>{"use strict";o.d(t,{makeEventItem:()=>i.makeEventItem});o(594945);var i=o(559993)},559993:(e,t,o)=>{"use strict";o.d(t,{makeEventItem:()=>n});var i=o(476726),s=o(613100),a=o(594945);function n(e,t,o,i){const n=r(),u=function({category:e,type:t,subtype:o}){const i={type:e};return{[e]:{type:t,subtype:o},...i}}(e),{catalogSectionId:d}=i;return{event:u,client_time:n,client_server_time:_(n),layer:t.layer?s.AudioEventLayer.Layer:s.AudioEventLayer.Not,autorecoms:t.autorecoms?s.Autorecoms.On:s.Autorecoms.Off,track_code:t.trackCode,timeline:t.timeline,timeline_from:o,player_init_id:s.PLAYER_INIT_ID,volume:t.volume,speed:t.speed,shuffle:t.shuffle?s.Shuffle.On:s.Shuffle.Off,app_state:document.hidden?s.AppState.Inactive:s.AppState.Active,streaming_type:t.streamingType,repeat_mode:t.repeatMode,...d?{nav_info:{section_id:d}}:void 0,...(0,a.mapListeningData)(t)}}function r(){return Math.floor(Date.now()/1e3)}function _(e=r()){return e-(Number.isFinite(window.vk?.dt)?window.vk.dt:(0,i.calculateTimeOffsets)())}},594945:(e,t,o)=>{"use strict";o.d(t,{mapListeningData:()=>s});var i=o(845434);function s(e){switch(e.listeningType){case i.ListeningType.Music:return function({listeningType:e,...t}){return{listening_type:e,[e]:{audio_id:t.audioId,audio_owner_id:t.ownerId,content_type:t.contentType}}}(e);case i.ListeningType.Podcast:return function({listeningType:e,...t}){return{listening_type:e,[e]:{podcast_id:t.podcastId,podcast_owner_id:t.ownerId,episode_id:t.episodeId,podcast_authors_ids:t.authorIds,content_type:t.contentType}}}(e);case i.ListeningType.Book:return function({listeningType:e,...t}){return{listening_type:e,[e]:{book_id:t.bookId,chapter_id:t.chapterId,content_type:"audiobook_chapter"}}}(e);case i.ListeningType.Radio:return function({listeningType:e,...t}){return{listening_type:e,[e]:{radio_id:t.radioId,content_type:"radio"}}}(e);case i.ListeningType.Adv:return function({listeningType:e,...t}){return{listening_type:e,[e]:{adv_id:t.advId,content_type:"audio_adv"}}}(e)}}},382399:(e,t,o)=>{"use strict";o.d(t,{AudioPlayerMyTrackerListener:()=>i.AudioPlayerMyTrackerListener,AudioPlayerStatsListener:()=>s.AudioPlayerStatsListener});var i=o(247034),s=o(135401)},419822:(e,t,o)=>{"use strict";o.d(t,{AudioHeartbeatTimer:()=>c});var i=o(434518),s=o(763812),a=o(255053),n=(0,s._)("_ms"),r=(0,s._)("_onBeat"),_=(0,s._)("_interval"),u=(0,s._)("_currentAudio"),d=(0,s._)("_clearInterval"),l=(0,s._)("_isActive");class c{start(e){if((0,i._)(this,l)[l])throw new Error("HeartbeatTimer is already started");const t=(0,i._)(this,r)[r];(0,i._)(this,d)[d](),(0,i._)(this,u)[u]=e,(0,i._)(this,_)[_]=setInterval((()=>{t(e)}),(0,i._)(this,n)[n])}stop(e){if(!(0,i._)(this,l)[l])throw new Error("HeartbeatTimer is not started");const t=(0,i._)(this,u)[u]&&(0,a.getAudioFullId)((0,i._)(this,u)[u]);if((0,a.getAudioFullId)(e)!==t)throw new Error("Trying to pause another audio");(0,i._)(this,d)[d](),(0,i._)(this,u)[u]=null}clear(){(0,i._)(this,d)[d](),(0,i._)(this,u)[u]=null}constructor(e){Object.defineProperty(this,d,{value:p}),Object.defineProperty(this,l,{get:m,set:void 0}),Object.defineProperty(this,n,{writable:!0,value:void 0}),Object.defineProperty(this,r,{writable:!0,value:void 0}),Object.defineProperty(this,_,{writable:!0,value:void 0}),Object.defineProperty(this,u,{writable:!0,value:void 0}),(0,i._)(this,_)[_]=null,(0,i._)(this,u)[u]=null,(0,i._)(this,n)[n]=e.ms,(0,i._)(this,r)[r]=e.onBeat}}function p(){null!=(0,i._)(this,_)[_]&&(clearInterval((0,i._)(this,_)[_]),(0,i._)(this,_)[_]=null)}function m(){return null!=(0,i._)(this,_)[_]}},134292:(e,t,o)=>{"use strict";o.d(t,{mapAudioDataToListeningData:()=>i.mapAudioDataToListeningData,mapPauseReasonToSubtype:()=>s.mapPauseReasonToSubtype,mapPlayReasonToSubtype:()=>s.mapPlayReasonToSubtype,mapSeekPauseReasonToSubtype:()=>s.mapSeekPauseReasonToSubtype,mapSeekPlayReasonToSubtype:()=>s.mapSeekPlayReasonToSubtype,mapStopReasonToSubtype:()=>s.mapStopReasonToSubtype});var i=o(922926),s=o(826725)},922926:(e,t,o)=>{"use strict";o.d(t,{mapAudioDataToListeningData:()=>r});var i=o(264544),s=o(504831);const a={[i.AudioType.MusicTrack]:s.MusicContentType.Track,[i.AudioType.MusicSnippet]:s.MusicContentType.Snippet},n={[i.AudioType.PodcastTrailer]:s.PodcastContentType.Trailer,[i.AudioType.PodcastEpisode]:s.PodcastContentType.Episode};function r(e){const{id:t,ownerId:o,type:r}=e;switch(r){case i.AudioType.MusicTrack:case i.AudioType.MusicSnippet:return{listeningType:s.ListeningType.Music,contentType:a[r],audioId:t,ownerId:o};case i.AudioType.PodcastEpisode:case i.AudioType.PodcastTrailer:return{listeningType:s.ListeningType.Podcast,contentType:n[r],episodeId:t,ownerId:o,podcastId:e.podcastId};case i.AudioType.Radio:return{listeningType:s.ListeningType.Radio,contentType:"radio",radioId:t}}}},826725:(e,t,o)=>{"use strict";o.d(t,{mapPauseReasonToSubtype:()=>l,mapPlayReasonToSubtype:()=>d,mapSeekPauseReasonToSubtype:()=>p,mapSeekPlayReasonToSubtype:()=>m,mapStopReasonToSubtype:()=>c});var i=o(122611),s=o(504831);const a={[i.AudioPlayerPlayAudioEventReason.PlayButton]:s.PlayEventSubtype.PlayButton,[i.AudioPlayerPlayAudioEventReason.NextButton]:s.PlayEventSubtype.NextButton,[i.AudioPlayerPlayAudioEventReason.PrevButton]:s.PlayEventSubtype.PrevButton,[i.AudioPlayerPlayAudioEventReason.NextMediaSession]:s.PlayEventSubtype.NextMediaSession,[i.AudioPlayerPlayAudioEventReason.PrevMediaSession]:s.PlayEventSubtype.PrevMediaSession,[i.AudioPlayerPlayAudioEventReason.MixAndPlayButton]:s.PlayEventSubtype.MixAndPlayButton,[i.AudioPlayerPlayAudioEventReason.ListButton]:s.PlayEventSubtype.FastplayListButton,[i.AudioPlayerPlayAudioEventReason.AudioButton]:s.PlayEventSubtype.FastplayAudioButton,[i.AudioPlayerPlayAudioEventReason.QueueContinuation]:s.PlayEventSubtype.QueueContinuation,[i.AudioPlayerPlayAudioEventReason.QueueContinuationAfterError]:s.PlayEventSubtype.QueueContinuationAfterError,[i.AudioPlayerPlayAudioEventReason.Autoplay]:s.PlayEventSubtype.Autoplay,[i.AudioPlayerPlayAudioEventReason.Repeat]:s.PlayEventSubtype.Repeat,[i.AudioPlayerPlayAudioEventReason.Voice]:s.PlayEventSubtype.Voice,[i.AudioPlayerPlayAudioEventReason.NextVoice]:s.PlayEventSubtype.NextVoice,[i.AudioPlayerPlayAudioEventReason.PrevVoice]:s.PlayEventSubtype.PrevVoice,[i.AudioPlayerPlayAudioEventReason.ChannelAutoResume]:s.PlayEventSubtype.ChannelAutoResume,[i.AudioPlayerPlayAudioEventReason.Unknown]:s.PlayEventSubtype.Unknown},n={[i.AudioPlayerPauseAudioEventReason.PauseButton]:s.PauseEventSubtype.PauseButton,[i.AudioPlayerPauseAudioEventReason.MediaSession]:s.PauseEventSubtype.MediaSession,[i.AudioPlayerPauseAudioEventReason.ChannelAutoPause]:s.PauseEventSubtype.ChannelAutoPause,[i.AudioPlayerPauseAudioEventReason.Voice]:s.PauseEventSubtype.Voice,[i.AudioPlayerPauseAudioEventReason.Paywall]:s.PauseEventSubtype.Paywall,[i.AudioPlayerPauseAudioEventReason.Unknown]:s.PauseEventSubtype.Unknown},r={[i.AudioPlayerStopAudioEventReason.NextButton]:s.StopEventSubtype.NextButton,[i.AudioPlayerStopAudioEventReason.PrevButton]:s.StopEventSubtype.PrevButton,[i.AudioPlayerStopAudioEventReason.QueueContinuation]:s.StopEventSubtype.Autoplay,[i.AudioPlayerStopAudioEventReason.Adv]:s.StopEventSubtype.Adv,[i.AudioPlayerStopAudioEventReason.Repeat]:s.StopEventSubtype.Repeat,[i.AudioPlayerStopAudioEventReason.ChangeQueue]:s.StopEventSubtype.ChangeSource,[i.AudioPlayerStopAudioEventReason.Clear]:s.StopEventSubtype.Close,[i.AudioPlayerStopAudioEventReason.Error]:s.StopEventSubtype.Error,[i.AudioPlayerStopAudioEventReason.Unknown]:s.StopEventSubtype.Unknown},_={[i.AudioPlayerSeekEventReason.SliderForward]:s.PauseEventSubtype.PullSliderForward,[i.AudioPlayerSeekEventReason.SliderBack]:s.PauseEventSubtype.PullSliderBack,[i.AudioPlayerSeekEventReason.TapForward]:s.PauseEventSubtype.SeekTapForward,[i.AudioPlayerSeekEventReason.TapBack]:s.PauseEventSubtype.SeekTapBack,[i.AudioPlayerSeekEventReason.DoubleTapForward]:s.PauseEventSubtype.NextDoubleTap,[i.AudioPlayerSeekEventReason.DoubleTapBack]:s.PauseEventSubtype.PrevDoubleTap,[i.AudioPlayerSeekEventReason.Unknown]:s.PauseEventSubtype.Unknown},u={[i.AudioPlayerSeekEventReason.SliderForward]:s.PlayEventSubtype.PullSliderForward,[i.AudioPlayerSeekEventReason.SliderBack]:s.PlayEventSubtype.PullSliderBack,[i.AudioPlayerSeekEventReason.TapForward]:s.PlayEventSubtype.SeekTapForward,[i.AudioPlayerSeekEventReason.TapBack]:s.PlayEventSubtype.SeekTapBack,[i.AudioPlayerSeekEventReason.DoubleTapForward]:s.PlayEventSubtype.NextDoubleTap,[i.AudioPlayerSeekEventReason.DoubleTapBack]:s.PlayEventSubtype.PrevDoubleTap,[i.AudioPlayerSeekEventReason.Unknown]:s.PlayEventSubtype.Unknown};function d(e){return a[e??i.AudioPlayerPlayAudioEventReason.Unknown]}function l(e){return n[e??i.AudioPlayerPauseAudioEventReason.Unknown]}function c(e){return r[e??i.AudioPlayerStopAudioEventReason.Unknown]}function p(e){return _[e??i.AudioPlayerPauseAudioEventReason.Unknown]}function m(e){return u[e??i.AudioPlayerPauseAudioEventReason.Unknown]}},49444:(e,t,o)=>{"use strict";o.d(t,{AudioListenedDAUCounter:()=>p});var i=o(434518),s=o(763812);var a=(0,s._)("_onReach"),n=(0,s._)("_startedAt"),r=(0,s._)("_timeout"),_=(0,s._)("_listenedTime"),u=(0,s._)("_reached"),d=(0,s._)("_reach"),l=(0,s._)("_clear"),c=(0,s._)("_clearTimeout");class p{start(){(0,i._)(this,u)[u]||this.started||((0,i._)(this,n)[n]=Date.now(),(0,i._)(this,r)[r]=setTimeout((()=>{(0,i._)(this,d)[d](),(0,i._)(this,r)[r]=null}),3e4-(0,i._)(this,_)[_]))}pause(){this.started&&((0,i._)(this,c)[c](),(0,i._)(this,_)[_]+=Date.now()-(0,i._)(this,n)[n],(0,i._)(this,_)[_]>=3e4&&(0,i._)(this,d)[d]())}reset(){this.pause(),(0,i._)(this,l)[l]()}get started(){return null!==(0,i._)(this,r)[r]}constructor(e){Object.defineProperty(this,d,{value:m}),Object.defineProperty(this,l,{value:h}),Object.defineProperty(this,c,{value:y}),Object.defineProperty(this,a,{writable:!0,value:void 0}),Object.defineProperty(this,n,{writable:!0,value:void 0}),Object.defineProperty(this,r,{writable:!0,value:void 0}),Object.defineProperty(this,_,{writable:!0,value:void 0}),Object.defineProperty(this,u,{writable:!0,value:void 0}),(0,i._)(this,n)[n]=-1,(0,i._)(this,r)[r]=null,(0,i._)(this,_)[_]=0,(0,i._)(this,u)[u]=!1,(0,i._)(this,a)[a]=e}}function m(){(0,i._)(this,u)[u]=!0,(0,i._)(this,a)[a]()}function h(){(0,i._)(this,c)[c](),(0,i._)(this,n)[n]=-1,(0,i._)(this,_)[_]=0,(0,i._)(this,u)[u]=!1}function y(){const e=(0,i._)(this,r)[r];e&&(clearTimeout(e),(0,i._)(this,r)[r]=null)}},34838:(e,t,o)=>{"use strict";o.d(t,{AudioPlayerActivityCounter:()=>f});var i=o(434518),s=o(763812),a=o(255053),n=o(476726),r=o(131139),_=o(49444),u=(0,s._)("_type"),d=(0,s._)("_timespent"),l=(0,s._)("_dau"),c=(0,s._)("_listenedCounter"),p=(0,s._)("_currentAudio"),m=(0,s._)("_debug"),h=(0,s._)("_logDebug"),y=(0,s._)("_isCurrentAudio");class f{get isActiveTimespent(){return(0,i._)(this,d)[d].isActiveTimespent}start(e){(0,i._)(this,y)[y](e)||((0,i._)(this,p)[p]=e,(0,i._)(this,c)[c].reset()),(0,i._)(this,h)[h](`start ${(0,a.getAudioFullId)(e.identity)}`),(0,i._)(this,c)[c].start(),(0,i._)(this,d)[d].startTimespent()}pause(e){(0,i._)(this,y)[y](e)&&(0,i._)(this,c)[c].pause(),(0,i._)(this,d)[d].stopTimespent(),(0,i._)(this,h)[h](`pause ${(0,a.getAudioFullId)(e.identity)}`)}stop(e){(0,i._)(this,y)[y](e)&&(0,i._)(this,c)[c].reset(),(0,i._)(this,d)[d].stopTimespent(),(0,i._)(this,h)[h](`stop ${(0,a.getAudioFullId)(e.identity)}`)}constructor({myTracker:e,type:t,strict:o}){Object.defineProperty(this,m,{get:E,set:void 0}),Object.defineProperty(this,h,{value:g}),Object.defineProperty(this,y,{value:v}),Object.defineProperty(this,u,{writable:!0,value:void 0}),Object.defineProperty(this,d,{writable:!0,value:void 0}),Object.defineProperty(this,l,{writable:!0,value:void 0}),Object.defineProperty(this,c,{writable:!0,value:void 0}),Object.defineProperty(this,p,{writable:!0,value:void 0}),(0,i._)(this,c)[c]=new _.AudioListenedDAUCounter((()=>{(0,i._)(this,l)[l].increment(),(0,i._)(this,h)[h]("increment")})),(0,i._)(this,p)[p]=null,(0,i._)(this,u)[u]=t,(0,i._)(this,d)[d]=A(e,r.TIMESPENT_ACTIVITY_MAP[t],o),(0,i._)(this,l)[l]=A(e,r.DAU_ACTIVITY_MAP[t],o)}}function E(){return(0,n.partConfigEnabled)("audio_player_stats_debug")}function g(e){(0,i._)(this,m)[m]&&console.log(`[AudioPlayerActivityCounter][${(0,i._)(this,u)[u]}] ${e}`)}function v(e){const t=(0,i._)(this,p)[p];return!!t&&(0,a.getAudioFullId)(e.identity)===(0,a.getAudioFullId)(t.identity)}function A(e,t,o){return e.ensureActivityCounter({activityId:t,timespentType:"service",strict:o})}},176123:(e,t,o)=>{"use strict";o.d(t,{AudioPlayerMyTrackerListener:()=>m});var i=o(434518),s=o(763812),a=o(131139),n=o(34838),r=(0,s._)("_player"),_=(0,s._)("_counters"),u=(0,s._)("_handlePlayAudio"),d=(0,s._)("_handlePauseAudio"),l=(0,s._)("_handleStopAudio"),c=(0,s._)("_getCounter"),p=(0,s._)("_canOperate");class m{destroy(){(0,i._)(this,r)[r].events.off("playAudio",(0,i._)(this,u)[u]).off("pauseAudio",(0,i._)(this,d)[d]).off("stopAudio",(0,i._)(this,l)[l])}constructor(e,t){Object.defineProperty(this,c,{value:h}),Object.defineProperty(this,p,{value:y}),Object.defineProperty(this,r,{writable:!0,value:void 0}),Object.defineProperty(this,_,{writable:!0,value:void 0}),Object.defineProperty(this,u,{writable:!0,value:void 0}),Object.defineProperty(this,d,{writable:!0,value:void 0}),Object.defineProperty(this,l,{writable:!0,value:void 0}),(0,i._)(this,u)[u]=e=>{if(!(0,i._)(this,p)[p]())return;const{audio:t}=e;(0,i._)(this,c)[c](t.type).start(t)},(0,i._)(this,d)[d]=e=>{if(!(0,i._)(this,p)[p]())return;const{audio:t}=e;(0,i._)(this,c)[c](t.type).pause(t)},(0,i._)(this,l)[l]=e=>{if(!(0,i._)(this,p)[p]())return;const{audio:t}=e;(0,i._)(this,c)[c](t.type).stop(t)},(0,i._)(this,r)[r]=e,(0,i._)(this,_)[_]=function(e){const t=t=>new n.AudioPlayerActivityCounter({myTracker:e,type:t,strict:!1});return{[a.AudioPlayerActivityCounterType.Music]:t(a.AudioPlayerActivityCounterType.Music),[a.AudioPlayerActivityCounterType.MusicSnippets]:t(a.AudioPlayerActivityCounterType.MusicSnippets),[a.AudioPlayerActivityCounterType.Podcasts]:t(a.AudioPlayerActivityCounterType.Podcasts),[a.AudioPlayerActivityCounterType.Audiobooks]:t(a.AudioPlayerActivityCounterType.Audiobooks),[a.AudioPlayerActivityCounterType.Radio]:t(a.AudioPlayerActivityCounterType.Radio)}}(t),(0,i._)(this,r)[r].events.on("playAudio",(0,i._)(this,u)[u]).on("pauseAudio",(0,i._)(this,d)[d]).on("stopAudio",(0,i._)(this,l)[l])}}function h(e){const t=a.AUDIO_TYPE_ACTIVITY_TYPE_MAP[e];return(0,i._)(this,_)[_][t]}function y(){return!(0,i._)(this,r)[r].isMarusiaTrack()}},131139:(e,t,o)=>{"use strict";o.d(t,{AUDIO_TYPE_ACTIVITY_TYPE_MAP:()=>n,AudioPlayerActivityCounterType:()=>i,DAU_ACTIVITY_MAP:()=>_,TIMESPENT_ACTIVITY_MAP:()=>r});var i,s=o(380719),a=o(264544);!function(e){e.Music="music",e.MusicSnippets="music_snippets",e.Podcasts="podcasts",e.Audiobooks="audiobooks",e.Radio="radio"}(i||(i={}));const n={[a.AudioType.MusicTrack]:"music",[a.AudioType.MusicSnippet]:"music_snippets",[a.AudioType.PodcastEpisode]:"podcasts",[a.AudioType.PodcastTrailer]:"podcasts",[a.AudioType.Radio]:"radio"},r={music:s.MyTrackerActivityId.MusicListen,music_snippets:s.MyTrackerActivityId.MusicSnippetsListen,podcasts:s.MyTrackerActivityId.PodcastsListen,audiobooks:s.MyTrackerActivityId.AudiobooksListen,radio:s.MyTrackerActivityId.RadioListen},_={music:s.MyTrackerActivityId.MusicTrackListenedDAU,music_snippets:s.MyTrackerActivityId.MusicSnippetListenedDAU,podcasts:s.MyTrackerActivityId.PodcastEpisodeListenedDAU,audiobooks:s.MyTrackerActivityId.AudiobookListenedDAU,radio:s.MyTrackerActivityId.RadiostationListenedDAU}},247034:(e,t,o)=>{"use strict";o.d(t,{AudioPlayerMyTrackerListener:()=>i.AudioPlayerMyTrackerListener});var i=o(176123)},596793:(e,t,o)=>{"use strict";function i(e){const t={};return e&&e.length&&e.filter((e=>!!e)).map((e=>e.queues&&e.queues[0])).forEach((e=>t[e.type]=e)),t}o.d(t,{unpackQueues:()=>i})},965912:(e,t,o)=>{"use strict";o.d(t,{BenchmarkMainStatCollector:()=>n});var i=o(144770),s=o(318288),a=o(87223);class n{logEvent(e){this.DEBUG&&(0,s.log)(e),e.type&&e[e.type]?(0,i.saveBenchmarkMainStats)(e):(0,a.logError)(new Error("BenchmarkMainStatCollector: invalid event."))}getBaseEvent(){return{id:this.getIntId(),timestamp:this.getCurrentTime()}}getIntId(){return Math.floor(Math.random()*n.MAX_INT32)}getCurrentTime(){return(1e3*Date.now()).toString(10)}constructor(){this.DEBUG=!1}}n.MAX_INT32=2147483647},278962:(e,t,o)=>{"use strict";o.d(t,{BenchmarkMainStatEventTypes:()=>a,MiniAppPerformanceErrors:()=>r,MiniAppPerformanceErrorsDescription:()=>_,MiniAppPerformanceSteps:()=>n,MiniAppPerformanceStorageKey:()=>i,PERFORMANCE_EMIT_TIMEOUT:()=>s});const i="mini_apps_performance_storage",s=1e4;var a,n,r,_;!function(e){e.MINI_APPS_PERFORMANCE="type_mini_apps_performance",e.WEB_APP_STARTS="type_web_app_starts",e.ACCESSIBILITY_ERRORS_COVERAGE="type_accessibility_errors_coverage_item",e.STORY_VIDEO_ITEM="type_story_video_item"}(a||(a={})),function(e){e.START="start_time",e.SCREEN_OPEN="screen_open_time",e.WEBVIEW_START_LOAD="webview_start_load_time",e.WEBVIEW_END_LOAD="webview_end_load_time",e.APP_INIT="app_init_time",e.END="end_time"}(n||(n={})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.NETWORK=1]="NETWORK",e[e.NO_APP_INIT=2]="NO_APP_INIT",e[e.UNAVAILABLE=3]="UNAVAILABLE",e[e.ODR_LOAD=4]="ODR_LOAD",e[e.USER_CANCELLED=5]="USER_CANCELLED"}(r||(r={})),function(e){e.STORAGE_TROUBLES="Storage troubles",e.IFRAME_NOT_LOAD="App iframe not loaded",e.APP_INIT="Not app init",e.EARLY_CLOSING="Early app closing"}(_||(_={}))},793241:(e,t,o)=>{"use strict";o.d(t,{renderAvatarToString:()=>_});var i=o(474848),s=o(440961),a=o(280234),n=o(714209),r=o(29700);function _(e,t,o,_="",u,d,l,c,p,m){let h;u&&(h="online"),n.mobPlatforms[u]&&(h="online-mobile");const y=null!==o&&o?"a":"span",f=document.createElement(y);void 0!==d&&f.setAttribute("onclick",d),m&&f.classList.add("nft_avatar_wrap"),_&&(Array.isArray(_)?f.classList.add(..._):f.classList.add(_)),o&&(f.href=o),s.render((0,i.jsxs)(a.RichAvatar,{className:r.default.root,alt:p,src:e,size:t,nft:m,children:[l&&(0,i.jsx)(a.RichAvatar.Outline,{"data-outline-id":c,appearance:"accent"}),h&&(0,i.jsx)(a.RichAvatar.BadgeWithPreset,{preset:h})]}),f);const E=f.outerHTML;return s.unmountComponentAtNode(f),E}},312258:(e,t,o)=>{"use strict";var i,s,a;o.d(t,{ColorSchemeMode:()=>i,ColorSchemeName:()=>s,SchemeColors:()=>a}),function(e){e.Light="light",e.Dark="dark",e.Auto="auto"}(i||(i={})),function(e){e.Dark="space_gray",e.Light="bright_light",e.WebDark="vkcom_dark",e.WebLight="vkcom_light"}(s||(s={})),function(e){e.Dark="#222222",e.Light="#ffffff"}(a||(a={}))},889393:(e,t,o)=>{"use strict";o.d(t,{OUR_DOMAINS:()=>n,RE_DOMAIN_PATTERN:()=>_,TOP_DOMAINS:()=>s,VK_DOMAIN:()=>r});var i=o(705744);const s=[..."aaa,aarp,abarth,abb,abbott,abbvie,abc,able,abogado,abudhabi,ac,academy,accenture,accountant,accountants,aco,active,actor,ad,adac,ads,adult,ae,aeg,aero,aetna,af,afamilycompany,afl,africa,ag,agakhan,agency,ai,aig,aigo,airbus,airforce,airtel,akdn,al,alfaromeo,alibaba,alipay,allfinanz,allstate,ally,alsace,alstom,am,americanexpress,americanfamily,amex,amfam,amica,amsterdam,an,analytics,android,anquan,anz,ao,aol,apartments,app,apple,aq,aquarelle,ar,aramco,archi,army,arpa,art,arte,as,asda,asia,associates,at,athleta,attorney,au,auction,audi,audible,audio,auspost,author,auto,autos,avianca,aw,aws,ax,axa,az,azure,ba,baby,baidu,banamex,bananarepublic,band,bank,bar,barcelona,barclaycard,barclays,barefoot,bargains,baseball,basketball,bauhaus,bayern,bb,bbc,bbt,bbva,bcg,bcn,bd,be,beats,beauty,beer,bentley,berlin,best,bestbuy,bet,bf,bg,bh,bharti,bi,bible,bid,bike,bing,bingo,bio,biz,bj,bl,black,blackfriday,blanco,blockbuster,blog,bloomberg,blue,bm,bms,bmw,bn,bnl,bnpparibas,bo,boats,boehringer,bofa,bom,bond,boo,book,booking,boots,bosch,bostik,boston,bot,boutique,box,bq,br,bradesco,bridgestone,broadway,broker,brother,brussels,bs,bt,budapest,bugatti,build,builders,business,buy,buzz,bv,bw,by,bz,bzh,ca,cab,cafe,cal,call,calvinklein,cam,camera,camp,cancerresearch,canon,capetown,capital,capitalone,car,caravan,cards,care,career,careers,cars,cartier,casa,case,caseih,cash,casino,cat,catering,catholic,cba,cbn,cbre,cbs,cc,cd,ceb,center,ceo,cern,cf,cfa,cfd,cg,ch,chanel,channel,chase,chat,cheap,chintai,chloe,christmas,chrome,chrysler,church,ci,cipriani,circle,cisco,citadel,citi,citic,city,cityeats,ck,cl,claims,cleaning,click,clinic,clinique,clothing,cloud,club,clubmed,cm,cn,co,coach,codes,coffee,college,cologne,com,comcast,commbank,community,company,compare,computer,comsec,condos,construction,consulting,contact,contractors,cooking,cookingchannel,cool,coop,corsica,country,coupon,coupons,courses,cr,credit,creditcard,creditunion,cricket,crown,crs,cruise,cruises,csc,cu,cuisinella,cv,cw,cx,cy,cymru,cyou,cz,dabur,dad,dance,data,date,dating,datsun,day,dclk,dds,de,deal,dealer,deals,degree,delivery,dell,deloitte,delta,democrat,dental,dentist,desi,design,dev,dhl,diamonds,diet,digital,direct,directory,discount,discover,dish,diy,dj,dk,dm,dnp,do,docs,doctor,dodge,dog,doha,domains,dot,download,drive,dtv,dubai,duck,dunlop,duns,dupont,durban,dvag,dvr,dz,earth,eat,ec,eco,edeka,edu,education,ee,eg,eh,email,emerck,energy,engineer,engineering,enterprises,epost,epson,equipment,er,ericsson,erni,es,esq,estate,esurance,et,eu,eurovision,eus,events,everbank,exchange,expert,exposed,express,extraspace,fage,fail,fairwinds,faith,family,fan,fans,farm,farmers,fashion,fast,fedex,feedback,ferrari,ferrero,fi,fiat,fidelity,fido,film,final,finance,financial,fire,firestone,firmdale,fish,fishing,fit,fitness,fj,fk,flickr,flights,flir,florist,flowers,fly,fm,fo,foo,food,foodnetwork,football,ford,forex,forsale,forum,foundation,fox,fr,free,fresenius,frl,frogans,frontdoor,frontier,ftr,fujitsu,fujixerox,fun,fund,furniture,futbol,fyi,ga,gal,gallery,gallo,gallup,game,games,gap,garden,gb,gbiz,gd,gdn,ge,gea,gent,genting,george,gf,gg,ggee,gh,gi,gift,gifts,gives,giving,gl,glade,glass,gle,global,globo,gm,gmail,gmbh,gmo,gmx,gn,godaddy,gold,goldpoint,golf,goo,goodhands,goodyear,goog,google,gop,got,gov,gp,gq,gr,grainger,graphics,gratis,green,gripe,group,gs,gt,gu,guardian,gucci,guge,guide,guitars,guru,gw,gy,hair,hamburg,hangout,haus,hbo,hdfc,hdfcbank,health,healthcare,help,helsinki,here,hermes,hgtv,hiphop,hisamitsu,hitachi,hiv,hk,hkt,hm,hn,hockey,holdings,holiday,homedepot,homegoods,homes,homesense,honda,honeywell,horse,hospital,host,hosting,hot,hoteles,hotmail,house,how,hr,hsbc,ht,htc,hu,hughes,hyatt,hyundai,ibm,icbc,ice,icu,id,ie,ieee,ifm,ikano,il,im,imamat,imdb,immo,immobilien,in,industries,infiniti,info,ing,ink,institute,insurance,insure,int,intel,international,intuit,investments,io,ipiranga,iq,ir,irish,is,iselect,ismaili,ist,istanbul,it,itau,itv,iveco,iwc,jaguar,java,jcb,jcp,je,jeep,jetzt,jewelry,jio,jlc,jll,jm,jmp,jnj,jo,jobs,joburg,jot,joy,jp,jpmorgan,jprs,juegos,juniper,kaufen,kddi,ke,kerryhotels,kerrylogistics,kerryproperties,kfh,kg,kh,ki,kia,kim,kinder,kindle,kitchen,kiwi,km,kn,koeln,komatsu,kosher,kp,kpmg,kpn,kr,krd,kred,kuokgroup,kw,ky,kyoto,kz,la,lacaixa,ladbrokes,lamborghini,lamer,lancaster,lancia,lancome,land,landrover,lanxess,lasalle,lat,latino,latrobe,law,lawyer,lb,lc,lds,lease,leclerc,lefrak,legal,lego,lexus,lgbt,li,liaison,lidl,life,lifeinsurance,lifestyle,lighting,like,lilly,limited,limo,lincoln,linde,link,lipsy,live,living,lixil,lk,loan,loans,local,locker,locus,loft,lol,london,lotte,lotto,love,lpl,lplfinancial,lr,ls,lt,ltd,ltda,lu,lundbeck,lupin,luxe,luxury,lv,ly,ma,macys,madrid,maif,maison,makeup,man,management,mango,market,marketing,markets,marriott,marshalls,maserati,mattel,mba,mc,mcd,mcdonalds,mckinsey,md,me,med,media,meet,melbourne,meme,memorial,men,menu,meo,metlife,mf,mg,mh,miami,microsoft,mil,mini,mint,mit,mitsubishi,mk,ml,mlb,mls,mm,mma,mn,mo,mobi,mobile,mobily,moda,moe,moi,mom,monash,money,monster,montblanc,mopar,mormon,mortgage,moscow,moto,motorcycles,mov,movie,movistar,mp,mq,mr,ms,msd,mt,mtn,mtpc,mtr,mu,museum,mutual,mv,mw,mx,my,mz,na,nab,nadex,nagoya,name,nationwide,natura,navy,nba,nc,ne,nec,net,netbank,netflix,network,neustar,new,newholland,news,next,nextdirect,nexus,nf,nfl,ng,ngo,nhk,ni,nico,nike,nikon,ninja,nissan,nissay,nl,no,nokia,northwesternmutual,norton,now,nowruz,nowtv,np,nr,nra,nrw,ntt,nu,nyc,nz,obi,observer,off,office,okinawa,olayan,olayangroup,oldnavy,ollo,om,omega,one,ong,onl,online,onyourside,ooo,open,oracle,orange,org,organic,orientexpress,origins,osaka,otsuka,ott,ovh,pa,page,pamperedchef,panasonic,panerai,paris,pars,partners,parts,party,passagens,pay,pccw,pe,pet,pf,pfizer,pg,ph,pharmacy,philips,phone,photo,photography,photos,physio,piaget,pics,pictet,pictures,pid,pin,ping,pink,pioneer,pizza,pk,pl,place,play,playstation,plumbing,plus,pm,pn,pnc,pohl,poker,politie,porn,post,pr,pramerica,praxi,press,prime,pro,prod,productions,prof,progressive,promo,properties,property,protection,pru,prudential,ps,pt,pub,pw,pwc,py,qa,qpon,quebec,quest,qvc,racing,radio,raid,re,read,realestate,realtor,realty,recipes,red,redstone,redumbrella,rehab,reise,reisen,reit,reliance,ren,rent,rentals,repair,report,republican,rest,restaurant,review,reviews,rexroth,rich,richardli,ricoh,rightathome,ril,rio,rip,rmit,ro,rocher,rocks,rodeo,rogers,room,rs,rsvp,ru,ruhr,run,rw,rwe,ryukyu,sa,saarland,safe,safety,sakura,sale,salon,samsclub,samsung,sandvik,sandvikcoromant,sanofi,sap,sapo,sarl,sas,save,saxo,sb,sbi,sbs,sc,sca,scb,schaeffler,schmidt,scholarships,school,schule,schwarz,science,scjohnson,scor,scot,sd,se,seat,secure,security,seek,select,sener,services,ses,seven,sew,sex,sexy,sfr,sg,sh,shangrila,sharp,shaw,shell,shia,shiksha,shoes,shop,shopping,shouji,show,showtime,shriram,si,silk,sina,singles,site,sj,sk,ski,skin,sky,skype,sl,sling,sm,smart,smile,sn,sncf,so,soccer,social,softbank,software,sohu,solar,solutions,song,sony,soy,space,spiegel,spot,spreadbetting,sr,srl,srt,ss,st,stada,staples,star,starhub,statebank,statefarm,statoil,stc,stcgroup,stockholm,storage,store,stream,studio,study,style,su,sucks,supplies,supply,support,surf,surgery,suzuki,sv,swatch,swiftcover,swiss,sx,sy,sydney,symantec,systems,sz,tab,taipei,talk,taobao,target,tatamotors,tatar,tattoo,tax,taxi,tc,tci,td,tdk,team,tech,technology,tel,telecity,telefonica,temasek,tennis,teva,tf,tg,th,thd,theater,theatre,tiaa,tickets,tienda,tiffany,tips,tires,tirol,tj,tjmaxx,tjx,tk,tkmaxx,tl,tm,tmall,tn,to,today,tokyo,tools,top,toray,toshiba,total,tours,town,toyota,toys,tp,tr,trade,trading,training,travel,travelchannel,travelers,travelersinsurance,trust,trv,tt,tube,tui,tunes,tushu,tv,tvs,tw,tz,ua,ubank,ubs,uconnect,ug,uk,um,unicom,university,uno,uol,ups,us,uy,uz,va,vacations,vana,vanguard,vc,ve,vegas,ventures,verisign,vermögensberater,vermögensberatung,versicherung,vet,vg,vi,viajes,video,vig,viking,villas,vin,vip,virgin,visa,vision,vista,vistaprint,viva,vivo,vlaanderen,vn,vodka,volkswagen,volvo,vote,voting,voto,voyage,vu,vuelos,wales,walmart,walter,wang,wanggou,warman,watch,watches,weather,weatherchannel,webcam,weber,website,wed,wedding,weibo,weir,wf,whoswho,wien,wiki,williamhill,win,windows,wine,winners,wme,wolterskluwer,woodside,work,works,world,wow,ws,wtc,wtf,xbox,xerox,xfinity,xihuan,xin,xperia,xxx,xyz,yachts,yahoo,yamaxun,yandex,ye,yodobashi,yoga,yokohama,you,youtube,yt,yu,yun,za,zappos,zara,zero,zip,zippo,zm,zone,zuerich,zw".split(","),..."бг,бел,дети,ею,католик,ком,мкд,мон,москва,онлайн,орг,рус,рф,сайт,срб,укр".split(","),..."qxam,90ae,90ais,d1acj3b,e1a4c,80aqecdr1a,j1aef,d1alf,l1acc,80adxhks,80asehdb,c1avg,p1acf,p1ai,80aswg,90a3ac,j1amh,80ao21a,y9a3aq,9dbq2a,mgbca7dzdo,mgba3a3ejt,mgbayh7gpa,lgbbat1ad8j,mgberp4a5d4ar,mgba7c0bbn0a,mgbc0a9azcg,mgb2ddes,mgbaam7a8h,mgba3a4f16a,mgbbh1a,mgbab2bd,ngbe9e0a,mgbbh1a71e,pgbs0dh,mgbpl2fh,ogbpf8fl,ngbc5azd,mgbtx2b,mgb9awbf,ygbi2ammx,wgbl6a,mgbi4ecexp,fhbei,wgbh1c,mgbx4cd0ab,mgbb9fbpob,4gbrim,mgbt3dhd,mgbai9azgqp6j,mgbgu82a,11b4c3d,c2br7g,h2brj9c,h2breg3eve,h2brj9c8c,i1b6b1a6a2e,54b7fta0cc,45brj9c,45br5cyl,s9brj9c,gecrj9c,3hcrj9c,xkc2dl3a5ee0h,xkc2al3hye2a,clchc0ea0b2g2a9gcd,fpcrj9c3d,2scrj9c,rvc1e0am3e,fzc2c9e2c,42c2d9a,o3cw4h,node,q9jyb4c,gckr3f0f,qcka1pmc,tckwe,cck2b3b,1ck2e1b,bck1b9a5dre4c,eckvdtc9d,rhqv96g,fiq64b,fiqs8s,fiqz9s,fiq228c5hs,vhquv,1qqw23a,vuq861b,nyqy26a,45q11c,55qx5d,55qw42g,kprw13d,kpry57d,czru2d,czrs0t,czr694b,w4rs40l,w4r85el8fhu5dnra,3ds443g,3oq18vl8pn36a,pssy2u,tiq49xqyj,fjq720a,fct429k,estv75g,xhq521b,9krt00a,30rr7y,6qq986b3xl,kput3i,kpu716f,zfr164b,mxtq1m,yfro4i67o,efvy88h,9et52u,rovu88b,nqv7f,b4w605ferd,unup4y,mix891f,mix082f,3pxu8k,pbt977c,6frz82g,nqv7fs00ema,ses554g,hxt814e,5tzm5g,io0a7i,8y0a063a,jlq61u9w7b,flw351e,g2xx48c,gk3at1e,3bst00m,fzys8d69uvgm,kcrx77d1x4a,jvr189m,imr513n,5su34j936bgsg,j6w193g,t60b56a,mk1bu44c,cg4bki,3e0b707e".split(",").map((e=>"xn--"+e))],a=i.VK_HOST_REGEX_GROUP_UNSAFE.source,n=new RegExp(`^([a-zA-Z0-9\\.\\_\\-]+\\.)?(${a}|vk\\.cc)$`),r=new RegExp(`^(?:https?:\\/\\/)?(?:${i.VK_SITES_REGEX_SOURCE_UNSAFE})?\\/([a-zA-Z0-9\\._]+)\\??$`),_="((?:[a-z0-9_]*[a-z0-9])?(?:(?:\\.[a-z](?:[a-z0-9_]+[a-z0-9])?)*\\.[a-z][a-z0-9_]{2,40}[a-z0-9])?)"},495917:(e,t,o)=>{"use strict";o.d(t,{EMAIL:()=>s});var i=o(678340);const s=new RegExp("([a-zA-Zа-яА-Я\\-_\\.0-9\\+]+@("+i.RE_URL_DOMAIN_NAME+i.RE_URL_DOMAIN_TOP+"))","ig")},487703:(e,t,o)=>{"use strict";o.d(t,{FREE_MENTION:()=>a,FREE_MENTION_LINK:()=>n,MENTION:()=>s});var i=o(705744);const s=/\[(id|club)(\d+)(?:\:([a-z0-9_\-]+))?\|([^\$]+?)\]/g,a=/\[([^\$\[\]]+?)\|([^\]]+?)\]/g,n=new RegExp(`\\[((?:https?:\\/\\/)?(?:(?:m\\.|dev\\.)?(?:${i.VK_HOST_REGEX_GROUP_UNSAFE.source}|vk\\.me))(?!\\/\\/)(?!\\/doc[\\d\\-])(?!\\/page[\\d\\-])(?!\\/away[\\.\\?])(?:\\/[-\\._~:\\/?#\\[\\]@!\\$&'\\(\\)\\*\\+,;=%.\\w]*)*)\\|([^\\]\\n\\t]*)\\]`)},678340:(e,t,o)=>{"use strict";o.d(t,{RE_URL_DOMAIN_NAME:()=>s,RE_URL_DOMAIN_TOP:()=>a,RE_URL_PATTERN:()=>n});const i="\\w\\$А-Яа-яёЁєЄҐґЇїІіЈј",s="((?:["+i+"\\—\\-\\_]+\\.){1,5})",a="([A-Za-zа-яА-Я\\-\\d]{2,22})",n="(https?:\\/\\/)?"+("("+s+a+"(?:\\:(\\d{2,5}))?)")+("(([\\/?#])(?:\\&|\\&#\\d{2,6};|,[_%]|!|,*[\\wА-Яа-я\\xa8\\xb8\\xc0-\\xffєЄҐґЇїІіЈј\\—\\-\\_@#%?+\\/\\$.~=;:'ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠ-ࢴࢶ-ࢽऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛱ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢄᢇ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲈᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎↃↄⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々〆〱-〵〻〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿕ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛥꜗ-ꜟꜢ-ꞈꞋ-ꞮꞰ-ꞷꟷ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭥꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ　-〿＀-￯*]+|"+("(?:\\(|\\[)["+i+"\\d&#%;,]+(?:\\)|\\])")+"){0,200})?")},529397:(e,t,o)=>{"use strict";o.d(t,{logDonutEvent:()=>n});var i=o(922748),s=o(695290),a=o(614212);function n(e,t){const{type:o,type_property:n,params:r}=(0,a.parseJSON)(e);n===s.ActionProductionStatEventTypes.TYPE_DONUT_PAYMENT_ITEM?i.donutStats.logEventAction({event_type:r.event_type,source:r.source,owner_id:r.owner_id}):t&&o===s.ProductionStatEventTypes.TYPE_NAVGO&&function(e,{params:t,typeProperty:o}){if(o===s.NavigationProductionStatEventTypes.TYPE_DONUT_DESCRIPTION_NAV_ITEM){const e=t.owner_id,o=t.track_code;if(!t||"number"!=typeof e||"string"!=typeof o)return;i.donutStats.logEventDescriptionClick({ownerId:e,trackCode:o})}}(0,{typeProperty:n,params:r})}},922748:(e,t,o)=>{"use strict";o.d(t,{donutStats:()=>r});var i=o(581903),s=o(695290),a=o(796044);class n{logEventAction(e){return this.actionStatCollector.logEvent(n.createDonutActionStatEvent(e))}logEventActionView(e){return this.logEventAction({...e,event_type:a.DonutActionEventType.PAYMENT_FORM})}logEventDescriptionClick(e){this.navStatCollector.logEvent({...n.createNavStatEventBase(),...n.createDescriptionClickStatEvent(e)})}static createDonutActionStatEvent(e){return{type:s.ActionProductionStatEventTypes.TYPE_DONUT_PAYMENT_ITEM,[s.ActionProductionStatEventTypes.TYPE_DONUT_PAYMENT_ITEM]:e}}static createNavStatEventBase(){return{screen:"wall",subtype:s.NavigationProductionStatEventTypes.GO}}static createDescriptionClickStatEvent(e){return{item:n.processClickParamsToEventItem(e),type:s.NavigationProductionStatEventTypes.TYPE_DONUT_DESCRIPTION_NAV_ITEM,[s.NavigationProductionStatEventTypes.TYPE_DONUT_DESCRIPTION_NAV_ITEM]:{}}}static processClickParamsToEventItem(e){return{type:s.EventItemType.BROWSER,owner_id:e.ownerId,track_code:e.trackCode}}constructor(){this.productionStatCollector=new i.ProductionStatCollector,this.actionStatCollector=new i.ActionStatCollector(this.productionStatCollector),this.navStatCollector=new i.NavigationStatCollector(this.productionStatCollector)}}const r=new n},699615:(e,t,o)=>{"use strict";o.d(t,{convertAttachesToPhpMedia:()=>p,convertKludgesToAttaches:()=>c,isEventForMarusia:()=>y,isOnboardingFindFriendsLink:()=>h,isPinnedSortId:()=>m});var i=o(7144),s=o(201193),a=o(705744),n=o(891911),r=o(336476);function _(e,t=[]){const[o,i]=e.split("_");return[o,i,t]}function u(e,t,o=0,i=0){if(i>50)return[[],e.length];const s=[];let a="";for(;o<e.length;){const n=e[o];if("id"===n)a=t[o];else if(","===n&&a)s.push(_(a)),a="";else if("("===n){const[n,r]=u(e,t,o+1,i+1);o=r,s.push(_(a,n)),a=""}else if(")"===n)return""!==a&&s.push(_(a)),[s,o];o++}return a&&s.push(_(a)),[s,o]}let d={};function l(e){if(d[e])return d[e];const t=e?e.length:0,o=[],i=[];let s="";for(let a=0;a<t;a++){const t=e[a],n=t.charCodeAt(0);n>=48&&n<=57||"_"===t||"-"===t?s+=t:"("!==t&&")"!==t&&":"!==t&&","!==t||(""!==s&&(i.push(s),o.push("id"),s=""),i.push(t),o.push(t))}s.length>0&&(i.push(s),o.push("id"));const[a]=u(o,i);return Object.keys(d).length>300&&(d={}),d[e]=a,a}function c(e,t){const o=[];e.fwd_count?o.push({type:"mail",id:-t,object:{fwd_count:e.fwd_count}}):e.fwd&&o.push({type:"mail",id:-t,object:{fwd_count:l(e.fwd).length}});for(let t=1;e[`attach${t}_type`];++t)switch(e[`attach${t}_type`]){case"call":o.push({type:e[`attach${t}_type`],id:e[`attach${t}`],initiatorId:(0,i.intval)(e[`attach${t}_call_initiator_id`]),state:e[`attach${t}_call_state`],duration:(0,i.intval)(e[`attach${t}_call_duration`]),receiverId:(0,i.intval)(e[`attach${t}_call_receiver_id`])});break;case"doc":if("audiomsg"===e[`attach${t}_kind`]){const i=e.attachments?JSON.parse(e.attachments)[0]:{};o.push({type:e[`attach${t}_type`],kind:"audio_message",id:e[`attach${t}`],audio_message:i.audio_message});break}default:o.push({type:e[`attach${t}_type`],id:e[`attach${t}`],kind:e[`attach${t}_kind`],productId:e[`attach${t}_product_id`]})}return e.geo&&o.push({type:"geo",id:e.geo}),o}function p(e){return e.map((e=>{const t="audiomsg"===e[2]?"audio_message":e[2];return`${e[0]}:${e[1]}:${t}`})).join(",")}function m(e){return e>0&&(e|s.PINNED_CONVERSATION_BIT_MASK)===s.PINNED_CONVERSATION_BIT_MASK}function h(e){return new RegExp(`(^(https?:\\/\\/)?([a-z0-9_\\-.]+\\.)?${a.VK_SITE_REGEX_SOURCE_UNSAFE})?\\/onboarding_find_friends`).test(decodeURIComponent(e))}function y(e){return e.type===n.ADD_MESSAGE&&(0,r.isMarusiaPeer)(e.peerId)}},414299:(e,t,o)=>{"use strict";o.d(t,{getMessageFromTuple:()=>n,hasUserMentions:()=>r});var i=o(201683),s=o(699615),a=o(388078);const n=([e,t,o,n,r,_,u,d,l,c])=>{const p=Object.assign({},_||{},u||{});return Array.isArray(p.marked_users)&&(p.marked_users=p.marked_users.filter((e=>Object.values(i.MARKED_TYPE).includes(e[0])))),{messageId:e,flags:t,peerId:o,date:n,attaches:(0,s.convertKludgesToAttaches)(p,e),subject:p.title||"",text:r,kludges:p,randomId:d,userId:a.Ranges.isChatOrChannelPeer(o)?Number(p.from)||0:o,update_time:c,chat_local_id:l}};function r(e,t){return!!e.kludges&&(e.kludges.marked_users||[]).some((e=>{if(e[0]!==i.MARKED_TYPE.MENTIONS)return!1;switch(e[1]){case"all":return!0;case"online":return e[2].includes(t);default:return e[1].includes(t)}}))}},891911:(e,t,o)=>{"use strict";o.d(t,{ADD_MESSAGE:()=>d,CHANGE_PEER:()=>L,CHANGE_TAB:()=>B,CONVERSATION_UPDATED:()=>f,CONVO_MAJOR_ID_CHANGED:()=>$,CONVO_MINOR_ID_CHANGED:()=>G,DELETE_DIALOG:()=>F,EDIT_MESSAGE:()=>N,FAILED_MESSAGE:()=>R,FLAG_AUDIO_MESSAGE_LISTENED:()=>oe,FLAG_DELETED:()=>J,FLAG_DELETE_BY_TTL:()=>ie,FLAG_HAS_REACTIONS:()=>se,FLAG_HAS_REPLY:()=>te,FLAG_IMPORTANT:()=>Q,FLAG_OUTBOUND:()=>X,FLAG_SPAM:()=>Z,FLAG_STEALTH:()=>ee,FOLDER_AD_TAG:()=>re,FOLDER_HAS_BANNER:()=>ne,FOLDER_IMPORTANT:()=>ae,INVALIDATE_MESSAGE:()=>W,KEYBOARD_CALLBACK_RECEIVED:()=>b,MAIL_CHAT_UPDATE_TYPE_ADMIN_GRANTED:()=>_e,MAIL_CHAT_UPDATE_TYPE_ADMIN_KICKED:()=>me,MAIL_CHAT_UPDATE_TYPE_BANNER_CHANGED:()=>he,MAIL_CHAT_UPDATE_TYPE_BUSINESS_NOTIFY_DATA_CHANGED:()=>ge,MAIL_CHAT_UPDATE_TYPE_CALL_IN_PROGRESS_CHANGED:()=>ve,MAIL_CHAT_UPDATE_TYPE_CONTACT_CONVERTED:()=>Ee,MAIL_CHAT_UPDATE_TYPE_FLAGS_CHANGED:()=>ue,MAIL_CHAT_UPDATE_TYPE_IS_NEW_CHANGED:()=>Ae,MAIL_CHAT_UPDATE_TYPE_KEYBOARD_CHANGED:()=>ye,MAIL_CHAT_UPDATE_TYPE_MESSAGE_REQUEST_CHANGED:()=>fe,MAIL_CHAT_UPDATE_TYPE_PINNED:()=>de,MAIL_CHAT_UPDATE_TYPE_USER_JOINED:()=>le,MAIL_CHAT_UPDATE_TYPE_USER_KICKED:()=>pe,MAIL_CHAT_UPDATE_TYPE_USER_LEFT:()=>ce,MESSAGE_REQUEST_STATUS_ACCEPTED:()=>we,MESSAGE_REQUEST_STATUS_NEW:()=>Pe,MESSAGE_REQUEST_STATUS_REJECTED:()=>be,MUTEX:()=>k,NOTIFY_SETTINGS_CHANGED:()=>w,PEER_PROFILE_TAGS_CHANGED_EVENT:()=>Y,PEER_TAGS_CHANGED_EVENT:()=>q,REACTION_CREATE_OR_EDIT_EVENT:()=>z,READ_INBOUND:()=>l,READ_INBOUND_BY_CMID:()=>p,READ_OUTBOUND:()=>c,READ_OUTBOUND_BY_CMID:()=>h,RECONNECTED:()=>H,RECONNECTING:()=>V,RECORDING_AUDIO:()=>g,REFRESH_LP_KEY:()=>M,REPLACE_DIRECTORIES:()=>I,REPLACE_FLAGS:()=>_,REPLACE_MESSAGE:()=>U,RESEND:()=>x,RESET_DIRECTORIES:()=>T,RESET_FLAGS:()=>u,RESET_PEER:()=>S,RESYNC:()=>C,SET_DIRECTORIES:()=>O,SET_FLAGS:()=>r,TRANSITION:()=>D,TYPING:()=>E,UNREAD_COUNT:()=>A,UNREAD_REACTIONS:()=>m,WAITING_FOR_RECONNECT:()=>K,constructEvent:()=>a,mutexEvent:()=>De,readInboundByCmidEvent:()=>Ce,readInboundEvent:()=>Te,resetDirectoriesEvent:()=>Ie,resyncEvent:()=>Me,setDirectoriesEvent:()=>Oe});var i=o(414299),s=o(7144);function a(e){switch(e[0]){case 0:return function([,e]){return{type:n,localId:e}}(e);case 1:return function([,e,t,o]){return{type:_,messageId:e,mask:t,peerId:o}}(e);case 2:return function([,e,t,o]){return{type:r,messageId:e,flags:t,peerId:o}}(e);case 3:return function([,e,t,o]){return{type:u,messageId:e,flags:t,peerId:o}}(e);case 4:return function([,e,t,o,s,a,n,r,_,u,l,c]){return{type:d,...(0,i.getMessageFromTuple)([Number(e),Number(t),Number(s),Number(a),n,r,_,u,l,c]),minorSortId:o}}(e);case 5:return function([,e,t,o,s,a,n,r,_,u,d]){return{type:N,...(0,i.getMessageFromTuple)([Number(e),Number(t),Number(o),Number(s),a,n,r,_,u,d])}}(e);case 6:return Te(e);case 7:return function([,e,t,o]){return{type:c,peerId:e,upToId:t,unread:o}}(e);case 10:return Ie(e);case 11:return function([,e,t]){return{type:I,peerId:e,mask:t}}(e);case 12:return Oe(e);case 13:return function([,e,t,o]){return{type:F,peerId:e,localId:t,leaveChat:o}}(e);case 18:return function([,e,t,o,s,a,n,r,_,u,d]){return{type:U,...(0,i.getMessageFromTuple)([Number(e),Number(t),Number(o),Number(s),a,n,r,_,u,d])}}(e);case 19:return function([,e]){return{type:W,messageId:e}}(e);case 20:return function([,e,t]){return{type:$,peerId:e,majorId:t}}(e);case 21:return function([,e,t]){return{type:G,peerId:e,minorId:t}}(e);case 23:return function([,e,t]){return{type:q,peerId:e,peerTagsMask:t}}(e);case 51:return function([,e,t]){return{type:y,chatId:e,self:t}}(e);case 52:return function([,e,t,o]){return{type:f,peerId:t,updateType:e,updateArg:o}}(e);case 63:return function([,e,t,o,i]){return{type:E,peerId:e,userIds:t,totalCount:o,ts:i}}(e);case 64:return function([,e,t,o,i]){return{type:g,peerId:e,userIds:t,totalCount:o,ts:i}}(e);case 70:return function([,e,t]){return{type:v,userId:e,callId:t}}(e);case 80:return function([,e,t,o,i,s,a,n,r,_]){return{type:A,count:e,countNotMuted:t,showOnlyNotMuted:o,businessNotifyUnread:i,headerTotalUnread:s,headerNotMutedUnread:a,archiveUnreadCount:n,archiveUnreadUnmutedCount:r,archiveMentionsCount:_}}(e);case 114:return function([,e]){const{peer_id:t,sound:o,disabled_until:i}=e||{};return{type:w,peerId:t,sound:o,disabledUntil:i}}(e);case 115:return function([,e]){return{type:j,payload:e}}(e);case 119:return function([,e]){const{event_id:t,owner_id:o,peer_id:i,action:s}=e;return{type:b,event_id:t,owner_id:o,peer_id:i,action:s}}(e);case 120:return function([]){return{type:Y}}(e);case 601:return function([,e,...t]){const o=[],i=1===e?t.splice(2,1).pop():void 0,[s,a,n,...r]=t;for(let e=0;e<n;e++){const e=r.shift(),[t,i,,...s]=r.splice(0,e);o.push({reaction_id:t,count:i,...s?{user_ids:s}:void 0})}return{type:z,subtype:e,peerId:s,cmid:a,reactionsCount:n,reactionCounters:o,...i?{reactionId:i}:void 0}}(e);case 602:return function([,e,t,...o]){return{type:m,peerId:e,totalCount:t,cmids:o}}(e);case 10006:return Ce(e);case 10007:return function([,e,t,o]){return{type:h,peerId:e,upToCmid:t,unread:o}}(e);case-1:return Me();case-2:return function([,e,t]){return{type:M,key:e,url:t}}(e);case-3:return function([,e]){return{type:K,timeout:e}}(e);case-4:return{type:V};case-5:return{type:H};default:return function(e){return{type:P,params:e}}(e)}}const n="event_delete",r="event_set_flags",_="event_replace_flags",u="event_reset_flags",d="event_add_message",l="event_read_inbound",c="event_read_outbound",p="event_read_inbound_by_cmid",m="event_unread_reactions",h="event_read_outbound_by_cmid",y="event_chat_changed",f="event_chat_updated",E="event_typing",g="event_recoding_audio",v="event_video_call",A="event_unread_count",w="event_notify_settings_changed",b="event_keyboard_callback_received",P="event_empty",T="event_reset_directories",I="event_replace_directories",O="event_set_directories",C="event_resync",M="event_refresh_lp_key",D="transition_event",S="reset_peer",k="mutex",L="change_peer",B="event_change_tab",R="event_failed_message",x="event_resend",F="event_delete_dialog",N="event_edit_message",U="event_replace_message",W="event_invalidate_event",K="event_waiting_for_reconnect",V="event_reconnecting",H="event_reconnected",j="incoming_call",$="event_convo_major_id_changed",G="event_convo_minor_id_changed",q="peer_tags_changed",Y="peer_profile_tags_changed",z="reaction_create_or_edit",X=2,Q=8,Z=64,J=128,ee=65536,te=1<<21,oe=4096,ie=1<<22,se=1<<24,ae=1,ne=8,re=32768,_e=3,ue=4,de=5,le=6,ce=7,pe=8,me=9,he=10,ye=11,fe=12,Ee=13,ge=14,ve=19,Ae=22,we=1,be=2,Pe=3;function Te([,e,t,o]){return{type:l,peerId:e,upToId:t,unread:o}}function Ie([,e,t,o=!1]){return{type:T,peerId:e,mask:t,local:o}}function Oe([,e,t,o=!1]){return{type:O,peerId:e,mask:t,local:o}}function Ce([,e,t,o]){return{type:p,peerId:e,upToCmid:t,unread:o}}function Me(){return{type:C}}function De([,e,t,o,i,a]){return{type:k,free:!!(0,s.intval)(e)||(0,s.intval)(i)===window.vk.id,resource:t,peerId:(0,s.intval)(o),who:(0,s.intval)(i),name:a}}},201683:(e,t,o)=>{"use strict";var i,s;o.d(t,{AttachmentType:()=>s,MARKED_TYPE:()=>i}),function(e){e[e.MENTIONS=1]="MENTIONS",e[e.CASPER=2]="CASPER"}(i||(i={})),function(e){e.REPLY="reply",e.DOCUMENT="doc",e.MAIL="mail",e.CALL="call",e.STICKER="sticker",e.UGC_STICKER="ugc_sticker"}(s||(s={}))},216147:(e,t,o)=>{"use strict";o.d(t,{ColorScheme:()=>_,ColorSchemeMode:()=>r.ColorSchemeMode,ColorSchemeName:()=>r.ColorSchemeName,colorScheme:()=>u});var i,s=o(772546),a=o(705744),n=o(490712),r=o(312258);!function(e){e.DARK="dark",e.LIGHT="light"}(i||(i={}));class _{init(e){if(this.isExecuted)return;if(this.schemesMap=e.schemesMap,this.setMode(e.mode),this.initSubscribers.forEach((e=>{e()})),(0,n.statlogsValueEvent)("web_dark_theme",this.getMode(),this.getScheme(),Number(this.isDarkScheme())),!_.isSchemesAutoSwitchingSupported())return;window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(e=>{this.currentMode===r.ColorSchemeMode.Auto&&this.setScheme(e.matches)})),this.isExecuted=!0}setScheme(e){_.isSchemesSupported()&&(this.applyScheme(document.body,e?r.ColorSchemeName.Dark:r.ColorSchemeName.Light),this.currentIsDark=e,document.querySelector("meta[name=theme-color]")?.setAttribute("content",e?r.SchemeColors.Dark:r.SchemeColors.Light),document.querySelector("meta[name=color-scheme]")?.setAttribute("content",e?"dark":"light"),this.isSchemeSavingAllowed&&(0,s.setCookie)("remixdark_color_scheme",Number(e),365),this.subscribers.forEach((e=>{e()})))}static getAppearanceByScheme(){switch(document.body.getAttribute("scheme")){case r.ColorSchemeName.Dark:case r.ColorSchemeName.WebDark:return"dark"}return"light"}isDarkScheme(){return this.currentIsDark}getMode(){return this.currentMode}setMode(e){let t=!1;switch(e){case r.ColorSchemeMode.Light:t=!1;break;case r.ColorSchemeMode.Dark:t=!0;break;case r.ColorSchemeMode.Auto:if(_.isSchemesAutoSwitchingSupported()){t=window.matchMedia("(prefers-color-scheme: dark)").matches}else e=r.ColorSchemeMode.Light}this.currentMode=e,this.setScheme(t),this.isModeSavingAllowed&&(0,s.setCookie)("remixcolor_scheme_mode",e,365)}getScheme(){return(0,a.isMvk)()?this.getMVKScheme():this.getWebScheme()}getMVKScheme(){return this.isDarkScheme()?r.ColorSchemeName.Dark:r.ColorSchemeName.Light}getWebScheme(){return this.isDarkScheme()?r.ColorSchemeName.WebDark:r.ColorSchemeName.WebLight}applyScheme(e,t){const o=this.schemesMap?.[t]||t;e.setAttribute("scheme",o)}subscribe(e){return this.subscribers.push(e),()=>{this.subscribers=this.subscribers.filter((t=>e!==t))}}onInit(e){return this.initSubscribers.push(e),()=>{this.initSubscribers=this.initSubscribers.filter((t=>e!==t))}}static isSchemesSupported(){return window.CSS&&CSS.supports&&CSS.supports("color","var(--custom-property)")}static isSchemesAutoSwitchingSupported(){return window.matchMedia&&window.matchMedia("(prefers-color-scheme)").matches}constructor(){this.subscribers=[],this.initSubscribers=[],this.isExecuted=!1,this.isModeSavingAllowed=!0,this.isSchemeSavingAllowed=!0}}let u;u=window.colorScheme?window.colorScheme:new _,window.colorScheme=u,window.isSchemesSupported=_.isSchemesSupported.bind(null)},507607:(e,t,o)=>{"use strict";o.d(t,{asyncComponent:()=>a});var i=o(296540),s=o(8520);function a(e,t){return(0,i.lazy)((()=>(0,s.asyncImportLoader)(e,3).then((e=>({default:t(e)})))))}},106149:(e,t,o)=>{"use strict";function i(e){return navigator.clipboard?function(e){return navigator.clipboard.writeText(e)}(e):(s(e),Promise.resolve())}function s(e){const t=document.createElement("input"),o=document.activeElement;t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),o.focus()}o.d(t,{_copyWithFakeElement:()=>s,copyToClipboard:()=>i})},178487:(e,t,o)=>{"use strict";function i(e,t){let o;e=Math.max(e,0);const i=Math.floor(e%60);o=i<10?"0"+i:i;const s=(e=Math.floor(e/60))%60;return o=s+":"+o,((e=Math.floor(e/60))>0||t)&&(s<10&&(o="0"+o),o=e+":"+o),o}o.d(t,{formatTime:()=>i})},969621:(e,t,o)=>{"use strict";o.d(t,{dedupeAsyncCallback:()=>s});var i=o(8520);function s(e,t=((...e)=>e)){const o=new Map;return(...s)=>{const a=t(...s);for(const[e,t]of o.entries())if((0,i.isEqual)(a,e))return t;const n=e(...s);return o.set(a,n),n.finally((()=>{o.delete(a)})),n}}},714707:(e,t,o)=>{"use strict";o.d(t,{NarrativeAnalyticEventType:()=>i,NarrativeAnalyticNavScreen:()=>s,sendNarrativeAnalytic:()=>r});var i,s,a=o(490712),n=o(476726);function r(e,t,o="other"){const i=t?.title||void 0,s=t?.customCover?0:t?.coverStoryId||0,r=t?.id||0,_=t?.ownerId||0,u=t?.stories?.map((e=>e.id)),d={event_type:e,nav_screen:o,narrative_owner_id:_,narrative_id:r,narrative_title:i,story_ids:u?.length?u:void 0,cover_story_id:s};(0,a.statlogsValueEvent)("narrative_product_analytic",d),(0,n.partConfigEnabled)("narratives_web_analytic_debug")&&console.log("-- narrative analytic",d)}!function(e){e.clickToAddToNarrative="click_to_add_to_narrative",e.addStoryToNarrative="add_story_to_narrative",e.openNarrativeList="open_narrative_list",e.close="close",e.changeSort="change_sort",e.publishNarrative="publish_narrative",e.createNarrative="create_narrative",e.deleteNarrative="delete_narrative",e.clickToEditNarrative="click_to_edit_narrative",e.editNarrative="edit_narrative",e.addToBookmarks="add_to_bookmarks",e.shareNarrative="share_narrative",e.seeMore="see_more",e.addToNarrativeFromActionSheet="add_to_narrative_from_action_sheet"}(i||(i={})),function(e){e.storyArchive="story_archive",e.storyViewer="story_viewer",e.profile="profile",e.feedBlock="narratives_feed_block",e.club="club",e.other="other"}(s||(s={}))},547754:(e,t,o)=>{"use strict";o.d(t,{logQuestionError:()=>i});const i=(0,o(953430).createSentryLogger)({debugPrefix:"[Questions Sentry Logger]"})},909075:(e,t,o)=>{"use strict";o.d(t,{QuestionsStatCollector:()=>_});var i=o(581903),s=o(695290),a=o(476726),n=o(789176),r=o(238540);class _{logClickEvent(e,t={}){const o={type:s.ClickProductionStatEventTypes.TYPE_QUESTION_ITEM,[s.ClickProductionStatEventTypes.TYPE_QUESTION_ITEM]:{type:e,screen:t.navScreen||window.cur.module||""}};t.questionReceiverId&&(o[s.ClickProductionStatEventTypes.TYPE_QUESTION_ITEM].question_receiver_id=t.questionReceiverId),t.questionAuthorId&&(o[s.ClickProductionStatEventTypes.TYPE_QUESTION_ITEM].question_author_id=t.questionAuthorId),t.questionText&&(o[s.ClickProductionStatEventTypes.TYPE_QUESTION_ITEM].question_text=t.questionText);const i={type:s.EventItemType.QUESTION,id:t.questionId||0};(0,a.partConfigEnabled)("profile_questions_analytic_debug")&&console.log(`--${e}`,o,i),this.clickStatCollector.logEvent(o,i)}logOpeningEvent(e,t,o){let i;switch(t){case r.QuestionsBoxRef.STORY:i=o===n.QuestionAnalyticBoxName.askQuestion?n.QuestionAnalyticEventType.openAskQuestionFromStory:n.QuestionAnalyticEventType.openMyQuestionsFromStory;break;case r.QuestionsBoxRef.SNIPPET:i=o===n.QuestionAnalyticBoxName.askQuestion?n.QuestionAnalyticEventType.openAskQuestionFromSnippet:n.QuestionAnalyticEventType.openMyQuestionsFromSnippet;break;default:i=o===n.QuestionAnalyticBoxName.askQuestion?n.QuestionAnalyticEventType.openAskQuestionFromUrl:n.QuestionAnalyticEventType.openMyQuestionsFromUrl}const s={questionReceiverId:e};o===n.QuestionAnalyticBoxName.askQuestion&&(s.questionAuthorId=window.vk.id),this.logClickEvent(i,s)}constructor(){this.productionStatCollector=new i.ProductionStatCollector,this.clickStatCollector=new i.ClickStatCollector(this.productionStatCollector)}}},731709:(e,t,o)=>{"use strict";o.d(t,{logQuestionsClickEvent:()=>s,logQuestionsOpeningEvent:()=>a});const i=new(o(909075).QuestionsStatCollector);function s(e,t={}){i.logClickEvent(e,t)}function a(e,t,o){i.logOpeningEvent(e,t,o)}},789176:(e,t,o)=>{"use strict";var i,s;o.d(t,{QuestionAnalyticBoxName:()=>s,QuestionAnalyticEventType:()=>i}),function(e){e.clickToQuestion="click_to_question",e.reply="reply",e.replyAgain="reply_again",e.sharing="sharing",e.shareToStory="share_to_story",e.shareToWall="share_to_wall",e.shareToGroup="share_to_group",e.shareToIm="share_to_im",e.copyLink="copy_link",e.openStory="open_story",e.callFriends="call_friends",e.openSettings="open_settings",e.openProfile="open_profile",e.block="block",e.unblock="unblock",e.deleteAllQuestions="delete_all_questions",e.delete="delete",e.cancelDelete="cancel_delete",e.cancelDeleteAllAuthorQuestions="cancel_delete_all_author_questions",e.cancelDeleteAllAnonymousQuestions="cancel_delete_all_anonymous_questions",e.next="next",e.close="close",e.clickToSend="click_to_send",e.sendQuestion="send_question",e.cancelSendQuestion="cancel_send_question",e.cancelWriteAnswer="cancel_write_answer",e.closeMyQuestions="close_my_questions",e.openMyQuestionsFromUrl="open_my_questions_from_url",e.openAskQuestionFromUrl="open_ask_question_from_url",e.openMyQuestionsFromSnippet="open_my_questions_from_snippet",e.openAskQuestionFromSnippet="open_ask_question_from_snippet",e.openMyQuestionsFromStory="open_my_questions_from_story",e.openAskQuestionFromStory="open_ask_question_from_story"}(i||(i={})),function(e){e[e.askQuestion=0]="askQuestion",e[e.myQuestions=1]="myQuestions"}(s||(s={}))},432654:(e,t,o)=>{"use strict";o.d(t,{parseReactWikiLinks:()=>l});var i=o(474848),s=o(296540),a=o(765668),n=o(408063);const r={target:"_self",withVKUILink:!1,withNewRegex:!1,wrapAwayIfExternal:!1},_=new RegExp(`\\[?(${/(?:http(s)?:\/\/)/.source}?${/[\w.-]+(?:\.[\w.-]+)+[\w\-._~:/?#[\]@!$&'()*+,;=.]+/.source})${/(?:\|([\wёЁА-я ]{1,}))/.source}?\\]?`),u=new RegExp(`(${_.source}|${/\[(id|public|club|event)-?[\d]{1,}\|[\wёЁА-я ]{1,}\]/.source})`,"gi"),d=/^(http(s)?:\/\/)?vk.(com|ru)/gi;function l(e,t=r){const{target:o=r.target,withVKUILink:_=r.withVKUILink}=t,l=e.match(t.withNewRegex?u:/\[(.*?)\]/g),c=l?l.map((e=>e.replace(/\[|(.*?)\]/g,"$1"))):[];if(!l||!c.length)return(0,i.jsx)(s.Fragment,{children:e});const p=_?a.Link:"a",m=c.map(((e,s)=>{const[a,r]=e.split("|");let _=t.hrefMap?.[a]||(d.test(a)?a.replace(d,""):a);const u=t.onClickMap?.[a];return t.wrapAwayIfExternal&&(_=(0,n.wrapAwayIfExternal)(_)),(0,i.jsx)(p,{href:_,target:o,onClick:u,children:r||a},s)})),h=[];return l.forEach(((t,o)=>{const i=e.indexOf(t);h.push(e.substr(0,i)),h.push(m[o]),e=e.slice(i+t.length)})),h.push(e),(0,i.jsx)(s.Fragment,{children:h})}},381263:(e,t,o)=>{"use strict";function i(e,t){let o,i=t.timeout,s=t.onLoad,a=t.onError,n=document.createElement("script");if(n.addEventListener("load",r),n.addEventListener("readystatechange",r),n.addEventListener("error",_),t.attributes)for(const[e,o]of Object.entries(t.attributes))null==o||("boolean"==typeof o?n.toggleAttribute(e,o):n.setAttribute(e,o));function r(){n.readyState&&"loaded"!==n.readyState&&"complete"!==n.readyState||(u(),s&&s())}function _(){u(),a&&a()}function u(){clearTimeout(o),n.removeEventListener("load",r),n.removeEventListener("readystatechange",r),n.removeEventListener("error",_)}return n.src=e,document.head.appendChild(n),i&&(o=setTimeout(_,i)),{destroy:function(){u()}}}o.d(t,{loadScript:()=>i})},970577:(e,t,o)=>{"use strict";o.d(t,{marusiaAudioStats:()=>_});var i=o(476726),s=o(668592),a=o(777892),n=o(190708);class r{startLoop(){this.stopLoop(),this.sendIsPlayingInterval=setInterval(this.sendTrackPlaying.bind(this),r.SEND_IS_PLAYING_INTERVAL),this.currentTrackStartPlayTimeMs=this.getCurrentTime()}getCurrentTime(){return(new Date).getTime()}stopLoop(){this.sendIsPlayingInterval&&(clearInterval(this.sendIsPlayingInterval),this.sendIsPlayingInterval=null),this.currentTrackStartPlayTimeMs=null}sendTrackPlaying(){if(!this.playerAdapter)return void this.stopLoop();if(!this.playerAdapter.isMarusiaTrack())return void this.stopLoop();const e=this.playerAdapter.getAudio();e?(this.sendDeviceStatEvent(n.PlayerDeviceStatEventType.TRACK_PLAYING,n.ActivationSource.playback,e),this.sendPlayerStatusEvent("PLAY",e)):this.stopLoop()}sendPlayerStatusEvent(e,t){if(!this.playerAdapter||!this.currentTrackStartPlayTimeMs)return;const o=(0,s.getAudioExtra)(t)?.voiceAssistant;if(!o)return;const i=o.source?.url??t.url,a=o.source?.skill_name??r.GLOBAL,n={meta:{source:o.source,title:t.title,url:i},url:i,volume:this.playerAdapter.getVolume(),repeat:this.playerAdapter.isRepeatCurrentAudio(),state:e,updated:(new Date).getTime()/1e3,position:this.playerAdapter.getTrackPosition(),elapsed:this.playerAdapter.getProgressInSeconds(),duration:t.duration,created:this.currentTrackStartPlayTimeMs,skill:a,random:this.playerAdapter.isShuffledPlaylist()};this.api.sendPlayerStatus(a,n)}sendDeviceStatEvent(e,t,o){if(!o||!this.playerAdapter)return;const i=(0,s.getAudioExtra)(o)?.voiceAssistant;if(!i)return;const a={type:e,phrase_id:i.source?.phrase_id??"",timestamp:Math.round((new Date).getTime()/1e3),data:{track_id:i.track_id??"",position:this.playerAdapter.getProgress(),duration:this.playerAdapter.getAudio().duration,activated_by:t,source_type:i.source?.type??"",flags:i.flags??"",playback_duration:this.playerAdapter.getListenedTime(),audio_type:i.source?.media_type??""}};this.api.sendDeviceStat([a])}getActivatedBy(e,t){switch(e){case n.PlayerDeviceStatEventType.TRACK_STOP:return n.ActivationSource.os_system;case n.PlayerDeviceStatEventType.TRACK_START:case n.PlayerDeviceStatEventType.TRACK_RESUME:if(t.isAutoPlayed())return n.ActivationSource.playback;return t.getSequence()?n.ActivationSource.playback:n.ActivationSource.app_ui;default:return n.ActivationSource.os_system}}onPlay(e){if(!(0,i.partConfigEnabled)("marusia_web_music_stats"))return;this.playerAdapter=e;const t=this.playerAdapter.getAudio();if(!t)return;const o=t.fullId,s=this.currentAudioId===o;this.currentAudioId=o,!s&&this.currentAudio&&this.onEnded(e,this.currentAudio),this.currentAudio=t;const a=s?n.PlayerDeviceStatEventType.TRACK_RESUME:n.PlayerDeviceStatEventType.TRACK_START,r=e.isAutoPlayed()?n.ActivationSource.playback:n.ActivationSource.app_ui;this.sendDeviceStatEvent(a,r,t),this.sendPlayerStatusEvent("PLAY",t),this.startLoop()}onPause(e){if(!(0,i.partConfigEnabled)("marusia_web_music_stats"))return;this.playerAdapter=e;const t=this.playerAdapter.getAudio();t&&(this.sendDeviceStatEvent(n.PlayerDeviceStatEventType.TRACK_PAUSE,n.ActivationSource.os_system,t),this.sendPlayerStatusEvent("PAUSE",t),this.stopLoop())}onEnded(e,t){(0,i.partConfigEnabled)("marusia_web_music_stats")&&(this.playerAdapter=e,t&&(this.sendDeviceStatEvent(n.PlayerDeviceStatEventType.TRACK_STOP,n.ActivationSource.os_system,t),this.sendPlayerStatusEvent("STOP",t),this.stopLoop()))}constructor(){this.api=new a.MarusiaSharedApi,this.sendIsPlayingInterval=null,this.playerAdapter=null,this.currentTrackStartPlayTimeMs=null,this.currentAudioId=null,this.currentAudio=null}}r.SEND_IS_PLAYING_INTERVAL=15e3,r.GLOBAL="__global__";const _=new r},777892:(e,t,o)=>{"use strict";o.d(t,{MarusiaSharedApi:()=>u});var i=o(933052),s=o(381081),a=o(223597),n=o(634180),r=o(231794);const _="https://vc.go.mail.ru";class u{generateDeviceId(){return(0,a.generateDeviceId)("vk_web",this.debug)}processBackendCommands(e,t){const o={phrase_id:e,command_ids:JSON.stringify(t)};return(0,i.api)("marusia.processCommands",o)}getSuggests(e){const t={has_unread_messages:Number(e)};return(0,i.api)("marusia.getSuggests",t)}getWebStatic(){return(0,i.api)("marusia.getWebStatic",{})}getWebSession(e){const t={device_id:e};return(0,i.api)("marusia.getWebSession",t)}revokeWebSession(e){const t={device_id:e};return(0,i.api)("marusia.revokeWebSession",t)}getLastMessageCommands(){return(0,i.api)("marusia.getLastMessageCommands",{})}sendStartSessionEvent(){return(0,i.api)("marusia.sendStartSessionEvent",{})}getOnboarding(){return(0,i.api)("marusia.getOnboarding",{})}async isBackendCommand(e){const t=(await this.getInitConfig()).marusiaBackendCommands?.commands;return!t||t.some((t=>"media"===e.type?"vk"===e.meta?.source?.type&&(e.type===t.type&&e.media_type===t.media_type):("playlist"!==e.type||"vk"===e.tracks[0]?.meta?.source?.type)&&e.type===t.type))}getInitConfig(){return null===this.initConfigCache&&(this.initConfigCache=(0,i.api)("marusia.getInitConfig",{device_id:this.generateDeviceId(),tts_type:"mp3"})),this.initConfigCache}sendMessage(e,t,o){return(0,i.api)("messages.send",{peer_id:e,random_id:Math.round(2147483647*Math.random()),payload:JSON.stringify(o),message:t})}reloadAudios(e){return Promise.resolve([])}getApiHost(){return this.getInitConfig().then((e=>e.marusiaServerType?e.marusiaServerType:{server_url:_,skill:""}))}async makeRequest(e,t={},o={}){const i=await(0,s.getSession)(this),a=await this.getApiHost(),r=a.server_url,u=this.generateDeviceId(),d=(await this.getInitConfig()).maskedChatId,l={...t,dialog_mode:"vk_bot",session_id:i.session_id,device_id:u,chat_id:":vk:chat:"+d};r!==_&&(l.skillserver_type=a.skill);const c=new URLSearchParams(l).toString();let p=!0,m=null;try{m=await fetch(`${r}/${e}?${c}`,{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i.session_secret}`},...o}),400===m.status&&(p=!1,m=null)}catch{}if(!p)return await(0,s.revokeSession)(this),this.makeRequest(e,t,o);if(!m)throw new Error(n.MarusiaError.API_ERROR);return m.json()}async getPreparedCapabilities(){const e=(await this.getInitConfig()).capabilities.capabilities2;let t={};return e&&(t=e.reduce(((e,t)=>({...e,[t.capability]:t.enabled})),{})),t}async getDefaultOptions(e){const t=await this.getPreparedCapabilities();return{body:JSON.stringify({...e,capabilities2:{capabilities:t}})}}async addChunk(e,t,o=!1,i,s){const a={last:o?1:0,phrase_id:e,chunk_num:t},n={signal:s,body:i};return(await this.makeRequest("phrase/add",a,n)).result}async createAsrPhrase(e,t){const o={};e&&(o.player_data=e);const i=await this.getDefaultOptions(o);return t&&(i.signal=t),this.makeRequest("phrase/create",{no_kw:1},i)}async phraseCreateText(e,t,o){const i={text:e,refuse_tts:1},s=t??{};o&&(s.player_data=o);const a=await this.getDefaultOptions(s);return this.makeRequest("phrase/create/text",i,a)}async phraseCreateEvent(e,t,o){const i={event:e,refuse_tts:1},s=t??{};o&&(s.player_data=o);const a=await this.getDefaultOptions(s);return this.makeRequest("phrase/create/event",i,a)}async getPhraseResult(e){const t={phrase_id:e,capabilities2:JSON.stringify({capabilities:await this.getPreparedCapabilities()})};return this.makeRequest("phrase/result",t,{method:"GET"})}async upgradeToken(e){const t={app_id:r.MARUSIA_APP_ID},o={body:JSON.stringify({phrase_info:e.phrase_info})};return this.makeRequest("account/vk/upgrade_token",t,o)}sendDeviceStat(e){const t={body:JSON.stringify({events:e})};return this.makeRequest("device/stat",{},t)}sendPlayerStatus(e,t){const o={as_global:1,skill_id:e},i={body:JSON.stringify(t)};return this.makeRequest("player/status",o,i)}skillList(e){const t={category:e,size:10,page:0,use_all_platforms:0};return this.makeRequest("skill_list",t,{method:"GET"})}skillListCategories(){return this.makeRequest("skill_list/categories",{add_featured:1,use_all_platforms:0},{method:"GET"})}constructor(e){this.debug=!1,this.initConfigCache=null,this.debug=!!e}}},231794:(e,t,o)=>{"use strict";o.d(t,{MARUSIA_APP_ID:()=>i});const i=6463690},223597:(e,t,o)=>{"use strict";o.d(t,{generateDeviceId:()=>n});var i=o(8520),s=o(134015);const a="marusia-device-id";function n(e,t){let o=i.localStorage.getItem(a);if(!o){o=`:${t?"d":"c"}:${"chat"}:${e}:${(0,s.uuid)(32)}`,i.localStorage.setItem(a,o)}return o}},381081:(e,t,o)=>{"use strict";let i;o.d(t,{getSession:()=>a,revokeSession:()=>r});let s=3;async function a(e){if(!i){const t=e.generateDeviceId();i=e.getWebSession(t)}try{return await i}catch(t){if(console.error("get session error",t),s<3)return s+=1,n(),a(e);throw new Error("get session error")}}function n(){i=void 0}function r(e){return n(),e.revokeWebSession(e.generateDeviceId())}},634180:(e,t,o)=>{"use strict";var i,s;o.d(t,{CommunicationType:()=>i,MarusiaError:()=>s}),function(e){e.kws="kws",e.listen_command="listen_command",e.button="button",e.text="text",e.suggest="suggest",e.skill="skill",e.widget="widget",e.other="other"}(i||(i={})),function(e){e.HIDDEN="HIDDEN",e.BACKEND_COMMAND_TIMEOUT="BACKEND_COMMAND_TIMEOUT",e.USER_INTERRUPT="USER_INTERRUPT",e.ATTACH_LOAD_TIMEOUT="ATTACHES_LOAD_TIMEOUT",e.API_ERROR="API_ERROR"}(s||(s={}))},255944:(e,t,o)=>{"use strict";var i;o.d(t,{MarusiaMediaType:()=>i}),function(e){e[e.music=1]="music",e[e.radio=2]="radio",e[e.noise=3]="noise",e[e.tale=4]="tale",e[e.podcast=5]="podcast",e[e.books=6]="books",e[e.video=8]="video"}(i||(i={}))},190708:(e,t,o)=>{"use strict";var i,s;o.d(t,{ActivationSource:()=>s,PlayerDeviceStatEventType:()=>i}),function(e){e.TRACK_START="player.track_start",e.TRACK_STOP="player.track_stop",e.TRACK_RESUME="player.track_resume",e.TRACK_PAUSE="player.track_pause",e.TRACK_PLAYING="player.track_playing"}(i||(i={})),function(e){e.playback="playback",e.backend_new_media="backend_new_media",e.backend_controls="backend_controls",e.os_ui="os_ui",e.os_system="os_system",e.app_ui="app_ui",e.playback_limit="playback_limit"}(s||(s={}))},134015:(e,t,o)=>{"use strict";o.d(t,{MARUSIA_PEER_ID:()=>i,disableMarusiaTextInput:()=>r,enableMarusiaTextInput:()=>_,getSuggestContentForApi:()=>d,isPayloadForCommand:()=>a,isSuggestCommand:()=>n,parseBase64JSON:()=>u,replaceSpecialPhrases:()=>l,uuid:()=>s});o(255944),o(891911);const i=-194070336;function s(e=32){return[...Array(e).keys()].reduce((e=>`${e}${Math.floor(16*Math.random()).toString(16)}`),"")}function a(e,t){if(!e.voice_assistant)return!1;const o=e.voice_assistant;return!(o.phrase_id!==t.phraseId||(i=o.command_ids,s=t.commandIds,i.length!==s.length||!i.every((e=>s.includes(e)))));var i,s}function n(e){return["text_suggest","event_suggest","url_suggest"].includes(e.type)}function r(e){e.contentEditable="false",e.classList.add("im-chat-input--text_disabled")}function _(e){e.contentEditable="true",e.classList.remove("im-chat-input--text_disabled")}function u(e){let t=null;if(e)try{t=JSON.parse(atob(e))}catch(e){console.error("Failed to parse JSON")}return t}function d(e){let t="";return"event_suggest"===e.type&&(t=e.text),"text_suggest"===e.type&&(t=e.payload),l(t)}function l(e){return e.replace("#DISLIKE#","👎🏻").replace("#LIKE#","👍🏻")}},65365:(e,t,o)=>{"use strict";o.d(t,{AuxiliaryPerformanceStatsEventName:()=>i.AuxiliaryPerformanceStatsEventName,LeavingFeedEventName:()=>s.LeavingFeedEventName,PerformanceStatsEventName:()=>i.PerformanceStatsEventName,SHARED_STATE_KEY:()=>a});var i=o(125005),s=o(790678);const a="performance-stats"},790678:(e,t,o)=>{"use strict";var i;o.d(t,{LeavingFeedEventName:()=>i}),function(e){e.navigation_from_feed="navigation_from_feed",e.navigation_from_feed_skeleton_off="navigation_from_feed_skeleton_off",e.navigation_from_feed_skeleton_on="navigation_from_feed_skeleton_on",e.navigation_from_feed_before_page_load="navigation_from_feed_before_page_load",e.navigation_from_feed_after_page_load="navigation_from_feed_after_page_load",e.stay_in_feed="stay_in_feed"}(i||(i={}))},125005:(e,t,o)=>{"use strict";var i,s;o.d(t,{AuxiliaryPerformanceStatsEventName:()=>s,PerformanceStatsEventName:()=>i}),function(e){e.render="render",e.render_without_ttfb="render_without_ttfb",e.render_content="render_content",e.render_content_without_ttfb="render_content_without_ttfb",e.render_content_after_skeleton="render_content_after_skeleton",e.render_content_after_skeleton_without_ttfb="render_content_after_skeleton_without_ttfb",e.render_skeleton="render_skeleton",e.render_skeleton_without_ttfb="render_skeleton_without_ttfb",e.render_content_after_skeleton_without_skeleton="render_content_after_skeleton_without_skeleton",e.paint_content_html="paint_content_html",e.paint_content_html_without_ttfb="paint_content_html_without_ttfb",e.paint_skeleton_html="paint_skeleton_html",e.paint_skeleton_html_without_ttfb="paint_skeleton_html_without_ttfb",e.render_content_after_skeleton_without_paint_content_html="render_content_after_skeleton_without_paint_content_html",e.render_skeleton_without_paint_skeleton_html="render_skeleton_without_paint_skeleton_html",e.load_performance_stats_chunk="load_performance_stats_chunk",e.request_content_after_skeleton="request_content_after_skeleton",e.waiting_for_content_1sec="waiting_for_content_1sec",e.waiting_for_content_3sec="waiting_for_content_3sec",e.waiting_for_content_6sec="waiting_for_content_6sec"}(i||(i={})),function(e){e.TTFB="TTFB"}(s||(s={}))},349471:(e,t,o)=>{"use strict";o.d(t,{calculateTimeDeltaFromPriorEvent:()=>h,collectStoryTechStatsEvent:()=>c,getStoryTechStatsEvent:()=>p,resetStoryTechStatsStorage:()=>y,saveStoryTechStatsEvent:()=>m});var i=o(278962),s=o(965912),a=o(723919),n=o(169834),r=o(728621),_=o(416206),u=o(961667);const d=new s.BenchmarkMainStatCollector,l=(0,r.createDebugConsole)("__stories_perf_metrics_debug_logs"),c=e=>{(0,u.isTechStoryStatsEnabled)()&&(l.log(`StoriesPerfStats: collecting event "${e.event_type}"\n`,e),n.StoryEventTypeDebugTypes.has(e.event_type)||d.logEvent({...d.getBaseEvent(),type:i.BenchmarkMainStatEventTypes.STORY_VIDEO_ITEM,[i.BenchmarkMainStatEventTypes.STORY_VIDEO_ITEM]:{...e,metric_value:e.metric_value?Math.round(e.metric_value):void 0,network_info:{network_effective_type:a.default.getConnectionEffectiveType()}}}))},p=(e,t)=>_.getStoryTechStatsEvent(e,t),m=(e,t,o=!1)=>{_.saveStoryTechStatsEvent(e,t),o&&c(e)};function h(e,t,o=performance.now()){return _.calculateTimeDeltaWithSavedEvent(e,t,!1,o)}const y=(e,t)=>{_.dropSavedStoryTechStatsEvent(e,t)}},416206:(e,t,o)=>{"use strict";o.d(t,{calculateTimeDeltaWithSavedEvent:()=>d,dropSavedStoryTechStatsEvent:()=>l,getStoryTechStatsEvent:()=>_,saveStoryTechStatsEvent:()=>u});var i=o(942451),s=o(169834),a=o(961667);const n=(0,i.makeSharedState)(s.STORY_TECH_STATS_STORAGE_NAME,(()=>new Map),{version:1});function r(e,t){if(!(0,a.isTechStoryStatsEnabled)())return null;const o=n().get(t)?.get(e);return o||null}function _(e,t){const o=r(e,t);return o?o.event:null}function u(e,t){if(!(0,a.isTechStoryStatsEnabled)())return;const o=e.event_type,i=n();let s=i.get(t);s||(s=new Map,i.set(t,s)),s.set(o,{at:performance.now(),event:e})}function d(e,t,o=!1,i=performance.now()){const s=r(e,t);if(!s)return null;const a=s.at,n=s.event.metric_value||0,_=o?n:a;return _<=i?i-_:null}function l(e,t){const o=n(),i=o.get(e);void 0!==i&&(void 0!==t&&i.delete(t),void 0!==t&&0!==i.size||o.delete(e))}},961667:(e,t,o)=>{"use strict";o.d(t,{isTechStoryStatsEnabled:()=>s});var i=o(476726);const s=()=>(0,i.partConfigEnabled)("tech_stories_metrics_web_mvk")},169834:(e,t,o)=>{"use strict";o.d(t,{STORY_TECH_STATS_STORAGE_NAME:()=>i,StoryErrorType:()=>n,StoryEventType:()=>r,StoryEventTypeDebugTypes:()=>_,StoryTypeNext:()=>a,StoryTypeOpen:()=>s});const i="story_tech_stats_storage";var s,a,n,r;!function(e){e.OPEN_STORY_BY_CLICK="OPEN_STORY_BY_CLICK",e.NEXT_OPEN_STORY="NEXT_OPEN_STORY",e.UNKNOWN="UNKNOWN"}(s||(s={})),function(e){e.NEXT_STORY="NEXT_STORY",e.PREV_STORY="PREV_STORY",e.RESET_STORY="RESET_STORY",e.NEXT_CONTAINER_STORY="NEXT_CONTAINER_STORY"}(a||(a={})),function(e){e.DOWNLOAD="download",e.UPLOAD="upload"}(n||(n={})),function(e){e.STORY_FEED_BLOCK_START_LOADING="story_feed_block_start_loading",e.STORY_FEED_BLOCK_CHUNK_LOADED="story_feed_block_chunk_loaded",e.STORY_FEED_BLOCK_DATA_LOADED="story_feed_block_data_loaded",e.STORY_FEED_BLOCK_DATA_LOADED_BEFORE_FEED_RENDERED="story_feed_block_data_loaded_before_feed_rendered",e.STORY_FEED_BLOCK_DATA_LOADED_AFTER_FEED_RENDERED="story_feed_block_data_loaded_after_feed_rendered",e.STORY_FEED_BLOCK_LOADING="story_feed_block_loading",e.FEED_RENDERED="feed_rendered",e.STORY_FEED_BLOCK_RENDERED="story_feed_block_rendered",e.STORY_FEED_BLOCK_RENDERED_WITHOUT_FEED="story_feed_block_rendered_without_feed",e.STORY_OPENING_START="story_opening_start",e.STORY_OPENED="story_opened",e.SHOW_VIEWER_LOADER="show_viewer_loader",e.HIDE_VIEWER_LOADER="hide_viewer_loader",e.DOWNLOAD="download",e.DOWNLOAD_START="download_start",e.UPLOAD_START="upload_start",e.UPLOAD="upload",e.VIDEO_STALL="video_stall",e.PLAYING_VIDEO_ERROR="playing_video_error"}(r||(r={}));const _=new Set(["story_feed_block_start_loading","story_opening_start","show_viewer_loader","download_start","upload_start"])},216708:(e,t,o)=>{"use strict";o.d(t,{AudioNetworkStatCollector:()=>s});var i=o(761895);class s{logEvent(e,t,o){const s={network_type:t,network_effective_type:o,type:i.NetworkStatEventTypes.TYPE_NETWORK_AUDIO_ITEM,[i.NetworkStatEventTypes.TYPE_NETWORK_AUDIO_ITEM]:e};this.networkStatCollector.logEvent(s)}constructor(e){this.networkStatCollector=e}}},826046:(e,t,o)=>{"use strict";o.d(t,{AudioNetworkStatCollector:()=>s.AudioNetworkStatCollector,AudioNetworkType:()=>a.AudioNetworkType,NetworkStatCollector:()=>i.NetworkStatCollector});var i=o(63640),s=o(216708),a=o(761895)},390317:(e,t,o)=>{"use strict";o.d(t,{TooltipStatCollector:()=>n});var i=o(695290),s=o(581903);const a="unknown";class n{logEvent(e,t,o){const s={action:e,hint_id:t,duration:o||0},a={...this.productionStatCollector.getBaseEvent(this.getScreen(this.getModule())),type:i.ActionProductionStatEventTypes.TYPE_UI_HINT_ITEM,[i.ActionProductionStatEventTypes.TYPE_UI_HINT_ITEM]:s};this.actionStatCollector.logEvent(a,{force:!0})}getModule(){return window.cur?.module??a}getScreen(e=a){return window.cur?.screen?window.cur.screen===a?e:window.cur.screen:e}constructor(){this.productionStatCollector=new s.ProductionStatCollector,this.actionStatCollector=new s.ActionStatCollector(this.productionStatCollector)}}},796044:(e,t,o)=>{"use strict";var i,s;o.d(t,{DonutActionEventScreen:()=>s,DonutActionEventType:()=>i}),function(e){e.PAYMENT_FORM="payment_form",e.PAYMENT_FORM_CLICK_OFFER="payment_form_click_offer",e.PAYMENT_FORM_CLICK_PAY="payment_form_click_pay",e.PAYMENT_FORM_CLICK_CLOSE="payment_form_click_close"}(i||(i={})),function(e){e.PAYMENT_START="payment_start",e.DATA_ACCESS="data_access",e.RESULT_PAYMENT_SUCCESS_OK="result_payment_success_ok",e.RESULT_PAYMENT_SUCCESS_WAITING="result_payment_success_waiting",e.RESULT_PAYMENT_SUCCESS_WAITING_TIMEOUT="result_payment_success_waiting_timeout",e.RESULT_RESUB_SUCCESS_WAITING_OK="result_resub_success_waiting_ok",e.RESULT_PAYMENT_UNAVAILABLE="result_payment_unavailable",e.RESULT_PAYMENT_CANCEL="result_payment_cancel",e.RESULT_ERROR="result_error",e.RESULT_CHANGE_ERROR="result_change_error",e.RESULT_CHANGE_SUCCESS_OK="result_change_success_ok",e.RESULT_CHANGE_SUCCESS_WAITING_TIMEOUT="result_change_success_waiting_timeout",e.UNKNOWN="donut_payment_screen_unknown"}(s||(s={}))},205504:(e,t,o)=>{"use strict";o.d(t,{getImageMinWidth:()=>i});const i=e=>Math.ceil(e*Math.max(window.devicePixelRatio,1))},730735:(e,t,o)=>{"use strict";o.d(t,{banUser:()=>l,deleteFromAuthor:()=>_,deleteQuestion:()=>n,getQuestion:()=>s,getQuestions:()=>a,getUsers:()=>d,reportQuestion:()=>p,restoreAuthorQuestions:()=>u,restoreQuestion:()=>r,unbanUser:()=>c});var i=o(933052);function s(e){return(0,i.api)("questions.getById",{owner_id:window.vk.id,question_id:e,extended:1,fields:"photo_50,photo_100,first_name_gen,last_name_gen,domain"})}function a(e="",t=15){return(0,i.api)("questions.get",{owner_id:window.vk.id,start_from:e,limit:t,extended:1,fields:"photo_50,photo_100,first_name_gen,last_name_gen,domain"})}function n(e){return(0,i.api)("questions.delete",{owner_id:window.vk.id,question_id:e})}function r(e){return(0,i.api)("questions.restore",{owner_id:window.vk.id,question_id:e})}function _(e){return(0,i.api)("questions.deleteFromAuthor",{owner_id:window.vk.id,question_id:e})}function u(e){return(0,i.api)("questions.restoreFromAuthor",{owner_id:window.vk.id,question_id:e})}function d(e){return(0,i.api)("users.get",{user_ids:e.join(","),fields:"photo_50,photo_100,can_ask_anonymous,can_ask_question,first_name_nom,first_name_dat,first_name_gen,last_name_gen,sex"})}function l(e){return(0,i.api)("questions.authorBan",{owner_id:window.vk.id,question_id:e})}function c(e){return(0,i.api)("questions.authorUnBan",{owner_id:window.vk.id,question_id:e})}function p(e){return(0,i.api)("reports.add",{type:"profile_story_question",owner_id:window.vk.id,item_id:e})}},238540:(e,t,o)=>{"use strict";var i;o.d(t,{QuestionsBoxRef:()=>i}),function(e){e.SNIPPET="snippet",e.URL="url",e.STORY="story"}(i||(i={}))},805088:(e,t,o)=>{"use strict";o.d(t,{isPopUpStickersEnabled:()=>n,isPopUpStickersEnabledInVkCom:()=>a});var i=o(705744),s=o(476726);const a=()=>(0,s.partConfigEnabled)("stickers.popup.vkcom"),n=()=>(0,i.isMvk)()?(0,s.partConfigEnabled)("stickers.popup.mvk"):a()},292188:(e,t,o)=>{"use strict";o.d(t,{DAY:()=>r,SECOND:()=>s,getShortPrintableTimeSpan:()=>l});var i=o(610989);const s=1e3,a=60*s,n=60*a,r=24*n,_=7*r,u=30*r,d=12*u;function l(e){return e>=d?(0,i.langNumeric)(Math.floor(e/d),i.getLang("global_short_years_fixed")):e>=u?(0,i.langNumeric)(Math.floor(e/u),i.getLang("global_short_months")):e>=_?(0,i.langNumeric)(Math.floor(e/_),i.getLang("global_short_weeks")):e>=r?(0,i.langNumeric)(Math.floor(e/r),i.getLang("global_short_days")):e>=n?(0,i.langNumeric)(Math.floor(e/n),i.getLang("global_short_hours")):e>=a?(0,i.langNumeric)(Math.floor(e/a),i.getLang("global_short_minutes")):e>=s?(0,i.langNumeric)(Math.floor(e/s),i.getLang("global_short_seconds")):""}},857125:(e,t,o)=>{"use strict";o.d(t,{TooltipsStat:()=>a});var i=o(695290);const s=new(o(390317).TooltipStatCollector);class a{handleShow(){this.showTime=new Date,this.skipShow?s.logEvent(i.ETooltipEventTypes.TOOLTIP_COULD_BE_SHOWN,this.tooltipId,0):s.logEvent(i.ETooltipEventTypes.TOOLTIP_SHOW,this.tooltipId,0)}handleHide(e=i.ETooltipEventTypes.TOOLTIP_HIDE_BY_INTERFACE_INTERACTION){let t=0;this.showTime&&(t=(new Date).getTime()-this.showTime.getTime()),s.logEvent(e,this.tooltipId,t)}static registryShow(e,t=!1){a.tootips[e]=new a(e,t),a.tootips[e].handleShow()}static registryHide(e,t=i.ETooltipEventTypes.TOOLTIP_HIDE_BY_INTERFACE_INTERACTION){(a.tootips[e]||new a(e,!1)).handleHide(t)}constructor(e,t){this.tooltipId=e,this.skipShow=t}}a.tootips={}},214716:(e,t,o)=>{"use strict";o.d(t,{checkOwnerIsNFT:()=>i});const i=e=>{if(e){if("is_nft"in e)return Boolean(e.is_nft);if("is_nft_photo"in e)return Boolean(e.is_nft_photo)}return!1}},953430:(e,t,o)=>{"use strict";o.d(t,{createSentryLogger:()=>n,isApiNetworkError:()=>a});var i=o(303323),s=o(87223);function a(e){return!(!e||"object"!=typeof e)&&e.type===i.APIErrorType.NETWORK_ERROR}const n=({debugPrefix:e="[Sentry Logger]",isConsoleEnabled:t=!1,environment:o,catchNetworkError:i})=>{function n(t,o){return`${e} `+(o?`${o}: ${t}`:t)}return function(r){const{error:_,additionalText:u,extra:d,environment:l}=r,c=l||o;if(t&&console.error(e,{error:_,additionalText:u||"Some error happened",extra:d,environment:c}),i&&a(_)&&i(r))return;const p=d?{environment:l,breadcrumb:{data:{extra:d}}}:{environment:c};if(_ instanceof Error){const e=new Error(n(_.message,u));return e.name=_.name,e.stack=_.stack,void(0,s.logError)(e,p)}if("string"!=typeof _)return _ instanceof Object?(p.breadcrumb?.data?p.breadcrumb.data.object=_:p.breadcrumb={...p.breadcrumb,data:{object:_}},void(0,s.logError)(new Error(n("Error as object",u)),p)):void(_||!u?(0,s.logError)(new Error(n("Unknown error")),p):(0,s.logError)(new Error(n(u)),p));(0,s.logError)(new Error(n(_,u)),p)}}},952881:(e,t,o)=>{"use strict";o.d(t,{getOwnerName:()=>i});const i=(e,t=!0,o)=>{let i="";return e&&("name"in e?i=e.name||"":!t&&"first_name"in e?i=o?e[`first_name_${o}`]||"":e.first_name||"":("first_name"in e||"last_name"in e)&&(i=o?`${e[`first_name_${o}`]} ${e[`last_name_${o}`]}`:`${e.first_name} ${e.last_name}`)),i}},417517:(e,t,o)=>{"use strict";o.d(t,{getOwnerUrl:()=>i});const i=(e,t="/",o="")=>e?"domain"in e&&"id"in e?`/artist/${e.domain||e.id||""}${o}`:"screen_name"in e&&e.screen_name?`${t}${e.screen_name}${o}`:"first_name"in e?`${t}id${e.id}${o}`:`${t}club${e.id}${o}`:""},33281:(e,t,o)=>{"use strict";o.d(t,{getVideoCopyLink:()=>_,getVideoUrl:()=>r});var i=o(112268),s=o(705744),a=o(753677),n=o(476726);const r=e=>{const{owner_id:t,id:o}=e;if(void 0===t)return"/video";if(void 0===o)return`/video/@id${t}`;return"/"+("short_video"===e.type?"clip":"video")+(0,i.joinRawId)({ownerId:t,itemId:o})+(e.access_key?`?list=${e.access_key}`:"")},_=(e,t,o,i)=>{const _=new URL(r(e),"https://"+(0,s.getHostName)());return t&&_.searchParams.set("t",(0,a.toString)(t)),e.access_key?.startsWith("ln-")?_.searchParams.set("list",e.access_key):_.searchParams.delete("list"),o&&(0,n.partConfigEnabled)("video_player_ref_domain_embed")&&_.searchParams.set("ref_domain",i||window.cur.mvOpts.ref_domain),_.toString()}},599568:(e,t,o)=>{"use strict";o.d(t,{replaceEmailLinks:()=>s});var i=o(495917);function s(e,t){return e.replace(i.EMAIL,t||function(e){return`<a href="mailto:${e}">${e}</a>`})}},399290:(e,t,o)=>{"use strict";o.d(t,{linksReplacer:()=>m,linksReplacerReact:()=>p,replaceHyperLinks:()=>l});var i=o(7144),s=o(705744),a=o(678340),n=o(889393),r=o(408063);function _(e){if(!e[0]||!e[6])return e;const t=e[0].length-1,o=e[6].length-1;return"."===e[0][t]&&"."===e[6][o]&&(e[0]=e[0].slice(0,t),e[6]=e[6].slice(0,o)),e}function u(e){return{full:e[0],protocol:e[1]||"http://",url:e[2],domain:e[4],query:e[6]||""}}function d(e){return e.replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function l(e,t){const o=new RegExp(a.RE_URL_PATTERN,"ig"),i=n.TOP_DOMAINS.reduce(((e,t)=>Math.max(e,t.length)),0);let s,r=0,d=e;for(;null!==(s=o.exec(e));){s=_(s);const o=s[0].length,a=s.index+o,l=e[s.index-1],c=e[a-1];if("@"===e[a]&&(!s[0]||s[0]&&!s[0].toLowerCase().includes("http")))continue;const p=void 0!==l&&/([\w\$А-Яа-яёЁєЄҐґЇїІіЈј—\-\_@;.])/i.test(l),m=void 0!==c&&/([:;$])/i.test(c);if(!p&&!m){const e=u(s),_=e.domain.toLowerCase();if(_.length<=i&&n.TOP_DOMAINS.includes(_)){const i=t(e);d=d.slice(0,s.index+r)+i+d.slice(a+r),r+=i.length-o}}}return d}function c(e,t){try{e=decodeURIComponent(e)}catch(e){}return e.length>t&&(e=e.substr(0,t-2)+".."),e=d(e).replace(/\n/g," ")}function p(e){return(t,o,a=55)=>{const{url:_,protocol:u,query:l,full:p}=o,m=c(p,a),h=(0,i.replaceEntities)(_+l);if(n.OUR_DOMAINS.test(_)){const o=d(u+_+l),i=p.match(n.VK_DOMAIN);return e({key:t,href:o,mentionId:i?i[1]:"",text:m})}{const o=window.nav?.strLoc?.startsWith("video"),a=((0,s.isPWA)()||o?`https://${(0,s.getHostName)()}`:"")+(0,r.wrapAway)(u+h,!0),n=(0,i.clean)(u+_+l);return e({key:t,href:a,goAwayUrl:n,text:m})}}}function m(e,t=55){let{full:o}=e;const{url:a,protocol:r,query:_}=e;o=c(o,t);const u=(0,i.replaceEntities)(a+_);if(n.OUR_DOMAINS.test(a)){let e="";const t=o.match(n.VK_DOMAIN);if(t){const o=t[1];e=(0,s.isMvk)()?"":` mention_id="${o}" onclick="return mentionClick(this, event)" onmouseover="mentionOver(this)"`}return`<a href="${d(r+a+_)}" target="_blank" rel="noopener"${e}>${o}</a>`}const l=window.nav?.strLoc?.startsWith("video"),p=`${(0,s.isPWA)()||l?`https://${(0,s.getHostName)()}/`:""}away.php?utf=1&to=${encodeURIComponent(r+u)}`,m=(0,i.clean)((r+a+_).replace(/'/g,"\\'"));return`<a href="${p}" target="_blank" rel="noopener" ${(0,s.isMvk)()?"":`onclick="return goAway('${m}', {}, event);"`}>${o}</a>`}},846210:(e,t,o)=>{"use strict";o.d(t,{mentionReplaceReact:()=>r,replaceMentions:()=>n});var i=o(487703),s=o(7144),a=o(705744);function n(e,t){return e.replace(i.MENTION,t||function(e,t,o,i,n){const r=(0,a.isMvk)()?"":` mention_id="${(0,s.clean)(t+o)}" onclick="return mentionClick(this, event)" onmouseover="mentionOver(this)"`;return`<a href="/${t+o}" class="mem_link" mention="${(0,s.clean)(i||"")}"${r}>${n}</a>`})}function r(e){return(t,o,i,s,a,n)=>e({key:t,mentionId:i+s,mention:a,href:`/${i+s}`,text:n})}},555603:(e,t,o)=>{"use strict";o.d(t,{MenuHelpHintTextTooltip:()=>n});var i=o(474848),s=o(296540),a=o(320830);const n=e=>{const[t,o]=(0,s.useState)(!1);return(0,s.useLayoutEffect)((()=>{const e=setTimeout((()=>o(!0)));return()=>{clearTimeout(e)}}),[]),(0,i.jsx)(a.TextTooltip,{shown:t,...e})}},183964:(e,t,o)=>{"use strict";o.d(t,{MenuHelpHintTooltip:()=>r});var i=o(474848),s=o(296540),a=o(753457),n=o(741531);const r=e=>{const{helpHint:t,onClose:o,...r}=e,[_,u]=(0,s.useState)(!1),d=(0,s.useCallback)((()=>{(0,n.ensureAccountHelpHintsService)().hideHelpHint({hintId:t.id,isOptimistic:!0}),o?.()}),[o]);return(0,s.useLayoutEffect)((()=>{const e=setTimeout((()=>u(!0)));return()=>{clearTimeout(e)}}),[]),(0,i.jsx)(a.OnboardingTooltip,{shown:_,header:t.title,text:t.description,onClose:d,...r})}},407816:(e,t,o)=>{"use strict";o.d(t,{MenuHelpHintTextTooltip:()=>s.MenuHelpHintTextTooltip,MenuHelpHintTooltip:()=>i.MenuHelpHintTooltip});var i=o(183964),s=o(555603)},197466:(e,t,o)=>{"use strict";o.d(t,{BASE_LOCATION:()=>_,MY_VIDEO_ALBUM_ID:()=>i,OWNER_VIDEOS_PAGE_BASE_PATH:()=>u,PLAYLIST_PAGE_BASE_PATH:()=>p,PLAYLIST_PAGE_REGEXP:()=>m,PLAYLIST_POPOVER_VERTICAL_OFFSET:()=>c,PLAYLIST_POPOVER_WIDTH:()=>l,SECTION_MY_BOOKMARKS:()=>a,SECTION_MY_LIKED:()=>n,SNACKBAR_TIMEOUT:()=>r,UPLOADED_ALBUM_ID:()=>s,VIDEO_COMMUNITY_COMMENTS_PATH:()=>h,VIDEO_PAGE_PATHNAME_REGEXP:()=>y,WATCH_LATER_PATH:()=>d});const i=-2,s=-1,a="my_bookmarks",n="my_liked",r=4e3,_="/video",u="/video/@",d="/video/bookmarks",l=252,c=16,p="video/playlist/",m=/video\/playlist\/(-?\d+_-?\d+)/,h="comments",y=/^\/video(-?\d+_\d+)$/},961694:(e,t,o)=>{"use strict";o.d(t,{getAdditionalInfo:()=>_});var i=o(8520),s=o(422495),a=o(129473),n=o(610989),r=o(292188);const _=e=>{const{partner_text:t,date:o,type:_,release_date:u,genres:d,views:l=1}=e;if("music_video"===_&&d?.length&&u)return`${new Date(u*r.SECOND).getFullYear()} · ${d[0].name}`;if(t)return(0,i.decodeHTMLEntities)(t);const c=e=>(0,i.decodeHTMLEntities)((0,a.getFormattedViews)(e));return o?o>Date.now()/r.SECOND?n.getLang("video_postponed_publication"):(0,s.isLiveVideo)(e)?c(l):`${c(l)} · ${(0,i.decodeHTMLEntities)((0,s.getFormattedUpdatedTime)(o,!0))}`:c(l)}},21941:(e,t,o)=>{"use strict";o.d(t,{getFormattedPostponePublishDateTime:()=>_,getFormattedUpdatedTime:()=>n,getFormattedUpdatedTimeWithPrefix:()=>r});var i=o(7144),s=o(610989);const a=(e,[t,o],a)=>{return a?(0,s.langNumeric)((0,i.intval)(e),o):(n=(0,i.intval)(e),r=t,_=o,(0,i.isArray)(r)&&n<r.length?r[n]:(0,s.langNumeric)(n,_));var n,r,_},n=(e,t)=>{const o=Date.now()/1e3-e;if(o<5)return((e,t)=>t?(0,s.langNumeric)((0,i.intval)(e),s.getLang("video_added_less_than_a_minute_ago")):s.getLang("video_added_now","raw")[0])(o,t);if(o<60)return((e,t)=>t?(0,s.langNumeric)((0,i.intval)(e),s.getLang("video_added_less_than_a_minute_ago","raw")):s.getLang("video_added_less_than_a_minute_ago"))(o,t);if(o<3600){const e=[s.getLang("video_word_mins_ago","raw"),s.getLang("video_mins_ago","raw")];return a(o/60,e,t)}if(o<86400){const e=[s.getLang("video_word_hours_ago","raw"),s.getLang("video_hours_ago","raw")];return a(o/3600,e,t)}if(o<2592e3){const e=[s.getLang("video_word_days_ago","raw"),s.getLang("video_days_ago","raw")];return a(o/86400,e,t)}if(o<31536e3){const e=[s.getLang("video_word_months_ago","raw"),s.getLang("video_months_ago","raw")];return a(o/2592e3,e,t)}const n=[s.getLang("video_word_years_ago","raw"),s.getLang("video_years_ago","raw")];return a(o/31363200,n,t)},r=e=>(0,s.langStr)(s.getLang("video_album_updated_time"),"updated_time_ago",n(e,!0)),_=e=>{const t=1e3*e,o=new Date,i=new Date(t);return(0,s.langDate)(t,o.getFullYear()===i.getFullYear()?s.getLang("video_postponed_publication_date","raw"):s.getLang("video_postponed_publication_full_date","raw"),0,s.getLang("months_sm_of"))}},129473:(e,t,o)=>{"use strict";o.d(t,{getFormattedViews:()=>a});var i=o(610989),s=o(422495);function a(e){return e>999?(0,s.getFormattedBigViewsToShortCase)(e):i.getLang("video_N_views_list",e||1,!0)}},471276:(e,t,o)=>{"use strict";o.d(t,{useOwner:()=>i.useOwner,useVideoInPlaylist:()=>s.useVideoInPlaylist});var i=o(103248),s=o(965657)},103248:(e,t,o)=>{"use strict";o.d(t,{useOwner:()=>a});var i=o(149183),s=o(847891);const a=(e,t,o)=>{const a=(0,i.useEntitiesStore)(t.$entitiesGroups,s.Ranges.convertOwnerIdToGroupId(e.owner_id)),n=(0,i.useEntitiesStore)(o.$entitiesUsers,e.owner_id);return s.Ranges.isGroupId(e.owner_id)&&a?a:s.Ranges.isUserId(e.owner_id)&&n?n:void 0}},965657:(e,t,o)=>{"use strict";o.d(t,{useVideoInPlaylist:()=>s});var i=o(293721);const s=(e,t,o)=>(0,i.useStoreMap)(e,(e=>!(!e||!e[t])&&Boolean(e[t][o])))},422495:(e,t,o)=>{"use strict";o.d(t,{BASE_LOCATION:()=>s.BASE_LOCATION,BOOKMARKS_URL:()=>f.BOOKMARKS_URL,MY_VIDEO_ALBUM_ID:()=>s.MY_VIDEO_ALBUM_ID,MenuHelpHintTextTooltip:()=>i.MenuHelpHintTextTooltip,MenuHelpHintTooltip:()=>i.MenuHelpHintTooltip,OWNER_VIDEOS_PAGE_BASE_PATH:()=>s.OWNER_VIDEOS_PAGE_BASE_PATH,PLAYLIST_PAGE_BASE_PATH:()=>s.PLAYLIST_PAGE_BASE_PATH,PLAYLIST_PAGE_REGEXP:()=>s.PLAYLIST_PAGE_REGEXP,PLAYLIST_POPOVER_VERTICAL_OFFSET:()=>s.PLAYLIST_POPOVER_VERTICAL_OFFSET,PLAYLIST_POPOVER_WIDTH:()=>s.PLAYLIST_POPOVER_WIDTH,SECTION_MY_BOOKMARKS:()=>s.SECTION_MY_BOOKMARKS,SECTION_MY_LIKED:()=>s.SECTION_MY_LIKED,SNACKBAR_TIMEOUT:()=>s.SNACKBAR_TIMEOUT,UPLOADED_ALBUM_ID:()=>s.UPLOADED_ALBUM_ID,VIDEO_COMMUNITY_COMMENTS_PATH:()=>s.VIDEO_COMMUNITY_COMMENTS_PATH,VIDEO_PAGE_PATHNAME_REGEXP:()=>s.VIDEO_PAGE_PATHNAME_REGEXP,WATCH_LATER_PATH:()=>s.WATCH_LATER_PATH,canAddVideoToCommunityPlaylist:()=>f.canAddVideoToCommunityPlaylist,createVideoBindingsService:()=>h.createVideoBindingsService,formatTextWithLinks:()=>f.formatTextWithLinks,get:()=>m.get,getAdditionalInfo:()=>a.getAdditionalInfo,getAllPlaylistURL:()=>f.getAllPlaylistURL,getFormattedBigLikesToShortCase:()=>E.getFormattedBigLikesToShortCase,getFormattedBigSubscribersToShortCase:()=>E.getFormattedBigSubscribersToShortCase,getFormattedBigViewsToShortCase:()=>E.getFormattedBigViewsToShortCase,getFormattedFullVideoViews:()=>E.getFormattedFullVideoViews,getFormattedPostponePublishDateTime:()=>n.getFormattedPostponePublishDateTime,getFormattedUpdatedTime:()=>n.getFormattedUpdatedTime,getFormattedUpdatedTimeWithPrefix:()=>n.getFormattedUpdatedTimeWithPrefix,getFormattedVideoDate:()=>E.getFormattedVideoDate,getFormattedViews:()=>r.getFormattedViews,getPlaylistURL:()=>f.getPlaylistURL,getThumbSrc:()=>f.getThumbSrc,isLiveVideo:()=>f.isLiveVideo,isPrivacyLocked:()=>p.isPrivacyLocked,mapArtistToVideoCardOwner:()=>u.mapArtistToVideoCardOwner,mapPlaylistToPlaylistCardItem:()=>d.mapPlaylistToPlaylistCardItem,mapRestrictions:()=>p.mapRestrictions,mapUserOrGroupToPlaylistCardOwner:()=>l.mapUserOrGroupToPlaylistCardOwner,mapUserOrGroupToVideoCardOwner:()=>c.mapUserOrGroupToVideoCardOwner,mapVideoToSimpleVideoCardItem:()=>p.mapVideoToSimpleVideoCardItem,mapVideoToVideoCardItem:()=>p.mapVideoToVideoCardItem,trackOneStatError:()=>y.trackOneStatError,useOwner:()=>_.useOwner,useVideoInPlaylist:()=>_.useVideoInPlaylist});var i=o(407816),s=o(197466),a=o(961694),n=o(21941),r=o(129473),_=o(471276),u=o(291423),d=o(284469),l=o(676822),c=o(275535),p=o(823213),m=o(899231),h=o(532656),y=o(554332),f=o(125830),E=o(219751)},624225:(e,t,o)=>{"use strict";o.d(t,{isPrivacyLocked:()=>i});const i=e=>!!e&&Boolean((e=>e.category&&!["all","any"].includes(e.category))(e)||e.excluded_category?.length||e.lists?.allowed?.length||e.lists?.excluded?.length||e.owners?.allowed?.length||e.owners?.excluded?.length)},665408:(e,t,o)=>{"use strict";o.d(t,{isUpcomingLiveVideo:()=>i});const i=({liveStatus:e,type:t})=>"live"===t&&"upcoming"===e},517347:(e,t,o)=>{"use strict";o.d(t,{isVideoExternal:()=>i});const i=e=>Boolean(e&&e.player&&(e.files?.external||"YouTube"===e.platform))},291423:(e,t,o)=>{"use strict";o.d(t,{mapArtistToVideoCardOwner:()=>u,mapVideoToFeaturedArtists:()=>d});var i=o(952881),s=o(417517),a=o(8520);const n=[50,100,200],r=({photo:e})=>e?n.reduce(((t,o)=>(t[`photo_${o}`]=(0,a.getPhotoSize)(e,o)?.url,t)),{}):{},_=e=>({name:(0,i.getOwnerName)(e),href:(0,s.getOwnerUrl)(e)}),u=e=>{if("music_video"!==e.type||!e.main_artists)return null;const[t]=e.main_artists;return t?{name:(0,i.getOwnerName)(t),href:(0,s.getOwnerUrl)(t),...r(t)}:null},d=e=>e?.featured_artists?e.featured_artists.map(_):void 0},284469:(e,t,o)=>{"use strict";o.d(t,{mapPlaylistToPlaylistCardItem:()=>n});var i=o(125830),s=o(624225),a=o(21941);const n=e=>({id:e.id,href:(0,i.getPlaylistURL)(e.owner_id,e.id),title:e.title,count:e.count,thumbSrc:(0,i.getThumbSrc)(e),isPrivacyLocked:(0,s.isPrivacyLocked)(e.privacy),isThumbBlurred:Boolean(e.image_blur),additionalInfo:(0,a.getFormattedUpdatedTimeWithPrefix)(e.updated_time)})},676822:(e,t,o)=>{"use strict";o.d(t,{mapUserOrGroupToPlaylistCardOwner:()=>n});var i=o(901219),s=o(952881),a=o(417517);const n=(e,t)=>({name:(0,s.getOwnerName)(e),href:(0,a.getOwnerUrl)(e,t),is_nft:(0,i.isOwnerUser)(e)?e.is_nft:e.is_nft_photo,verified:Boolean(e.verified),has_unseen_stories:e.has_unseen_stories,photo_50:e.photo_50,photo_100:e.photo_100,photo_200:e.photo_200})},275535:(e,t,o)=>{"use strict";o.d(t,{mapUserOrGroupToVideoCardOwner:()=>n});var i=o(214716),s=o(952881),a=o(417517);const n=(e,t)=>e?{...e,name:(0,s.getOwnerName)(e),href:(0,a.getOwnerUrl)(e,t),verified:1===e.verified,is_nft:(0,i.checkOwnerIsNFT)(e)}:{name:"",href:""}},823213:(e,t,o)=>{"use strict";o.d(t,{isPrivacyLocked:()=>p,mapRestrictions:()=>h,mapVideoToSimpleVideoCardItem:()=>v,mapVideoToVideoCardItem:()=>g});var i=o(8520),s=o(610989),a=o(292188),n=o(33281),r=o(665408),_=o(291423),u=o(125830),d=o(961694),l=o(129473),c=o(21941);const p=e=>!!e&&((e=>"members"===e.category?"to_subscribers":"by_link"===e.category?"by_link":Boolean(e.category&&!["all","any"].includes(e.category)))(e)||Boolean(e.excluded_category?.length||e.lists?.allowed?.length||e.lists?.excluded?.length||e.owners?.allowed?.length||e.owners?.excluded?.length)),m=e=>{if(!e)return;return{delete_outline:"delete",hide_outline:"hide",recent_outline:"recent",info_outline:"info",lock_outline:"lock",picture_outline:"picture",live_clock_badge_outline:"liveClockBadge",do_not_disturb_outline:"doNotDisturb",users3_outline:"users3",cancle_circle_outline:"cancleCircle"}[e]},h=e=>{const t=e&&(e=>e&&(e.icon_name?.length||e.mute_info_link?.length)?1===e.blur?"blurred":e.mute_info_link&&e.mute_info_link.length>0?"muted":"hidden":null)(e);return t?{title:e.title,mode:t,iconType:m(e.icon_name)}:null},y=e=>{const t=e.title||"",o=e.subtitle||"";return"music_video"===e.type?`${t} ${o}`:t},f=e=>{const t=e.published_at;if(!t)return;const o=t*a.SECOND;return Date.now()>o?void 0:(0,s.langDate)(o,s.getLang("global_short_date_time","raw"),0,s.getLang("months_sm_of","raw"))};function E(e){const t={isUpcoming:(0,r.isUpcomingLiveVideo)({type:e.type,liveStatus:e.live_status}),isInteractive:Boolean(e.interactive_info),badgeText:e.platform};return t.isUpcoming?t.badgeText=s.getLang("global_video_soon"):t.isInteractive&&(t.badgeText=s.getLang("video_interactive_label")),t}const g=e=>{const{isUpcoming:t,isInteractive:o,badgeText:i}=E(e);return{additionalInfo:(0,d.getAdditionalInfo)(e),description:e.description,duration:e.duration,href:(0,n.getVideoUrl)(e),isLive:(0,u.isLiveVideo)(e),isPrivacyLocked:p(e.privacy_view),isProcessing:Boolean(e.processing),ownersRelationText:e.featured_artists?s.getLang("video_feature_relation_text"):void 0,badgeText:i,publishDate:f(e),restriction:h(e.restriction),secondaryOwners:(0,_.mapVideoToFeaturedArtists)(e),thumbSrc:(0,u.getThumbSrc)(e),title:y(e),trailerSrc:e.trailer?.mp4_360,isUpcoming:t,viewedDuration:e.viewed_duration,isInteractive:o}},v=(e,t)=>{const{isUpcoming:o,isInteractive:s,badgeText:a}=E(e);return{title:y(e),isPrivacyLocked:p(e.privacy_view),isLive:(0,u.isLiveVideo)(e),duration:e.duration,viewedDuration:e.viewed_duration,badgeText:a,isUpcoming:o,isInteractive:s,thumbSrc:(0,u.getThumbSrc)(e),restriction:h(e.restriction),href:(0,n.getVideoUrl)(e),views:void 0!==e.views?(0,l.getFormattedViews)(e.views):void 0,date:t||void 0===e.date?void 0:(0,i.decodeHTMLEntities)((0,c.getFormattedUpdatedTime)(e.date,!0))}}},899231:(e,t,o)=>{"use strict";o.d(t,{get:()=>_});var i=o(933052),s=o(793656),a=o(623702);const n="videoplayer_auth_token",r=async({refresh:e=!1,prefetch:t=!1}={})=>{const o=t?s.apiWithPrefetch:i.api,{token:r}=await o("video.getStatsToken",{env:window.__dev?"development":"production",force_refresh:e?1:0});var _;return _=r,a.bestAvailableStorage.setItem(n,_),r},_=async(e={})=>e.refresh?await r(e):a.bestAvailableStorage.getItem(n)??await r(e)},608314:(e,t,o)=>{"use strict";o.d(t,{createVideoBindingsService:()=>a});var i=o(32489),s=o(679005);const a=e=>{const t=e.createEvent(),o=e.createEvent(),a=e.createEvent(),n=e.createStore({});return(0,i.sample)({clock:t,source:n,fn:(e,{album_ids:t,video_id:o})=>(0,s.produce)(e,(e=>{t.forEach((t=>{e[o]||(e[o]={}),e[o][t]=!0}))})),target:n}),(0,i.sample)({clock:o,source:n,fn:(e,{album_id:t,video_id:o})=>{const i=!e[o]||!e[o][t];return(0,s.produce)(e,(e=>{e[o]||(e[o]={}),e[o][t]=i}))},target:n}),(0,i.sample)({clock:a,fn:()=>({}),target:n}),{$entitiesVideoBinding:n,addBindingsEvent:t,toggleBindingEvent:o,resetBindingsEvent:a}}},532656:(e,t,o)=>{"use strict";o.d(t,{createVideoBindingsService:()=>i.createVideoBindingsService});var i=o(608314)},554332:(e,t,o)=>{"use strict";o.d(t,{trackOneStatError:()=>a});var i=o(476726),s=o(490712);const a=(0,i.partConfigEnabled)("video_player_track_onestat_errors")?e=>{const t=e instanceof Error?e.name:String(e);(0,s.statlogsValueEvent)("video_player_insignificant_network_error","onestat",t)}:()=>{}},125830:(e,t,o)=>{"use strict";o.d(t,{BOOKMARKS_URL:()=>p,canAddVideoToCommunityPlaylist:()=>E,formatTextWithLinks:()=>f,getAllPlaylistURL:()=>l,getArtistPhotos:()=>m,getPlaylistURL:()=>c,getThumbSrc:()=>g,isLiveVideo:()=>h});var i=o(7144),s=o(399290),a=o(846210),n=o(599568),r=o(517347),_=o(8520),u=o(205504),d=o(163633);const l=e=>`/video/@${e}/playlists`,c=(e,t)=>`/video/playlist/${e}_${t}`,p="/video/bookmarks",m=e=>{const t=[50,100,200],o={};return e.photo?e.photo.reduce(((e,o)=>(t.includes(o.width)&&(e[`photo_${o.width}`]=o.url),e)),o):o},h=({live_status:e})=>Boolean(e&&!["postlive","finished"].includes(e)),y=(e,t,o,i,s)=>s,f=(e,t=!1)=>{let o=(0,i.clean)(e);return o=(0,s.replaceHyperLinks)(o,s.linksReplacer),o=(0,a.replaceMentions)(o,t?y:void 0),o=(0,n.replaceEmailLinks)(o),o},E=e=>"short_video"!==e.type&&(!e.restriction||((0,r.isVideoExternal)(e)?1===e.restriction.can_play:1===e.restriction.can_preview)),g=e=>{const t=(e instanceof d.Video?e.data:e).image||[],o=t.filter((e=>!e.with_padding)),i=o.length?o:t;return(0,_.getPhotoSize)(i,(0,u.getImageMinWidth)(240))?.url}},219751:(e,t,o)=>{"use strict";o.d(t,{getFormattedBigLikesToShortCase:()=>l,getFormattedBigSubscribersToShortCase:()=>d,getFormattedBigViewsToShortCase:()=>u,getFormattedFullVideoViews:()=>p,getFormattedVideoDate:()=>c});var i=o(610989),s=o(7144),a=o(292188);const n=({count:e,localeOptions:t})=>{const{getMinNumbersLocale:o,getThousandLocale:i,getMillionLocale:a}=t,n=window.langConfig?.locale||"ru";if(e<1e3)return o?o(e):e.toString();let r=1e3,_=i();e>999999&&(r=1e6,_=a());const[u="",d=""]=(e/r).toString().split("."),l=e>=1e5&&e<1e6||0===d.length?0:(0,s.intval)(d.substring(0,1)),c=(0,s.intval)(l)>0?`${u}.${l}`:u;return`${Number(c).toLocaleString(n)}${_}`},r={getMinNumbersLocale:e=>i.getLang("video_N_views_list",e),getThousandLocale:()=>i.getLang("video_N_views_thousand"),getMillionLocale:()=>i.getLang("video_N_views_million")},_={getMinNumbersLocale:e=>i.getLang("video_N_group_members_count",e),getThousandLocale:()=>i.getLang("video_N_subscribers_thousand"),getMillionLocale:()=>i.getLang("video_N_subscribers_million")},u=e=>n({count:e,localeOptions:r}),d=e=>n({count:e,localeOptions:_}),l=e=>n({count:e,localeOptions:{getThousandLocale:()=>i.getLang("video_N_thousand"),getMillionLocale:()=>i.getLang("video_N_million")}}),c=e=>(0,i.langDate)(e*a.SECOND,i.getLang("global_date","raw").slice(0,2),0,i.getLang("months_of","raw")),p=e=>`${e.toLocaleString("ru-RU")} ${i.getLang("video_showcase_N_viewers",e).split(" ")[1]}`},984869:(e,t,o)=>{"use strict";o.d(t,{logSavedUsersAuthStart:()=>r,logSavedUsersDropAccount:()=>_,logSwitcherAccounts:()=>u});var i=o(581903);const s=new i.ProductionStatCollector,a=new i.ActionStatCollector(s),n=new i.RegistrationItemStatCollector(a);function r(e){n.logEvent(i.RegistrationItemEventTypes.AUTH_SAVED_START,i.EventScreens.START_PROCEED_AS,void 0,{force:!0},[{name:i.RegistrationFieldItemNames.SAVED_SOURCE,value:i.RegistrationFieldItemValues.SAVED_SOURCE_CAROUSEL,start_interaction_time:"",end_interaction_time:""}],e)}function _(e){n.logEvent(i.RegistrationItemEventTypes.DROP_ACCOUNT_FROM_SAVED,i.EventScreens.START_PROCEED_AS,void 0,{force:!0},[{name:i.RegistrationFieldItemNames.SAVED_SOURCE,value:i.RegistrationFieldItemValues.SAVED_SOURCE_CAROUSEL,start_interaction_time:"",end_interaction_time:""}],e)}function u(){n.logEvent(i.RegistrationItemEventTypes.POPUP_OPEN,i.EventScreens.MAIN,i.EventScreens.MULTI_ACC_SWITCHER,{force:!0})}},768772:(e,t,o)=>{"use strict";function i(e,t,o=null){e&&!window.vk?.isBanned&&window.stManager.add([window.jsc("web/article_layer.js"),"article.css"]).then((()=>{window.ArticleLayer.prepare(e,o,t)}))}o.d(t,{articlePrepare:()=>i})},54482:(e,t,o)=>{"use strict";o.d(t,{AudioPageProxy:()=>l});var i=o(434518),s=o(763812),a=o(919225),n=o(942451),r=o(523149),_=(0,s._)("_emitter"),u=(0,s._)("_globalStorage"),d=(0,s._)("_audioPage");class l{get emitter(){return(0,i._)(this,_)[_]}get events(){return(0,i._)(this,_)[_].listenable}get isInitialized(){return Boolean((0,i._)(this,d)[d])}get data(){return(0,i._)(this,d)[d]?._data||null}get readyAudio(){return(0,i._)(this,d)[d]?._readyAudio??null}get currentPlaylist(){return(0,i._)(this,d)[d]?.getPageCurrentPlaylist()}get currentSection(){return(0,i._)(this,d)[d]?._currentSection??null}get audioStartReadyAudio(){return(0,i._)(this,u)[u]?.audioStartReadyAudio??!1}set audioStartReadyAudio(e){(0,i._)(this,u)[u]={audioStartReadyAudio:e}}get ownerId(){return(0,i._)(this,d)[d]?.getOwnerId()??null}get canAddToGroup(){return Boolean((0,i._)(this,d)[d]?.canAddToGroup())}get canEditGroup(){return Boolean((0,i._)(this,d)[d]?.canEditGroup())}get contentBlock(){return(0,i._)(this,d)[d]?._els?.contentBlock??null}destroyReadyAudio(){(0,i._)(this,d)[d]?._destroyReadyAudio()}initAudioRowsAutoList(e){(0,i._)(this,d)[d]?._initAudioRowsAutoList(e)}reloadGeneralSectionData(e){(0,i._)(this,d)[d]?.reloadGeneralSectionData(e)}onUserAction(e,t){(0,i._)(this,d)[d]?.onUserAction(e,t)}constructor(){Object.defineProperty(this,u,{get:c,set:p}),Object.defineProperty(this,d,{get:m,set:void 0}),Object.defineProperty(this,_,{writable:!0,value:void 0}),(0,i._)(this,_)[_]=new a.Emitter}}function c(){return window.cur??null}function p(e){(0,r.default)(window.cur)&&(window.cur={...window.cur,...e})}function m(){return(0,i._)(this,u)[u]?.audioPage??null}l.ensure=(0,n.makeSharedState)("AudioPageProxy",(()=>new l),{version:5})},208144:(e,t,o)=>{"use strict";var i;o.d(t,{AudioRecomsOnboardingShowRequestedEventReason:()=>i}),function(e){e.VibeRecommendationsPlaylistPlayButton="VIBE_RECOMMENDATIONS_PLAYLIST_PLAY_BUTTON",e.RecommendationsPlaylistOpenButton="RECOMMENDATIONS_PLAYLIST_OPEN_BUTTON",e.RecommendationsPlaylistPlayButton="RECOMMENDATIONS_PLAYLIST_PLAY_BUTTON",e.SnippetsBannerOpenSnippetsPageLink="SNIPPETS_BANNER_SNIPPETS_PAGE_LINK",e.Navigation="NAVIGATION",e.AudioPageInit="AUDIO_PAGE_INIT",e.Unknown="UNKNOWN"}(i||(i={}))},98916:(e,t,o)=>{"use strict";var i;o.d(t,{AudioPageEventType:()=>i}),function(e){e.Updated="updated",e.RadioStationFollowed="radioStationFollowed",e.PodcastAddedToFavorites="podcastAddedToFavorites",e.AudioLinkCopied="audioLinkCopied",e.AudioRecomsOnboardingShowRequested="audioRecomsOboardingShowRequested"}(i||(i={}))},119265:(e,t,o)=>{"use strict";o.d(t,{AudioPageEventType:()=>s.AudioPageEventType,AudioPageProxy:()=>i.AudioPageProxy,AudioRecomsOnboardingShowRequestedEventReason:()=>a.AudioRecomsOnboardingShowRequestedEventReason});var i=o(54482),s=o(98916),a=o(208144)},527966:(e,t,o)=>{"use strict";o.d(t,{FetchService:()=>d});var i=o(434518),s=o(763812),a=o(624216),n=o(385608),r=o(476726),_=o(441914),u=(0,s._)("_getAudioIdsBySourceApi");class d{async getAudioIdsBySource(e,t={}){const o=(0,r.partConfigEnabled)("audio_recom_playlists_starts_with_last_played_audio_web"),{audioListId:s,audioListSource:n,ref:d}=t,l={audioIds:[],lastPlayedAudioRawId:null};try{if(o&&"playlist"===n&&s){const{audios:e,last_listened_audio_id:t=null}=await(0,i._)(this,u)[u]({entity_id:s,source:n,ref:d});return l.audioIds=e.map((e=>({audio_raw_id:e.audio_id,access_key:(0,_.mapAPIRawIdToAudioIdentity)(e.audio_id)?.accessKey??"",track_code:e.track_code}))),t&&(l.lastPlayedAudioRawId=t),l}const t=await a.ajax.promisifiedPost("al_audio.php?act=get_audio_ids_by_source",{...e}),r=t?.[0];Array.isArray(r)&&(l.audioIds=r)}finally{return l}}constructor(){Object.defineProperty(this,u,{writable:!0,value:void 0}),(0,i._)(this,u)[u]=(0,n.createMethod)("audio.getAudioIdsBySource"),this.reloadAudios=e=>new Promise(((t,o)=>{a.ajax.post("al_audio.php?act=reload_audios",{audio_ids:e},{onDone:e=>{t(e)},onFail:e=>(o(e),!1)})})),this.getAutoplayAudioIdsBySource=e=>new Promise(((t,o)=>{a.ajax.post("al_audio.php?act=get_next_audios",{...e},{onDone:e=>{t(e)},onFail:e=>(o(e),!1)})})),this.followRadiostation=(e,t)=>new Promise(((o,i)=>{a.ajax.post("al_audio.php?act=follow_radiostation",{id:e,hash:t},{onDone:e=>{o(e)},onFail:e=>(i(e),!0)})})),this.unfollowRadiostation=(e,t)=>new Promise(((o,i)=>{a.ajax.post("al_audio.php?act=unfollow_radiostation",{id:e,hash:t},{onDone:e=>{o(e)},onFail:e=>(i(e),!0)})}))}}},149143:(e,t,o)=>{"use strict";o.d(t,{hideCatalogBlock:()=>n});var i=o(327527),s=o(514640),a=o(624216);function n(e,t){a.ajax.post("/al_audio.php?act=hide_catalog_block",{block_id:e});const o=t.closest(".CatalogBlock__content");o&&(0,i.getAudioPlayer)().notify(s.events.PLACEHOLDER_REMOVE,o.dataset.id)}},439677:(e,t,o)=>{"use strict";o.d(t,{showAudioLongtapModal:()=>u});var i=o(474848),s=o(296540),a=o(753457),n=o(507607),r=o(272259);const _=(0,n.asyncComponent)((()=>Promise.all([o.e(91498),o.e(89631),o.e(21529),o.e(1715)]).then(o.bind(o,96507))),(({AudioLongtapModal:e})=>e)),u=(e,t)=>{(0,r.showMessageBoxModalSuspense)((o=>(0,i.jsx)(s.Suspense,{fallback:(0,i.jsx)(a.ScreenSpinner,{state:"cancelable",onClick:o.onClose}),children:(0,i.jsx)(_,{...o,audio:e,trackCode:t})})),{width:380})}},843225:(e,t,o)=>{"use strict";o.d(t,{showAudioLongtapModalEffector:()=>d});var i=o(474848),s=o(507607),a=o(272259),n=o(355110),r=o(672229),_=o(332583);const u=(0,s.asyncComponent)((()=>Promise.all([o.e(91498),o.e(89631),o.e(21529),o.e(1715)]).then(o.bind(o,800028))),(({AudioLongtapModal:e})=>e)),d=(e,t)=>{const o=r.AudioLongtapModalService.ensure(),s=(0,_.ensureMyMusicService)();o.setAudioElement(t),(0,a.showMessageBoxModalSuspense)((t=>(0,i.jsx)(u,{...t,audioLongtapService:o,previewsService:n.audioPreviewsService,myMusicService:s,audio:e})),{width:380,onDestroy:()=>{o.onCloseModal("click_outside")}})}},445677:(e,t,o)=>{"use strict";o.d(t,{SpecialProjectModal:()=>m});var i=o(474848),s=o(296540),a=o(209642),n=o(416124),r=o(943388),_=o(104900),u=o(533048),d=o(753457),l=o(102629),c=o(432654);const p="SpecialProjectModal__subheader",m=({title:e,text:t,button:o,style:m,image:h,backgroundImage:y,sendCloseReason:f,onClose:E})=>{const g=e=>{"A"===e.target.tagName&&f("link")};return(0,s.useEffect)((()=>{const[e]=document.getElementsByClassName(p);return e.addEventListener("click",g),()=>{e.removeEventListener("click",g)}}),[]),(0,i.jsxs)(a.ModalBox,{children:[(0,i.jsx)(d.ModalDismissButton,{onClick:E}),(0,i.jsx)(l.SpecialProjectHeader,{backgroundImage:y,image:h,style:m}),(0,i.jsxs)(n.ModalBody,{insetLevel:1,children:[(0,i.jsx)(r.ModalTextLayout,{subheader:(0,i.jsx)("span",{className:p,children:(0,c.parseReactWikiLinks)(t)}),subheaderMode:"primary",children:e}),(0,i.jsx)(_.ButtonLayout,{children:(0,i.jsx)(u.Button,{onClick:()=>{f("button"),o.action?.url&&window.nav.go(o.action.url)},size:"l",mode:"primary",children:o.title},"special-project-submit-button")})]})]})}},118415:(e,t,o)=>{"use strict";o.d(t,{showWebSpecialProjectModal:()=>n});var i=o(474848),s=o(272259),a=o(445677);const n=(e,t)=>{(0,s.showMessageBoxModal)((o=>(0,i.jsx)(a.SpecialProjectModal,{...o,...e,sendCloseReason:t})),{width:420,onDestroy:()=>{t("close")}})}},207431:(e,t,o)=>{"use strict";o.d(t,{AUDIO_STORAGE_KEYS_ENUM:()=>i});const i={AUDIO_PREVIEW_TOOLTIP_SHOW_DATE_TIME:"audio_preview_tooltip_show_date_time"}},298077:(e,t,o)=>{"use strict";o.d(t,{createAudioDislikesInMyMusicWebService:()=>A});var i=o(94359),s=o(919225),a=o(23280),n=o(471027),r=o(255053),_=o(32489),u=o(278758),d=o(540401),l=o(753421),c=o(514640),p=o(277942),m=o(297420),h=o(630082),y=o(711055),f=o(671300),E=o(198155),g=o(145608),v=o(823103);function A(e){const t=(0,i.getEffectorServiceDomain)(e),o=new s.Emitter,f=(0,d.ensureAudioPlayerService)(),E=(0,a.ensureMyAudioDislikesService)(),g=(0,l.ensureMyAudioMusicWebService)(),v=(0,_.createEvent)(),{$fullIdsMap:A,fullIdsMapApi:P}=(0,n.createFullIdsMap)(t),{$fullIdsMap:T,fullIdsMapApi:I}=(0,n.createFullIdsMap)(t),{$fullIdsMap:O,fullIdsMapApi:C}=(0,n.createFullIdsMap)(t),M=(0,_.restore)(v,null),D=(0,_.attach)({source:M,async effect(e){if(!e)throw new Error("Audio not exists");const t=(0,r.getAudioFullId)(e);await Promise.all([g.addFx({audio:e,isNotificationDisabled:!0}),E.removeFx({identity:e})]),C.remove(t),f.updateAudioDislikeStatusFx({audioFullId:t,hasDislike:!1}),f.notifyFx({eventType:c.AudioPlayerEventType.AUDIO_RESTORE_BY_DISLIKE_ACTION,params:[t]}),o.emit(y.AudioDislikesInMyMusicWebServiceEventType.LastDislikedAudioInMyMusicRestored,{audio:e})}}),S=(0,_.attach)({source:(0,_.combine)({dislikesIdentitiesMap:E.$identitiesMap,myMusicIdentitiesMap:g.$identitiesMap,dislikeActionInitializedIdentitiesMap:A,myMusicActionInitializedIdentitiesMap:g.$initializedIdentitiesMap,isFinitePlaylist:(0,m.not)((0,h.equals)(f.$currentPlaylist.map((e=>Boolean(e?.isLive()||e?.isLoadable()))),!0)),playerCurrentAudio:f.$currentAudio,playerProgress:f.$progress}),async effect({dislikeActionInitializedIdentitiesMap:e,myMusicActionInitializedIdentitiesMap:t,dislikesIdentitiesMap:i,myMusicIdentitiesMap:s,isFinitePlaylist:a,playerCurrentAudio:n,playerProgress:_},{audio:u,audioEl:d=null,skipDeletionAudioFromMyMusic:m,needReloadTrackCode:h}){if(!u)throw new Error("Audio not exists");const A=(0,r.getAudioFullId)(u),P=n&&A===(0,r.getAudioFullId)(n)?_:0,T=Boolean(e[A]);if((0,p.hasDislike)({audio:u,dislikesIdentitiesMap:i,isDislikeActionInitialized:T}))throw new Error("Audio already disliked");const I=await w({playerService:f,audio:u,audioEl:d});try{let e=u;if(h){const t=await b(u,d);t&&(e={...u,trackCode:t})}await E.addFx({identity:u});if(!m&&(0,l.isMy)({identity:u,myMusicIdentitiesMap:s,isMyMusicActionInitialized:Boolean(t[A]),userId:window.vk.id}))try{await g.deleteFx({audio:u}),v(u),o.emit(y.AudioDislikesInMyMusicWebServiceEventType.AudioDislikedInMyMusic,{audio:e,playlistIdentity:I,playerProgress:P}),C.add(A),f.updateAudioDislikeStatusFx({audioFullId:A,hasDislike:!0}),f.notifyFx({eventType:c.AudioPlayerEventType.AUDIO_DELETE_BY_DISLIKE_ACTION,params:[A]})}catch(e){throw new Error("Failed to delete audio from MyMusic",{cause:e})}else o.emit(y.AudioDislikesInMyMusicWebServiceEventType.AudioDisliked,{audio:e,playlistIdentity:I,playerProgress:P});const i=f.getPlaylistQueue();if(a&&i&&i?.indexOfAudio?.(u)===i?.length-1)return;f.getCurrentAudio()?.id===u.id&&f.playNextFx()}catch(e){throw new Error("Failed to add dislike to audio",{cause:e})}}}),k=(0,_.attach)({source:(0,_.combine)({dislikesIdentitiesMap:E.$identitiesMap,initializedIdentitiesMap:A,lastDislikedAudioInMyMusic:M,isCancelDeletionLastDislikedAudioInMyMusicFxPending:D.pending,dislikedAudiosInMyMusicMap:O,playerCurrentAudio:f.$currentAudio,playerProgress:f.$progress}),async effect({initializedIdentitiesMap:e,dislikesIdentitiesMap:t,lastDislikedAudioInMyMusic:i,isCancelDeletionLastDislikedAudioInMyMusicFxPending:s,dislikedAudiosInMyMusicMap:a,playerCurrentAudio:n,playerProgress:_},{audio:u,audioEl:d=null,needReloadTrackCode:l}){if(!u)throw new Error("Audio not exists");const m=(0,r.getAudioFullId)(u),h=Boolean(e[m]);if(!(0,p.hasDislike)({audio:u,dislikesIdentitiesMap:t,isDislikeActionInitialized:h}))throw new Error("Audio not disliked");const A=await w({playerService:f,audio:u,audioEl:d}),P=Boolean(i)&&i?.id===u.id;let T=u;if(l){const e=await b(u,d);e&&(T={...u,trackCode:e})}try{!h||!(m in a)||s&&P?await E.removeFx({identity:u}):(P&&(o.emit(y.AudioDislikesInMyMusicWebServiceEventType.LastDislikedAudioInMyMusicRestoreRequestedByCancelDislikeButton,{audio:u}),v(null)),await Promise.all([g.addFx({audio:u,isNotificationDisabled:!0}),E.removeFx({identity:u})]),C.remove(m),f.notifyFx({eventType:c.AudioPlayerEventType.AUDIO_RESTORE_BY_DISLIKE_ACTION,params:[m]})),o.emit(y.AudioDislikesInMyMusicWebServiceEventType.AudioDislikeRemoved,{audio:T,playlistIdentity:A,playerProgress:n&&m===(0,r.getAudioFullId)(n)?_:0}),f.updateAudioDislikeStatusFx({audioFullId:m,hasDislike:!1})}catch(e){throw new Error("Failed to remove dislike from audio",{cause:e})}}}),L=(0,_.attach)({source:(0,_.combine)({dislikesIdentitiesMap:E.$identitiesMap,dislikeActionInitializedIdentitiesMap:A,playerCurrentAudio:f.$currentAudio,playerProgress:f.$progress}),async effect({dislikesIdentitiesMap:e,dislikeActionInitializedIdentitiesMap:t,playerCurrentAudio:i,playerProgress:s},{audio:a,audioEl:n,needReloadTrackCode:_,...u}){if(!a)throw new Error("Audio not exists");const d=await w({playerService:f,audio:a,audioEl:n}),l=(0,r.getAudioFullId)(a),c=(0,p.hasDislike)({audio:a,dislikesIdentitiesMap:e,isDislikeActionInitialized:l in t});let m=a;if(_){const e=await b(a,n);e&&(m={...a,trackCode:e})}c?(await Promise.all([E.removeFx({identity:a}),g.addFx({audio:m,needReloadTrackCode:!1,...u})]),f.updateAudioDislikeStatusFx({audioFullId:l,hasDislike:!1}),o.emit(y.AudioDislikesInMyMusicWebServiceEventType.AudioDislikeRemovedByAddToMyMusicButton,{audio:m,playlistIdentity:d,playerProgress:i&&l===(0,r.getAudioFullId)(i)?s:0})):await g.addFx({audio:m,audioEl:n,...u})}});return(0,_.sample)({clock:[S.done,k.done],filter:({params:{audio:e}})=>Boolean(e),fn:({params:{audio:e}})=>(0,r.getAudioFullId)(e),target:P.add}),(0,_.sample)({clock:[S,k],filter:({audio:e})=>Boolean(e),fn:({audio:e})=>(0,r.getAudioFullId)(e),target:I.add}),(0,_.sample)({clock:[S.finally,k.finally],filter:({params:{audio:e}})=>Boolean(e),fn:({params:{audio:e}})=>(0,r.getAudioFullId)(e),target:I.remove}),(0,u.reset)({clock:D.done,target:M}),{$dislikesIdentitiesMap:E.$identitiesMap,$dislikesInitializedIdentitiesMap:A,$dislikesLoadingIdentitiesMap:T,addDislikeFx:S,removeDislikeFx:k,$myMusicIdentitiesMap:g.$identitiesMap,$myMusicInitializedIdentitiesMap:g.$initializedIdentitiesMap,$myMusicLoadingIdentitiesMap:g.$loadingIdentitiesMap,addToMyMusicFx:L,deleteFromMyMusicFx:g.deleteFx,cancelDeletionLastDislikedAudioInMyMusicFx:D,events:o.listenable}}async function w({playerService:e,audio:t,audioEl:o}){if(t.album)return{id:t.album[v.AudioPlaylistTupleKeys.Id],ownerId:t.album[v.AudioPlaylistTupleKeys.OwnerId]};const i=e.getCurrentAudio();if(i&&(0,r.getAudioFullId)(i)===(0,r.getAudioFullId)(t)){const t=await e.getCurrentPlaylistFx();if(t){const e=t?.getPlaylistId(),o=t?.getPlaylistId();if(e&&o)return{id:+e,ownerId:+o}}}if(o){let e=f.AudioUtils.getContextPlaylist(o);if(e?.playlist){const t=e.playlist?.getPlaylistId(),o=e.playlist?.getPlaylistId();if(t&&o)return{id:+t,ownerId:+o}}}return null}async function b(e,t){const o=(0,E.getContextPlaylist)(t);if(!o)return null;return await(0,g.getAudioTrackCodeFromPlaylist)(o?.playlist,e)??null}},711055:(e,t,o)=>{"use strict";var i;o.d(t,{AudioDislikesInMyMusicWebServiceEventType:()=>i}),function(e){e.AudioDisliked="audioDisliked",e.AudioDislikedInMyMusic="audioDislikedInMyMusic",e.LastDislikedAudioInMyMusicRestored="lastDislikedAudioInMyMusicRestored",e.LastDislikedAudioInMyMusicRestoreRequestedByCancelDislikeButton="lastDislikedAudioInMyMusicRestoreRequestedByCancelDislikeButton",e.AudioDislikeRemoved="audioDislikeRemoved",e.AudioDislikeRemovedByAddToMyMusicButton="audioDislikeRemovedByAddToMyMusicButton"}(i||(i={}))},432800:(e,t,o)=>{"use strict";o.d(t,{ensureAudioDislikesInMyMusicWebService:()=>r,hasDislike:()=>n.hasDislike});var i=o(942451),s=o(32489),a=o(298077),n=o(277942);o(711055);const r=(0,i.makeSharedState)("global/web/audio/dislikesInMyMusic",(()=>(0,a.createAudioDislikesInMyMusicWebService)({domain:(0,s.createDomain)("global/web/audio/dislikesInMyMusic"),name:"global/web/audio/dislikesInMyMusic"})),{version:3})},830875:(e,t,o)=>{"use strict";o.d(t,{hasDislike:()=>a});var i=o(255053),s=o(668592);function a({audio:e,dislikesIdentitiesMap:t,isDislikeActionInitialized:o}){return!!e&&(!!t[(0,i.getAudioFullId)(e)]||!o&&((0,s.getAudioExtra)(e)?.dislike??!1))}},277942:(e,t,o)=>{"use strict";o.d(t,{hasDislike:()=>i.hasDislike});var i=o(830875)},282246:(e,t,o)=>{"use strict";o.d(t,{createAudioLongtapFetchService:()=>a});var i=o(32489),s=o(332583);function a(e){const t=(0,i.createDomain)("AudioLongtapModal"),o=(0,s.ensureMyMusicService)(),a=t.createStore(!1),n=t.createStore(!1),r=(0,i.attach)({effect:e.fetchAudioPreviewFx}),_=(0,i.attach)({effect:o.addFx}),u=t.createEvent();return n.reset(u),(0,i.sample)({clock:r.failData,fn:()=>!0,target:a}),(0,i.sample)({clock:r,fn:()=>!1,target:a}),(0,i.sample)({clock:_.doneData,fn:()=>!0,target:n}),(0,i.sample)({clock:_,fn:()=>!1,target:n}),{$failFetch:a,$successAddAudio:n,resetAddSuccessResult:u,fetchAudioPreviewFx:r,addAudioFx:_}}},672229:(e,t,o)=>{"use strict";o.d(t,{AudioLongtapModalService:()=>E});var i=o(514640),s=o(695290),a=o(327527),n=o(191457),r=o(132873),_=o(671300),u=o(774576),d=o(355110),l=o(449502),c=o(441914),p=o(332583),m=o(255053),h=o(282246),y=o(476726);let f=null;class E{static ensure(){return f||(f=new E,f)}async fetchPreview(e){await this.fetcher.fetchAudioPreviewFx({identity:(0,c.mapAPIRawIdToAudioIdentity)(e.fullId)}),this.previewPlayer.timelinePosition=0,this.previewPlayer.setCurrentAudio(e)}async play(e){const t={...this.getStatData(),audio:this.previewPlayer.currentAudio};this.statCollector.openModal(t),this.commonAudioWasPlaying=this.commonAudioPlayer.isPlaying(),await this.previewPlayer.play(e,this.commonAudioPlayer.getVolume()),this.commonAudioWasPlaying&&this.commonAudioPlayer.pauseByChangeChannel();const o=r.AudioLongtapTooltip.ensure();this.statCollector.start(this.getStatData()),o.canShow()&&o.disable()}setAudioElement(e){this.audioElement=e}stop(){const e=this.commonAudioPlayer.getCurrentAudio();if(this.previewPlayer.stop(),this.commonAudioWasPlaying&&e){const t=this.commonAudioPlayer.getCurrentPlaylist();this.commonAudioPlayer.resumeChannel({audio:e,playlist:t,context:void 0}),this.commonAudioWasPlaying=!1}}subscribeStop(e){this.previewPlayer.subscribe.call(this.previewPlayer,i.events.STOP_PREVIEW,e),this.previewPlayer.subscribe.call(this.previewPlayer,i.events.END_PREVIEW,e)}unsubscribeStop(e){this.previewPlayer.unsubscribe.call(this.previewPlayer,i.events.STOP_PREVIEW,e),this.previewPlayer.unsubscribe.call(this.previewPlayer,i.events.END_PREVIEW,e)}subscribeProgress(e){this.previewPlayer.subscribe.call(this.previewPlayer,i.events.PROGRESS_PREVIEW,e)}unsubscribeProgress(e){this.previewPlayer.unsubscribe.call(this.previewPlayer,i.events.PROGRESS_PREVIEW,e)}onCloseModal(e){if(this.audioElement)switch(e){case"click_exit":this.statCollector.closeBy(s.EventItemSubType.AUDIO_LONGTAP_CLICK_EXIT,this.getStatData());break;case"click_outside":this.statCollector.closeBy(s.EventItemSubType.AUDIO_LONGTAP_CLICK_OUTSIDE,this.getStatData());break;case"auto_finish":this.statCollector.closeBy(s.EventItemSubType.AUDIO_LONGTAP_AUTO_FINISH,this.getStatData())}this.audioElement=null,this.stop(),this.commonAudioWasPlaying=!1,this.previewPlayer.unsubscribe(i.events.STOP_PREVIEW,this.stop),this.previewPlayer.unsubscribe(i.events.END_PREVIEW,this.stop)}get currentAudio(){return this.previewPlayer.currentAudio}get timelinePosition(){return this.previewPlayer.timelinePosition}get playbackDuration(){return this.previewPlayer.playbackDuration}async addAudio(e){const t=(0,y.partConfigEnabled)("add_audio_to_effector_web");await this.fetcher.addAudioFx({trackedIdentity:{id:e.id,ownerId:e.owner_id,accessKey:e.accessKey,trackCode:e.trackCode},userId:window.vk.id});const o=(0,p.ensureMyMusicService)().$identitiesMap.getState()[(0,m.getAudioFullId)({id:e.id,ownerId:e.ownerId})];(0,a.getAudioPlayer)().notify(i.events.ADDED,e,o.id);const s={...this.getStatData(),audioAddedId:o.id||void 0};if(this.audioElement&&this.audioElement.classList.add("audio_row__added"),!t){_.AudioUtils.getAddRestoreInfo()[e.fullId]={state:"added",addedFullId:(0,m.getAudioFullId)({id:o.id,ownerId:o.ownerId}),audio:e}}this.statCollector.addTrack(s)}getStatData(){const e=this.commonAudioPlayer.getCurrentPlaylist(),t=e?.getPlaylistId()??void 0;return{audio:this.currentAudio,timelinePosition:this.timelinePosition,playlistId:t,playbackDuration:this.playbackDuration,volume:(0,l.unLogF)(this.commonAudioPlayer.getVolume()),snippetLength:this.previewPlayer.previewLength}}goToTrack(e){e&&(this.statCollector.goToTrack(this.getStatData()),window.nav.go(`audio${e}`))}goToArtist(e){e&&(this.statCollector.goToArtist(this.getStatData()),window.nav.go(`artist/${e}`))}constructor(){this.previewPlayer=n.PreviewAudioPlayerEffector.ensure(),this.commonAudioPlayer=(0,a.getAudioPlayer)(),this.statCollector=u.AudioLongtapStatCollectorEffector.ensure(),this.previewPlayer.subscribe(i.events.STOP_PREVIEW,this.stop),this.previewPlayer.subscribe(i.events.END_PREVIEW,this.stop),this.fetcher=(0,h.createAudioLongtapFetchService)(d.audioPreviewsService)}}},774576:(e,t,o)=>{"use strict";o.d(t,{AudioLongtapStatCollectorEffector:()=>r});var i=o(695290),s=o(581903);const a=e=>{if(!e.audio)return{event_category:e.eventCategory};const{trackCode:t,id:o,ownerId:i,albumId:s}=e.audio;return{track_code:t,audio_id:o,audio_owner_id:i,playlist_id:s,playlist_owner_id:void 0,audio_id_new:e.audioAddedId||void 0,timeline_position:e.timelinePosition,playback_duration:e.playbackDuration,volume:Math.round(100*e.volume),audio_length:e.snippetLength,event_category:e.eventCategory}};let n=null;class r{static ensure(){return n||(n=new r,n)}start(e){const t=a({...e,eventCategory:i.LongtapEventCategory.play});this.actionStatCollector.logEvent({type:i.ActionProductionStatEventTypes.TYPE_CATALOG_AUDIO_LONGTAP_ITEM,[i.ActionProductionStatEventTypes.TYPE_CATALOG_AUDIO_LONGTAP_ITEM]:{event_type:i.EventItemType.START,event_subtype:i.EventItemSubType.AUDIO_LONGTAP,...t}})}openModal(e){this.audio=e.audio;const t=a(e);this.sendView(i.EventItemType.OPEN,i.EventItemSubType.AUDIO_LONGTAP_OPEN,i.LongtapEventCategory.view,t)}addTrack(e){const t=a({...e,eventCategory:i.LongtapEventCategory.action});this.actionStatCollector.logEvent({type:i.ActionProductionStatEventTypes.TYPE_CATALOG_AUDIO_LONGTAP_ITEM,[i.ActionProductionStatEventTypes.TYPE_CATALOG_AUDIO_LONGTAP_ITEM]:{event_type:i.EventItemType.ADDED,event_subtype:i.EventItemSubType.AUDIO_ADD_AFTER_LONGTAP,...t}})}tipHasShown(){this.sendView(i.EventItemType.HINT,i.EventItemSubType.AUDIO_LONGTAP_HINT,i.LongtapEventCategory.view)}closeBy(e,t){if(!this.audio)return;const o=a({...t,audio:this.audio,eventCategory:i.LongtapEventCategory.play});this.actionStatCollector.logEvent({type:i.ActionProductionStatEventTypes.TYPE_CATALOG_AUDIO_LONGTAP_ITEM,[i.ActionProductionStatEventTypes.TYPE_CATALOG_AUDIO_LONGTAP_ITEM]:{event_type:i.EventItemType.STOP,event_subtype:e,...o}}),this.audio=null}goToTrack(e){this.audio=e.audio;const t=a(e);this.sendView(i.EventItemType.LONGTAP_DRILLDOWN,i.EventItemSubType.AUDIO_LONGTAP_GO_TO_TRACK,i.LongtapEventCategory.nav,t)}goToArtist(e){this.audio=e.audio;const t=a(e);this.sendView(i.EventItemType.LONGTAP_DRILLDOWN,i.EventItemSubType.AUDIO_LONGTAP_GO_TO_ARTIST,i.LongtapEventCategory.nav,t)}sendView(e,t,o,s){const a={type:i.ViewProductionStatEventTypes.TYPE_CATALOG_AUDIO_LONGTAP_ITEM,[i.ViewProductionStatEventTypes.TYPE_CATALOG_AUDIO_LONGTAP_ITEM]:{...s,event_type:e,event_subtype:t,event_category:o}},n={type:e,track_code:s?.track_code};this.viewCollector.logEvent(a,n)}constructor(){this.audio=null,this.productCollector=new s.ProductionStatCollector,this.viewCollector=new s.ViewStatCollector(this.productCollector),this.actionStatCollector=new s.ActionStatCollector(this.productCollector)}}},132873:(e,t,o)=>{"use strict";o.d(t,{AudioLongtapTooltip:()=>v});var i=o(434518),s=o(763812),a=o(96526),n=o(623702),r=o(207431),_=o(774576),u=o(741531),d=o(165753),l=o(942451),c=o(119265);var p=(0,s._)("_audioPage"),m=(0,s._)("_hint"),h=(0,s._)("_tooltip"),y=(0,s._)("_isOpen"),f=(0,s._)("_disabled"),E=(0,s._)("_isUserAuthorized"),g=(0,s._)("_getTooltip");class v{getHints(){(0,i._)(this,E)[E]&&(0,i._)(this,p)[p].isInitialized&&(0,u.ensureAccountHelpHintsService)().getHelpHintsFx()}getHint(){const e=(0,u.ensureAccountHelpHintsService)().$helpHints.getState()[d.AvailableHelpHints.ACCOUNT_HINT_AUDIO_LONG_TAP_PREVIEW_WEB];return(0,i._)(this,m)[m]=e||null,(0,i._)(this,m)[m]}canShow(){if((0,i._)(this,f)[f])return!1;let e=!1;if(this.getHint()){const t=n.vkLocalStorage.getItem(r.AUDIO_STORAGE_KEYS_ENUM.AUDIO_PREVIEW_TOOLTIP_SHOW_DATE_TIME),o=t?JSON.parse(t):null,i=o?o.firstShow:null;if(i){const t=new Date(+i).getTime(),s=(new Date).getTime(),a=Math.abs(s-t),_=Math.ceil(a/864e5);if(_<=3&&o?.disabledDay!==_){e=!0;const t={firstShow:i,disabledDay:_};n.vkLocalStorage.setItem(r.AUDIO_STORAGE_KEYS_ENUM.AUDIO_PREVIEW_TOOLTIP_SHOW_DATE_TIME,JSON.stringify(t))}o?.disabledDay===_&&(e=!1)}else{e=!0;const t={firstShow:(new Date).getTime(),disabledDay:1};n.vkLocalStorage.setItem(r.AUDIO_STORAGE_KEYS_ENUM.AUDIO_PREVIEW_TOOLTIP_SHOW_DATE_TIME,JSON.stringify(t))}}return e}async show(e){e&&((0,i._)(this,h)[h]=(0,i._)(this,g)[g](e),(0,i._)(this,h)[h]&&((0,i._)(this,h)[h].show(),(0,i._)(this,y)[y]=!0,_.AudioLongtapStatCollectorEffector.ensure().tipHasShown()))}disable(){this.getHint()&&(0,u.ensureAccountHelpHintsService)().hideHelpHint({hintId:d.AvailableHelpHints.ACCOUNT_HINT_AUDIO_LONG_TAP_PREVIEW_WEB}),(0,i._)(this,f)[f]=!0}get isOpen(){return(0,i._)(this,y)[y]}constructor({audioPage:e}){Object.defineProperty(this,E,{get:A,set:void 0}),Object.defineProperty(this,g,{value:w}),Object.defineProperty(this,p,{writable:!0,value:void 0}),Object.defineProperty(this,m,{writable:!0,value:void 0}),Object.defineProperty(this,h,{writable:!0,value:void 0}),Object.defineProperty(this,y,{writable:!0,value:void 0}),Object.defineProperty(this,f,{writable:!0,value:void 0}),(0,i._)(this,y)[y]=!1,(0,i._)(this,f)[f]=!1,(0,i._)(this,p)[p]=e}}function A(){return Boolean(window?.vk?.id)}function w(e){const t={autoShow:!1,cls:"feature_intro_tt feature_intro_blue_tt feature_info_tooltip audio_snippet_tooltip",content:(0,i._)(this,m)[m]?.title,align:"right",centerShift:8,appendTo:document.body,autoAdjustToViewport:!0,noAutoHideOnWindowClick:!0,autoHide:!0,onHide:()=>{(0,i._)(this,y)[y]=!1,(0,i._)(this,h)[h]?.destroy()},width:286},o=new a.ElementTooltip(e,t);return window.cur?.destroy?.push((()=>{o?.destroy()})),o}v.ensure=(0,l.makeSharedState)("AudioLongtapTooltip",(()=>new v({audioPage:c.AudioPageProxy.ensure()})),{version:1})},933631:(e,t,o)=>{"use strict";o.d(t,{ensureAudioPageMyAudioPlaylistsService:()=>_});var i=o(32489),s=o(94359),a=o(958955),n=o(918081),r=o(842225);const _=(0,o(942451).makeSharedState)("global/audio/audioPage/myPlaylists",(()=>function({config:e,myAudioPlaylistsService:t}){const o=(0,s.getEffectorServiceDomain)(e),i=o.createStore({}),r=o.createEffect((async e=>await t.createFx({...e}))),_=o.createEffect((async e=>{await t.deleteFx({...e})}));return i.on(r.done,((e,{params:t,result:o})=>(0,a.addPairToMap)(e,{key:t.blockId,value:o}))),i.on(_.done,((e,{params:t})=>(0,n.removePairFromMap)(e,t.blockId))),{createFx:r,deleteFx:_,setUserId:t.setUserId,$myAudioPlaylistsIdentitiesMap:i}}({config:{domain:(0,i.createDomain)("global/audio/audioPage/myPlaylists"),name:"global/audio/audioPage/myPlaylists"},myAudioPlaylistsService:(0,r.ensureMyAudioPlaylistsService)()})),{version:1})},499012:(e,t,o)=>{"use strict";o.d(t,{ensureAudioPageMyAudioPlaylistsService:()=>i.ensureAudioPageMyAudioPlaylistsService});var i=o(933631)},473137:(e,t,o)=>{"use strict";o.d(t,{createAudioPageService:()=>T});var i=o(94359),s=o(471027),a=o(255053),n=o(156693),r=o(760325),_=o(847891),u=o(248251),d=o(851579),l=o(432800),c=o(32489),p=o(753421),m=o(119265),h=o(7144),y=o(671300),f=o(620626),E=o(20025),g=o(610989),v=o(879007),A=o(248298),w=o(327527),b=o(624216),P=o(525294);function T(e){const t=(0,i.getEffectorServiceDomain)(e),o=m.AudioPageProxy.ensure(),_=(0,l.ensureAudioDislikesInMyMusicWebService)(),u=(0,d.ensureGroupsAudioMusicWebService)(),T=t.createEvent(),M=(0,c.restore)(T,null),{$fullIdsMap:D,fullIdsMapApi:S}=(0,s.createFullIdsMap)(t),{$fullIdsMap:k,fullIdsMapApi:L}=(0,s.createFullIdsMap)(t),{$deleteAudiosFromMyMusicForLastWeekDataIdentitiesMap:B,deleteAudiosFromMyMusicForLastWeekDataIdentitiesMapApi:R}=(0,P.createDeleteAudiosFromMyMusicForLastWeekDataIdentities)(t),x=t.createEffect((({audioEl:e,inProgress:t})=>{e&&(e.dataset["in-progress"]=(0,h.intval)(t).toString())})),F=(0,c.attach)({source:(0,c.combine)({myMusicIdentitiesMap:_.$myMusicIdentitiesMap,myMusicInitializedIdentitiesMap:_.$myMusicInitializedIdentitiesMap,deletedFromMyMusicAudiosIdentitiesMap:D,deleteAudiosFromMyMusicForLastWeekDataIdentitiesMap:B}),async effect({myMusicIdentitiesMap:e,myMusicInitializedIdentitiesMap:t,deletedFromMyMusicAudiosIdentitiesMap:i,deleteAudiosFromMyMusicForLastWeekDataIdentitiesMap:s},{audio:n,audioEl:r,playlist:u,audioRef:d}){if(!n)throw new Error("Audio not exists");const l=(0,a.getAudioFullId)(n),c=(0,p.isMy)({identity:n,myMusicIdentitiesMap:e,isMyMusicActionInitialized:l in t,userId:window.vk.id});try{c?await _.deleteFromMyMusicFx({audioEl:r,audio:n,audioRef:d,needReloadTrackCode:!0}):(u&&o.onUserAction(n,u),await _.addToMyMusicFx({audioEl:r,audio:n,audioRef:d,isNotificationDisabled:!0,needReloadTrackCode:!0}),c?S.add(l):(l in i&&S.remove(l),l in s&&R.remove(l)),!c&&l in i?S.remove(l):c&&S.add(l))}catch(e){throw new Error(`${c?'Failed to delete audio from "My Music"':'Failed to add audio to "My music"'}`,{cause:e})}}}),N=(0,c.attach)({source:u.$identitiesMap,async effect(e,{audioEl:t,audio:i,groupId:s,playlist:a}){if(!i)throw new Error("Audio not exists");const r=(0,d.isAddedToGroup)({identity:i,groupsMusicIdentitiesMap:e,groupId:s});try{r?await u.deleteFx({audioEl:t,groupId:s,audio:i}):(a&&o.onUserAction(i,a),await u.addFx({audioEl:t,groupId:s,audio:i}),L.remove((0,n.getGroupAudioFullId)(i,s)))}catch(e){throw new Error(`${r?"Failed to delete audio from group with id":"Failed to add audio to group with id"} ${s}`,{cause:e})}}}),U=(0,c.attach)({source:M,async effect(e,{audioEl:t,audio:i,audioRef:s=""}){if(!O(e))return window.vk&&window.vk.widget&&window.Widgets?void window.Widgets.oauth():void console.error("The user is not authorized, it is impossible to add or delete audio");if(window.cur.viewAsBox)return void window.cur.viewAsBox();if(C(t))return;const a=i||y.AudioUtils.getAudioFromEl(i,!0);if(!a)throw new Error("Audio not exists");const n=o.currentPlaylist,_=I(o),u=(0,r.isNumber)(_),d=u&&t&&!t.classList.contains("audio_row__deleted")&&Boolean(t.closest(".CatalogBlock__group_audios"));!u||d?await F({audioEl:t,audio:a,playlist:n,audioRef:s}):await N({audioEl:t,audio:a,groupId:_,playlist:n})}}),W=(0,c.attach)({source:B,async effect(e,{audioEl:t,audio:o}){if(!o)throw new Error("Audio not exists");const i=(0,a.getAudioFullId)(o),s=e[i];if(!s)throw new Error("Audio is not ready to delete all audio from the last week in My Music");(0,E.showFastBox)({title:g.getLang("audio_delete_all_title"),onHide:()=>{x({audioEl:t,inProgress:!1})}},s.message||"",g.getLang("global_delete"),(function(e){let t=(0,v.extend)({act:"delete_all"},s.data);b.ajax.post("al_audio.php",t,{showProgress:()=>(0,A.lockButton)(e),onDone:function(){let e=(0,w.getAudioPlayer)().getPlaylist(f.AudioPlaylist.TYPE_PLAYLIST,s.data.from_id,f.AudioPlaylist.DEFAULT_PLAYLIST_ID);(0,w.getAudioPlayer)().deletePlaylist(e),S.remove(i),window.nav.reload()},onFail:()=>!0})}),g.getLang("global_cancel"))}}),K=(0,c.attach)({source:(0,c.combine)({userId:M,myMusicInitializedIdentitiesMap:_.$myMusicInitializedIdentitiesMap,myMusicIdentitiesMap:_.$myMusicIdentitiesMap,deleteAudiosFromMyMusicForLastWeekDataIdentitiesMap:B}),async effect({userId:e,myMusicIdentitiesMap:t,myMusicInitializedIdentitiesMap:i,deleteAudiosFromMyMusicForLastWeekDataIdentitiesMap:s},{audio:d,audioEl:l}){if(!O(e))return void console.error("The user is not authorized, it is impossible to add or delete audio");if(!d)throw new Error("Audio not exists");if(C(l))return;window.tooltips&&window.tooltips.hideAll();const c=(0,a.getAudioFullId)(d);if(c in s)return void await W({audioEl:l,audio:d});const m=I(o),h=(0,r.isNumber)(m)&&d.ownerId===m;if(!(0,p.isMy)({identity:d,myMusicIdentitiesMap:t,isMyMusicActionInitialized:c in i,userId:e})&&!h)throw new Error("Audio not added");if(d.isClaimed&&l?.remove(),h)return await u.deleteFx({audioEl:l,groupId:m,audio:d,needShowDeletedAudioRowState:!0}),d.isClaimed&&y.AudioUtils.deleteDeletedAudios(),x({audioEl:l,inProgress:!1}),void L.add((0,n.getGroupAudioFullId)(d,m));const[f,E]=await b.ajax.promisifiedPost("al_audio.php",{act:"delete_audio",oid:d.ownerId,aid:d.id,hash:d.deleteHash,restore:1,track_code:d.trackCode});f&&R.add({audioFullId:c,value:{data:f,message:E||""}}),await _.deleteFromMyMusicFx({audio:d,audioEl:l,forceRemoveFromStoreParams:{oldIdentity:d,newIdentity:d}}),S.add(c),d.isClaimed&&y.AudioUtils.deleteDeletedAudios(),x({audioEl:l,inProgress:!1})}});return(0,c.sample)({clock:[U,K],fn:({audioEl:e})=>({audioEl:e,inProgress:!0}),target:x}),(0,c.sample)({clock:U.finally,fn:({params:{audioEl:e}})=>({audioEl:e,inProgress:!1}),target:x}),{$myMusicIdentitiesMap:_.$myMusicIdentitiesMap,$deletedFromMyMusicAudiosIdentitiesMap:D,$deletedFromGroupAudiosIdentitiesMap:k,$deleteAudiosFromMyMusicForLastWeekDataIdentitiesMap:B,toggleAddAudioFx:U,deleteAudioLegacyFx:K,setUserId:T}}function I(e){if(!(0,r.isNumber)(e.ownerId))return null;return Boolean(e.ownerId&&(0,r.isNumber)(e.ownerId)&&_.Ranges.isGroupId(e.ownerId)&&e.canAddToGroup)?(0,u.convertToGroupMusicId)(e.ownerId):null}function O(e){return(0,r.isNumber)(e)&&_.Ranges.isUserId(e)}function C(e){return Boolean(e?.dataset?.["in-progress"])}},145357:(e,t,o)=>{"use strict";o.d(t,{ensureAudioPageService:()=>n});var i=o(942451),s=o(32489),a=o(473137);const n=(0,i.makeSharedState)("global/audio/audioPage/service",(()=>(0,a.createAudioPageService)({domain:(0,s.createDomain)("global/audio/audioPage/service"),name:"global/audio/audioPage/service"})),{version:2})},525294:(e,t,o)=>{"use strict";o.d(t,{createDeleteAudiosFromMyMusicForLastWeekDataIdentities:()=>n});var i=o(32489),s=o(958955),a=o(918081);function n(e){const t=e.createStore({});return{$deleteAudiosFromMyMusicForLastWeekDataIdentitiesMap:t,deleteAudiosFromMyMusicForLastWeekDataIdentitiesMapApi:(0,i.createApi)(t,{add:(e,t)=>(0,s.addPairToMap)(e,{key:t.audioFullId,value:t.value}),remove:(e,t)=>(0,a.removePairFromMap)(e,t)})}}},579032:(e,t,o)=>{"use strict";o.d(t,{ensureAudioPageMyAudioPlaylistsService:()=>i.ensureAudioPageMyAudioPlaylistsService,ensureAudioPageService:()=>s.ensureAudioPageService});var i=o(499012),s=o(145357)},487379:(e,t,o)=>{"use strict";o.d(t,{createAudioPlayerService:()=>c});var i=o(32489),s=o(327527),a=o(514640),n=o(13709),r=o(735477),_=o(94359),u=o(264874),d=o(281524),l=o(8520);function c(e){const t=(0,_.getEffectorServiceDomain)(e),o=t.createEvent(),c=()=>{const e=(0,s.getAudioPlayer)();if(!e)throw new Error("Audio player does not initialize");return e.getPlaylistQueue()??null},p=t.createEvent(),m=t.createEvent(),h=t.createEvent(),y=t.createEvent(),f=t.createEvent(),E=t.createEvent(),g=t.createEvent(),v=t.createEvent(),A=t.createEvent(),w=t.createEvent(),b=t.createEvent(),P=t.createEvent(),T=t.createEvent(),I=t.createEvent(),O=t.createEvent(),C=t.createEvent(),M=t.createEvent(),D=t.createEvent(),S=t.createEvent(),k=(0,i.restore)(p,null),L=t.createStore(null,{updateFilter:(e,t)=>!(0,l.isEqual)(e,t)}),B=L.map((e=>e&&(0,r.audioTupleToAudioObject)(e)||null)),R=(0,i.restore)(m,!1),x=(0,i.restore)(w,!1),F=(0,i.restore)(b,null),N=(0,i.restore)(h,null),U=(0,i.restore)(f,0),W=(0,i.restore)(E,0),K=(0,i.restore)(g,0),V=(0,i.restore)(v,0),H=(0,i.restore)(A,1),j=(0,i.restore)(P,!1),$=(0,i.restore)(T,!1),G=(0,i.restore)(I,!1),q=(0,i.restore)(O,!1),Y=(0,i.restore)(C,!1),z=t.createEffect((()=>{const e=(0,s.getAudioPlayer)();if(!e)throw new Error("Audio player does not initialize");m(e.isPlaying()),w(e.ads.isActive||!1),b(e.ads.getCurrentAd()||null),h(e.getCurrentPlaylist()||null),y(e.getCurrentAudio()||null),f(e.getCurrentProgress()??0),E(0),g(e.getCurrentBuffered()??0),v(e.getVolume()||0),A(n.AudioPlayer.podcastGetPlaybackRate()||1),P(Boolean(n.AudioPlayer.getDurationType())),T(Boolean(c()?.shuffled)),I(Boolean(e.isRepeatCurrentAudio())),O(Boolean(e.isRepeatAll())),e.subscribe(a.AudioPlayerEventType.PLAYER_IS_PLAYING_CHANGED,(e=>{m(e)})),e.subscribe(a.AudioPlayerEventType.PLAYLIST_CHANGED,(()=>{h(e.getCurrentPlaylist()||null)})),e.on(this,a.AudioPlayerEventType.PLAYLIST_CLEAR_REQUESTED,(()=>{D()})),e.on(this,a.AudioPlayerEventType.PLAYLIST_CLEARED,(()=>{h(e.getCurrentPlaylist()||null),P(Boolean(n.AudioPlayer.getDurationType())),T(c()?.shuffled??!1),A(n.AudioPlayer.podcastGetPlaybackRate()||1),I(Boolean(e.isRepeatCurrentAudio())),O(Boolean(e.isRepeatAll()))})),e.subscribe(this,a.AudioPlayerEventType.PLAYER_IS_AD_CHANGED,(t=>{w(t||!1),b(e.ads.getCurrentAd()||null)})),e.on(this,[a.AudioPlayerEventType.AD_STARTED,a.AudioPlayerEventType.AD_READY,a.AudioPlayerEventType.AD_DEINITED,a.AudioPlayerEventType.AD_COMPLETED],(()=>{w(e.ads.isActive||!1),b(e.ads.getCurrentAd()||null)})),e.on(this,[a.AudioPlayerEventType.PLAY,a.AudioPlayerEventType.PLAY_REQUESTED],(()=>{M()})),e.on(this,[a.AudioPlayerEventType.PLAY,a.AudioPlayerEventType.PLAY_REQUESTED,a.AudioPlayerEventType.CURRENT_RADIOSTATION_FOLLOW_STATUS_UPDATE,a.AudioPlayerEventType.CURRENT_AUDIO_DISLIKE_STATUS_UPDATE,a.AudioPlayerEventType.PLAYLIST_CLEARED,a.AudioPlayerEventType.CURRENT_CHANGED,a.AudioPlayerEventType.UPDATE],(e=>{y(e||null)})),e.subscribe(a.AudioPlayerEventType.CURRENT_RADIOSTATION_FOLLOW_STATUS_UPDATE,(e=>{S(e)})),e.subscribe(a.AudioPlayerEventType.CURRENT_CHANGED,(()=>{f(0)})),e.subscribe(a.AudioPlayerEventType.PROGRESS,((t,o)=>{C(!1),f(e.ads?.isActive?e.ads.getCurrentProgress():t),E(o)})),e.subscribe(a.AudioPlayerEventType.BUFFERED,(t=>{g(e.ads?.isActive?0:t)})),e.subscribe(a.AudioPlayerEventType.VOLUME,(e=>{v(e)})),e.on(this,a.AudioPlayerEventType.UPDATE,(()=>{P(Boolean(n.AudioPlayer.getDurationType()))})),e.on(this,a.AudioPlayerEventType.START_LOADING,(()=>{C(!0)})),e.on(this,a.AudioPlayerEventType.CAN_PLAY,(()=>{C(!1)})),e.on(this,a.AudioPlayerEventType.ENDED,(()=>{C(!1)})),e.on(this,a.AudioPlayerEventType.FAILED,(()=>{C(!1)})),p(e)})),X=(0,d.attachPlayer)(k,(async(e,t)=>{if(!t)return void e.playAudioItem();const{audio:o,playlist:i,context:s,byPlayerButton:a=!1}=t;e[a?"playByButton":"playAudioItem"].bind(e)({audio:o,playlist:i,context:s})})),Q=(0,d.attachPlayer)(k,((e,t)=>{if(!t)return void e.pauseByButton();const{byChangeChannel:o=!1}=t;e[o?"pauseByChangeChannel":"pauseByButton"].bind(e)()})),Z=(0,d.attachPlayer)(k,(e=>{e.resume()})),J=(0,d.attachPlayer)(k,(e=>{e.playNext()})),ee=(0,d.attachPlayer)(k,(e=>{e.playPrev()})),te=(0,d.attachPlayer)(k,(e=>{e.playNextByButton()})),oe=(0,d.attachPlayer)(k,(e=>{e.playPrevByButton()})),ie=(0,d.attachPlayer)(k,((e,{audioEl:t,audio:o})=>{e.setNext(t,o)})),se=(0,d.attachPlayer)(k,((e,t)=>{e.seek(t)})),ae=(0,d.attachPlayer)(k,((e,t)=>{e.seekBySlider(t)})),ne=(0,d.attachPlayer)(k,((e,t)=>{e.setVolume(t)})),re=(0,d.attachPlayer)(k,(e=>{e.toggleDurationType()})),_e=t.createEffect((()=>{T(c()?.shuffled??!1)})),ue=(0,d.attachPlayer)(k,(e=>{e.toggleRepeatCurrentAudio(),I(Boolean(e.isRepeatCurrentAudio())),O(Boolean(e.isRepeatAll()))})),de=(0,d.attachPlayer)(k,(e=>{e.toggleRepeatAll(),I(Boolean(e.isRepeatCurrentAudio())),O(Boolean(e.isRepeatAll()))})),le=(0,i.attach)({source:(0,i.combine)({ap:k,prevSpeed:H}),effect({ap:e,prevSpeed:t},o){if(!e)throw new Error("Audio player does not initialize");t!==o&&(e.podcastChangePlaybackRate(1!==o&&o<t),A(n.AudioPlayer.podcastGetPlaybackRate()??1))}}),ce=(0,d.attachPlayer)(k,(e=>e.getCurrentPlaylist()??null)),pe=(0,d.attachPlayer)(k,((e,{audio:t,actionType:o,ref:i="",refEl:s=null})=>{e.podcastSetActionRef(t,o,i,s)})),me=(0,d.attachPlayer)(k,((e,{audioFullId:t,hasDislike:o})=>{e.updateAudioDislikeStatus(t,o)})),he=(0,d.attachPlayer)(k,((e,t)=>e?.emitter?.emit(t.eventName,t.data))),ye=(0,d.attachPlayer)(k,((e,{eventType:t,params:o})=>e.notify(t,...o)));return(0,i.sample)({clock:(0,u.once)(o),target:z}),(0,i.sample)({clock:y,target:L}),{$isPlaying:R,$isAd:x,$currentAd:F,$currentPlaylist:N,$currentAudio:B,$currentAudioTuple:L,$progress:U,$duration:W,$loadingProgress:K,$volume:V,$negativeDurationTypeEnabled:j,$isShuffled:$,$isRepeatCurrentAudio:G,$isRepeatAll:q,$playbackSpeed:H,$isPending:Y,playFx:X,pauseFx:Q,resumeFx:Z,playNextFx:J,playPrevFx:ee,playNextByButtonFx:te,playPrevByButtonFx:oe,setNextFx:ie,seekFx:se,seekBySliderFx:ae,updateVolumeFx:ne,toggleNegativeDurationTypeFx:re,updatedIsShuffledFx:_e,toggleRepeatCurrentAudioFx:ue,toggleRepeatAllFx:de,updatePlaybackSpeedFx:le,getCurrentPlaylistFx:ce,podcastSetActionRefFx:pe,updateAudioDislikeStatusFx:me,emitFx:he,notifyFx:ye,notifyAudioStartedPlaying:M,notifyPlaylistClearRequested:D,notifyCurrentRadioStationFollowStatusUpdate:S,init:o,getCurrentAudio:()=>{const e=(0,s.getAudioPlayer)();if(!e)throw new Error("Audio player does not initialize");const t=e.getCurrentAudio();return t?(0,r.audioTupleToAudioObject)(t):null},getPlaylistQueue:c,getPlaylist:({type:e,ownerId:t,albumId:o,accessHash:i,blockId:a})=>{const n=(0,s.getAudioPlayer)();if(!n)throw new Error("Audio player does not initialize");return n.getPlaylist(e,t,o,i,a)||null}}}},540401:(e,t,o)=>{"use strict";o.d(t,{AudioPlayerPodcastActionType:()=>n.AudioPlayerPodcastActionType,ensureAudioPlayerService:()=>r});var i=o(942451),s=o(32489),a=o(487379),n=o(306948);const r=(0,i.makeSharedState)("global/web/audio/player",(()=>(0,a.createAudioPlayerService)({domain:(0,s.createDomain)("global/web/audio/player"),name:"audio/web/audio/player"})),{version:3})},281524:(e,t,o)=>{"use strict";o.d(t,{attachPlayer:()=>s});var i=o(32489);function s(e,t){return(0,i.attach)({source:e,effect(e,o){if(!e)throw new Error("Audio player does not initialize");return t(e,o)}})}},306948:(e,t,o)=>{"use strict";o.d(t,{AudioPlayerPodcastActionType:()=>i});var i,s=o(697034);!function(e){e[e.Play=s.ACTION_PLAY]="Play",e[e.Pause=s.ACTION_PAUSE]="Pause",e[e.Seek=s.ACTION_SEEK]="Seek",e[e.TimeMaker=s.ACTION_TIME_MARKER]="TimeMaker",e[e.Heartbeat=s.ACTION_HEARTBEAT]="Heartbeat"}(i||(i={}))},355110:(e,t,o)=>{"use strict";o.d(t,{audioPreviewsService:()=>i});const i=(0,o(398565).ensureAudioPreviewsService)()},181353:(e,t,o)=>{"use strict";o.d(t,{createGroupsMusicWebService:()=>h});var i=o(94359),s=o(611713),a=o(471027),n=o(255053),r=o(156693),_=o(32489),u=o(143219),d=o(746570),l=o(540401),c=o(514640),p=o(620626),m=o(671300);function h(e){const t=(0,i.getEffectorServiceDomain)(e),o=(0,s.ensureGroupsMusicService)(),h=(0,l.ensureAudioPlayerService)(),{$fullIdsMap:y,fullIdsMapApi:f}=(0,a.createFullIdsMap)(t),E=(0,_.attach)({source:(0,_.combine)({groupsMusicIdentitiesMap:o.$identitiesMap}),async effect({groupsMusicIdentitiesMap:e},{audio:t,groupId:i,audioEl:s=null}){if(!t)throw new Error("Audio not exists");if((0,u.isAddedToGroup)({identity:t,groupsMusicIdentitiesMap:e,groupId:i}))throw new Error(`Audio already in group with id ${i}`);const a=(0,n.getAudioFullId)(t);let r=document.querySelector(`._audio_row_${a}`);r=r==s?null:r;try{i!==t.ownerId&&s&&s.classList.add("audio_row__added"),i!==t.ownerId&&r&&r.classList.add("audio_row__added"),h.notifyFx({eventType:c.AudioPlayerEventType.ADDED,params:[a]}),await o.addFx({groupId:i,trackedIdentity:t}),s&&(s.classList.remove("audio_row__deleted"),m.AudioUtils.onRowOver(s,!1,!0)),r&&(r.classList.remove("audio_row__deleted"),m.AudioUtils.onRowOver(r,!1,!0)),h.notifyFx({eventType:c.AudioPlayerEventType.MUSIC_AUDIOS_ADD,params:[t,Boolean(s)&&{audioElement:s}]})}catch(e){throw i!==t.ownerId&&s&&s.classList.remove("audio_row__added"),i!==t.ownerId&&r&&r.classList.remove("audio_row__added"),new Error(`Failed to add audio to group with id ${i}`,{cause:e})}}}),g=(0,_.attach)({source:(0,_.combine)({groupsMusicIdentitiesMap:o.$identitiesMap}),async effect({groupsMusicIdentitiesMap:e},{audio:t,groupId:i,audioEl:s=null,needShowDeletedAudioRowState:a}){if(!t)throw new Error("Audio not exists");const _=(0,r.getGroupAudioFullId)(t,i),u=(0,d.isGroupAudio)({identity:t,groupsMusicIdentitiesMap:e,groupId:i}),l=e[_];if(!u&&!l)throw new Error(`Audio not found in group with id ${i}`);const y=(0,n.getAudioFullId)(t),f=(0,n.getAudioFullId)(l??t);let E=document.querySelector(`._audio_row_${y}`);E=E==s?null:E;try{s&&!a&&s.classList.remove("audio_row__added"),E&&!a&&E.classList.remove("audio_row__added"),h.notifyFx({eventType:c.AudioPlayerEventType.REMOVED,params:[y,f]}),await o.deleteFx({groupId:i,audioId:l?l.id:t.id}),s&&a&&(s.classList.add("audio_row__deleted"),m.AudioUtils.onRowOver(s,!1,!0),s.classList.remove("audio_row__added")),E&&a&&(E.classList.add("audio_row__deleted"),m.AudioUtils.onRowOver(E,!1,!0),E.classList.remove("audio_row__added"));const e=h.getPlaylist({type:p.AudioPlaylist.TYPE_PLAYLIST,ownerId:i,albumId:p.AudioPlaylist.DEFAULT_PLAYLIST_ID});e&&e.removeAudio(f),h.notifyFx({eventType:c.AudioPlayerEventType.MUSIC_AUDIOS_DELETE,params:[t,Boolean(s)&&{audioElement:s}]})}catch(e){throw s&&s.classList.add("audio_row__added"),s&&a&&(s.classList.add("audio_row__deleted"),m.AudioUtils.onRowOver(s,!1,!0)),E&&E.classList.add("audio_row__added"),E&&a&&(E.classList.add("audio_row__deleted"),m.AudioUtils.onRowOver(E,!1,!0)),new Error(`Failed to delete audio from group with id ${i}`,{cause:e})}}});return(0,_.sample)({clock:[E,g],filter:({audio:e})=>Boolean(e),fn:({audio:e,groupId:t})=>(0,r.getGroupAudioFullId)(e,t),target:f.add}),(0,_.sample)({clock:[E.finally,g.finally],filter:({params:{audio:e}})=>Boolean(e),fn:({params:{audio:e,groupId:t}})=>(0,r.getGroupAudioFullId)(e,t),target:f.remove}),{$loadingIdentitiesMap:y,$identitiesMap:o.$identitiesMap,addFx:E,deleteFx:g}}},851579:(e,t,o)=>{"use strict";o.d(t,{ensureGroupsAudioMusicWebService:()=>r,isAddedToGroup:()=>n.isAddedToGroup});var i=o(942451),s=o(32489),a=o(181353),n=o(143219);const r=(0,i.makeSharedState)("global/web/audio/groupsMusic",(()=>(0,a.createGroupsMusicWebService)({domain:(0,s.createDomain)("global/web/audio/groupsMusic"),name:"global/web/audio/groupsMusic"})),{version:3})},143219:(e,t,o)=>{"use strict";o.d(t,{isAddedToGroup:()=>a});var i=o(760325),s=o(156693);function a({identity:e,groupsMusicIdentitiesMap:t,groupId:o}){if(!e||!(0,i.isNumber)(o))return!1;return(0,s.getGroupAudioFullId)(e,o)in t}},746570:(e,t,o)=>{"use strict";o.d(t,{isGroupAudio:()=>n});var i=o(760325),s=o(248251),a=o(143219);function n({identity:e,groupsMusicIdentitiesMap:t,groupId:o}){return!(!e||!(0,i.isNumber)(o))&&(e.ownerId===(0,s.convertToGroupMusicId)(o)||(0,a.isAddedToGroup)({identity:e,groupsMusicIdentitiesMap:t,groupId:o}))}},339372:(e,t,o)=>{"use strict";o.d(t,{createMusicAudioMyDislikesService:()=>n});var i=o(255053),s=o(32489),a=o(432800);function n({domain:e,$audio:t,$audioEl:o}){const n=(0,a.ensureAudioDislikesInMyMusicWebService)(),r=o??e.createStore(null),_=t.map((e=>e&&e.id&&e.ownerId?{id:e.id,ownerId:e.ownerId,trackCode:e.trackCode}:null)),u=(0,s.combine)({identity:_,fullIdsMap:n.$dislikesInitializedIdentitiesMap}).map((({identity:e,fullIdsMap:t})=>Boolean(e&&t[(0,i.getAudioFullId)(e)])));return{$isAudioDisliked:(0,s.combine)({audio:t,myAudioDislikesIdentitiesMap:n.$dislikesIdentitiesMap,isDislikeActionInitialized:u}).map((({audio:e,myAudioDislikesIdentitiesMap:t,isDislikeActionInitialized:o})=>(0,a.hasDislike)({audio:e,dislikesIdentitiesMap:t,isDislikeActionInitialized:o}))),$isDislikeActionLoading:(0,s.combine)({identity:_,fullIdsMap:n.$dislikesLoadingIdentitiesMap}).map((({identity:e,fullIdsMap:t})=>Boolean(e&&t[(0,i.getAudioFullId)(e)]))),addFx:(0,s.attach)({source:(0,s.combine)({audio:t,audioEl:r}),async effect({audio:e,audioEl:t},o){await n.addDislikeFx({audio:e,audioEl:t,skipDeletionAudioFromMyMusic:o?.skipDeletionAudioFromMyMusic,needReloadTrackCode:o?.needReloadTrackCode})}}),removeFx:(0,s.attach)({source:(0,s.combine)({audio:t,audioEl:r}),async effect({audio:e,audioEl:t},o){await n.removeDislikeFx({audio:e,audioEl:t,needReloadTrackCode:o?.needReloadTrackCode})}})}}},478508:(e,t,o)=>{"use strict";o.d(t,{createMusicAudioMyDislikesService:()=>i.createMusicAudioMyDislikesService});var i=o(339372)},579437:(e,t,o)=>{"use strict";o.d(t,{createMyMusicWebService:()=>g});var i=o(94359),s=o(332583),a=o(919225),n=o(471027),r=o(255053),_=o(32489),u=o(540401),d=o(514640),l=o(234053),c=o(271560),p=o(620626),m=o(671300),h=o(143148),y=o(280357),f=o(145608),E=o(198155);function g(e){const t=(0,i.getEffectorServiceDomain)(e),o=(0,s.ensureMyMusicService)(),f=(0,u.ensureAudioPlayerService)(),E=new a.Emitter,{$fullIdsMap:g,fullIdsMapApi:A}=(0,n.createFullIdsMap)(t),{$fullIdsMap:w,fullIdsMapApi:b}=(0,n.createFullIdsMap)(t),P=(0,_.attach)({source:(0,_.combine)({myMusicIdentitiesMap:o.$identitiesMap,initializedIdentitiesMap:g}),async effect({myMusicIdentitiesMap:e,initializedIdentitiesMap:t},{audio:i,audioEl:s=null,isNotificationDisabled:a,forceAddToStoreParams:n,needReloadTrackCode:_,audioRef:u}){if(!i)throw new Error("Audio not exist");const p=Boolean(t[(0,r.getAudioFullId)(i)]);if((0,l.isMy)({identity:i,myMusicIdentitiesMap:e,isMyMusicActionInitialized:p,userId:window.vk.id}))throw new Error('Audio already in "My Music"');const h=(0,r.getAudioFullId)(i);let y=document.querySelector(`._audio_row_${h}`);y=y==s?null:y;let g=!1,A=!1;s&&(s.closest(".CatalogBlock__my_audios_block")||s.closest(".CatalogBlock__my_audios"))&&(g=!0),y&&(y.closest(".CatalogBlock__my_audios_block")||y.closest(".CatalogBlock__my_audios"))&&(A=!0);try{s&&!g&&s.classList.add("audio_row__added"),y&&!A&&y.classList.add("audio_row__added"),f.notifyFx({eventType:d.AudioPlayerEventType.ADDED,params:[h]});let e=i.trackCode;const t=i.context;if(_){const t=await v(i,s,u);t&&(e=t)}n?o.addToStore(n):await o.addFx({userId:window.vk.id,trackedIdentity:{...i,ref:t,trackCode:e}}),s&&g&&(s.classList.remove("audio_row__deleted"),m.AudioUtils.onRowOver(s,!1,!0)),y&&A&&(y.classList.remove("audio_row__deleted"),m.AudioUtils.onRowOver(y,!1,!0)),a||E.emit(c.MyMusicWebServiceEventType.AudioAddedToMyMusic),f.notifyFx({eventType:d.AudioPlayerEventType.MUSIC_AUDIOS_ADD,params:[i,Boolean(s)&&{audioElement:s}]})}catch(e){throw s&&(s.classList.remove("audio_row__added"),g&&(s.classList.add("audio_row__deleted"),m.AudioUtils.onRowOver(s,!1,!0))),y&&(y.classList.remove("audio_row__added"),A&&(y.classList.add("audio_row__deleted"),m.AudioUtils.onRowOver(s,!1,!0))),new Error('Failed to add audio to "My Music"',{cause:e})}}}),T=(0,_.attach)({source:(0,_.combine)({myMusicIdentitiesMap:o.$identitiesMap,initializedIdentitiesMap:g}),async effect({myMusicIdentitiesMap:e,initializedIdentitiesMap:t},{audio:i,audioEl:s=null,forceRemoveFromStoreParams:a,audioRef:n,needReloadTrackCode:_}){if(!i)throw new Error("Audio not exist");const u=(0,r.getAudioFullId)(i),c=Boolean(t[u]),E=(0,l.isMy)({identity:i,myMusicIdentitiesMap:e,isMyMusicActionInitialized:c,userId:window.vk.id}),g=e[u];if(!E&&!g)throw new Error('Audio not found in "My Music"');let A=document.querySelector(`._audio_row_${u}`);A=A==s?null:A;let w=!1,b=!1;s&&(s.closest(".CatalogBlock__my_audios_block")||s.closest(".CatalogBlock__my_audios"))&&(w=!0),A&&(A.closest(".CatalogBlock__my_audios_block")||A.closest(".CatalogBlock__my_audios"))&&(b=!0);const P=(0,r.getAudioFullId)(g??i);try{s&&s.classList.remove("audio_row__added"),A&&A.classList.remove("audio_row__added"),f.notifyFx({eventType:d.AudioPlayerEventType.REMOVED,params:[u,P]}),a?o.removeFromStore(a):await o.deleteFx({identity:g??i}),_?v(i,s,n).then((e=>{(0,h.onAdditionalEvent)(s,i,{type:y.TYPE_REMOVED,trackCode:e||i.trackCode})})):(0,h.onAdditionalEvent)(s,i,{type:y.TYPE_REMOVED,trackCode:i.trackCode}),s&&w&&(s.classList.add("audio_row__deleted"),m.AudioUtils.onRowOver(s,!1,!0)),A&&b&&(A.classList.add("audio_row__deleted"),m.AudioUtils.onRowOver(A,!1,!0));const e=f.getPlaylist({type:p.AudioPlaylist.TYPE_PLAYLIST,ownerId:window.vk.id,albumId:p.AudioPlaylist.DEFAULT_PLAYLIST_ID});e&&e.removeAudio(P),f.notifyFx({eventType:d.AudioPlayerEventType.MUSIC_AUDIOS_DELETE,params:[i,Boolean(s)&&{audioElement:s}]})}catch(e){throw s&&(w?(s.classList.remove("audio_row__deleted"),m.AudioUtils.onRowOver(s,!1,!0)):s.classList.add("audio_row__added")),A&&(b?(A.classList.remove("audio_row__deleted"),m.AudioUtils.onRowOver(s,!1,!0)):A.classList.add("audio_row__added")),new Error('Failed to delete audio from "My Music"',{cause:e})}}});return(0,_.sample)({clock:[P.done,T.done],filter:({params:{audio:e}})=>Boolean(e),fn:({params:{audio:e}})=>(0,r.getAudioFullId)(e),target:A.add}),(0,_.sample)({clock:[P,T],filter:({audio:e})=>Boolean(e),fn:({audio:e})=>(0,r.getAudioFullId)(e),target:b.add}),(0,_.sample)({clock:[P.finally,T.finally],filter:({params:{audio:e}})=>Boolean(e),fn:({params:{audio:e}})=>(0,r.getAudioFullId)(e),target:b.remove}),{$initializedIdentitiesMap:g,$loadingIdentitiesMap:w,$identitiesMap:o.$identitiesMap,addFx:P,deleteFx:T,events:E.listenable}}async function v(e,t,o){const i=(0,E.getContextPlaylist)(t)??{context:o,playlist:null};return await(0,f.getAudioTrackCodeFromPlaylist)(i?.playlist,e)??null}},271560:(e,t,o)=>{"use strict";var i;o.d(t,{MyMusicWebServiceEventType:()=>i}),function(e){e.AudioAddedToMyMusic="audioAddedToMyMusic"}(i||(i={}))},753421:(e,t,o)=>{"use strict";o.d(t,{ensureMyAudioMusicWebService:()=>r,isMy:()=>n.isMy});var i=o(942451),s=o(32489),a=o(579437),n=o(234053);const r=(0,i.makeSharedState)("global/web/audio/myMusic",(()=>(0,a.createMyMusicWebService)({domain:(0,s.createDomain)("global/web/audio/myMusic"),name:"global/web/audio/myMusic"})),{version:3})},234053:(e,t,o)=>{"use strict";o.d(t,{isMy:()=>s});var i=o(255053);function s({identity:e,myMusicIdentitiesMap:t,isMyMusicActionInitialized:o,userId:s}){if(!e)return!1;return(0,i.getAudioFullId)(e)in t||!o&&e.ownerId===s}},702203:(e,t,o)=>{"use strict";o.d(t,{AudioRowMoreTooltipApplication:()=>n});var i=o(474848),s=o(505954),a=o(234570);function n({target:e,portalRoot:t,onShownChange:o}){return(0,i.jsx)(s.AppRootProvider,{children:(0,i.jsx)(a.AudioRowMoreTooltipContainer,{onShownChange:o,target:e,portalRoot:t})})}},667962:(e,t,o)=>{"use strict";o.d(t,{AudioRowMoreTooltipController:()=>m});var i=o(434518),s=o(763812),a=o(410796),n=o(702203),r=o(919225),_=o(942451),u=o(988365),d=(0,s._)("_initiator"),l=(0,s._)("_emitter"),c=(0,s._)("_target"),p=(0,s._)("_handleShownChange");class m{get isMounted(){return this.checkIsMounted()}get events(){return(0,i._)(this,l)[l].listenable}mount(e,t){this.checkIsMounted(e)||((0,i._)(this,c)[c]=e),this.isShown=!0,(0,i._)(this,d)[d].render({target:e,portalRoot:t,onShownChange:(0,i._)(this,p)[p]})}unmount(){this.checkIsMounted()&&(0,i._)(this,d)[d].unmount(),(0,i._)(this,c)[c]=null,this.isShown=!1,(0,i._)(this,l)[l].emit(u.AudioRowMoreTooltipControllerEventType.Closed)}checkIsMounted(e){return(!e||e===(0,i._)(this,c)[c])&&(0,i._)(this,d)[d].isMounted()}constructor(){Object.defineProperty(this,d,{writable:!0,value:void 0}),Object.defineProperty(this,l,{writable:!0,value:void 0}),Object.defineProperty(this,c,{writable:!0,value:void 0}),Object.defineProperty(this,p,{writable:!0,value:void 0}),this.isShown=!1,(0,i._)(this,d)[d]=(0,a.createReactInitiator)(n.AudioRowMoreTooltipApplication),(0,i._)(this,l)[l]=new r.Emitter,(0,i._)(this,c)[c]=null,(0,i._)(this,p)[p]=e=>{this.isShown=e,e||(this.unmount(),(0,i._)(this,l)[l].emit(u.AudioRowMoreTooltipControllerEventType.Closed))}}}m.ensure=(0,_.makeSharedState)("audio/audioPage/audioRow/moreTooltip/controller",(()=>new m),{version:2})},879036:(e,t,o)=>{"use strict";o.d(t,{AudioRowMoreTooltipController:()=>i.AudioRowMoreTooltipController,AudioRowMoreTooltipControllerEventType:()=>s.AudioRowMoreTooltipControllerEventType});var i=o(667962),s=o(988365)},988365:(e,t,o)=>{"use strict";var i;o.d(t,{AudioRowMoreTooltipControllerEventType:()=>i}),function(e){e.Closed="closed"}(i||(i={}))},568755:(e,t,o)=>{"use strict";o.d(t,{AudioRowMoreTooltipContainer:()=>S});var i=o(474848),s=o(349826),a=o(234337),n=o(106412),r=o(575489),_=o(485749),u=o(203788),d=o(223173),l=o(136017),c=o(715782),p=o(684540),m=o(490363),h=o(694430),y=o(168799),f=o(293721),E=o(933933),g=o(296540),v=o(610989),A=o(476726),w=o(207099),b=o(433387),P=o(760325),T=o(302495);const I=(0,A.partConfigEnabled)("audio_longtap_web"),O=(0,A.partConfigEnabled)("audio_tooltip_copy_link_web"),C=(0,A.partConfigEnabled)("dislikes_web_enabled")||(0,A.partConfigEnabled)("redesign_audio_player_tooltip_dislikes_web_enabled"),M=(0,E.ensureAudioRowMoreTooltipService)(),{dislikesService:D}=M;function S({target:e,portalRoot:t=null,onShownChange:o}){const[E,A]=(0,g.useState)(!1),S=(0,f.useUnit)(M.setIsShowTooltip),k=(0,f.useUnit)(M.$audio),L=(0,f.useUnit)(M.$isAudioClaimed),B=(0,f.useUnit)(M.$isEpisode),R=(0,f.useUnit)(M.$isAlbum),x=(0,f.useUnit)(M.$isCurrentAlbumSnippet),F=(0,f.useUnit)(M.$isAudioHasSnippet),N=(0,f.useUnit)(M.$audioPlaylists),U=(0,f.useUnit)(M.$isShowAllPlaylists),W=(0,f.useUnit)(M.$isAudioPlaylistsFetching),K=(0,f.useUnit)(M.$loadingAddToPlaylistFullIdsMap),V=(0,f.useUnit)(M.$addedPlaylistsFullIdsMap),H=(0,f.useUnit)(M.$initializedPlaylistsFullIdsMap),j=(0,f.useUnit)(M.$currentGroupId),$=(0,f.useUnit)(D.$isAudioDisliked),G=(0,f.useUnit)(D.$isDislikeActionLoading),q=I&&F,Y=O&&!L&&!B,z=C&&!L&&!B,X=!L&&R&&!x,Q=!L&&!B,Z=(0,f.useUnit)(M.copyAudioLinkFx),J=(0,f.useUnit)(M.shareAudioFx),ee=(0,f.useUnit)(M.openEpisodeFx),te=(0,f.useUnit)(M.openAlbumFx),oe=(0,f.useUnit)(M.setNextInPlayerQueueFx),ie=(0,f.useUnit)(D.addFx),se=(0,f.useUnit)(D.removeFx),ae=(0,f.useUnit)(M.addAudioToNewPlaylistFx),ne=(0,f.useUnit)(M.toggleAddAudioToPlaylistFx),re=(0,f.useUnit)(M.showAllPlaylistsFx),_e=(0,g.useMemo)((()=>$?"audio-show-more-tooltip-remove-dislike-button":"audio-show-more-tooltip-add-dislike-button"),[$]);return(0,g.useEffect)((()=>(S(!0),()=>{S(!1)})),[]),(0,i.jsx)(s.DropdownActionSheet,{usePortal:t??!1,trigger:"hover",restoreFocus:!1,placement:"auto",content:(0,i.jsxs)(i.Fragment,{children:[q&&(0,i.jsx)(s.DropdownActionSheet.Item,{before:(0,i.jsx)(r.Icon20ListPlayOutline,{className:(0,a.getColorClass)("color_icon_secondary")}),onClick:()=>((0,T.logSearchAudioClick)(T.SearchClickActionMap.LISTEN_NEXT,k?.trackCode),oe()),"data-testid":"audio-row-more-tooltip-set-next-audio",children:v.getLang("audio_set_next_audio")}),Y&&(0,i.jsx)(s.DropdownActionSheet.Item,{before:(0,i.jsx)(_.Icon20CopyOutline,{className:(0,a.getColorClass)("color_icon_secondary")}),onClick:()=>((0,T.logSearchAudioClick)(T.SearchClickActionMap.COPY_LINK,k?.trackCode),Z()),"data-testid":"audio-row-more-tooltip-copy-audio-link",keepOpen:!0,children:v.getLang("audio_copy_audio_link")}),B&&(0,i.jsx)(s.DropdownActionSheet.Item,{before:(0,i.jsx)(u.Icon20PodcastOutline,{className:(0,a.getColorClass)("color_icon_secondary")}),onClick:ee,"data-testid":"audio-row-more-tooltip-podcast-open-episode",children:v.getLang("audio_podcast_open_episode")}),!L&&(0,i.jsx)(s.DropdownActionSheet.Item,{before:(0,i.jsx)(d.Icon20ShareOutline,{className:(0,a.getColorClass)("color_icon_secondary")}),onClick:()=>((0,T.logSearchAudioClick)(T.SearchClickActionMap.SHARE,k?.trackCode),J()),"data-testid":"audio-row-more-tooltip-share-audio",children:v.getLang("audio_share_audio")}),z&&(0,i.jsx)(s.DropdownActionSheet.Item,{before:$?(0,i.jsx)(l.Icon20ThumbsDown,{className:(0,a.getColorClass)("color_icon_secondary")}):(0,i.jsx)(c.Icon20ThumbsDownOutline,{className:(0,a.getColorClass)("color_icon_secondary")}),keepOpen:$,onClick:()=>{if($)return(0,T.logSearchAudioClick)(T.SearchClickActionMap.REMOVE_DISLIKE,k?.trackCode),void se({needReloadTrackCode:!0});(0,T.logSearchAudioClick)(T.SearchClickActionMap.DISLIKE,k?.trackCode),ie({skipDeletionAudioFromMyMusic:(0,P.isNumber)(j),needReloadTrackCode:!0})},disabled:G,"data-testid":_e,children:v.getLang("audio_action_dislike")}),X&&(0,i.jsx)(s.DropdownActionSheet.Item,{before:(0,i.jsx)(p.Icon20VinylOutline,{className:(0,a.getColorClass)("color_icon_secondary")}),onClick:()=>((0,T.logSearchAudioClick)(T.SearchClickActionMap.OPEN_ALBUM,k?.trackCode),te()),"data-testid":"audio-row-more-tooltip-open-album",children:v.getLang("audio_open_album")}),Q&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.DropdownActionSheet.Separator,{}),(0,i.jsx)(n.DropdownActionSubSheet,{before:(0,i.jsx)(m.Icon20ListPlusOutline,{className:(0,a.getColorClass)("color_icon_secondary")}),loading:W,disabled:W,onPointerEnter:()=>{A(!0)},shown:E??void 0,sheet:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.DropdownActionSubSheet.Item,{disabled:W,before:(0,i.jsx)(h.Icon24Add,{className:(0,a.getColorClass)("color_icon_secondary")}),onClick:()=>((0,T.logSearchAudioClick)(T.SearchClickActionMap.ADD_TO_PLAYLIST,k?.trackCode),ae()),"data-testid":"audio-row-more-tooltip-add-to-new-playlist",children:v.getLang("audio_add_to_new_pl")}),N?.map(((e,t)=>{if(!k||!e)return null;const o=(0,w.getAudioPlaylistId)(k.id,e.id),s=o in H?o in V:e.hasTargetAudio;return(0,i.jsx)(g.Fragment,{children:(0,i.jsx)(n.DropdownActionSubSheet.Item,{keepOpen:!0,loading:!!k&&o in K,before:s?(0,i.jsx)(y.Icon20Check,{className:(0,a.getColorClass)("color_icon_secondary")}):null,onClick:()=>((0,T.logSearchAudioClick)(T.SearchClickActionMap.ADD_TO_PLAYLIST,k?.trackCode),ne(e)),"data-testid":"audio-row-more-tooltip-add-to-playlist",children:e.title??""})},null===e.id?t:e.id)})),U&&(0,i.jsx)(n.DropdownActionSubSheet.Item,{onClick:re,"data-testid":"audio-row-more-tooltip-show-all-playlists",children:v.getLang("audio_row_show_all_playlists")})]}),children:v.getLang("audio_add_to_playlist")})]})]}),shown:!0,onShownChange:o,children:(0,i.jsx)(b.ForwardElementRef,{element:e})})}},141550:(e,t,o)=>{"use strict";o.d(t,{AudioRowMoreTooltipContainer:()=>i.AudioRowMoreTooltipContainer});var i=o(568755)},234570:(e,t,o)=>{"use strict";o.d(t,{AudioRowMoreTooltipContainer:()=>i.AudioRowMoreTooltipContainer});var i=o(141550)},402409:(e,t,o)=>{"use strict";o.d(t,{AudioRowMoreTooltipController:()=>i.AudioRowMoreTooltipController,AudioRowMoreTooltipControllerEventType:()=>i.AudioRowMoreTooltipControllerEventType,ensureAudioRowMoreTooltipService:()=>s.ensureAudioRowMoreTooltipService});var i=o(879036),s=o(933933)},508722:(e,t,o)=>{"use strict";o.d(t,{createAudioPlaylistsDataService:()=>A});var i=o(624216),s=o(119265),a=o(8520),n=o(32489),r=o(477810),_=o(842225),u=o(255053),d=o(471027),l=o(562984),c=o(625523),p=o(823103),m=o(671300),h=o(143148),y=o(280357),f=o(20025),E=o(30052),g=o(207099),v=o(278758);function A({domain:e,$audio:t,$audioTuple:o,$audioEl:p,$isShowTooltip:A}){const P=s.AudioPageProxy.ensure(),T=(0,_.ensureMyAudioPlaylistsService)(),I=e.createEvent(),O=t.map((e=>e&&e.id&&e.ownerId?(0,u.getAudioFullId)({id:e.id,ownerId:e.ownerId}):null)),{$audioPlaylistsDataMap:C,audioPlaylistsDataMapApi:M}=(0,r.createAudioPlaylistsDataMap)(e),{$fullIdsMap:D,fullIdsMapApi:S}=(0,d.createFullIdsMap)(e),{$fullIdsMap:k,fullIdsMapApi:L}=(0,d.createFullIdsMap)(e),{$fullIdsMap:B,fullIdsMapApi:R}=(0,d.createFullIdsMap)(e),{$fullIdsMap:x,fullIdsMapApi:F}=(0,d.createFullIdsMap)(e),N=(0,n.combine)({audioFullId:O,audioPlaylistsDataMap:C}).map((({audioFullId:e,audioPlaylistsDataMap:t})=>Boolean(e)&&(0,a.isString)(e)?t[e]??null:null)),{$audioPlaylists:U,$isShowAllPlaylists:W,$newPlaylistHash:K}=(0,c.reshape)({source:N,shape:{$audioPlaylists:e=>e?.playlists||[],$isShowAllPlaylists:e=>e?.isShowAllPlaylists||!1,$newPlaylistHash:e=>e?.newPlaylistHash||null}}),V=(0,n.combine)({audioFullId:O,loadingFetchingFullIdsMap:D}).map((({audioFullId:e,loadingFetchingFullIdsMap:t})=>!!e&&Boolean(t[e]))),H=e.createEffect((async e=>{if(!e)throw new Error("Audio not exists");const t=b(P);try{const o=await i.ajax.promisifiedPost("al_audio.php",{act:"playlists_by_audio",owner_id:t,audio_owner_id:e.ownerId,audio_id:e.id});if(!o)throw new Error("Unknown error when fetching playlists by audio");const[s,a,n]=o;return{playlists:(s||[]).map(w),isShowAllPlaylists:a||!1,newPlaylistHash:n||null}}catch(e){throw new Error("Error when fetching playlists by audio",{cause:e})}})),j=(0,n.attach)({source:t,effect:async e=>H(e)}),$=(0,n.attach)({source:(0,n.combine)({audioTuple:o,newPlaylistHash:K}),effect({audioTuple:e,newPlaylistHash:t}){if(!e)throw new Error("Audio not exists");if(!t)throw new Error("Playlist hash not exists");const o=b(P);m.AudioUtils.editPlaylist(o,!1,"edit",{addAudio:e,newPlaylistHash:t,onSavePlaylistDone(){I()}})}}),G=(0,n.attach)({source:(0,n.combine)({audioEl:p,addedPlaylistsFullIdsMap:B,initializedPlaylistsFullIdsMap:x,addedAudiosMap:T.$addedAudiosMap}),async effect({audioEl:e,addedPlaylistsFullIdsMap:t,initializedPlaylistsFullIdsMap:o,addedAudiosMap:i},{audio:s,playlist:a}){if(!s||!e)throw new Error("Audio not exists");const n=(0,g.getAudioPlaylistId)(s.id,a.id),r=n in o?n in t:a.hasTargetAudio;if(T.setUserId(window.vk.id),r){const e=i[(0,l.getPlaylistAudioFullId)({playlist:{id:a.id,ownerId:a.ownerId},originalAudio:s})]??{id:s.id,ownerId:window.vk.id};await T.deleteAudioFx({originalAudioIdentity:s,audioIdentity:e,playlistId:a.id})}else await T.addAudioFx({audioIdentity:s,playlistId:a.id});(0,h.onAdditionalEvent)(e,s,{type:r?y.TYPE_REMOVED:y.TYPE_ADDED,subtype:y.SUBTYPE_PLAYLIST})}}),q=(0,n.attach)({source:t,async effect(e,t){await G({audio:e,playlist:t})}}),Y=(0,n.attach)({source:U,async effect(e,t){if(e&&t){for(const o of e){const e=(0,g.getAudioPlaylistId)(t.id,o.id);L.remove(e),R.remove(e),F.remove(e)}M.remove((0,u.getAudioFullId)(t))}}}),z=(0,n.attach)({source:t,effect(e){if(!e)throw new Error("Audio not exists");const t=b(P);(0,f.showBox)("al_audio.php?act=more_playlists_add",{owner_id:t,audio_owner_id:e.ownerId,audio_id:e.id},{params:{bodyStyle:"padding: 0px",width:560},onDone(){Y(e)}})}});return(0,n.sample)({source:N,clock:(0,n.combine)({audio:t,isShowTooltip:A}),filter:(e,{isShowTooltip:t,audio:o})=>t&&!e&&Boolean(o),target:j}),(0,n.sample)({source:O,clock:j.doneData,filter:e=>Boolean(e),fn:(e,t)=>({audioFullId:e,playlistsData:t}),target:M.add}),(0,n.sample)({clock:H,filter:e=>Boolean(e),fn:e=>(0,u.getAudioFullId)({id:e.id,ownerId:e.ownerId}),target:S.add}),(0,n.sample)({clock:H.finally,filter:({params:e})=>Boolean(e),fn:({params:e})=>{const t=e;return(0,u.getAudioFullId)({id:t.id,ownerId:t.ownerId})},target:S.remove}),(0,n.sample)({clock:G,filter:({audio:e,playlist:t})=>Boolean(e)&&Boolean(t),fn:({audio:e,playlist:t})=>(0,g.getAudioPlaylistId)(e.id,t.id),target:L.add}),(0,n.sample)({clock:G.finally,filter:({params:{audio:e,playlist:t}})=>Boolean(e)&&Boolean(t),fn:({params:e})=>{const{audio:t,playlist:o}=e;return(0,g.getAudioPlaylistId)(t.id,o.id)},target:L.remove}),(0,n.sample)({source:(0,n.combine)({addedPlaylistsFullIdsMap:B,initializedPlaylistsFullIdsMap:x}),clock:G.done,filter:(e,{params:{audio:t,playlist:o}})=>Boolean(t)&&Boolean(o),fn:({addedPlaylistsFullIdsMap:e,initializedPlaylistsFullIdsMap:t},{params:o})=>{const{audio:i,playlist:s}=o,a=(0,g.getAudioPlaylistId)(i.id,s.id);return{added:a in t?a in e:s.hasTargetAudio,audioPlaylistId:a}},target:[F.add.prepend((({audioPlaylistId:e})=>e)),(0,E.condition)({if:({added:e})=>e,then:R.remove.prepend((({audioPlaylistId:e})=>e)),else:R.add.prepend((({audioPlaylistId:e})=>e))})]}),(0,v.reset)({clock:I,target:[C,D,k,x,B]}),{$audioPlaylists:U,$isShowAllPlaylists:W,$isAudioPlaylistsFetching:V,$loadingAddToPlaylistFullIdsMap:k,$addedPlaylistsFullIdsMap:B,$initializedPlaylistsFullIdsMap:x,addAudioToNewPlaylistFx:$,toggleAddAudioToPlaylistFx:q,showAllPlaylistsFx:z}}function w(e){return{ownerId:+e[p.AudioPlaylistTupleKeys.OwnerId],id:+e[p.AudioPlaylistTupleKeys.Id],title:e[p.AudioPlaylistTupleKeys.Title]||null,hasTargetAudio:e[p.AudioPlaylistTupleKeys.HasTargetAudio]||!1,actionHash:e[p.AudioPlaylistTupleKeys.ActionHash]||null}}function b(e){let t;return t=(0,a.isNumber)(e.ownerId)&&e.ownerId<0&&e.canEditGroup?e.ownerId:window.vk.id,t}},207099:(e,t,o)=>{"use strict";function i(e,t){return`${e}_${t}`}o.d(t,{getAudioPlaylistId:()=>i})},689046:(e,t,o)=>{"use strict";o.d(t,{createAudioPlaylistsDataService:()=>i.createAudioPlaylistsDataService});var i=o(508722)},477810:(e,t,o)=>{"use strict";o.d(t,{createAudioPlaylistsDataMap:()=>n});var i=o(32489),s=o(958955),a=o(918081);function n(e){const t=e.createStore({});return{$audioPlaylistsDataMap:t,audioPlaylistsDataMapApi:(0,i.createApi)(t,{add:(e,{audioFullId:t,playlistsData:o})=>(0,s.addPairToMap)(e,{key:t,value:o}),remove:(e,t)=>(0,a.removePairFromMap)(e,t)})}}},823103:(e,t,o)=>{"use strict";var i;o.d(t,{AudioPlaylistTupleKeys:()=>i}),function(e){e[e.OwnerId=0]="OwnerId",e[e.Id=1]="Id",e[e.Title=2]="Title",e[e.HasTargetAudio=3]="HasTargetAudio",e[e.ActionHash=4]="ActionHash"}(i||(i={}))},883028:(e,t,o)=>{"use strict";o.d(t,{createAudioRowMoreTooltipService:()=>m});var i=o(94359),s=o(919225),a=o(760325),n=o(32489),r=o(810780),_=o(671300),u=o(119265),d=o(478508),l=o(689046),c=o(540401),p=o(781352);function m(e){const t=(0,i.getEffectorServiceDomain)(e),o=u.AudioPageProxy.ensure(),m=(0,c.ensureAudioPlayerService)(),y=new s.Emitter,f=(0,n.createEvent)(),E=t.createEvent(),g=t.createEvent(),v=(0,n.restore)(E,!1),A=t.createStore(null),w=t.createStore(null),b=t.createStore(null),P=t.createStore(null),T=t.createStore(null),I=(0,n.restore)(g,null),{$audioPlaylists:O,$isShowAllPlaylists:C,$isAudioPlaylistsFetching:M,$loadingAddToPlaylistFullIdsMap:D,$addedPlaylistsFullIdsMap:S,$initializedPlaylistsFullIdsMap:k,addAudioToNewPlaylistFx:L,toggleAddAudioToPlaylistFx:B,showAllPlaylistsFx:R}=(0,l.createAudioPlaylistsDataService)({domain:t,$audio:w,$audioEl:A,$audioTuple:b,$isShowTooltip:v}),x=w.map((e=>!!e&&Boolean(e?.isClaimed))),F=w.map((e=>!!e&&Boolean(_.AudioUtils.isPodcast(e)))),N=w.map((e=>!!e&&Boolean(e?.album))),U=w.map((e=>!!e&&Boolean(e?.isCurrentAlbumSnippet))),W=(0,n.combine)({audioEl:A,audio:w}).map((({audioEl:e,audio:t})=>{if(!e||!t)return!1;const o=_.AudioUtils.getContextPlaylist(e,!0),[i,s]=_.AudioUtils.contextSplit(o);if(!i||"my_audios_block"===s)return Boolean(t?.isInSnippet);switch(i){case"search_results":case"catalog":case"album_page":case"my":case"module":case"user_list":case"group_list":case"edit_playlist":return!0}return Boolean(t?.isInSnippet)})),K=(0,d.createMusicAudioMyDislikesService)({domain:t,$audio:w,$audioEl:A}),V=(0,n.attach)({source:(0,n.combine)({audio:w,audioLinkPathname:P,audioAccessKey:T}),async effect({audio:e,audioLinkPathname:t,audioAccessKey:o}){if(!e)throw new Error("Audio not exist");t?await _.AudioUtils.copyAudioLink(t):await _.AudioUtils.copyAudioLinkByIdentity(e,o??""),y.emit(p.AudioRowMoreTooltipServiceEventType.AudioLinkCopied,e)}}),H=(0,n.attach)({source:(0,n.combine)({audioEl:A,currentAudio:w}),effect:({audioEl:e,currentAudio:t})=>{const i=t||o.readyAudio;if(!e||!i)throw new Error("Audio not exist");i&&_.AudioUtils.shareAudio(e??!1,i)}}),j=(0,n.attach)({source:(0,n.combine)({audioEl:A,currentAudio:w}),effect:({audioEl:e,currentAudio:t})=>{const i=t||o.readyAudio;if(!e||!i)throw new Error("Audio not exist");i&&_.AudioUtils.openEpisode(e??!1,i)}}),$=(0,n.attach)({source:(0,n.combine)({audioEl:A,currentAudio:w}),effect:({audioEl:e,currentAudio:t})=>{const i=t||o.readyAudio;if(!e||!i)throw new Error("Audio not exist");i&&_.AudioUtils.showAudioAlbum(e??!1,i)}}),G=(0,n.attach)({source:(0,n.combine)({audioEl:A,audio:w}),effect:({audioEl:e,audio:t})=>{if(!e||!t)throw new Error("Audio not exist");t&&m.setNextFx({audioEl:e,audio:t})}}),q=(0,n.attach)({source:w,async effect(e){if(!e)throw new Error("Audio not exists");const t=o.ownerId&&(0,a.isNumber)(o.ownerId)&&o.ownerId<0&&o.canAddToGroup&&o.ownerId!==e.ownerId;g(t?-o.ownerId:null)}});return(0,r.spread)({source:f.map(h),targets:{audioEl:A,audioTuple:b,audio:w,audioLinkPathname:P,audioAccessKey:T}}),o.events.on(u.AudioPageEventType.Updated,(()=>{q()})),{init:f,$audio:w,$audioEl:A,$isAudioClaimed:x,$isEpisode:F,$isAlbum:N,$isCurrentAlbumSnippet:U,$isAudioHasSnippet:W,$audioPlaylists:O,$isShowAllPlaylists:C,$isAudioPlaylistsFetching:M,$loadingAddToPlaylistFullIdsMap:D,$addedPlaylistsFullIdsMap:S,$initializedPlaylistsFullIdsMap:k,$currentGroupId:I,setIsShowTooltip:E,copyAudioLinkFx:V,shareAudioFx:H,openEpisodeFx:j,openAlbumFx:$,setNextInPlayerQueueFx:G,addAudioToNewPlaylistFx:L,toggleAddAudioToPlaylistFx:B,showAllPlaylistsFx:R,dislikesService:K,events:y.listenable}}function h(e){return{audioEl:e.audioEl??null,audio:e.audio??null,audioTuple:e.audioTuple,audioLinkPathname:e?.audioLinkPathname||e.audio?.trackPageId||null,audioAccessKey:e?.audioAccessKey||null}}},781352:(e,t,o)=>{"use strict";var i;o.d(t,{AudioRowMoreTooltipServiceEventType:()=>i}),function(e){e.AudioLinkCopied="audioLinkCopied"}(i||(i={}))},933933:(e,t,o)=>{"use strict";o.d(t,{ensureAudioRowMoreTooltipService:()=>n});var i=o(942451),s=o(32489),a=o(883028);const n=(0,i.makeSharedState)("audio/audioPage/audioRow/moreTooltip",(()=>(0,a.createAudioRowMoreTooltipService)({domain:(0,s.createDomain)("audio/audioPage/audioRow/moreTooltip"),name:"audio/audioPage/audioRow/moreTooltip"})),{version:3})},433387:(e,t,o)=>{"use strict";o.d(t,{ForwardElementRef:()=>i});const i=(0,o(296540).forwardRef)((function({element:e,getRootRef:t},o){return t&&s(t,e),s(o,e),null}));function s(e,t){e&&("function"==typeof e?e(t):e.current=t)}},856826:(e,t,o)=>{"use strict";o.d(t,{SaveUserForQuickLoginBox:()=>m});var i=o(474848),s=o(296540),a=o(610989),n=o(581903),r=o(272259),_=o(209642),u=o(125852),d=o(416124),l=o(785118),c=o(966576),p=o(533048);const m=({logoutUrl:e,onLogout:t,onClose:o})=>{const[m,h]=(0,s.useState)(!0),y=()=>{n.vkConnectNavigationCollector.logCancelOnExit(),o()};return(0,s.useEffect)((()=>{n.vkConnectNavigationCollector.logSaveLoginModalShow()}),[]),(0,i.jsxs)(_.ModalBox,{children:[(0,i.jsx)(u.ModalHeader,{onClose:y,closeAriaLabel:a.getLang("global_close"),children:a.getLang("vkconnect_logout_save_user_dialog_title")}),(0,i.jsx)(d.ModalBody,{insetLevel:1,children:(0,i.jsx)(l.Div,{children:(0,i.jsx)(r.SettingsCellSwitch,{description:a.getLang("vkconnect_logout_save_user_dialog_description_text"),checked:m,onChange:e=>h(e.target.checked),children:a.getLang("vkconnect_logout_save_user_dialog_description_title")})})}),(0,i.jsx)(c.ModalFooter,{actions:[(0,i.jsx)(p.Button,{size:"s",mode:"secondary",onClick:y,children:a.getLang("global_cancel")},"close"),(0,i.jsx)(p.Button,{size:"s",mode:"primary",onClick:()=>{let o="&save_user=0";m&&(o="&save_user=1"),t(`${e}${o}`)},children:a.getLang("global_head_logout")},"logout")]})]})}},646387:(e,t,o)=>{"use strict";o.d(t,{logout:()=>r,logoutWithDialog:()=>u});var i=o(474848),s=o(933052),a=o(856826),n=o(272259);const r=(e,t)=>{(0,s.removeLoginCache)(e,t)},_=e=>{r(),window.location.href=e},u=e=>{(0,s.login)("check_user_saved").then((t=>{const{feature_enabled:o,is_user_saved:s}=t;o&&!s?(0,n.showMessageBoxModal)((t=>(0,i.jsx)(a.SaveUserForQuickLoginBox,{...t,logoutUrl:e,onLogout:_})),{width:420}):_(e)})).catch((()=>{_(e)}))}},187465:(e,t,o)=>{"use strict";o.d(t,{writeLogout:()=>r});var i=o(490712),s=o(368759),a=o(832813),n=o(935037);const r=(e="unknown",t="",o="")=>{if(!t)return;let r=0;try{const e=(0,s.imDbGet)(window.vk.id);Object.entries(e).forEach((function(e){const t=e[0],o=e[1];t.startsWith("draft_")&&(o.txt||o.attaches&&o.attaches.length)&&r++}))}catch(e){}o&&((0,a.logSwitcherDropAccount)(o),localStorage.setItem(n.NOTIFY_SWITCH_KEY,"0")),(0,a.prepareLogSwitchAccountEvent)(),(0,i.statlogsValueEvent)("logout_stat",e,t,r)}},812477:(e,t,o)=>{"use strict";o.d(t,{TOOLTIP_CLASSES_DEFAULT:()=>a,helpHintTooltip:()=>n});var i=o(624216),s=o(96526);const a="feature_intro_tt feature_intro_blue_tt feature_info_tooltip",n=(e,t,o={})=>{let n;const r={...{autoShow:!1,cls:a,content:t.content,withCloseButton:!0,noAutoHideOnWindowClick:!0,onHide:()=>{n?.destroy()},width:230},...o,onDestroy:()=>{var e;"isServerSideHideDisabled"in(e=t)&&e.isServerSideHideDisabled||i.ajax.post("al_index.php",{act:"help_hints_hide",hash:t.helpHintHash,hint_id:t.helpHintId}),t.onHideRequestSent?.(),o.onDestroy&&o.onDestroy()}};return"helpHintId"in t&&(r.helpHintId=t.helpHintId,r.skipShow=Boolean(t.skipShow)),n=new s.ElementTooltip(e,r),window.cur?.destroy?.push((()=>{n?.destroy()})),{tooltip:n}}},331876:(e,t,o)=>{"use strict";o.d(t,{EcoPlateAnalytics:()=>_,EcoPlateAnalyticsContext:()=>u});var i=o(695290),s=o(581903),a=o(216147),n=o(296540),r=o(333258);class _{updateThemeField(){this.theme=a.colorScheme.getMode()===a.ColorSchemeMode.Auto?"system":a.colorScheme.getMode()}init(e,t,o,i){this.securityStatus=e===r.AccountSecurityLevelEnumNames.HAVE_ISSUES?"critical_vulnerabilities":e===r.AccountSecurityLevelEnumNames.HAVE_RECOMMENDATIONS?"protection_recommendations":"securely_protected",this.nftAvatar=t,this.isVerified=o,this.multiaccId=i,this.unsubscribeThemeListener=a.colorScheme.subscribe((()=>{this.updateThemeField()}))}getCommonFields(){return{multiacc_id:this.multiaccId,metadata:JSON.stringify({security_status:this.securityStatus,theme:this.theme,nft_avatar:this.nftAvatar,is_verified:this.isVerified}),options:[{names:i.VkidEcosystemNavigationItem.AVATAR,values:i.VkidEcosystemNavigationItemPlace.ECOSYSTEM},{names:i.VkidEcosystemNavigationItem.VKID_LK,values:i.VkidEcosystemNavigationItemPlace.ECOSYSTEM},{names:i.VkidEcosystemNavigationItem.BALANCE,values:i.VkidEcosystemNavigationItemPlace.VK},{names:i.VkidEcosystemNavigationItem.QR_SIGN_IN,values:i.VkidEcosystemNavigationItemPlace.VK},{names:i.VkidEcosystemNavigationItem.SETTINGS,values:i.VkidEcosystemNavigationItemPlace.VK},{names:i.VkidEcosystemNavigationItem.THEME,values:i.VkidEcosystemNavigationItemPlace.VK},{names:i.VkidEcosystemNavigationItem.HELP,values:i.VkidEcosystemNavigationItemPlace.VK},{names:i.VkidEcosystemNavigationItem.LOGOUT,values:i.VkidEcosystemNavigationItemPlace.VK},{names:i.VkidEcosystemNavigationItem.SWITCHER,values:i.VkidEcosystemNavigationItemPlace.MULTIACCOUNT}]}}logTopNavItemClick(e){e!==i.VkidEcosystemNavigationItemEventType.LOGOUT?s.vkIdEcosystemNavigationCollector.logEvent({event:i.VkidEcosystemNavigationItemEventType.TAP,item:e,...this.getCommonFields()}):s.vkIdEcosystemNavigationCollector.logEvent({event:i.VkidEcosystemNavigationItemEventType.LOGOUT,...this.getCommonFields()},{force:!0})}logThemeChange(){s.vkIdEcosystemNavigationCollector.logEvent({event:i.VkidEcosystemNavigationItemEventType.THEME_CHANGED,item:i.VkidEcosystemNavigationItem.THEME,...this.getCommonFields()})}logTopNavToggle(e){s.vkIdEcosystemNavigationCollector.logEvent({event:e?i.VkidEcosystemNavigationItemEventType.OPEN:i.VkidEcosystemNavigationItemEventType.CLOSE,...this.getCommonFields()})}logApiError(){s.vkIdEcosystemNavigationCollector.logEvent({event:i.VkidEcosystemNavigationItemEventType.ERROR_API,...this.getCommonFields()})}logSwitcherError(){s.vkIdEcosystemNavigationCollector.logEvent({event:i.VkidEcosystemNavigationItemEventType.ERROR_SWITCHER,...this.getCommonFields()})}logMultiaccAddAnotherTap(){s.vkIdEcosystemNavigationCollector.logEvent({event:i.VkidEcosystemNavigationItemEventType.ADD_ANOTHER_ACCOUNT_TAP,...this.getCommonFields()})}logMultaccSwitchAccountTap(){s.vkIdEcosystemNavigationCollector.logEvent({event:i.VkidEcosystemNavigationItemEventType.SWITCH_ACCOUNT_TAP,...this.getCommonFields()})}logMultaccDropAccountTap(){s.vkIdEcosystemNavigationCollector.logEvent({event:i.VkidEcosystemNavigationItemEventType.DROP_ACCOUNT_TAP,...this.getCommonFields()})}logSecurityRecommShow(){s.vkIdEcosystemNavigationCollector.logEvent({event:i.VkidEcosystemNavigationItemEventType.SECURITY_RECCOMENDATION_SHOW,...this.getCommonFields()})}unsubscribe(){this.unsubscribeThemeListener()}constructor(){this.updateThemeField()}}const u=(0,n.createContext)(void 0)},832813:(e,t,o)=>{"use strict";o.d(t,{logSwitchAccountEvent:()=>m,logSwitchAccountTapEvent:()=>c,logSwitcherAddAnotherTapEvent:()=>d,logSwitcherDropAccount:()=>l,logTopNavElements:()=>h,prepareLogSwitchAccountEvent:()=>p});var i=o(581903),s=o(968083);const a=new i.ProductionStatCollector,n=new i.ActionStatCollector(a),r=new i.RegistrationItemStatCollector(n),_=new s.VkConnectNavigationCollector;function u(e){const t=n.productionStatCollector.getCurrentTime(!1);return[{name:i.RegistrationFieldItemNames.TO_SWITCHER_FROM,value:e,start_interaction_time:t,end_interaction_time:t}]}function d(e,t){r.logEvent(i.RegistrationItemEventTypes.MULTIACC_ADD_ANOTHER_ACCOUNT_TAP,i.EventScreens.MULTI_ACC_SWITCHER,i.EventScreens.NOWHERE,{force:!0},u(t),void 0,void 0,e)}function l(e,t="profile"){e&&(r.logEvent(i.RegistrationItemEventTypes.MULTIACC_DROP_ACCOUNT_TAP,i.EventScreens.MULTI_ACC_SWITCHER,i.EventScreens.NOWHERE,{force:!0},u(t),void 0,void 0,e),r.logEvent(i.RegistrationItemEventTypes.MULTIACC_DROP_ACCOUNT,i.EventScreens.MULTI_ACC_SWITCHER,i.EventScreens.NOWHERE,{force:!0},u(t),void 0,void 0,e))}function c(e,t){e&&r.logEvent(i.RegistrationItemEventTypes.SWITCH_ACCOUNT_TAP,i.EventScreens.MULTI_ACC_SWITCHER,i.EventScreens.NOWHERE,{force:!0},u(t),void 0,void 0,e)}function p(){window.vk.id&&sessionStorage.setItem("LOG_ACC_SWITCH",String(window.vk.id))}function m(e,t,o,s){e&&t&&o&&(r.logEvent(i.RegistrationItemEventTypes.SWITCH_FROM_ACCOUNT,i.EventScreens.MULTI_ACC_SWITCHER,i.EventScreens.NOWHERE,{force:!0},u(s),void 0,t,e),r.logEvent(i.RegistrationItemEventTypes.SWITCH_TO_ACCOUNT,i.EventScreens.MULTI_ACC_SWITCHER,i.EventScreens.NOWHERE,{force:!0},u(s),void 0,o,e))}function h(e){_.logTopNavElements(e)}},935037:(e,t,o)=>{"use strict";o.d(t,{APP_NAME:()=>i,LAST_ACC_ID_KEY:()=>n,LOG_ACC_SWITCH_KEY:()=>a,NOTIFY_SWITCH_KEY:()=>s});const i="EcosystemMultiAccountsEntry",s="multiacc_should_show_notifier",a="multacc_should_send_analytics",n="multiacc_last_id"},945192:(e,t,o)=>{"use strict";o.d(t,{init:()=>u});var i=o(823875),s=o(402953),a=o(850101),n=o(359244),r=o(741531),_=o(87223);const u=()=>{(0,i.init)(),(0,s.tqi)().setHandler("Common/nav_go",(e=>{e.payload.event?.target&&window.nav.go(e.payload.event.target,e.payload.event,JSON.parse(e.payload.dataAttrs?.options||"{}"))}),!1),(0,s.tqi)().setHandler("Common/cur_box_hide",(()=>{(0,a.curBox)()?.hide()}),!1),(0,s.tqi)().setHandler("Common/show_menu_settings",(e=>{const t=e.payload.dataAttrs?.type?Number(e.payload.dataAttrs.type):void 0;(0,n.loadMenuSettingsBox)(t)}),!1),(0,s.tqs)().setHandler("HelpHints/init",(({payload:{target:e}})=>{e?.remove(),(0,r.ensureAccountHelpHintsService)().initialize({viewerId:window.vk?.id,logErrorFn:_.logError})}),!0)}},787179:(e,t,o)=>{"use strict";o.d(t,{FEED_OFFLINE_MODE_FIELD:()=>i,PageCacheState:()=>s});const i="feed_offline_mode_state";var s;!function(e){e.Active="active",e.Inactive="inactive",e[e.Unset="%%pageCacheState%%"]="Unset"}(s||(s={}))},470147:(e,t,o)=>{"use strict";o.d(t,{handleSWResponse:()=>r,handleSWTimingsMessage:()=>n});var i=o(850263),s=o(942451);const a=(0,s.makeSharedState)("feed_with_offline_mode_sw_timings_data",(()=>({})),{version:1}),n=e=>{a().timings=e},r=()=>{const e=Date.now(),{timings:t}=a();if(!t?.lastTimestamp)return;const{lastTimestamp:o,...s}=t;(e=>{const{gettingFromCache:t,fetching:o,gettingFromCacheOnError:s,puttingIntoCache:a,postingFeedStateMessage:n,responding:r}=e;new i.DevNullStatCollector(new i.CustomStatCollector).logEvent({key:"feed_with_offline_mode_sw_content_timings",value:t,value2:o,value3:s,value4:a,value5:n,value6:r})})({...s,responding:e-o})}},212823:(e,t,o)=>{"use strict";o.d(t,{isPageCacheStateActive:()=>s,setPageCacheState:()=>a});var i=o(787179);const s=()=>window.vk.pageCacheState===i.PageCacheState.Active,a=e=>{window.vk.pageCacheState=e}},870700:(e,t,o)=>{"use strict";var i;function s(e){return e.type?`profile_tooltip__${e.type}`:"profile_tooltip"}function a(e){return e.type?`profile_tooltip_all__${e.type}`:"profile_tooltip"}o.d(t,{GiftRef:()=>i,getAllGiftsRefInTooltip:()=>a,getGiftRefInTooltip:()=>s}),function(e){e.PROFILE_BUTTON="profile_button",e.PROFILE_MODULE="profile_module",e.PROFILE_TOOLTIP="profile_tooltip",e.PROFILE_TOOLTIP_ALL="profile_tooltip_all"}(i||(i={}))},528411:(e,t,o)=>{"use strict";o.d(t,{MARKET_ALIEXPRESS_APP_ID:()=>i,MARKET_ALIEXPRESS_APP_NAME:()=>s,MARKET_ALIEXPRESS_GROUP_ID:()=>n,MARKET_ALIEXPRESS_HOME_URL:()=>a,MARKET_YOULA_GROUP_ID:()=>r});const i=6706576,s="ae_app",a="https://aliexpress.com",n=36941068,r=198582766},380181:(e,t,o)=>{"use strict";o.d(t,{getErrorText:()=>a,logImError:()=>s});var i=o(87223);function s(e,t=""){console.error(e);const o=e=>{(0,i.logError)(e,{environment:"im"})};if(e instanceof Error){const i=new Error(a(e,t));return i.name=e.name,i.stack=e.stack,o(i)}return o(new Error(a(e,t)))}function a(e,t=""){if(e instanceof Error)return t?`${t}: ${e.message}`:e.message;if("string"==typeof e||"number"==typeof e)return t?`${t}: ${e}`:`${e}`;if(e&&"api_error"===e.type){const o=JSON.stringify(e.error);return t?`${t}: ${o}`:o}if(e instanceof Object){let o="";try{o=JSON.stringify(e)}catch(e){o=`Error data ${e}`}return t?`${t}: ${o}`:o}return t}},857031:(e,t,o)=>{"use strict";o.d(t,{isVKCOMProfileRedesignedEnabled:()=>u,markLiveInStoriesFinished:()=>c,markSeenStoriesInProfile:()=>l,showFansBox:()=>d,showOwnerGiftsBox:()=>h,showSendGiftBox:()=>p,showSendSelectedGiftInBirthdayBox:()=>m,showSilentModeBox:()=>y});var i=o(20025),s=o(850101),a=o(870700),n=o(490712),r=o(476726),_=o(114896);function u(){return(0,r.partConfigEnabled)("redesign_web_profile_feature")}function d(e,t,o,s={},a=""){return window.cur.viewAsBox?window.cur.viewAsBox():!(0,i.showBox)("al_fans.php",{act:"box",tab:t||"fans",oid:e,from:a},{cache:1,stat:["page_help.css",window.jsc("web/fansbox.js")],params:{...s}},o)}function l(e){"profile"===window.cur.module&&window.Profile?.markSeenStories&&window.Profile.markSeenStories(e)}function c(e){"profile"===window.cur.module&&window.Profile?.markLiveInStoriesFinished&&window.Profile.markLiveInStoriesFinished(e)}function p(e,t,o,n,r){const _=(0,s.getBoxLayerWrap)();_&&(window.cur.gftbxWasScroll=_.scrollTop,_.scrollTop=0),(0,i.showBox)("al_gifts.php",{act:"get_gift_box",mid:e,fr:e===t?1:0,ref:n??a.GiftRef.PROFILE_BUTTON,gift:r??null},{stat:["gifts.css",window.jsc("web/wide_dd.js"),"wide_dd.css"],cache:1},o)}function m(e,t,o=a.GiftRef.PROFILE_BUTTON){(0,n.statlogsValueEvent)("gifts_tooltip_action",0,"gift_click",t),(0,i.showBox)("al_gifts.php",{act:"get_gift_box",mid:e,gift:t,ref:o})}function h(e,t,o){return!(0,i.showBox)("al_gifts.php",{act:"box",tab:o||"received",mid:e},{cache:1,stat:["gifts.css",window.jsc("web/gifts.js")]},t)}function y(e,t,o,i){(0,_.showSilentModeEnabledFormBox)({csrf:o,endDate:e,callsMailSend:t,redirectOnClose:!1,redirectOnSubmit:!1,onSubmit:i})}},929085:(e,t,o)=>{"use strict";o.r(t),o.d(t,{showAskQuestionBox:()=>l,showMyQuestionsBox:()=>d});var i=o(452314),s=o(850101),a=o(730735),n=o(547754),r=o(476726),_=o(789176),u=o(731709);function d(e){if(!(0,r.partConfigEnabled)("profile_questions_enabled"))return;if(window.cur.viewAsBox)return void window.cur.viewAsBox();if(window.MyQuestionsBox?.isMounted())return;e?.ref&&(0,u.logQuestionsOpeningEvent)(window.vk.id,e.ref,_.QuestionAnalyticBoxName.myQuestions);const t=document.querySelector("#box_layer_wrap"),o=document.querySelector("#box_loader");(0,i.show)(t),(0,i.show)(o),(0,s.refreshBoxLoaderCoords)(),Promise.all([(0,a.getQuestions)(),window.stManager.add([window.jsc("web/my_questions.js")]),new Promise(((e,t)=>{window.ajax.post("al_questions.php",{act:"load_ask_my_questions_box_lang_keys"},{onDone:()=>{e()},onFail:()=>(t(),!0)})}))]).then((([s])=>{window.boxQueue.count()||(0,i.hide)(t),(0,i.hide)(o),window.MyQuestionsBox.init(s.count,s.items,s.profiles,s.next_from,{onClose:e?.onClose,fromElement:e?.fromElement})})).catch((e=>{(0,i.hide)(t),(0,i.hide)(o),(0,n.logQuestionError)({error:e,additionalText:"An error occurred while loading data for my_questions.js"})}))}function l(e,t){if(!(0,r.partConfigEnabled)("profile_questions_enabled"))return;if(e===window.vk.id)return void d({ref:t?.ref,fromElement:t?.fromElement});if(window.cur.viewAsBox)return void window.cur.viewAsBox();if(window.AskQuestionBox?.isMounted())return;if(!e)return void(0,n.logQuestionError)({error:"Empty toUserId has been passed to showAskQuestionBox"});t?.ref&&(0,u.logQuestionsOpeningEvent)(e,t.ref,_.QuestionAnalyticBoxName.askQuestion);const o=document.querySelector("#box_layer_wrap"),l=document.querySelector("#box_loader");(0,i.show)(o),(0,i.show)(l),(0,s.refreshBoxLoaderCoords)(),Promise.all([(0,a.getUsers)([e]),window.stManager.add([window.jsc("web/ask_question.js")]),new Promise(((e,t)=>{window.ajax.post("al_questions.php",{act:"load_ask_question_box_lang_keys"},{onDone:()=>{e()},onFail:()=>(t(),!0)})}))]).then((([e])=>{(0,i.hide)(o),(0,i.hide)(l);const s=e[0];s&&window.AskQuestionBox.init(s,t?.fromElement)})).catch((e=>{(0,i.hide)(o),(0,i.hide)(l),(0,n.logQuestionError)({error:e,additionalText:"An error occurred while loading data for ask_question.js"})}))}},114896:(e,t,o)=>{"use strict";o.d(t,{showSilentModeEnabledFormBox:()=>r,showSilentModeEndFormBox:()=>_,showSilentModeFormBox:()=>n});var i=o(474848),s=o(507607),a=o(326382);function n(e){const t=(0,s.asyncComponent)((()=>Promise.all([o.e(91498),o.e(89631),o.e(73214)]).then(o.bind(o,211679))),(({SilentModeForm:e})=>e));(0,a.showMessageBoxModalSuspense)((o=>(0,i.jsx)(t,{...o,...e})),{width:400})}function r(e){const t=(0,s.asyncComponent)((()=>Promise.all([o.e(91498),o.e(89631),o.e(73214)]).then(o.bind(o,232804))),(({SilentModeEnabledForm:e})=>e));(0,a.showMessageBoxModalSuspense)((o=>(0,i.jsx)(t,{...o,...e})),{width:400})}function _(e,t){const n=(0,s.asyncComponent)((()=>Promise.all([o.e(91498),o.e(89631),o.e(73214)]).then(o.bind(o,370580))),(({SilentModeEndForm:e})=>e));(0,a.showMessageBoxModalSuspense)((t=>(0,i.jsx)(n,{...t,...e})),{width:400,onDestroy:t})}},302495:(e,t,o)=>{"use strict";o.d(t,{EventItemType:()=>s.EventItemType,SearchClickActionMap:()=>s.SearchClickActionMap,getTrackCodeFromElement:()=>n,logEvent:()=>r,logSearchAudioClick:()=>u,logSearchClipClick:()=>_,logSearchPlaylistClickOut:()=>d});var i=o(581903),s=o(695290),a=o(512912);const n=(e,t)=>e?t&&e.dataset?.[t]?e.dataset?.[t]||"":e.dataset?.trackCode?e.dataset?.trackCode||"":n(e.parentElement,t):"",r=e=>{e.track_code&&i.searchStatsCollector.logEvent(e)},_=e=>{/^search$|^clips\/search$|^search\?|^clips\/search\?|^search\/clips$|^search\/clips?$/g.test(window?.mvcur?.mvPrevLoc?.[0]??"")&&window?.mvcur?.mvShown&&i.searchStatsCollector.logEvent({action:e,type:s.EventItemType.CLIP,track_code:(0,a.getVideoTrackCode)()})},u=(e,t="")=>{r({action:e,track_code:t,type:s.EventItemType.MUSIC_AUDIO})},d=e=>{i.searchStatsCollector.logOutOfSerpEvent({type:s.EventItemType.MUSIC_PLAYLIST,action:e})}},512912:(e,t,o)=>{"use strict";o.d(t,{getVideoTrackCode:()=>a,pickTrackCodeFromURL:()=>s});var i=o(687604);const s=()=>{setTimeout((()=>i.TRACK_CODE_TYPES.some((e=>(e=>{const t=window.nav.objLoc[e];if(!t)return!1;const o={...window.nav.objLoc};return delete o[e],window.nav.setLoc(o,{replace:!0}),history.replaceState({...history.state,[e]:t},""),!0})(e)))))},a=()=>window?.Videoview?.getMvData()?.track_code??window.mvcur?.options?.addParams?.track_code??""},359244:(e,t,o)=>{"use strict";async function i(e){const{showMenuSettingsBox:t}=await Promise.all([o.e(91498),o.e(89631),o.e(6694)]).then(o.bind(o,477547));t(e)}o.d(t,{loadMenuSettingsBox:()=>i})},85953:(e,t,o)=>{"use strict";o.d(t,{initColorSchemeDropdowns:()=>a});var i=o(216147),s=o(832813);function a(){document.querySelectorAll(".SettingsColorSchemeDropdown").forEach((e=>{!function(e){if(e.dataset.inited)return;e.dataset.inited="1";let t=e.dataset.value,o=JSON.parse(e.dataset.items||"[]");i.ColorScheme.isSchemesAutoSwitchingSupported()||(t===i.ColorSchemeMode.Auto&&(t=i.ColorSchemeMode.Light),o=o.filter((([e])=>e!==i.ColorSchemeMode.Auto)));const a=new window.InlineDropdown(e,{selected:t,items:o,onSelect(t){i.colorScheme.setMode(t),(0,s.logTopNavElements)("theme");const o=e.dataset.hash;window.ajax.post("al_settings.php?act=a_save_color_scheme_mode",{mode:t,hash:o})}}),n=i.colorScheme.subscribe((()=>{e&&a?a.val(i.colorScheme.getMode(),!0):n()}))}(e)}))}},739739:(e,t,o)=>{"use strict";o.d(t,{composeEventObject:()=>s,getTimeSinceNavigation:()=>a,initializeSharedState:()=>n});var i=o(942451);function s(e,t){const o={event_type:e,metric_value:performance.now(),...t};return(o.error_type||o.error_description)&&(o.metric_value=void 0),o}function a(){const e=window.vkTabLoaded??Date.now(),t=window.vkLastNav??Date.now();let o=Date.now();return o<t&&(o=e+Math.floor(performance.now())),{elapsed:o-t,isAjaxNav:t!==e}}function n(e,t,o){return(0,i.makeSharedState)(e,(()=>o),{version:t})()}},423522:(e,t,o)=>{"use strict";o.d(t,{isStoryPerfStatsEnabledOnDesktopWeb:()=>n});var i=o(476726);const s=()=>(0,i.partConfigEnabled)("tech_stories_metrics_web"),a=()=>(0,i.partConfigEnabled)("tech_stories_metrics_web_mvk");function n(){return s()&&a()}},610390:(e,t,o)=>{"use strict";o.d(t,{trackHideViewerLoader:()=>g,trackShowViewerLoader:()=>E,trackStoryClosed:()=>f,trackStoryDownloadEnd:()=>y,trackStoryOpened:()=>m,trackStoryOpeningStart:()=>p,trackStoryViewerClosed:()=>h});var i=o(349471),s=o(169834),a=o(65365),n=(o(147937),o(739739)),r=o(423522);const _=e=>Number(e)?1:0,u=`${a.SHARED_STATE_KEY}::web:storyOpeningDetails`,d=(0,n.initializeSharedState)(u,0,new Map);function l(e,t){const o=d.get(e),i={...o,...t,timeOfStart:o?.timeOfStart??t?.timeOfStart??performance.now()};d.set(e,i)}function c(e,t,o){const i=d.get(e);return i?(0,n.composeEventObject)(t,{metric_value:o,story_info:i.storyDetails,view_entry_point:i.viewSource,story_type_open:i.navigationSource??s.StoryTypeOpen.UNKNOWN,type_next_story:i.navigationNextSpecifier,is_cold_start_viewer:_(i.isColdStart),is_preview_instance:_(i.isAnimated)}):null}function p(e,t){(0,r.isStoryPerfStatsEnabledOnDesktopWeb)()&&(d.has(e)||l(e,t))}function m(e,t){if(!(0,r.isStoryPerfStatsEnabledOnDesktopWeb)())return;l(e,t);const o=d.get(e)?.timeOfStart||0,a=c(e,s.StoryEventType.STORY_OPENED,performance.now()-o);a&&(0,i.collectStoryTechStatsEvent)(a)}function h(e){(0,r.isStoryPerfStatsEnabledOnDesktopWeb)()&&((0,i.resetStoryTechStatsStorage)(e),d.clear())}function y(e,t){if(!(0,r.isStoryPerfStatsEnabledOnDesktopWeb)())return;l(e,t);const o=d.get(e)?.timeOfStart||0,a=performance.now()-o,n=c(e,s.StoryEventType.DOWNLOAD,a);n&&a&&(0,i.collectStoryTechStatsEvent)(n)}function f(e){d.delete(e)}function E(e,t){if(!(0,r.isStoryPerfStatsEnabledOnDesktopWeb)())return;const o=(0,n.composeEventObject)(s.StoryEventType.SHOW_VIEWER_LOADER,{metric_value:performance.now(),is_cold_start_viewer:_(t.isColdStart)});(0,i.saveStoryTechStatsEvent)(o,e)}function g(e){if(!(0,r.isStoryPerfStatsEnabledOnDesktopWeb)())return;const t=s.StoryEventType.SHOW_VIEWER_LOADER,o=(0,i.getStoryTechStatsEvent)(t,e),a=(0,i.calculateTimeDeltaFromPriorEvent)(t,e)||0,_=(0,n.composeEventObject)(s.StoryEventType.HIDE_VIEWER_LOADER,{metric_value:a,is_cold_start_viewer:o?.is_cold_start_viewer||0});(0,i.collectStoryTechStatsEvent)(_),(0,i.resetStoryTechStatsStorage)(e,t)}},70780:(e,t,o)=>{"use strict";o.d(t,{isWidget:()=>i});const i=()=>window.vk.widget},147937:(e,t,o)=>{"use strict";o.d(t,{stringifyUnknown:()=>i});const i=e=>{if("object"!=typeof e)return String(e);if(e instanceof Error){const{name:t,message:o}=e,i=e instanceof DOMException?e.code:null;return`${t}${null!=i?` code #${i}`:""}: ${o}`}try{return JSON.stringify(e)}catch{return"got a non-serializable error object"}}},60553:(e,t,o)=>{"use strict";function i(){return window.stManager.add([window.jsc("web/video.js")])}function s(){return window.VideoUpload?Promise.resolve():Promise.all([o.e(91498),o.e(50560),o.e(89631),o.e(85172),o.e(762),o.e(21529),o.e(23045),o.e(21608),o.e(56229),o.e(66118),o.e(36237),o.e(56154),o.e(58292),o.e(49925),o.e(71247),o.e(17213),o.e(73248),o.e(25459),o.e(42099),o.e(51943)]).then(o.bind(o,938179)).then((({initVideoUpload:e,VideoUpload:t,VideoUploadSubtitles:o,VideoInlineUpload:i})=>{!window.VideoUpload&&t&&(window.VideoUpload=t),!window.VideoUploadSubtitles&&o&&(window.VideoUploadSubtitles=o),!window.VideoInlineUpload&&i&&(window.VideoInlineUpload=i),e()}))}function a(){return window.stManager.add([window.jsc("web/video_showcase.js")])}function n(){return window.stManager.add([window.jsc("web/indexer.js")])}function r(){return window.stManager.add([window.jsc("web/grid_sorter.js")])}o.d(t,{getGridSorterModule:()=>r,getIndexerModule:()=>n,getVideoModule:()=>i,getVideoShowcaseModule:()=>a,getVideoUploadModule:()=>s})},400281:(e,t,o)=>{"use strict";o.d(t,{CreatePlaylistRequestOrigin:()=>g,PlaylistFormEvents:()=>E,VideoAddToPlaylistActionSheetEvents:()=>y,VideoCardAddButtonEvents:()=>f,VideoOrderEvents:()=>h,checkVideoIsPreloaded:()=>p,createPlaylistPopup:()=>d,getAdditionalInfo:()=>n.getAdditionalInfo,getFormattedBigViewsToShortCase:()=>n.getFormattedBigViewsToShortCase,getFormattedPostponePublishDateTime:()=>n.getFormattedPostponePublishDateTime,getFormattedUpdatedTime:()=>n.getFormattedUpdatedTime,getVideoTrackCode:()=>_,idlizeCall:()=>r,isMediaHlsSupported:()=>m,logClipClick:()=>u,startLiveVideoPopup:()=>c,uploadVideoPopup:()=>l});var i=o(60553),s=o(695290),a=o(581903),n=o(422495);const r=(e,t=1e3)=>{const o=()=>{setTimeout((()=>e()),t)};return"function"==typeof window.requestIdleCallback?window.requestIdleCallback(o,{timeout:5e3}):o()},_=()=>window?.Videoview?.getMvData()?.track_code||window.mvcur?.options?.addParams?.track_code,u=(e,t)=>{a.shortVideoStatsCollector.logEvent({type:s.EventItemType.CLIP,action:e,track_code:t})},d=async(e,t,o,s,a)=>{window.Video||await(0,i.getVideoModule)(),window.Video.createAlbum(e,t,o,s,a)},l=(e,t,o)=>{window.VideoUpload.showBox({aid:t,from:"video",oid:e,disabled:o})},c=e=>{window.cur.webcast_settings?window.VideoUpload.showLiveVideoLeaveWarning(e):window.VideoUpload.showLiveTypeModal(e)},p=e=>Object.keys(window.ajaxCache).some((t=>t.startsWith("/al_video.php?act=video_box")&&t.includes(`&video=${e}`))),m=()=>window.MediaSource&&MediaSource.isTypeSupported&&MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),h={START_LOADING:"VideoOrderEvents/START_LOADING",END_LOADING:"VideoOrderEvents/END_LOADING"},y={INIT:"VideoAddToPlaylistActionSheetEvents/INIT",SHOW:"VideoAddToPlaylistActionSheetEvents/SHOW",HIDE:"VideoAddToPlaylistActionSheetEvents/HIDE"},f={SET_ADD:"VideoCardAddButtonEvents/SET_ADD",SET_ADDED:"VideoCardAddButtonEvents/SET_ADDED",SHOW:"VideoCardAddButtonEvents/SHOW",HIDE:"VideoCardAddButtonEvents/HIDE"},E={CREATE:"PlaylistFormEvents/CREATE",UPDATE:"PlaylistFormEvents/UPDATE",DELETE:"PlaylistFormEvents/DELETE"},g={VIDEO_PLAYLISTS_MODAL:"CreatePlaylistRequestOrigin/VIDEO_PLAYLISTS_MODAL",NEW_PLAYLIST_PAGE:"CreatePlaylistRequestOrigin/NEW_PLAYLIST_PAGE",VIDEO_CATALOG:"CreatePlaylistRequestOrigin/VIDEO_CATALOG"}},823617:(e,t,o)=>{"use strict";o.d(t,{showProductAttachModal:()=>n});var i=o(474848),s=o(272259);const a=(0,o(507607).asyncComponent)((()=>Promise.all([o.e(91498),o.e(89631),o.e(21529),o.e(40482),o.e(21608),o.e(24535),o.e(96649)]).then(o.bind(o,89691))),(({ProductAttachModalLegacy:e})=>e));function n(e){(0,s.showMessageBoxModalSuspense)((t=>(0,i.jsx)(a,{...t,...e})),{width:558})}},401063:(e,t,o)=>{"use strict";var i=o(296540);var s="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},a=i.useState,n=i.useEffect,r=i.useLayoutEffect,_=i.useDebugValue;function u(e){var t=e.getSnapshot;e=e.value;try{var o=t();return!s(e,o)}catch(e){return!0}}var d="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var o=t(),i=a({inst:{value:o,getSnapshot:t}}),s=i[0].inst,d=i[1];return r((function(){s.value=o,s.getSnapshot=t,u(s)&&d({inst:s})}),[e,o,t]),n((function(){return u(s)&&d({inst:s}),e((function(){u(s)&&d({inst:s})}))}),[e]),_(o),o};t.useSyncExternalStore=void 0!==i.useSyncExternalStore?i.useSyncExternalStore:d},788940:(e,t,o)=>{"use strict";var i=o(296540),s=o(19888);var a="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},n=s.useSyncExternalStore,r=i.useRef,_=i.useEffect,u=i.useMemo,d=i.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,o,i,s){var l=r(null);if(null===l.current){var c={hasValue:!1,value:null};l.current=c}else c=l.current;l=u((function(){function e(e){if(!_){if(_=!0,n=e,e=i(e),void 0!==s&&c.hasValue){var t=c.value;if(s(t,e))return r=t}return r=e}if(t=r,a(n,e))return t;var o=i(e);return void 0!==s&&s(t,o)?t:(n=e,r=o)}var n,r,_=!1,u=void 0===o?null:o;return[function(){return e(t())},null===u?void 0:function(){return e(u())}]}),[t,o,i,s]);var p=n(e,l[0],l[1]);return _((function(){c.hasValue=!0,c.value=p}),[p]),d(p),p}},19888:(e,t,o)=>{"use strict";e.exports=o(401063)},69242:(e,t,o)=>{"use strict";e.exports=o(788940)},391943:(e,t,o)=>{"use strict";o.d(t,{default:()=>i});const i={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)}},913469:(e,t,o)=>{"use strict";o.d(t,{default:()=>i});const i=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},543407:(e,t,o)=>{"use strict";let i;o.d(t,{default:()=>a});const s=new Uint8Array(16);function a(){if(!i&&(i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!i))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(s)}},338823:(e,t,o)=>{"use strict";o.d(t,{unsafeStringify:()=>s});o(766382);const i=[];for(let e=0;e<256;++e)i.push((e+256).toString(16).slice(1));function s(e,t=0){return(i[e[t+0]]+i[e[t+1]]+i[e[t+2]]+i[e[t+3]]+"-"+i[e[t+4]]+i[e[t+5]]+"-"+i[e[t+6]]+i[e[t+7]]+"-"+i[e[t+8]]+i[e[t+9]]+"-"+i[e[t+10]]+i[e[t+11]]+i[e[t+12]]+i[e[t+13]]+i[e[t+14]]+i[e[t+15]]).toLowerCase()}},418562:(e,t,o)=>{"use strict";o.d(t,{default:()=>n});var i=o(391943),s=o(543407),a=o(338823);const n=function(e,t,o){if(i.default.randomUUID&&!t&&!e)return i.default.randomUUID();const n=(e=e||{}).random||(e.rng||s.default)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){o=o||0;for(let e=0;e<16;++e)t[o+e]=n[e];return t}return(0,a.unsafeStringify)(n)}},766382:(e,t,o)=>{"use strict";o.d(t,{default:()=>s});var i=o(913469);const s=function(e){return"string"==typeof e&&i.default.test(e)}},43014:(e,t,o)=>{"use strict";o.d(t,{persist:()=>r});var i=o(32489),s=new Map,a=e=>(t,o)=>e(o,t.ref),n=(0,i.createEvent)();function r(e){var{adapter:t,store:o,source:r=o,target:_=o,clock:u=r,done:d,fail:l=n,finally:c,pickup:p,context:m,key:h,keyPrefix:y="",contract:f}=e;if(!t)throw Error("Adapter is not defined");if(!r)throw Error("Store or source is not defined");if(!_)throw Error("Target is not defined");if(!h&&r.shortName===r.id)throw Error("Key or name is not defined");if(r===_&&!i.is.store(r))throw Error("Source must be different from target");void 0===e.def&&i.is.store(r)&&(e.def=r.defaultState);var E="factory"in t?t(e):t,g=h||r.shortName,v=function(e,t){var o=s.get(e);void 0===o&&(o=new Map,s.set(e,o));var a=o.get(t);return void 0!==a||(a=(0,i.createStore)(null,{serialize:"ignore"}),o.set(t,a)),a}(E.keyArea||E,y+g),A=(0,i.createNode)(),w=()=>(0,i.clearNode)(A),b=e=>({status:t="fail",params:o,result:i,error:s})=>"done"===t?{status:t,key:g,keyPrefix:y,operation:e,value:"get"===e?i:o}:{status:t,key:g,keyPrefix:y,operation:e,value:o,error:s};return(0,i.withRegion)(A,(()=>{var e,t=(0,i.createStore)({ref:void 0},{serialize:"ignore"}),o=E(y+g,(e=>I(e))),s=(0,i.attach)({source:t,effect:a(o.get)}),n=(0,i.attach)({source:t,effect:a(o.set)}),h=(0,i.createEffect)((e=f,t=>!e||void 0===t||("isData"in e?e.isData(t):e(t))?t:(()=>{throw"getErrorMessages"in e?e.getErrorMessages(t):void 0})())),A=(0,i.createEvent)(),w=A.filterMap((({status:e,key:t,keyPrefix:o,operation:i,value:s})=>"done"===e?{key:t,keyPrefix:o,operation:i,value:s}:void 0)),P=A.filterMap((({status:e,key:t,keyPrefix:o,operation:i,error:s,value:a})=>"fail"===e?{key:t,keyPrefix:o,operation:i,error:s,value:a}:void 0)),T=(0,i.createEvent)(),I=s;t.updates.watch((()=>{I=(e=>{try{return(0,i.scopeBind)(e,{safe:!0})}catch(t){return e}})(s)})),(0,i.sample)({source:r,clock:u,target:T}),(0,i.guard)({source:(0,i.sample)(v,T,((e,t)=>[t,e])),filter:([e,t])=>e!==t,target:n.prepend((([e])=>e))}),(0,i.forward)({from:[s.doneData,n],to:v}),(0,i.sample)({source:(0,i.merge)([s.doneData,v]),target:h}),(0,i.forward)({from:h.doneData,to:_}),(0,i.forward)({from:[s.finally.map(b("get")),n.finally.map(b("set")),h.fail.map(b("validate"))],to:A}),(0,i.forward)({from:P,to:l}),d&&(0,i.forward)({from:w,to:d}),c&&(0,i.forward)({from:A,to:c}),m&&t.on(m,(({ref:e},t)=>({ref:void 0===t?e:t}))),p?((0,i.forward)({from:p,to:s.prepend((()=>{}))}),t.on(p,(({ref:e},t)=>({ref:void 0===t?e:t})))):s()})),w.unsubscribe=w}n.watch((e=>console.error(e.error)))},225604:(e,t,o)=>{"use strict";o.d(t,{persist:()=>_});var i=o(43014),s=o(719888),a=o(764318);function n(e){return function(){try{return"undefined"!=typeof localStorage}catch(e){return!0}}()?(0,a.storage)({storage:()=>localStorage,sync:!0,...e}):(0,s.nil)({keyArea:"local"})}n.factory=!0;var r,_=e=>(0,i.persist)({adapter:n,...r,...e})},719888:(e,t,o)=>{"use strict";function i({keyArea:e=""}={}){var t=()=>({get(){},set(){}});return t.keyArea=e,t.noop=!0,t}o.d(t,{nil:()=>i}),i.factory=!0},764318:(e,t,o)=>{"use strict";function i({storage:e,sync:t=!1,serialize:o=JSON.stringify,deserialize:i=JSON.parse,timeout:s,def:a}){var n=(n,r)=>{var _,u,d,l=()=>d.setItem(n,o(u)),c=e=>{_=clearTimeout(_),e&&l(),"undefined"!=typeof removeEventListener&&removeEventListener("beforeunload",c)};return t&&"undefined"!=typeof addEventListener&&addEventListener("storage",(o=>{o.storageArea===e()&&(o.key===n&&r("force"===t?void 0:o.newValue),null===o.key&&r(null))})),{get(t){c();var o=void 0!==t?t:e().getItem(n);return null===o?void 0!==a?a:t:i(o)},set(t){u=t,d=e(),void 0===s?l():_||(_=setTimeout(c,s,1),"undefined"!=typeof addEventListener&&addEventListener("beforeunload",c))}}};try{n.keyArea=e()}catch(e){}return n}o.d(t,{storage:()=>i}),i.factory=!0},202732:(e,t,o)=>{"use strict";o.d(t,{default:()=>a});var i=o(280702),s=o(41917);const a=(0,i.default)(s.default,"DataView")},965373:(e,t,o)=>{"use strict";o.d(t,{default:()=>u});var i=o(962944),s=o(349190),a=o(178417),n=o(18813),r=o(463957);function _(e){var t=-1,o=null==e?0:e.length;for(this.clear();++t<o;){var i=e[t];this.set(i[0],i[1])}}_.prototype.clear=i.default,_.prototype.delete=s.default,_.prototype.get=a.default,_.prototype.has=n.default,_.prototype.set=r.default;const u=_},277919:(e,t,o)=>{"use strict";o.d(t,{default:()=>u});var i=o(36838),s=o(362384),a=o(104787),n=o(898207),r=o(451031);function _(e){var t=-1,o=null==e?0:e.length;for(this.clear();++t<o;){var i=e[t];this.set(i[0],i[1])}}_.prototype.clear=i.default,_.prototype.delete=s.default,_.prototype.get=a.default,_.prototype.has=n.default,_.prototype.set=r.default;const u=_},168335:(e,t,o)=>{"use strict";o.d(t,{default:()=>a});var i=o(280702),s=o(41917);const a=(0,i.default)(s.default,"Map")},935917:(e,t,o)=>{"use strict";o.d(t,{default:()=>u});var i=o(95088),s=o(829846),a=o(831521),n=o(782509),r=o(549);function _(e){var t=-1,o=null==e?0:e.length;for(this.clear();++t<o;){var i=e[t];this.set(i[0],i[1])}}_.prototype.clear=i.default,_.prototype.delete=s.default,_.prototype.get=a.default,_.prototype.has=n.default,_.prototype.set=r.default;const u=_},20180:(e,t,o)=>{"use strict";o.d(t,{default:()=>a});var i=o(280702),s=o(41917);const a=(0,i.default)(s.default,"Promise")},439857:(e,t,o)=>{"use strict";o.d(t,{default:()=>a});var i=o(280702),s=o(41917);const a=(0,i.default)(s.default,"Set")},601275:(e,t,o)=>{"use strict";o.d(t,{default:()=>r});var i=o(935917),s=o(25668),a=o(529875);function n(e){var t=-1,o=null==e?0:e.length;for(this.__data__=new i.default;++t<o;)this.add(e[t])}n.prototype.add=n.prototype.push=s.default,n.prototype.has=a.default;const r=n},93265:(e,t,o)=>{"use strict";o.d(t,{default:()=>d});var i=o(277919),s=o(591532),a=o(42),n=o(173061),r=o(144105),_=o(487681);function u(e){var t=this.__data__=new i.default(e);this.size=t.size}u.prototype.clear=s.default,u.prototype.delete=a.default,u.prototype.get=n.default,u.prototype.has=r.default,u.prototype.set=_.default;const d=u},243988:(e,t,o)=>{"use strict";o.d(t,{default:()=>i});const i=o(41917).default.Uint8Array},753631:(e,t,o)=>{"use strict";o.d(t,{default:()=>a});var i=o(280702),s=o(41917);const a=(0,i.default)(s.default,"WeakMap")},102634:(e,t,o)=>{"use strict";o.d(t,{default:()=>i});const i=function(e,t){for(var o=-1,i=null==e?0:e.length,s=0,a=[];++o<i;){var n=e[o];t(n,o,e)&&(a[s++]=n)}return a}},550423:(e,t,o)=>{"use strict";o.d(t,{default:()=>d});var i=o(159520),s=o(241788),a=o(292049),n=o(74616),r=o(925353),_=o(118719),u=Object.prototype.hasOwnProperty;const d=function(e,t){var o=(0,a.default)(e),d=!o&&(0,s.default)(e),l=!o&&!d&&(0,n.default)(e),c=!o&&!d&&!l&&(0,_.default)(e),p=o||d||l||c,m=p?(0,i.default)(e.length,String):[],h=m.length;for(var y in e)!t&&!u.call(e,y)||p&&("length"==y||l&&("offset"==y||"parent"==y)||c&&("buffer"==y||"byteLength"==y||"byteOffset"==y)||(0,r.default)(y,h))||m.push(y);return m}},976912:(e,t,o)=>{"use strict";o.d(t,{default:()=>i});const i=function(e,t){for(var o=-1,i=t.length,s=e.length;++o<i;)e[s+o]=t[o];return e}},463736:(e,t,o)=>{"use strict";o.d(t,{default:()=>i});const i=function(e,t){for(var o=-1,i=null==e?0:e.length;++o<i;)if(t(e[o],o,e))return!0;return!1}},652851:(e,t,o)=>{"use strict";o.d(t,{default:()=>n});var i=o(152528),s=o(166984),a=Object.prototype.hasOwnProperty;const n=function(e,t,o){var n=e[t];a.call(e,t)&&(0,s.default)(n,o)&&(void 0!==o||t in e)||(0,i.default)(e,t,o)}},210169:(e,t,o)=>{"use strict";o.d(t,{default:()=>s});var i=o(166984);const s=function(e,t){for(var o=e.length;o--;)if((0,i.default)(e[o][0],t))return o;return-1}},152528:(e,t,o)=>{"use strict";o.d(t,{default:()=>s});var i=o(684171);const s=function(e,t,o){"__proto__"==t&&i.default?(0,i.default)(e,t,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[t]=o}},966318:(e,t,o)=>{"use strict";o.d(t,{default:()=>a});var i=o(687465),s=o(930901);const a=function(e,t){for(var o=0,a=(t=(0,i.default)(t,e)).length;null!=e&&o<a;)e=e[(0,s.default)(t[o++])];return o&&o==a?e:void 0}},833831:(e,t,o)=>{"use strict";o.d(t,{default:()=>a});var i=o(976912),s=o(292049);const a=function(e,t,o){var a=t(e);return(0,s.default)(e)?a:(0,i.default)(a,o(e))}},509789:(e,t,o)=>{"use strict";o.d(t,{default:()=>i});const i=function(e,t){return null!=e&&t in Object(e)}},974846:(e,t,o)=>{"use strict";o.d(t,{default:()=>a});var i=o(979672),s=o(753098);const a=function(e){return(0,s.default)(e)&&"[object Arguments]"==(0,i.default)(e)}},891038:(e,t,o)=>{"use strict";o.d(t,{default:()=>a});var i=o(343244),s=o(753098);const a=function e(t,o,a,n,r){return t===o||(null==t||null==o||!(0,s.default)(t)&&!(0,s.default)(o)?t!=t&&o!=o:(0,i.default)(t,o,a,n,e,r))}},343244:(e,t,o)=>{"use strict";o.d(t,{default:()=>h});var i=o(93265),s=o(608967),a=o(480402),n=o(937265),r=o(935861),_=o(292049),u=o(74616),d=o(118719),l="[object Arguments]",c="[object Array]",p="[object Object]",m=Object.prototype.hasOwnProperty;const h=function(e,t,o,h,y,f){var E=(0,_.default)(e),g=(0,_.default)(t),v=E?c:(0,r.default)(e),A=g?c:(0,r.default)(t),w=(v=v==l?p:v)==p,b=(A=A==l?p:A)==p,P=v==A;if(P&&(0,u.default)(e)){if(!(0,u.default)(t))return!1;E=!0,w=!1}if(P&&!w)return f||(f=new i.default),E||(0,d.default)(e)?(0,s.default)(e,t,o,h,y,f):(0,a.default)(e,t,v,o,h,y,f);if(!(1&o)){var T=w&&m.call(e,"__wrapped__"),I=b&&m.call(t,"__wrapped__");if(T||I){var O=T?e.value():e,C=I?t.value():t;return f||(f=new i.default),y(O,C,o,h,f)}}return!!P&&(f||(f=new i.default),(0,n.default)(e,t,o,h,y,f))}},500759:(e,t,o)=>{"use strict";o.d(t,{default:()=>a});var i=o(93265),s=o(891038);const a=function(e,t,o,a){var n=o.length,r=n,_=!a;if(null==e)return!r;for(e=Object(e);n--;){var u=o[n];if(_&&u[2]?u[1]!==e[u[0]]:!(u[0]in e))return!1}for(;++n<r;){var d=(u=o[n])[0],l=e[d],c=u[1];if(_&&u[2]){if(void 0===l&&!(d in e))return!1}else{var p=new i.default;if(a)var m=a(l,c,d,e,t,p);if(!(void 0===m?(0,s.default)(c,l,3,a,p):m))return!1}}return!0}},651979:(e,t,o)=>{"use strict";o.d(t,{default:()=>p});var i=o(389610),s=o(870640),a=o(523149),n=o(281121),r=/^\[object .+?Constructor\]$/,_=Function.prototype,u=Object.prototype,d=_.toString,l=u.hasOwnProperty,c=RegExp("^"+d.call(l).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const p=function(e){return!(!(0,a.default)(e)||(0,s.default)(e))&&((0,i.default)(e)?c:r).test((0,n.default)(e))}},289717:(e,t,o)=>{"use strict";o.d(t,{default:()=>r});var i=o(979672),s=o(5254),a=o(753098),n={};n["[object Float32Array]"]=n["[object Float64Array]"]=n["[object Int8Array]"]=n["[object Int16Array]"]=n["[object Int32Array]"]=n["[object Uint8Array]"]=n["[object Uint8ClampedArray]"]=n["[object Uint16Array]"]=n["[object Uint32Array]"]=!0,n["[object Arguments]"]=n["[object Array]"]=n["[object ArrayBuffer]"]=n["[object Boolean]"]=n["[object DataView]"]=n["[object Date]"]=n["[object Error]"]=n["[object Function]"]=n["[object Map]"]=n["[object Number]"]=n["[object Object]"]=n["[object RegExp]"]=n["[object Set]"]=n["[object String]"]=n["[object WeakMap]"]=!1;const r=function(e){return(0,a.default)(e)&&(0,s.default)(e.length)&&!!n[(0,i.default)(e)]}},952141:(e,t,o)=>{"use strict";o.d(t,{default:()=>_});var i=o(544943),s=o(256474),a=o(929008),n=o(292049),r=o(792263);const _=function(e){return"function"==typeof e?e:null==e?a.default:"object"==typeof e?(0,n.default)(e)?(0,s.default)(e[0],e[1]):(0,i.default)(e):(0,r.default)(e)}},17064:(e,t,o)=>{"use strict";o.d(t,{default:()=>n});var i=o(897271),s=o(733938),a=Object.prototype.hasOwnProperty;const n=function(e){if(!(0,i.default)(e))return(0,s.default)(e);var t=[];for(var o in Object(e))a.call(e,o)&&"constructor"!=o&&t.push(o);return t}},708823:(e,t,o)=>{"use strict";o.d(t,{default:()=>r});var i=o(523149),s=o(897271),a=o(981493),n=Object.prototype.hasOwnProperty;const r=function(e){if(!(0,i.default)(e))return(0,a.default)(e);var t=(0,s.default)(e),o=[];for(var r in e)("constructor"!=r||!t&&n.call(e,r))&&o.push(r);return o}},544943:(e,t,o)=>{"use strict";o.d(t,{default:()=>n});var i=o(500759),s=o(997960),a=o(945997);const n=function(e){var t=(0,s.default)(e);return 1==t.length&&t[0][2]?(0,a.default)(t[0][0],t[0][1]):function(o){return o===e||(0,i.default)(o,e,t)}}},256474:(e,t,o)=>{"use strict";o.d(t,{default:()=>d});var i=o(891038),s=o(877500),a=o(217511),n=o(386586),r=o(909396),_=o(945997),u=o(930901);const d=function(e,t){return(0,n.default)(e)&&(0,r.default)(t)?(0,_.default)((0,u.default)(e),t):function(o){var n=(0,s.default)(o,e);return void 0===n&&n===t?(0,a.default)(o,e):(0,i.default)(t,n,3)}}},769084:(e,t,o)=>{"use strict";o.d(t,{default:()=>n});var i=o(966318),s=o(837346),a=o(687465);const n=function(e,t,o){for(var n=-1,r=t.length,_={};++n<r;){var u=t[n],d=(0,i.default)(e,u);o(d,u)&&(0,s.default)(_,(0,a.default)(u,e),d)}return _}},82199:(e,t,o)=>{"use strict";o.d(t,{default:()=>s});var i=o(966318);const s=function(e){return function(t){return(0,i.default)(t,e)}}},837346:(e,t,o)=>{"use strict";o.d(t,{default:()=>_});var i=o(652851),s=o(687465),a=o(925353),n=o(523149),r=o(930901);const _=function(e,t,o,_){if(!(0,n.default)(e))return e;for(var u=-1,d=(t=(0,s.default)(t,e)).length,l=d-1,c=e;null!=c&&++u<d;){var p=(0,r.default)(t[u]),m=o;if("__proto__"===p||"constructor"===p||"prototype"===p)return e;if(u!=l){var h=c[p];void 0===(m=_?_(h,p,c):void 0)&&(m=(0,n.default)(h)?h:(0,a.default)(t[u+1])?[]:{})}(0,i.default)(c,p,m),c=c[p]}return e}},159520:(e,t,o)=>{"use strict";o.d(t,{default:()=>i});const i=function(e,t){for(var o=-1,i=Array(e);++o<e;)i[o]=t(o);return i}},764099:(e,t,o)=>{"use strict";o.d(t,{default:()=>i});const i=function(e,t){return e.has(t)}},687465:(e,t,o)=>{"use strict";o.d(t,{default:()=>r});var i=o(292049),s=o(386586),a=o(865722),n=o(648182);const r=function(e,t){return(0,i.default)(e)?e:(0,s.default)(e,t)?[e]:(0,a.default)((0,n.default)(e))}},113161:(e,t,o)=>{"use strict";o.d(t,{default:()=>i});const i=o(41917).default["__core-js_shared__"]},684171:(e,t,o)=>{"use strict";o.d(t,{default:()=>s});var i=o(280702);const s=function(){try{var e=(0,i.default)(Object,"defineProperty");return e({},"",{}),e}catch(e){}}()},608967:(e,t,o)=>{"use strict";o.d(t,{default:()=>n});var i=o(601275),s=o(463736),a=o(764099);const n=function(e,t,o,n,r,_){var u=1&o,d=e.length,l=t.length;if(d!=l&&!(u&&l>d))return!1;var c=_.get(e),p=_.get(t);if(c&&p)return c==t&&p==e;var m=-1,h=!0,y=2&o?new i.default:void 0;for(_.set(e,t),_.set(t,e);++m<d;){var f=e[m],E=t[m];if(n)var g=u?n(E,f,m,t,e,_):n(f,E,m,e,t,_);if(void 0!==g){if(g)continue;h=!1;break}if(y){if(!(0,s.default)(t,(function(e,t){if(!(0,a.default)(y,t)&&(f===e||r(f,e,o,n,_)))return y.push(t)}))){h=!1;break}}else if(f!==E&&!r(f,E,o,n,_)){h=!1;break}}return _.delete(e),_.delete(t),h}},480402:(e,t,o)=>{"use strict";o.d(t,{default:()=>l});var i=o(700241),s=o(243988),a=o(166984),n=o(608967),r=o(164877),_=o(729959),u=i.default?i.default.prototype:void 0,d=u?u.valueOf:void 0;const l=function(e,t,o,i,u,l,c){switch(o){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!l(new s.default(e),new s.default(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return(0,a.default)(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var p=r.default;case"[object Set]":var m=1&i;if(p||(p=_.default),e.size!=t.size&&!m)return!1;var h=c.get(e);if(h)return h==t;i|=2,c.set(e,t);var y=(0,n.default)(p(e),p(t),i,u,l,c);return c.delete(e),y;case"[object Symbol]":if(d)return d.call(e)==d.call(t)}return!1}},937265:(e,t,o)=>{"use strict";o.d(t,{default:()=>a});var i=o(719042),s=Object.prototype.hasOwnProperty;const a=function(e,t,o,a,n,r){var _=1&o,u=(0,i.default)(e),d=u.length;if(d!=(0,i.default)(t).length&&!_)return!1;for(var l=d;l--;){var c=u[l];if(!(_?c in t:s.call(t,c)))return!1}var p=r.get(e),m=r.get(t);if(p&&m)return p==t&&m==e;var h=!0;r.set(e,t),r.set(t,e);for(var y=_;++l<d;){var f=e[c=u[l]],E=t[c];if(a)var g=_?a(E,f,c,t,e,r):a(f,E,c,e,t,r);if(!(void 0===g?f===E||n(f,E,o,a,r):g)){h=!1;break}y||(y="constructor"==c)}if(h&&!y){var v=e.constructor,A=t.constructor;v==A||!("constructor"in e)||!("constructor"in t)||"function"==typeof v&&v instanceof v&&"function"==typeof A&&A instanceof A||(h=!1)}return r.delete(e),r.delete(t),h}},719042:(e,t,o)=>{"use strict";o.d(t,{default:()=>n});var i=o(833831),s=o(214792),a=o(327422);const n=function(e){return(0,i.default)(e,a.default,s.default)}},883973:(e,t,o)=>{"use strict";o.d(t,{default:()=>n});var i=o(833831),s=o(283511),a=o(241865);const n=function(e){return(0,i.default)(e,a.default,s.default)}},515547:(e,t,o)=>{"use strict";o.d(t,{default:()=>s});var i=o(649914);const s=function(e,t){var o=e.__data__;return(0,i.default)(t)?o["string"==typeof t?"string":"hash"]:o.map}},997960:(e,t,o)=>{"use strict";o.d(t,{default:()=>a});var i=o(909396),s=o(327422);const a=function(e){for(var t=(0,s.default)(e),o=t.length;o--;){var a=t[o],n=e[a];t[o]=[a,n,(0,i.default)(n)]}return t}},280702:(e,t,o)=>{"use strict";o.d(t,{default:()=>a});var i=o(651979),s=o(208104);const a=function(e,t){var o=(0,s.default)(e,t);return(0,i.default)(o)?o:void 0}},315647:(e,t,o)=>{"use strict";o.d(t,{default:()=>i});const i=(0,o(40367).default)(Object.getPrototypeOf,Object)},214792:(e,t,o)=>{"use strict";o.d(t,{default:()=>r});var i=o(102634),s=o(613153),a=Object.prototype.propertyIsEnumerable,n=Object.getOwnPropertySymbols;const r=n?function(e){return null==e?[]:(e=Object(e),(0,i.default)(n(e),(function(t){return a.call(e,t)})))}:s.default},283511:(e,t,o)=>{"use strict";o.d(t,{default:()=>r});var i=o(976912),s=o(315647),a=o(214792),n=o(613153);const r=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)(0,i.default)(t,(0,a.default)(e)),e=(0,s.default)(e);return t}:n.default},935861:(e,t,o)=>{"use strict";o.d(t,{default:()=>A});var i=o(202732),s=o(168335),a=o(20180),n=o(439857),r=o(753631),_=o(979672),u=o(281121),d="[object Map]",l="[object Promise]",c="[object Set]",p="[object WeakMap]",m="[object DataView]",h=(0,u.default)(i.default),y=(0,u.default)(s.default),f=(0,u.default)(a.default),E=(0,u.default)(n.default),g=(0,u.default)(r.default),v=_.default;(i.default&&v(new i.default(new ArrayBuffer(1)))!=m||s.default&&v(new s.default)!=d||a.default&&v(a.default.resolve())!=l||n.default&&v(new n.default)!=c||r.default&&v(new r.default)!=p)&&(v=function(e){var t=(0,_.default)(e),o="[object Object]"==t?e.constructor:void 0,i=o?(0,u.default)(o):"";if(i)switch(i){case h:return m;case y:return d;case f:return l;case E:return c;case g:return p}return t});const A=v},208104:(e,t,o)=>{"use strict";o.d(t,{default:()=>i});const i=function(e,t){return null==e?void 0:e[t]}},285054:(e,t,o)=>{"use strict";o.d(t,{default:()=>u});var i=o(687465),s=o(241788),a=o(292049),n=o(925353),r=o(5254),_=o(930901);const u=function(e,t,o){for(var u=-1,d=(t=(0,i.default)(t,e)).length,l=!1;++u<d;){var c=(0,_.default)(t[u]);if(!(l=null!=e&&o(e,c)))break;e=e[c]}return l||++u!=d?l:!!(d=null==e?0:e.length)&&(0,r.default)(d)&&(0,n.default)(c,d)&&((0,a.default)(e)||(0,s.default)(e))}},962944:(e,t,o)=>{"use strict";o.d(t,{default:()=>s});var i=o(220674);const s=function(){this.__data__=i.default?(0,i.default)(null):{},this.size=0}},349190:(e,t,o)=>{"use strict";o.d(t,{default:()=>i});const i=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},178417:(e,t,o)=>{"use strict";o.d(t,{default:()=>a});var i=o(220674),s=Object.prototype.hasOwnProperty;const a=function(e){var t=this.__data__;if(i.default){var o=t[e];return"__lodash_hash_undefined__"===o?void 0:o}return s.call(t,e)?t[e]:void 0}},18813:(e,t,o)=>{"use strict";o.d(t,{default:()=>a});var i=o(220674),s=Object.prototype.hasOwnProperty;const a=function(e){var t=this.__data__;return i.default?void 0!==t[e]:s.call(t,e)}},463957:(e,t,o)=>{"use strict";o.d(t,{default:()=>s});var i=o(220674);const s=function(e,t){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=i.default&&void 0===t?"__lodash_hash_undefined__":t,this}},925353:(e,t,o)=>{"use strict";o.d(t,{default:()=>s});var i=/^(?:0|[1-9]\d*)$/;const s=function(e,t){var o=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==o||"symbol"!=o&&i.test(e))&&e>-1&&e%1==0&&e<t}},386586:(e,t,o)=>{"use strict";o.d(t,{default:()=>r});var i=o(292049),s=o(761882),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;const r=function(e,t){if((0,i.default)(e))return!1;var o=typeof e;return!("number"!=o&&"symbol"!=o&&"boolean"!=o&&null!=e&&!(0,s.default)(e))||(n.test(e)||!a.test(e)||null!=t&&e in Object(t))}},649914:(e,t,o)=>{"use strict";o.d(t,{default:()=>i});const i=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},870640:(e,t,o)=>{"use strict";o.d(t,{default:()=>n});var i,s=o(113161),a=(i=/[^.]+$/.exec(s.default&&s.default.keys&&s.default.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"";const n=function(e){return!!a&&a in e}},897271:(e,t,o)=>{"use strict";o.d(t,{default:()=>s});var i=Object.prototype;const s=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||i)}},909396:(e,t,o)=>{"use strict";o.d(t,{default:()=>s});var i=o(523149);const s=function(e){return e==e&&!(0,i.default)(e)}},36838:(e,t,o)=>{"use strict";o.d(t,{default:()=>i});const i=function(){this.__data__=[],this.size=0}},362384:(e,t,o)=>{"use strict";o.d(t,{default:()=>a});var i=o(210169),s=Array.prototype.splice;const a=function(e){var t=this.__data__,o=(0,i.default)(t,e);return!(o<0)&&(o==t.length-1?t.pop():s.call(t,o,1),--this.size,!0)}},104787:(e,t,o)=>{"use strict";o.d(t,{default:()=>s});var i=o(210169);const s=function(e){var t=this.__data__,o=(0,i.default)(t,e);return o<0?void 0:t[o][1]}},898207:(e,t,o)=>{"use strict";o.d(t,{default:()=>s});var i=o(210169);const s=function(e){return(0,i.default)(this.__data__,e)>-1}},451031:(e,t,o)=>{"use strict";o.d(t,{default:()=>s});var i=o(210169);const s=function(e,t){var o=this.__data__,s=(0,i.default)(o,e);return s<0?(++this.size,o.push([e,t])):o[s][1]=t,this}},95088:(e,t,o)=>{"use strict";o.d(t,{default:()=>n});var i=o(965373),s=o(277919),a=o(168335);const n=function(){this.size=0,this.__data__={hash:new i.default,map:new(a.default||s.default),string:new i.default}}},829846:(e,t,o)=>{"use strict";o.d(t,{default:()=>s});var i=o(515547);const s=function(e){var t=(0,i.default)(this,e).delete(e);return this.size-=t?1:0,t}},831521:(e,t,o)=>{"use strict";o.d(t,{default:()=>s});var i=o(515547);const s=function(e){return(0,i.default)(this,e).get(e)}},782509:(e,t,o)=>{"use strict";o.d(t,{default:()=>s});var i=o(515547);const s=function(e){return(0,i.default)(this,e).has(e)}},549:(e,t,o)=>{"use strict";o.d(t,{default:()=>s});var i=o(515547);const s=function(e,t){var o=(0,i.default)(this,e),s=o.size;return o.set(e,t),this.size+=o.size==s?0:1,this}},164877:(e,t,o)=>{"use strict";o.d(t,{default:()=>i});const i=function(e){var t=-1,o=Array(e.size);return e.forEach((function(e,i){o[++t]=[i,e]})),o}},945997:(e,t,o)=>{"use strict";o.d(t,{default:()=>i});const i=function(e,t){return function(o){return null!=o&&(o[e]===t&&(void 0!==t||e in Object(o)))}}},760608:(e,t,o)=>{"use strict";o.d(t,{default:()=>s});var i=o(446632);const s=function(e){var t=(0,i.default)(e,(function(e){return 500===o.size&&o.clear(),e})),o=t.cache;return t}},220674:(e,t,o)=>{"use strict";o.d(t,{default:()=>i});const i=(0,o(280702).default)(Object,"create")},733938:(e,t,o)=>{"use strict";o.d(t,{default:()=>i});const i=(0,o(40367).default)(Object.keys,Object)},981493:(e,t,o)=>{"use strict";o.d(t,{default:()=>i});const i=function(e){var t=[];if(null!=e)for(var o in Object(e))t.push(o);return t}},40367:(e,t,o)=>{"use strict";o.d(t,{default:()=>i});const i=function(e,t){return function(o){return e(t(o))}}},25668:(e,t,o)=>{"use strict";o.d(t,{default:()=>i});const i=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},529875:(e,t,o)=>{"use strict";o.d(t,{default:()=>i});const i=function(e){return this.__data__.has(e)}},729959:(e,t,o)=>{"use strict";o.d(t,{default:()=>i});const i=function(e){var t=-1,o=Array(e.size);return e.forEach((function(e){o[++t]=e})),o}},591532:(e,t,o)=>{"use strict";o.d(t,{default:()=>s});var i=o(277919);const s=function(){this.__data__=new i.default,this.size=0}},42:(e,t,o)=>{"use strict";o.d(t,{default:()=>i});const i=function(e){var t=this.__data__,o=t.delete(e);return this.size=t.size,o}},173061:(e,t,o)=>{"use strict";o.d(t,{default:()=>i});const i=function(e){return this.__data__.get(e)}},144105:(e,t,o)=>{"use strict";o.d(t,{default:()=>i});const i=function(e){return this.__data__.has(e)}},487681:(e,t,o)=>{"use strict";o.d(t,{default:()=>n});var i=o(277919),s=o(168335),a=o(935917);const n=function(e,t){var o=this.__data__;if(o instanceof i.default){var n=o.__data__;if(!s.default||n.length<199)return n.push([e,t]),this.size=++o.size,this;o=this.__data__=new a.default(n)}return o.set(e,t),this.size=o.size,this}},865722:(e,t,o)=>{"use strict";o.d(t,{default:()=>n});var i=o(760608),s=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,a=/\\(\\)?/g;const n=(0,i.default)((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(s,(function(e,o,i,s){t.push(i?s.replace(a,"$1"):o||e)})),t}))},930901:(e,t,o)=>{"use strict";o.d(t,{default:()=>s});var i=o(761882);const s=function(e){if("string"==typeof e||(0,i.default)(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},281121:(e,t,o)=>{"use strict";o.d(t,{default:()=>s});var i=Function.prototype.toString;const s=function(e){if(null!=e){try{return i.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},166984:(e,t,o)=>{"use strict";o.d(t,{default:()=>i});const i=function(e,t){return e===t||e!=e&&t!=t}},877500:(e,t,o)=>{"use strict";o.d(t,{default:()=>s});var i=o(966318);const s=function(e,t,o){var s=null==e?void 0:(0,i.default)(e,t);return void 0===s?o:s}},217511:(e,t,o)=>{"use strict";o.d(t,{default:()=>a});var i=o(509789),s=o(285054);const a=function(e,t){return null!=e&&(0,s.default)(e,t,i.default)}},929008:(e,t,o)=>{"use strict";o.d(t,{default:()=>i});const i=function(e){return e}},241788:(e,t,o)=>{"use strict";o.d(t,{default:()=>_});var i=o(974846),s=o(753098),a=Object.prototype,n=a.hasOwnProperty,r=a.propertyIsEnumerable;const _=(0,i.default)(function(){return arguments}())?i.default:function(e){return(0,s.default)(e)&&n.call(e,"callee")&&!r.call(e,"callee")}},238446:(e,t,o)=>{"use strict";o.d(t,{default:()=>a});var i=o(389610),s=o(5254);const a=function(e){return null!=e&&(0,s.default)(e.length)&&!(0,i.default)(e)}},74616:(e,t,o)=>{"use strict";o.d(t,{default:()=>_});var i=o(41917),s=o(624639),a="object"==typeof exports&&exports&&!exports.nodeType&&exports,n=a&&"object"==typeof module&&module&&!module.nodeType&&module,r=n&&n.exports===a?i.default.Buffer:void 0;const _=(r?r.isBuffer:void 0)||s.default},389610:(e,t,o)=>{"use strict";o.d(t,{default:()=>a});var i=o(979672),s=o(523149);const a=function(e){if(!(0,s.default)(e))return!1;var t=(0,i.default)(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},5254:(e,t,o)=>{"use strict";o.d(t,{default:()=>i});const i=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},118719:(e,t,o)=>{"use strict";o.d(t,{default:()=>r});var i=o(289717),s=o(552789),a=o(364841),n=a.default&&a.default.isTypedArray;const r=n?(0,s.default)(n):i.default},269592:(e,t,o)=>{"use strict";o.d(t,{default:()=>i});const i=function(e){return void 0===e}},327422:(e,t,o)=>{"use strict";o.d(t,{default:()=>n});var i=o(550423),s=o(17064),a=o(238446);const n=function(e){return(0,a.default)(e)?(0,i.default)(e):(0,s.default)(e)}},241865:(e,t,o)=>{"use strict";o.d(t,{default:()=>n});var i=o(550423),s=o(708823),a=o(238446);const n=function(e){return(0,a.default)(e)?(0,i.default)(e,!0):(0,s.default)(e)}},446632:(e,t,o)=>{"use strict";o.d(t,{default:()=>a});var i=o(935917);function s(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var o=function(){var i=arguments,s=t?t.apply(this,i):i[0],a=o.cache;if(a.has(s))return a.get(s);var n=e.apply(this,i);return o.cache=a.set(s,n)||a,n};return o.cache=new(s.Cache||i.default),o}s.Cache=i.default;const a=s},478672:(e,t,o)=>{"use strict";o.d(t,{default:()=>i});const i=function(e){if("function"!=typeof e)throw new TypeError("Expected a function");return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}},596034:(e,t,o)=>{"use strict";o.d(t,{default:()=>n});var i=o(952141),s=o(478672),a=o(141470);const n=function(e,t){return(0,a.default)(e,(0,s.default)((0,i.default)(t)))}},141470:(e,t,o)=>{"use strict";o.d(t,{default:()=>r});var i=o(45572),s=o(952141),a=o(769084),n=o(883973);const r=function(e,t){if(null==e)return{};var o=(0,i.default)((0,n.default)(e),(function(e){return[e]}));return t=(0,s.default)(t),(0,a.default)(e,o,(function(e,o){return t(e,o[0])}))}},792263:(e,t,o)=>{"use strict";o.d(t,{default:()=>r});var i=o(770805),s=o(82199),a=o(386586),n=o(930901);const r=function(e){return(0,a.default)(e)?(0,i.default)((0,n.default)(e)):(0,s.default)(e)}},613153:(e,t,o)=>{"use strict";o.d(t,{default:()=>i});const i=function(){return[]}},624639:(e,t,o)=>{"use strict";o.d(t,{default:()=>i});const i=function(){return!1}}}]);try{stManager.done("dist/web/chunks/common.d19457e9.js")}catch(e){}