(()=>{"use strict";var e,t={899542:(e,t,r)=>{r.d(t,{EMPTY_SCREEN:()=>i});const i="other"},401281:(e,t,r)=>{r.d(t,{FAVE_PRODUCTS_SCREEN:()=>s,FAVE_SCREEN:()=>i});const i="fave",s="fave_products"},224932:(e,t,r)=>{r.d(t,{initMarketAnalytics:()=>b,trackMarketArea:()=>S,trackMarketEvent:()=>p});var i=r(827773),s=r(681029),a=r(401281),o=r(899542),n=r(338148),c=r(843335),_=r(193270),d=r(70933),m=r(806838),l=r(85867),u=r(375962),E=r(782225);const h=[];let I=!1;function T(e,t=0){const r=v(t);return!!r&&e.includes(r.event)}function v(e=0){return h.length>e?h[h.length-(1+e)]:null}function O(e){I||(window.addEventListener("beforeunload",(()=>{(0,l.observersStop)(),(0,u.flushMarketEvents)(e)})),I=!0)}function p(e){if(!function(e){const t=v();if(t){if(e===m.ECommGoodsEvent.CLOSE_ITEM&&t.event===m.ECommGoodsEvent.CLOSE_ITEM)return!1;if(e===m.ECommGoodsEvent.TRANSITION_TO_ITEM){if(T([m.ECommGoodsEvent.TRANSITION_TO_ITEM_LEFT,m.ECommGoodsEvent.TRANSITION_TO_ITEM_RIGHT]))return!1;if(T([m.ECommGoodsEvent.SWITCH_ITEM_VARIANT_1,m.ECommGoodsEvent.SWITCH_ITEM_VARIANT_2]))return!1}}return!0}(e.event))return;if(!e.event&&!e.table)return void(0,s.marketDebug)("error","event and table not specified",e);e.table||(Object.values(m.ECommGoodsEvent).includes(e.event)?e.table=m.AnalyticsEventTable.GOODS:Object.values(m.ECommOrdersEvent).includes(e.event)?e.table=m.AnalyticsEventTable.ORDERS:(0,s.marketDebug)("error","table not specified")),e.screen=e.screen?e.screen:window.MarketAnalyticsManager&&window.MarketAnalyticsManager.getScreen(),e.platform=e.platform?e.platform:"web",e.itemType=e.itemType?e.itemType:"",O(e.platform);const t=String(e.event),r=`${e.table}:${t}`;e.instant?(0,u.logMarketEventNow)(e.platform,r,e.ownerId,e.itemId,e.screen,e.albumId,e.time,e.duration,e.itemType):(0,u.logMarketEvent)(e.platform,r,e.ownerId,e.itemId,e.screen,e.albumId,e.time,e.duration,e.itemType),h.push(e),h.length>3&&h.shift()}function S(e,t=""){O(t),(0,u.flushMarketEvents)(t),(0,l.observersStop)(),(0,s.marketDebug)("warn","analytics: start tracking area",e);const r=({observerId:e,container:r,types:s,refSource:a,screen:d,customItemReachedCallback:l})=>{const u=E.MarketAnalyticsObserver.create({observerId:e,itemSelector:{types:s??"market_item"},isUnifyNodes:!0,isDynamicContent:!0,platform:t,container:r,getExtraItemParams:()=>({ref_source:a})});return u.itemReachedCallback=l??(e=>{t!==i.PLATFORM_MVK?n.viewAnalytics.logMarketItemView({view:{start_view:e.viewStart.toString(),end_view:e.viewEnd.toString()},screen:d||(0,c.getStatScreen)(),previous_screen:(0,_.getScreenPrev)()||o.EMPTY_SCREEN,ref_source:e.ref_source,params:{item_id:Number(e.itemId),owner_id:e.ownerId,search_query_id:e.searchQueryId,item_idx:Number(e.node.getAttribute("data-stat-id"))||0}}):p({event:"market_item"===e.type?m.ECommGoodsEvent.VIEW_ITEM:m.ECommGoodsEvent.VIEW_ALBUM,ownerId:e.ownerId,itemId:"market_item"===e.type?e.itemId:0,duration:e.duration,time:e.viewStart,albumId:"market_item"===e.type?0:e.itemId,platform:e.platform})}),u.watch(),u};switch(e){case m.AnalyticsArea.MARKET:const e=e=>{let r=0;if(void 0!==window.cur.aid&&(r=window.cur.aid),t!==i.PLATFORM_MVK){if("market_item"===e.type)n.viewAnalytics.logMarketItemView({view:{start_view:e.viewStart.toString(),end_view:e.viewEnd.toString()},screen:(0,c.getStatScreen)(),ref_source:e.ref_source,params:{item_id:Number(e.itemId),owner_id:e.ownerId,search_query_id:e.searchQueryId,item_idx:Number(e.node.getAttribute("data-stat-id"))||0}})}else p({event:"market_item"===e.type?m.ECommGoodsEvent.VIEW_ITEM:m.ECommGoodsEvent.VIEW_ALBUM,ownerId:e.ownerId,itemId:"market_item"===e.type?e.itemId:0,albumId:"market_item"===e.type?r:e.itemId,duration:e.duration,time:e.viewStart,platform:e.platform})},s=new URLSearchParams(window.location.search).has("section")?d.RefSource.COMMUNITY_GROUP_GOODS:d.RefSource.COMMUNITY_GOODS;r({observerId:"market_products",refSource:s,customItemReachedCallback:e});const o=r({observerId:"market_albums",types:"market_album",refSource:s,customItemReachedCallback:e});t!==i.PLATFORM_MVK&&(o.preCheckReachedCallback=e=>{const t=e.offsetTop,r=e.parentNode?.parentNode;return r&&t<r.offsetHeight});break;case m.AnalyticsArea.GROUP:r({observerId:"market_module",refSource:d.RefSource.COMMUNITY_SHOWCASE}),r({observerId:"group_wall",types:"market_item,market_album",refSource:d.RefSource.POST});break;case m.AnalyticsArea.USER_PROFILE:r({observerId:"user_wall",types:"market_item,market_album",refSource:d.RefSource.POST});break;case m.AnalyticsArea.BOOKMARKS:const _="product"===window.nav.objLoc.type;r({observerId:"bookmarks",refSource:d.RefSource.BOOKMARKS,screen:_?a.FAVE_PRODUCTS_SCREEN:a.FAVE_SCREEN});break;case m.AnalyticsArea.FEED:r({observerId:"feed",container:".feed_wrap",refSource:d.RefSource.POST});break;case m.AnalyticsArea.GLUBS:r({observerId:"glubs",container:".glubs-container",refSource:d.RefSource.GLUBS})}}function b(e,t,r,i){if(window.MarketAnalyticsManager)try{window.MarketAnalyticsManager.setScreen(e),window.MarketAnalyticsManager.setHash(r),window.MarketAnalyticsManager.setEnabled(i),window.MarketAnalytics.trackArea(t)}catch(e){console.error("cannot init market analytics",e)}else console.error("MarketAnalyticsManager is undefined")}},782225:(e,t,r)=>{r.d(t,{MarketAnalyticsObserver:()=>c});var i=r(681029),s=r(733070),a=r(454368),o=r(226095),n=r(827773);class c extends a.NodeViewObserver{isReached(e){if(!(0,i.isElementVisible)(e))return!1;let t,r=this.gap;const s=e.closest("[data-stat-viewport]");if(s){const e=s.getBoundingClientRect();r={top:e.top,left:e.left},t={width:e.left+e.width,height:e.top+e.height}}return(0,i.isElementInViewport)(e,45,r,t)}static create(e){return new c(e.observerId,e.itemSelector,e?.container,e?.isUnifyNodes,e?.isDynamicContent,e?.platform,e?.getExtraItemParams)}static getViewportGap(e=""){const t={left:0,top:0};let r="";r=e===n.PLATFORM_MVK?"#vk_head":"#page_header_wrap,#market_search_input";return document.querySelectorAll(r).forEach((e=>{const r=(0,o.getElementSize)(e);t.top=t.top+r.height})),t}constructor(e,t,r="",i=!1,a=!1,o="",n){super(e,t,r,i,o,n),this.observerId=e,this.itemSelector=t,this.container=r,this.isUnifyNodes=i,this.isDynamicNodes=a,this.gap=null,a&&this.addMutators([new s.NodeMutationObserver]),this.gap=c.getViewportGap(this.getPlatform())}}},806838:(e,t,r)=>{var i,s,a,o;r.d(t,{AnalyticsArea:()=>i,AnalyticsEventTable:()=>s,ECommGoodsEvent:()=>a,ECommOrdersEvent:()=>o}),function(e){e.MARKET="market",e.GROUP="group",e.USER_PROFILE="user_profile",e.BOOKMARKS="bookmarks",e.FEED="feed",e.GLUBS="glubs"}(i||(i={})),function(e){e.GOODS="ecomm_goods",e.ORDERS="ecomm_orders"}(s||(s={})),function(e){e.TRANSITION_TO_ITEM="transition_to_item",e.TRANSITION_TO_ALBUM="transition_to_album",e.SWITCH_ITEM_VARIANT_1="switch_item_variant_1",e.SWITCH_ITEM_VARIANT_2="switch_item_variant_2",e.TRANSITION_TO_ITEM_LEFT="transition_to_item_left",e.TRANSITION_TO_ITEM_RIGHT="transition_to_item_right",e.VIEW_ITEM="view_item",e.VIEW_ALBUM="view_album",e.CLOSE_ITEM="close_item",e.TRANSITION_TO_OWNER="transition_to_owner",e.VIEW_ITEM_MEDIA="view_item_media",e.ADD_ITEM_TO_CART="add_item_to_cart",e.EXPAND_ITEM_DESCRIPTION="expand_item_description",e.ADD_ITEM_TO_BOOKMARKS="add_item_to_bookmarks",e.REMOVE_ITEM_FROM_BOOKMARKS="remove_item_from_bookmarks",e.EXPAND_COMMENTS="expand_comments",e.COMMENT="comment",e.OPEN_WIKI="open_wiki",e.SEND_MESSAGE_TO_OWNER="send_message_to_owner",e.SEND_MESSAGE_TO_OWNER_2="send_message_to_owner_2",e.OPEN_CHAT_WITH_OWNER="open_chat_with_owner",e.OPEN_CHAT_WITH_OWNER_2="open_chat_with_owner_2",e.LIKE_ITEM="like_item",e.UNLIKE_ITEM="unlike_item",e.SHARE_ITEM="share_item",e.CTA_LINK="cta_link",e.CTA_LINK_2="cta_link_2",e.CALL="call",e.CALL_2="call_2",e.CREATE_ITEM="create_item",e.CREATE_ALBUM="create_album",e.EDIT_ITEM="edit_item",e.EDIT_ALBUM="edit_album",e.DELETE_ITEM="delete_item",e.DELETE_ALBUM="delete_album",e.GROUP_ITEMS="group_items",e.ADD_PROPERTY="add_property",e.ADD_PROPERTY_VALUE="add_property_value",e.DELETE_PROPERTY="delete_property",e.DELETE_PROPERTY_VALUE="delete_property_value",e.TRANSITION_TO_EDIT_PROPERTIES="transition_to_edit_properties",e.TRANSITION_TO_EDIT_ALBUMS="transition_to_edit_albums",e.TRANSITION_TO_ADD_ALBUM="transition_to_add_album",e.TRANSITION_TO_ADD_ITEM="transition_to_add_item",e.TRANSITION_TO_EDIT_ITEM="transition_to_edit_item",e.TRANSITION_TO_DELETE_ALBUM="transition_to_delete_album",e.TRANSITION_TO_GROUP_ITEMS="transition_to_group_items",e.VIEW_FEEDBACK="view_feedback",e.OPEN_FEEDBACK_PHOTO="open_feedback_photo"}(a||(a={})),function(e){e.EVENT_MAKE_ORDER="make_order",e.CANCEL_ORDER="cancel_order",e.EXPAND_ORDER_INFO="expand_order_info",e.TRANSITION_TO_ORDERS="transition_to_orders",e.OPEN_MARKET_GROUP_ORDERS="open_market_group_orders",e.OPEN_MARKET_GROUP_ITEMS="open_market_group_items",e.OPEN_MARKET_GROUP_SETTINGS="open_market_group_settings",e.OPEN_MARKET_GROUP_DELIVERY="open_market_group_delivery",e.TRANSITION_TO_MARKET_SUPPORT="transition_to_market_support",e.OPEN_ORDER_INFO="open_order_info",e.ADD_TRACK_CODE="add_track_code",e.ADD_INTERNAL_COMMENT="add_internal_comment",e.CHANGE_ORDER_STATUS="change_order_status",e.OPEN_CHAT_WITH_CUSTOMER="open_chat_with_customer",e.SEND_MESSAGE_TO_CUSTOMER="send_message_to_customer",e.OPEN_ORDER_HISTORY="open_order_history",e.FILTER_ORDERS_BY_STATUS="filter_orders_by_status",e.EXPORT_ORDERS_DATA="export_orders_data"}(o||(o={}))},733070:(e,t,r)=>{r.d(t,{NodeMutationObserver:()=>i});class i{connectMutator(e){if(this.mutationObserver)throw new Error(`{Observer #${e.getObserverId()}} MutationObserver already connected to observer`);const t=document.querySelector(e.getContainerQuery());t instanceof HTMLElement&&(this.mutationObserver=new MutationObserver((t=>{t.forEach((t=>{if(t.addedNodes)for(let r=0;r<t.addedNodes.length;r++){const s=t.addedNodes[r];if(s instanceof HTMLElement){const t=i.resolveNodes(s,e).filter((e=>!!e));t&&(t.forEach((t=>{e.add(t)})),e.scan())}}}))})),this.mutationObserver.observe(t,{childList:!0,subtree:!0,attributes:!1,characterData:!1}))}disconnectMutator(e){e.isRunning()&&this.mutationObserver&&this.mutationObserver.disconnect()}static resolveNodes(e,t){let r=[];if(t.getSelectorQuery(!1).split(",").forEach((t=>{if(e.matches(t))return r.push(e),!1})),r.length<1){const i=e.querySelectorAll(t.getSelectorQuery(!1));r=Array.from(i)}return r}}},69833:(e,t,r)=>{r.d(t,{NodeObserver:()=>c});var i=r(248782),s=r(85867),a=r(843335);const o="data-stat-item",n="data-stat-id";class c{set debounceTimeout(e){this._debounceTimeout=e}set itemReachedCallback(e){this._itemReachedCallback=e}set preCheckReachedCallback(e){this._preCheckReachedCallback=e}getObserverId(){return this.observerId}getItemSelector(){return this.itemSelector}getPlatform(){return this.platform}add(e){this.nodes.push(e)}getTrackingItems(){return this.trackingItems}addMutators(e){this.mutatorList=this.mutatorList.concat(e)}isRunning(){return this.isWatching}watch(){this.isWatching||(this.update(),this.startObserving(),this.connectMutators(),this.isWatching=!0)}stop(){this.isWatching&&(this.trackUntracked(),this.stopObserving(),this.disconnectMutators(),this.isWatching=!1)}scan(){this.viewportScanner()}trackUntracked(){const e=this.getTrackingItems();for(let t in e)if(e[t]){const r=e[t];!r.isTracked&&r.isReached&&(this.track(r),this.persist(r))}}connectMutators(){this.mutatorList.forEach((e=>{e.connectMutator(this)}))}disconnectMutators(){this.mutatorList.forEach((e=>{e.disconnectMutator(this)}))}getContainerQuery(){const e=this.container.substr(0,1);if("#"===e||"."===e)return this.container;return`[data-stat-container="${this.container?this.container:this.observerId}"]`}getSelectorQuery(e=!0){const t=this.getContainerQuery();let r=[];return this.itemSelector.selectors?r=this.itemSelector.selectors.split(",").map((r=>e?`${t} ${r}`:r)):this.itemSelector.types&&(r=this.itemSelector.types.split(",").map((r=>e?`${t} [${o}^="${r}|"]`:`[${o}^="${r}|"]`))),r.join(",")}update(){const e=document.querySelectorAll(this.getSelectorQuery());this.nodes=Array.from(e)}static parseStatAttribute(e){const t=e.getAttribute(o),r=t?.split("|");return r?{type:r[0],ownerId:parseInt(r[1]),itemId:r[2]}:{type:"",ownerId:0,itemId:0}}getNodeKey(e,t){let r=String(t.itemId);if(this.isUnifyNodes){this.unifyNode(e);r=`${r}_${e.getAttribute(n)}`}return`${this.observerId}_${r}`}isItemReached(e){return!(void 0!==this._preCheckReachedCallback&&!this._preCheckReachedCallback(e))&&this.isReached(e)}filterItem(e){return!e.isTracked&&!e.isReached&&(this.isItemReached(e.node)?(this.track(e),this.persist(e),!1):(this.persist(e),!0))}track(e){e.isTracked||(e.viewEnd=Date.now(),e.duration=e.viewEnd-e.viewStart,this._itemReachedCallback(e),e.isReached=!1,e.isTracked=!0)}persist(e){this.trackingItems[e.key]=e}getTrackingItem(e){const t=c.parseStatAttribute(e);if(!t.type||!t.itemId)return null;const r=this.getNodeKey(e,t);return r?r in this.trackingItems?this.trackingItems[r]:this.createTrackingItem(e,t):null}createTrackingItem(e,t){const r=this.getNodeKey(e,t),i=this.getExtraItemParams&&this.getExtraItemParams()||{};return this.trackingItems[r]={...i,key:r,type:t.type,observerId:this.observerId,ownerId:t.ownerId,itemId:t.itemId,isTracked:!1,isReached:!1,viewStart:0,viewEnd:0,duration:0,node:e,viewTimer:0,data:{},platform:this.getPlatform(),city:(0,a.getStatCity)(),screen:i.screen||(0,a.getStatScreen)()},this.trackingItems[r]}getNextUnifyId(){return++this.uniqueNodeCounter}unifyNode(e){e.getAttribute(n)||e.setAttribute(n,String(this.getNextUnifyId()))}startObserving(){this.update(),this.viewportScanner=(0,i.debounce)((()=>{this.nodes=this.nodes.filter((e=>{const t=this.getTrackingItem(e);return!!t&&this.filterItem(t)}))}),this._debounceTimeout),this.scrollEventListener=()=>this.scan(),document.addEventListener("scroll",this.scrollEventListener,{passive:!0}),this.scan()}stopObserving(){document.removeEventListener("scroll",this.scrollEventListener),this.nodes=[],this.viewportScanner=()=>{},this.scrollEventListener=()=>{}}constructor(e,t,r="",i=!1,a="",o){if(this.observerId=e,this.itemSelector=t,this.container=r,this.isUnifyNodes=i,this.platform=a,this.getExtraItemParams=o,this.trackingItems={},this._debounceTimeout=20,this.uniqueNodeCounter=0,this.nodes=[],this.isWatching=!1,this.mutatorList=[],(0,s.observersRegister)(this),!this.itemSelector.types&&!this.itemSelector.selectors)throw new Error("Empty itemSelector definition");this.container||(this.container=this.observerId)}}},454368:(e,t,r)=>{r.d(t,{NodeViewObserver:()=>s});var i=r(69833);class s extends i.NodeObserver{filterItem(e){return!e.isTracked&&(e.isReached&&!this.isItemReached(e.node)?(this.track(e),this.persist(e),!1):(this.isItemReached(e.node)&&this.view(e),this.persist(e),!0))}view(e){e.isTracked||(e.isReached=!0,e.viewStart||(e.viewStart=Date.now()),e.viewTimer&&(clearTimeout(e.viewTimer),e.viewTimer=0),e.viewTimer=window.setTimeout((()=>{const t=e.node;!this.isItemReached(t)||function(e){const t=e.viewStart;return Date.now()-t>3e4}(e)?this.track(e):this.view(e)}),3e3))}track(e){e.viewTimer&&(clearTimeout(e.viewTimer),e.viewTimer=0),super.track(e)}}},85867:(e,t,r)=>{r.d(t,{observersRegister:()=>s,observersRescan:()=>o,observersStop:()=>a});const i={};function s(e){e.getObserverId()in i&&(i[e.getObserverId()].stop(),delete i[e.getObserverId()]),i[e.getObserverId()]=e}function a(){for(let e in i)if(i[e]){i[e].stop()}}function o(){for(let e in i)if(i[e]){i[e].scan()}}},614008:(e,t,r)=>{var i=r(490712),s=r(224932),a=r(375962),o=r(806838),n=r(338148),c=r(843335);window.vk?.pe?.static_manager_dynamic_imports&&window.vk?.stDomain&&(r.p=window.vk.stDomain+"/dist/");const _={trackArea:s.trackMarketArea,onMarketAlbumEdit:(e,t,r)=>{(0,s.trackMarketEvent)({table:o.AnalyticsEventTable.GOODS,event:r?o.ECommGoodsEvent.CREATE_ALBUM:o.ECommGoodsEvent.EDIT_ALBUM,ownerId:e,albumId:t,instant:!0})},setStorageData:a.setStorageData,logViewItemEvent:e=>{n.viewAnalytics.logMarketItemView({view:{start_view:"0",end_view:"0"},screen:(0,c.getStatScreen)(),ref_source:e.refSource,params:{item_id:e.itemId,owner_id:e.ownerId,item_idx:0,search_query_id:0}})},onMarketItemCardOpen:a.onMarketItemCardOpen};window.MarketAnalytics=_;try{window.stManager.done(window.jsc("web/market_analytics.js"))}catch(e){}requestIdleCallback((()=>{try{(0,i.statlogsValueEvent)("entries_requests",1,"market_analytics","web")}catch{}}),{timeout:5e3})}},r={};function i(e){var s=r[e];if(void 0!==s)return s.exports;var a=r[e]={exports:{}};return t[e].call(a.exports,a,a.exports,i),a.exports}i.m=t,e=[],i.O=(t,r,s,a)=>{if(!r){var o=1/0;for(d=0;d<e.length;d++){for(var[r,s,a]=e[d],n=!0,c=0;c<r.length;c++)(!1&a||o>=a)&&Object.keys(i.O).every((e=>i.O[e](r[c])))?r.splice(c--,1):(n=!1,a<o&&(o=a));if(n){e.splice(d--,1);var _=s();void 0!==_&&(t=_)}}return t}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[r,s,a]},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.e=()=>Promise.resolve(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.p="/dist/",(()=>{var e={11999:0};i.O.j=t=>0===e[t];var t=(t,r)=>{var s,a,[o,n,c]=r,_=0;if(o.some((t=>0!==e[t]))){for(s in n)i.o(n,s)&&(i.m[s]=n[s]);if(c)var d=c(i)}for(t&&t(r);_<o.length;_++)a=o[_],i.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return i.O(d)},r=self.webpackChunkvkweb=self.webpackChunkvkweb||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var s=i.O(void 0,[35623],(()=>i(614008)));s=i.O(s)})();