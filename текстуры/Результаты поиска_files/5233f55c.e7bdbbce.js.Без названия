"use strict";(self.webpackChunkvkweb=self.webpackChunkvkweb||[]).push([[8307],{685962:(e,t,n)=>{n.d(t,{Auth:()=>s});var o=n(411423),r=n(772902),a=n(537071),i=n(919507);class s{static login(e){return e.redirectUrl&&r.Config.init({...r.Config.get(),redirectUrl:e.redirectUrl}),e?.entry&&(e.entry=(0,a.makeInitStatsInfo)(e.entry)),o.Auth.login(e),r.Config.get().mode===i.ConfigAuthMode.InNewTab?new Promise((e=>{const t=setInterval((()=>{const n=o.Auth.dataService;void 0!==n&&(clearInterval(t),e(n))}),100)})):Promise.resolve()}}},537071:(e,t,n)=>{function o(e){return e?btoa(JSON.stringify(e)):""}n.d(t,{makeInitStatsInfo:()=>o})},507423:(e,t,n)=>{n.d(t,{isActionValid:()=>r});const o=["extend_token","login_with_user","login_silent_user","__sferum_invite_link","registration_with_phone","registration_with_email","validate_phone","bind_ok_account","no_password_flow","confirm_service_action","login_with_eljour","login_with_edu_profile","login_with_multi_user","auth_validation_phone","qr_auth","multi_account_flow"];function r(e){return e&&o.includes(e.name)}},761960:(e,t,n)=>{n.d(t,{AuthQR:()=>m});var o=n(537071),r=n(788836),a=n(389466),i=n(594960),s=n(219372),c=n(867122),l=n(774096),d=n(858952),h=n(772902),u=n(501831);class m extends i.BaseModule{constructor(e){super();const t=a.authQRInitConfigValidator.validate(e);!t.isValid()&&console.error(t.error()),e?.langId&&!u.allowedLanguages.includes(e?.langId)&&console.error(c.CommonErrorReasons.wrongParam("lang_id","This lang id is not allowed")),this.updateConfig(e)}getIframeUrl(){return this.getIframeUrlParams().then((e=>{const{connectDomain:t}=h.Config.get();return Promise.resolve(`https://${t}/qr_auth?${e}`)}))}getIframeUrlParams(){return h.Config.fetchDomain().then((()=>{const{appId:e,_debug:t,_localhost:n}=h.Config.get();return Promise.resolve((0,d.makeParams)({scheme:this.params?.scheme||null,app_id:e,origin:location.protocol+"//"+location.host,lang_id:this.config.langId||null,initial_stats_info:(0,o.makeInitStatsInfo)(this.config.entry)||null,debug:t?1:null,localhost:n?1:null}))}))}handleBridgeMessage(e){switch(super.handleBridgeMessage(e),e.handler){case r.AuthQREvents.CLICKED:this.events.emit(r.AuthQREvents.CLICKED);break;case r.AuthQREvents.SCANNED:this.events.emit(r.AuthQREvents.SCANNED,e.params.token);break;case l.CommonSDKEvents.GET_CAPTCHA:const t=e.params.uuid,n=new s.Captcha(t,{captcha_sid:e.params.captcha_sid,captcha_img:e.params.captcha_img,is_refresh_enabled:e.params.is_refresh_enabled,is_sound_captcha_available:e.params.is_sound_captcha_available});n.show().then((e=>{this.bridge.sendMessage({handler:`${l.CommonSDKEvents.GET_CAPTCHA}Success`,params:{uuid:t,...e}})})).catch((()=>{this.bridge.sendMessage({handler:`${l.CommonSDKEvents.GET_CAPTCHA}Fail`,params:{uuid:t}}),n.destroy()}));break;default:return}}getIframeContainer=()=>this.config.container?this.config.container:window.document.body}},788836:(e,t,n)=>{var o;n.d(t,{AuthQREvents:()=>o}),function(e){e.SCANNED="VKSDKQRScaned",e.CLICKED="VKSDKQRClicked"}(o||(o={}))},389466:(e,t,n)=>{n.d(t,{authQRInitConfigValidator:()=>a});var o=n(867122),r=n(481060);const a=new(n(782272).Validator)({container:[{rule:r.isRequiredHandler,errorText:o.CommonErrorReasons.validationIsRequired("container")}]})},594960:(e,t,n)=>{n.d(t,{BaseModule:()=>g});var o=n(28995),r=n(995812),a=n(867122),i=n(774096),s=n(457615),c=n(858952),l=n(772902),d=n(311933),h=n(211176),u=n(148607),m=n(523146);class g{config={};params={};bridge;iframe;loadingTask=new s.default;initTask=new s.default;timeoutTimer;cssText="";events;constructor(){this.events=(0,o.default)(),this.handleBridgeMessage=this.handleBridgeMessage.bind(this),this.handleChangeSuperAppToken=this.handleChangeSuperAppToken.bind(this),this.close=this.close.bind(this),this.handleLogout=this.handleLogout.bind(this)}preload(e){return l.Config.fetchDomain().then((()=>this.validateParams(e).then((()=>(this.updateParams(e),this.createIframe().then((()=>(this.initTask.start(),this.loadingTask.start(),this.timeoutTimer=setTimeout((()=>{if(this.initTask.finished)return;const e=(0,h.makeLegacyError)((0,h.makeError)(a.ERROR_CODES[a.ERROR_CODES.LOADING_ERROR],a.ERROR_CODES.LOADING_ERROR,a.CommonErrorReasons.loadingTimeout()));this.initTask.reject(e)}),5e3),this.iframe.onload=()=>{this.iframe.onload=null,this.loadingTask.resolve()},this.bridge=new r.default({iframe:this.iframe,origin:"https://"+l.Config.get().connectDomain}),this.bridge.onMessage(this.handleBridgeMessage),l.Config.events.on(d.ConfigInternalEvents.SUPERAPP_TOKEN_CHANGE_V2,this.handleChangeSuperAppToken),l.Config.events.on(i.CommonSDKEvents.LOGOUT,this.close),this.getIframeContainer().appendChild(this.iframe),this.loadingTask.get()))))))))}open(e){return this.validateParams(e).then((()=>this.initTask.finished?(this.updateParams(e),Promise.resolve()):this.initTask.active||this.initTask.finished?(this.updateParams(e),this.initTask.get()):this.preload(e).then((()=>this.initTask.get()))))}update(e,t){e&&this.updateParams(e),t&&this.updateConfig(t)}close(){this.iframe&&(this.iframe.onload=null,this.iframe.remove()),this.bridge&&this.bridge.destroy(),l.Config.events.off(d.ConfigInternalEvents.SUPERAPP_TOKEN_CHANGE_V2,this.handleChangeSuperAppToken),l.Config.events.off(i.CommonSDKEvents.LOGOUT,this.close),delete this.iframe,delete this.bridge,this.loadingTask=new s.default,this.initTask=new s.default,this.events.emit(i.CommonSDKEvents.CLOSE)}sendMessage(e){const t=u.messageRequirementValidator.validate({message:e});!t.isValid()&&console.error(t.error()),this.bridge.sendMessage(e)}on(e,t){const n=u.onOffValidator.validate({event:e,handler:t});!n.isValid()&&console.error(n.error()),this.events.on(e,t)}off(e,t){const n=u.onOffValidator.validate({event:e,handler:t});!n.isValid()&&console.error(n.error()),this.events.off(e,t)}handleInit(){this.initTask.finished||(clearTimeout(this.timeoutTimer),this.initTask.resolve()),this.sendUpdateParamsMessage(),this.iframe.style.display="block"}handleRequestAuth(){l.Config._auth({version:2})}handleRequestSuperAppToken(e){l.Config._requestSuperAppToken(e,{version:2})}handleChangeSuperAppToken(e){this.bridge.sendMessage({handler:`${i.CommonSDKEvents.REQUEST_SUPERAPP_TOKEN}Success`,params:{result:e}})}handleError=e=>{const t=(0,h.makeLegacyError)((0,h.makeError)(a.ERROR_CODES[a.ERROR_CODES.CUSTOM],a.ERROR_CODES.CUSTOM,"",e));this.events.emit(i.CommonSDKEvents.ERROR,t)};handleBridgeMessage(e){switch(e.handler){case i.CommonInternalSDKEvents.INIT:this.handleInit();break;case i.CommonSDKEvents.REQUEST_SUPERAPP_TOKEN:this.handleRequestSuperAppToken(e.params);break;case i.CommonSDKEvents.AUTH_NEEDED:this.handleRequestAuth();break;case i.CommonSDKEvents.CLOSE:this.close();break;case i.CommonSDKEvents.ERROR:this.handleError(e.params);break;default:return}}handleLogout(){l.Config._logout()}handleAfterUpdateParams(){this.sendUpdateParamsMessage()}handleAfterUpdateConfig(){}handleAfterCreateIframe(){}validateParams(e){const t=m.paramsValidator.validate({params:e});return!t.isValid()&&console.error(t.error()),Promise.resolve(e)}createIframe(){return this.getIframeUrl().then((e=>(this.iframe=(0,c.makeFrame)(e,{cssText:this.cssText}),this.handleAfterCreateIframe(),Promise.resolve())))}getIframeUrl(){return new Promise((e=>e("")))}getIframeContainer(){return window.document.body}getIframeUrlParams(){return l.Config.fetchDomain().then((()=>{const{superAppTokenV2:e,appId:t,_debug:n,_localhost:o}=l.Config.get();return Promise.resolve((0,c.makeParams)({...this.params,host_app_id:t,superapp_token:e,origin:location.protocol+"//"+location.host,debug:n?1:null,localhost:o?1:null}))}))}updateConfig(e){this.config=(0,c.mergeDeep)(this.config,e),this.handleAfterUpdateConfig()}updateParams(e){this.params=(0,c.mergeDeep)(this.params,e||{}),this.handleAfterUpdateParams()}sendUpdateParamsMessage(){this.bridge&&this.initTask.finished&&this.bridge.sendMessage({params:this.params,handler:i.CommonSDKEvents.UPDATE_PARAMS})}}},523146:(e,t,n)=>{n.d(t,{paramsValidator:()=>a});var o=n(867122),r=n(481060);const a=new(n(782272).Validator)({params:[{rule:r.isRequiredHandler,errorText:o.CommonErrorReasons.validationIsRequired("params")}]})},219372:(e,t,n)=>{n.d(t,{Captcha:()=>m});var o=n(28995),r=n(995812),a=n(867122),i=n(774096),s=n(457615),c=n(858952),l=n(772902),d=n(501831),h=n(211176),u=n(300769);class m{events=(0,o.default)();showReadyPromiseTask=new s.default;uuid;captchaData;scheme;iframe;bridge;constructor(e,t,n){this.uuid=e,this.captchaData=t,this.scheme=n,this.createFrame().init()}init=()=>{l.Config.fetchDomain().then((()=>{(0,d.makeAuthUrl)({origin:location.protocol+"//"+location.host,uuid:this.uuid,...this.captchaData,scheme:this.scheme||null,is_refresh_enabled:Number(this.captchaData.is_refresh_enabled),is_sound_captcha_available:Number(this.captchaData.is_sound_captcha_available)},"auth_captcha").then(this.handleCaptcha)}))};createFrame=()=>(this.iframe=(0,c.makeFrame)("",{cssText:"\n      display: none;\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100vh;\n      min-height: 100vh;\n      border: none;\n      z-index: 99999;\n      color-scheme: none;\n     "}),this);handleError=e=>{const t=(0,h.makeLegacyError)((0,h.makeError)(a.ERROR_CODES[a.ERROR_CODES.CUSTOM],a.ERROR_CODES.CUSTOM,"",e));this.events.emit(i.CommonSDKEvents.ERROR,t)};onMessage=e=>{switch(e.handler){case i.CommonSDKEvents.ERROR:this.handleError(e.params);break;case u.AuthCaptchaEventsSDK.CAPTCHA_SUCCESS:this.showReadyPromiseTask.resolve(e.params),this.destroy();break;default:this.showReadyPromiseTask.reject(),this.destroy()}};handleCaptcha=e=>{this.iframe.src=e,document.body.appendChild(this.iframe),this.bridge=new r.default({iframe:this.iframe,origin:`https://${l.Config.get().connectDomain}`}),this.bridge.onMessage(this.onMessage)};destroy=()=>{this.iframe&&document.body.removeChild(this.iframe),this.bridge&&this.bridge.destroy()};show=()=>(this.iframe.style.display="block",new Promise((e=>{this.showReadyPromiseTask.start(),this.showReadyPromiseTask.get().then(e)})))}},300769:(e,t,n)=>{var o;n.d(t,{AuthCaptchaEventsSDK:()=>o}),function(e){e.CAPTCHA_SUCCESS="VKSDKAuthCaptchaSuccess",e.CAPTCHA_FAIL="VKSDKAuthCaptchaFail"}(o||(o={}))},995812:(e,t,n)=>{n.d(t,{default:()=>a});var o=n(889702);const r="vk-sak-sdk";class a{handler=()=>({});config;constructor(e){const t=o.bridgeConfigValidator.validate(e);!t.isValid()&&console.error(t.error()),this.config=e,window.addEventListener("message",this.handleMessage)}destroy=()=>{delete this.config,window.removeEventListener("message",this.handleMessage)};onMessage=e=>{const t=o.bridgeHandlerValidator.validate({handler:e});!t.isValid()&&console.error(t.error()),this.handler=e};sendMessage=e=>{const t=o.messageDataRequirementValidator.validate(e);!t.isValid()&&console.error(t.error()),this.config.iframe.contentWindow?.postMessage({type:r,...e},this.config.origin)};handleMessage=e=>{const t=o.messageEventValidator.validate({event:e});!t.isValid()&&console.error(t.error()),this.config.origin&&e.origin===this.config.origin&&e.source===this.config.iframe.contentWindow&&e.data&&e.data.type===r&&this.handler(e.data)}}},774096:(e,t,n)=>{var o,r;n.d(t,{CommonInternalSDKEvents:()=>r,CommonSDKEvents:()=>o}),function(e){e.OPEN="VKSDKOpen",e.CLOSE="VKSDKClose",e.LOGOUT="VKSDKLogout",e.GET_CAPTCHA="VKSDKGetCaptcha",e.CAPTCHA_SUCCESS="VKSDKGetCaptchaSuccess",e.CAPTCHA_FAILED="VKSDKGetCaptchaFail",e.AUTH_NEEDED="VKSDKAuthNeeded",e.UPDATE_PARAMS="VKSDKUpdateParams",e.REQUEST_SUPERAPP_TOKEN="VKSDKRequestSuperAppToken",e.ERROR="VKSDKError"}(o||(o={})),function(e){e.INIT="VKSDKInit"}(r||(r={}))},457615:(e,t,n)=>{n.d(t,{default:()=>o});class o{resolveHandler;rejectHandler;promise;finished;active;start(){this.active=!0,this.finished=!1,this.promise=new Promise(((e,t)=>{this.resolveHandler=e,this.rejectHandler=t}))}get(){return this.promise}resolve=e=>{if(Boolean(this.promise))return this.finished=!0,this.active=!1,this.resolveHandler(e)};reject=e=>{if(Boolean(this.promise))return this.finished=!0,this.active=!1,this.rejectHandler(e)}}},858952:(e,t,n)=>{n.d(t,{filterObjectKeys:()=>h,hasAllowedAppSettingsParams:()=>s,makeAppSettingsString:()=>c,makeFrame:()=>l,makeParams:()=>a,mergeDeep:()=>d});var o=n(992742),r=(n(780754),n(463009),n(641651),n(581204));function a(e){return o.querystring.stringify(e,{skipNull:!0})}function i(e){return Object.keys(e).filter((e=>r.ALLOWED_APP_SETTINGS_KEYS.includes(e)))}function s(e){return Boolean(i(e)?.length)}function c(e){const t=function(e){return i(e).reduce(((t,n)=>(t[n]=e[n],t)),{})}(e);return btoa(JSON.stringify(t))}function l(e,t){const n=document.createElement("iframe");e&&(n.src=e),n.style.cssText=t?.cssText??"",n.width="100%",n.height="100%",n.style.border="none",n.style.colorScheme="none";for(let e in t?.properties)t&&t.properties.hasOwnProperty(e)&&(n[e]=t.properties[e]??"");return n}function d(...e){const t=e=>e&&"object"==typeof e;return e.reduce(((e,n)=>(Object.keys(n).forEach((o=>{const r=e[o],a=n[o];Array.isArray(r)&&Array.isArray(a)?e[o]=r.concat(...a):t(r)&&t(a)?e[o]=d(r,a):e[o]=a})),e)),{})}function h(e,t){return e&&"object"==typeof e?Object.keys(e).reduce(((n,o)=>t.includes(o)?(n[o]=e[o],n):n),{}):e}},889702:(e,t,n)=>{n.d(t,{bridgeConfigValidator:()=>i,bridgeHandlerValidator:()=>c,messageDataRequirementValidator:()=>l,messageEventValidator:()=>s});var o=n(867122),r=n(481060),a=n(782272);const i=new a.Validator({iframe:[{rule:r.isRequiredHandler,errorText:o.CommonErrorReasons.validationIsRequired("iframe")}],origin:[{rule:r.isStringHandler,errorText:o.CommonErrorReasons.validationIsString("origin")},{rule:r.isRequiredHandler,errorText:o.CommonErrorReasons.validationIsRequired("origin")}]}),s=new a.Validator({event:[{rule:r.isRequiredHandler,errorText:o.CommonErrorReasons.validationIsRequired("event")}]}),c=new a.Validator({handler:[{rule:r.isRequiredHandler,errorText:o.CommonErrorReasons.validationIsRequired("handler")},{rule:r.isFunctionHandler,errorText:o.CommonErrorReasons.validationIsFunction("handler")}]}),l=new a.Validator({handler:[{rule:r.isRequiredHandler,errorText:o.CommonErrorReasons.validationIsRequired("handler")}],params:[{rule:r.isRequiredHandler,errorText:o.CommonErrorReasons.validationIsRequired("params")}]})},501831:(e,t,n)=>{n.d(t,{CONNECT_AUTH_RESPONSE_TYPE:()=>c,allowedLanguages:()=>d,makeAuthActionString:()=>s,makeAuthUrl:()=>l});var o=n(507423),r=n(581204),a=n(858952),i=n(772902);function s(e){return(0,o.isActionValid)(e)?btoa(JSON.stringify(e)):""}const c="silent_token";function l(e,t="auth"){return i.Config.fetchDomain().then((()=>{const{appId:n,connectDomain:o,appSettings:s,_debug:l,_localhost:d}=i.Config.get(),h={app_id:n,response_type:c,v:r.VERSION,debug:l?1:null,localhost:d?1:null,...e};s&&(0,a.hasAllowedAppSettingsParams)(s)&&(h.app_settings=(0,a.makeAppSettingsString)(s));const u=(0,a.makeParams)(h);return Promise.resolve(`https://${o}/${t}?${u}`)}))}const d=[r.LANGUAGES.RUS,r.LANGUAGES.UKR,r.LANGUAGES.ENG,r.LANGUAGES.SPA,r.LANGUAGES.GERMAN,r.LANGUAGES.POL,r.LANGUAGES.FRA,r.LANGUAGES.TURKEY]},412471:(e,t,n)=>{function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{_define_property:()=>o})},786465:(e,t,n)=>{n.d(t,{_object_spread:()=>r});var o=n(412471);function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){(0,o._define_property)(e,t,n[t])}))}return e}},749694:(e,t,n)=>{function o(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}n.d(t,{_type_of:()=>o})},630838:(e,t,n)=>{var o,r;n.d(t,{Scheme:()=>r}),function(e){e[e.RUS=0]="RUS",e[e.UKR=1]="UKR",e[e.ENG=3]="ENG",e[e.SPA=4]="SPA",e[e.GERMAN=6]="GERMAN",e[e.POL=15]="POL",e[e.FRA=16]="FRA",e[e.TURKEY=82]="TURKEY"}(o||(o={})),function(e){e.LIGHT="light",e.DARK="dark"}(r||(r={}))},992742:(e,t,n)=>{n.d(t,{querystring:()=>a});var o=n(786465),r=n(749694);var a={parse:function(e){if("string"!=typeof e)return{};var t=e.trim().replace(/^[?#&]/,"");return t?t.substring(t.indexOf("?")+1).split("&").reduce((function(e,t){var n=t.split("=");return n[1]&&(e[decodeURIComponent(n[0])]=decodeURIComponent(n[1].replace(/\+/g," "))),e}),{}):{}},stringify:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"!==(void 0===e?"undefined":(0,r._type_of)(e))||null===e)return"";t=(0,o._object_spread)({encode:!0},t);var n=function(e){return t.encode?encodeURIComponent(e):String(e)};return Object.keys(e).reduce((function(o,r){var a=e[r];return void 0===a?o:null===a?(t.skipNull||o.push([n(r),""].join("=")),o):Array.isArray(a)?(a.map((function(e){o.push("".concat(n(r),"[]=").concat(n(e)))})).join(),o):(o.push([n(r),n(a)].join("=")),o)}),[]).join("&")}}},641651:(e,t,n)=>{n.d(t,{nanoid:()=>o});let o=(e=21)=>{let t="",n=e;for(;n--;)t+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[64*Math.random()|0];return t}},703797:(e,t,n)=>{n.d(t,{registrationItemStat:()=>i});var o=n(581903);const r=new o.ProductionStatCollector,a=new o.ActionStatCollector(r),i=new o.RegistrationItemStatCollector(a)},787315:(e,t,n)=>{n.d(t,{VK_WEB_AUTH_APP_ID:()=>r,initVkId:()=>a});var o=n(772902);const r=7913379;function a(){const{loginDomain:e,connectDomain:t}=window.vk.apiConfigDomains;o.Config.init({appId:r,loginDomain:e,connectDomain:t})}},790156:(e,t,n)=>{var o;n.d(t,{AuthAppId:()=>o}),function(e){e[e.VK=7913379]="VK",e[e.MVK=7934655]="MVK"}(o||(o={}))},641162:(e,t,n)=>{n.d(t,{showErrorNotification:()=>s});var o=n(474848),r=n(767734),a=n(711896),i=n(272259);function s(e){const t=window.cur;(0,i.showMessageBoxModal)((({onClose:t})=>(0,o.jsx)(r.ModalCardBase,{header:e.title,subheader:e.text,onClose:t})),{hideOnBGClick:!0,onDestroy(){t.zNavInfo&&(0,a.zNav)(t.zNavInfo.info,t.zNavInfo.opts)}})}},122348:(e,t,n)=>{n.d(t,{initJoinVKConnectButton:()=>T,initJoinVKConnectForm:()=>I,initVkIdForm:()=>b});var o=n(772902),r=n(685962),a=n(630838),i=n(761960),s=n(581903),c=n(703797),l=n(248298),d=n(258643),h=n(691004),u=n(610989),m=n(96526),g=n(216147),p=n(787315),f=n(171444),_=n(641162),v=n(476726),E=n(790156),S=n(503552);const C=7913379;let R=s.EventScreens.START;function A(e){const{loginDomain:t,connectDomain:n}=window.vk.apiConfigDomains;o.Config.init({appId:C,loginDomain:t,connectDomain:n,appSettings:{external_device_id:e,vkc_auth_action:"registration",promo:"registration"},redirectUrl:location.protocol+"//"+location.host})}function k(e){const{proceedAs:t,savedUsersCount:n,availableQR:o,saveUserChecked:r}=e;t&&(R=s.EventScreens.START_PROCEED_AS),window.cur.eventScreen=R,o&&c.registrationItemStat.logFieldInteraction(s.RegistrationFieldItemNames.AVAILABLE_AUTH_WITH_QR,"1"),n&&c.registrationItemStat.logFieldInteraction(s.RegistrationFieldItemNames.ACCOUNTS_COUNT,n.toString()),r&&c.registrationItemStat.logFieldInteraction(s.RegistrationFieldItemNames.SAVED_AUTHORIZATION_ON,"1"),c.registrationItemStat.logEvent(s.RegistrationItemEventTypes.SCREEN_PROCEED,s.EventScreens.NOWHERE,R,{force:!0})}function T(e,t){const{proceedAs:n,unauthId:o}=t;A(o),k({proceedAs:n});const a=e.querySelector(".JoinForm__connectButton");if(!a)return;a.addEventListener("click",(e=>{e.preventDefault(),r.Auth.login({redirectUrl:location.protocol+"//"+location.host+"/join"})}))}function I(e,t){const{proceedAs:n,unauthId:o,phonePrefix:a,hash:i,fbApp:m,fbState:g,fbLocale:p}=t;A(o),k({proceedAs:n});const f=e.querySelector('.JoinForm__textInput[name="phone"]'),_=e.querySelector(".JoinForm__connectButton"),v=e.querySelector(".JoinForm__connectError"),E=e.querySelector(".JoinForm__form"),S=e.querySelector(".JoinForm__facebookLogin"),C=e.querySelector(".JoinForm__facebookLogin .FacebookLogin__button");let T=!1;if(!(f&&_&&v&&E))return;const I=e=>{(0,l.notaBene)(f),v&&e&&(v.innerHTML=e),c.registrationItemStat.logEvent(s.RegistrationItemEventTypes.INCORRECT_PHONE_NUMBER,R,void 0,{force:!0})},b=()=>{if(d.FlatButton.isLocked(_))return;if(!(e=>{const t=String(e).replace(/[^0-9]/g,"").length;return t>=10&&t<=13})(f.value.trim().replace(" ","")))return void I(u.getLang("index_error_bad_phone"));((e,t,n)=>{const o=e.hash;window.ajax.post("join.php?act=connect",e,{onDone:(e,a)=>{if("error"===e)return I(u.getLang("index_error_bad_phone")),void(0,l.notaBene)(n);d.FlatButton.lock(t);const i={name:"registration_with_phone",token:a,params:{csrf_hash:o}};r.Auth.login({redirectUrl:location.protocol+"//"+location.host+"/join",action:i})},showProgress:()=>d.FlatButton.lock(t),hideProgress:()=>d.FlatButton.unlock(t)})})({phone:f.value.trim(),hash:i},_,f)};if((0,h.placeholderInit)(f),f.value=a,f.addEventListener("keyup",(e=>{"Enter"!==e.key&&(v&&v.innerHTML&&(v.innerHTML=""),T||(c.registrationItemStat.logEvent(s.RegistrationItemEventTypes.START_REG_TAP,R,void 0,{force:!0}),T=!0))})),E.addEventListener("submit",(e=>{e.preventDefault(),b()})),_.addEventListener("click",(e=>{e.preventDefault(),b()})),m){const e=window.cur;e.fbApp=m,e.fbState=g,e.fbLocale=p,window.Index.fbCheck(m,"",S)}C?.addEventListener("click",(e=>{e.preventDefault(),window.Index.fbJoin("",C)}))}function b(e,t,n){(0,p.initVkId)();let o=g.colorScheme.isDarkScheme()?a.Scheme.DARK:a.Scheme.LIGHT,l=null;n?.proceed_as&&(R=s.EventScreens.START_PROCEED_AS);const h=g.colorScheme.subscribe((()=>{l&&l.update({scheme:g.colorScheme.isDarkScheme()?g.ColorSchemeName.WebDark:g.ColorSchemeName.Light}),o=g.colorScheme.isDarkScheme()?a.Scheme.DARK:a.Scheme.LIGHT}));let C=t;const A=location.search.match(/to=(?:[A-Za-z\d+/]{4})*(?:[A-Za-z\d+/]{3}=|[A-Za-z\d+/]{2}==)?/);if(A){const e=atob(A[0].slice(3)).replace(/\W*/g,"");C=""===e?"main":e}const T=e.querySelector(".VkIdForm__signInButton"),I=e.querySelector(".VkIdForm__signUpButton"),b=e.querySelector(".VkIdForm__businessSignUpButton"),y=e.querySelector(".VkIdForm__signInQRButton"),D=e.querySelector(".VkIdForm__qrPanel"),w=e.querySelector(".VkIdForm__qrPanelStub"),P=e.querySelector(".VkIdForm__input"),O=e.querySelector(".VkIdForm__messageError"),U=document.querySelector(".VkIdCheckbox--save"),L=U?.querySelector("#index_save_user_checkbox"),V=document.querySelector(".VkIdCheckbox--save .VkIdCheckbox__rightIcon");if(n&&k({proceedAs:n?.proceed_as??!1,savedUsersCount:n?.saved_users_count,availableQR:Boolean(D),saveUserChecked:Boolean(L?.checked)}),!T||!I)return;const N=e=>{P&&P.classList.add("VkIdForm__input--error"),O&&e&&(O.classList.remove("VkIdForm__messageError--hidden"),O.innerHTML=e)},K=()=>{P&&P.classList.remove("VkIdForm__input--error"),O&&O.innerHTML&&(O.classList.add("VkIdForm__messageError--hidden"),O.innerHTML="")},q=(e,t,n)=>{const o=e.hash||"",a=L?.checked?1:0;c.registrationItemStat.logFieldInteraction(s.RegistrationFieldItemNames.SAVED_AUTHORIZATION_ON,String(a)),c.registrationItemStat.logEvent(s.RegistrationItemEventTypes.SCREEN_PROCEED,R,s.EventScreens.NOWHERE,{force:!0}),window.ajax.post("join.php?act=connect",e,{onDone:(e,a)=>{if("error"===e)return N(u.getLang("vkconnect_auth_empty_login")),void d.FlatButton.unlock(n);t.action={name:"no_password_flow",token:a,params:{type:"sign_in",csrf_hash:o}},r.Auth.login(t)},onFail:e=>("security_error"===e&&(0,_.showErrorNotification)({title:u.getLang("vkconnect_auth_security_error_title"),text:u.getLang("vkconnect_auth_security_error_text")}),!1),showProgress:()=>d.FlatButton.lock(n),hideProgress:()=>{(0,v.partConfigEnabled)("vkconnect_auth_flat_button_unlock")&&d.FlatButton.unlock(n)}})},F=e=>{const t={redirectUrl:e||location.protocol+"//"+location.host+"/join"+location.search,action:{name:"no_password_flow",params:{type:"sign_up"}},entry:{source:C,screen:R},scheme:o};r.Auth.login(t)};(()=>{const e=`\n      <div class="VkIdCheckbox__saveTooltipHeader">\n        ${u.getLang("vkconnect_auth_save_user_tooltip_header")}\n      </div>\n      <div>\n        ${u.getLang("vkconnect_auth_save_user_tooltip_body")}\n      </div>\n    `;if(V){let t=new m.ElementTooltip(V,{autoShow:!0,width:260,content:e,cls:"feature_intro_tt",align:m.ElementTooltip.ALIGN_CENTER,forceSide:"bottom",appendToParent:!0,withCloseButton:!1,noHideOnClick:!0,offset:[1,0],onWindowClick(){},autoAdjustToViewport:!1,onHide:function(){}});(0,f.pushNavDestroy)((()=>{t&&(t.destroy(),t=null)}))}})(),(()=>{const e=location.protocol+"//"+location.host;if(!D)return;const t={source:C,screen:R};l=new i.AuthQR({container:D,entry:t}),l.on("VKSDKQRScaned",(n=>{r.Auth.login({action:{name:"qr_auth",token:n??"qr_auth_scanned"},entry:t,scheme:o,redirectUrl:e+(0,S.getToParam)()})})),l.on("VKSDKQRClicked",(()=>{r.Auth.login({action:{name:"qr_auth"},entry:t,scheme:o,redirectUrl:e+(0,S.getToParam)()})})),l.open({scheme:g.colorScheme.isDarkScheme()?g.ColorSchemeName.WebDark:g.ColorSchemeName.Light}).then((()=>{w&&w.remove()})).catch((()=>{l&&l.close(),D.remove()}))})(),I.addEventListener("click",(e=>{e.preventDefault(),h(),F()})),b&&b.addEventListener("click",(e=>{const t=`${location.protocol}//${location.host}/groups_create?type=business&source=registration`;e.preventDefault(),h(),c.registrationItemStat.logEvent(s.RegistrationItemEventTypes.CREATE_BUSINESS_START,R,s.EventScreens.NOWHERE,void 0,void 0,E.AuthAppId.VK),F(t)})),P&&(P.addEventListener("focus",(()=>{K()})),P.addEventListener("input",(()=>{K()})),e.addEventListener("submit",(e=>{e.preventDefault(),h(),(()=>{const e=location.protocol+"//"+location.host,a={source:C,screen:R},i={redirectUrl:n?.to_feed?e+"/feed":e+(0,S.getToParam)(),action:{name:"no_password_flow",params:{type:"sign_in"}},entry:a,scheme:o};if(!P)return void r.Auth.login(i);const s=P.value?.trim().replace(" ","");if(!s)return void N(u.getLang("vkconnect_auth_empty_login"));i.entry&&(i.entry.source=t);const c=document.querySelector("#index_expire_input"),l=c?.checked?1:0,h=document.querySelector("#index_save_user_checkbox"),m=h?.checked?1:0;d.FlatButton.lock(T),q({login:encodeURIComponent(s),hash:n?.hash,expire:l,save_user:m},i,T)})()}))),y&&y.addEventListener("click",(e=>{e.preventDefault(),h(),(()=>{const e=location.protocol+"//"+location.host,t={source:C,screen:R},a={redirectUrl:n?.to_feed?e+"/feed":e+(0,S.getToParam)(),action:{name:"qr_auth"},entry:t,scheme:o};r.Auth.login(a)})()}))}},503552:(e,t,n)=>{n.d(t,{generateDays:()=>a,getToParam:()=>s,updateDayDropdown:()=>i});var o=n(8520),r=n(610989);function a(e,t){const n=[[0,r.getLang("index_sel_bday")]],a=(0,o.getLastDayOfMonth)(e,t);for(let e=1;e<=a;++e)n.push([e,String(e)]);return n}function i(e,t,n,r){Number(n.val())>(0,o.getLastDayOfMonth)(e,t)&&n.clear(),n.setData(a(e,t).slice(Number(r)?1:0))}function s(){if(location.href.includes("login"))return"/login"+location.search;const e=new URLSearchParams(window.location.search).get("to"),t=e?atob(e.replaceAll("-","=")):"",n=t.startsWith("/")?"":"/";return e?n+t:""}}}]);try{stManager.done("dist/web/chunks/5233f55c.e7bdbbce.js")}catch(e){}