"use strict";(self.webpackChunkvkweb=self.webpackChunkvkweb||[]).push([[77805],{705678:(e,t,i)=>{function s(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="#fff" d="m6.55 5.05 4.77 2.64a.35.35 0 0 1 0 .62l-4.77 2.64a.37.37 0 0 1-.5-.13.34.34 0 0 1-.05-.17v-5.3A.36.36 0 0 1 6.37 5c.06 0 .12.02.18.05Z"/></svg>',name:"play_marusia_foreground_16"}}i.d(t,{getIcon16PlayMarusiaForeground:()=>s})},74472:(e,t,i)=>{function s(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="#fff" d="M5 7.4c0-.84 0-1.26.16-1.58a1.5 1.5 0 0 1 .66-.66C6.14 5 6.56 5 7.4 5h1.2c.84 0 1.26 0 1.58.16a1.5 1.5 0 0 1 .66.66c.16.32.16.74.16 1.58v1.2c0 .84 0 1.26-.16 1.58a1.5 1.5 0 0 1-.66.66c-.32.16-.74.16-1.58.16H7.4c-.84 0-1.26 0-1.58-.16a1.5 1.5 0 0 1-.66-.66C5 9.86 5 9.44 5 8.6V7.4Z"/></svg>',name:"stop_marusia_foreground_16"}}i.d(t,{getIcon16StopMarusiaForeground:()=>s})},346645:(e,t,i)=>{function s(e,t,i,s){const r=t?"article.php":"al_articles.php";ajax.post(r,{act:"tts",article_owner_id:e.owner_id,article_id:e.id,hash:e.tts_hash,support_streaming:i?1:0},{onDone:e=>{s(e)}})}i.d(t,{loadArticle:()=>s})},868132:(e,t,i)=>{i.d(t,{ArticleTts:()=>h});var s=i(1810),r=i(59052),n=i(668089),o=i(514640),a=i(735477),_=i(620626),l=i(668592),d=i(346645);class h{static load(e,t,i,s){this.loadingArticleRawId=e.raw_id,(0,d.loadArticle)(e,t,i,(e=>{this.loadingArticleRawId=null,s(e)}))}static getAudio(e,t,i){const s=[],n=JSON.stringify({articleTts:!0,articleId:e,articleOwnerId:t,externalStream:!0});return s[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ID]=`${t}${e}`,s[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_OWNER_ID]=t,s[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_URL]=i.url,s[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_TITLE]=i.title,s[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_PERFORMER]=i.artist,s[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_DURATION]=i.duration,s[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_AUTHOR_LINK]="",s[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_LYRICS]=0,s[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_FLAGS]=0,s[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_CONTEXT]="",s[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_EXTRA]=n,s[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_HASHES]="",s[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_COVER_URL]="",s[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ADS]={},s[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_SUBTITLE]="",s[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_MAIN_ARTISTS]="",s[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_FEAT_ARTISTS]="",s[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ALBUM]=!1,s[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_TRACK_CODE]="",s[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_RESTRICTION]=0,s[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ALBUM_PART]=0,s[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_ACCESS_KEY]="",s[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_CHART_INFO_INDEX]=!1,s}static play(e,t,i,r){this.onArticleTtsExpire=r,this.statsHandlersInitialized||(this._audioPlayer().subscribe(o.AudioPlayerEventType.PLAY,(()=>{if(this.isAnyArticleInPlayer()){const e=this._audioPlayer().getCurrentProgress()>0?s.ArticleTtsActionType.CONTINUE:s.ArticleTtsActionType.START;this.sendStats(e)}})),this._audioPlayer().subscribe(o.AudioPlayerEventType.PAUSE,(()=>{this.isAnyArticleInPlayer()&&this.sendStats(s.ArticleTtsActionType.PAUSE)})),this._audioPlayer().subscribe(o.AudioPlayerEventType.ENDED,(()=>{if(this.isAnyArticleInPlayer()){let e=this._audioPlayer();if(e._impl?._hlsError||e._impl?._currentAudioEl?.error){e._impl&&(e._impl._hlsError=void 0);const t=(0,l.getAudioExtra)(e.getCurrentAudio());e.deleteCurrentPlaylist(),h.retryCount<3&&(h.retryCount+=1,setTimeout((()=>{this.onArticleTtsExpire?.(t)}),h.RETRY_TIMEOUT))}this.sendStats(s.ArticleTtsActionType.P100)}})),this.statsHandlersInitialized=!0);const n=this.getAudio(e,t,i),a=this._audioPlayer().getPlaylist(_.AudioPlaylist.TYPE_ARTICLE_TTS,t,e);a.mergeWith({list:[n]}),this._audioPlayer().play(n,a)}static _audioPlayer(){return window.getAudioPlayer()}static _audioExtra(){const e=this._audioPlayer().getCurrentAudio();return(0,l.getAudioExtra)(e)??{}}static isLoadingArticle(e){return this.loadingArticleRawId===e.raw_id}static isArticleInPlayer(e){return e.owner_id===this._audioExtra().articleOwnerId&&e.id===this._audioExtra().articleId}static isAnyArticleInPlayer(){return(0,n.isArticleTts)(this._audioPlayer().getCurrentAudio())}static sendStats(e){const{articleId:t,articleOwnerId:i}=this._audioExtra();s.articleTtsActionStatController.logEvent({action:e,nav_screen:"article_read",article_id:t,owner_id:i,audio_length:(0,a.audioTupleToAudioObject)(this._audioPlayer().getCurrentAudio())?.duration??0,speed:Math.round(100*AudioPlayer.podcastGetPlaybackRate()),volume:Math.round(100*this._audioPlayer().getVolume())})}}h.statsHandlersInitialized=!1,h.retryCount=0,h.RETRY_TIMEOUT=1e3},946076:(e,t,i)=>{i.r(t),i.d(t,{UIGallery:()=>c,UI_GALLERY_CLASSNAME:()=>l.UI_GALLERY_CLASSNAME,UI_GALLERY_CONTENT_CLASSNAME:()=>l.UI_GALLERY_CONTENT_CLASSNAME,UI_GALLERY_INNER_CLASSNAME:()=>l.UI_GALLERY_INNER_CLASSNAME,uiGetGallery:()=>h});var s=i(942451),r=i(7144),n=i(663878),o=i(317412),a=i(879007),_=i(452314),l=i(374036);const d=(0,s.makeSharedState)("ui-gallery",(()=>({galleries:{},incIndex:0})),{version:0});function h(e){const t=(0,_.domData)((0,_.ge)(e),"gallery-id");return t&&d().galleries[t]}class c{_checkSizesAndUpdate(){return 0!==this._width&&0!==this._itemWidth||(this._width=Math.round((0,_.getSize)(this._el)[0]),this._itemWidth=(0,_.getSize)(this._items[0])[0],this._itemFullWidth=this._itemWidth+this._itemOffset),!(0===this._width||0===this._itemWidth)}_initScroll(){(this._opts.scrollX||this._opts.scrollY)&&(this._opts.isModernTransitionsEnabled||(0,o.addEvent)(this._innerCont,"DOMMouseScroll wheel",this._onWheelScroll.bind(this)))}_initArrows(){this._opts.noArrows?(0,_.addClass)(this._el,"ui_gallery_no_arrows"):(this._leftArrow=(0,_.geByClass1)("ui_gallery__arrow_left",this._el),this._rightArrow=(0,_.geByClass1)("ui_gallery__arrow_right",this._el),this._arrowWidth=(0,_.getSize)(this._leftArrow)[0],this._opts.isModernTransitionsEnabled?((0,o.addEvent)(this._leftArrow,"click",this._slide.bind(this,-1,void 0,{eventName:"arrow"})),(0,o.addEvent)(this._rightArrow,"click",this._slide.bind(this,1,void 0,{eventName:"arrow"}))):((0,o.addEvent)(this._leftArrow,"click",this._legacySlide.bind(this,-1,void 0,{eventName:"arrow"})),(0,o.addEvent)(this._rightArrow,"click",this._legacySlide.bind(this,1,void 0,{eventName:"arrow"}))),(0,o.addEvent)(this._leftArrow,"mouseover",this._onArrowMouseOver.bind(this,"left")),(0,o.addEvent)(this._leftArrow,"mouseout",this._onArrowMouseOut.bind(this)),(0,o.addEvent)(this._rightArrow,"mouseover",this._onArrowMouseOver.bind(this,"right")),(0,o.addEvent)(this._rightArrow,"mouseout",this._onArrowMouseOut.bind(this)))}_onWheelScroll(e){let t;if("wheel"==e.type)if(Math.abs(e.deltaY)>Math.abs(e.deltaX)){if(!this._opts.scrollY)return;t=-e.deltaY}else{if(!this._opts.scrollX)return;t=-e.deltaX}else if(void 0!==e.wheelDeltaY){if(!this._opts.scrollY)return;t=e.wheelDeltaY}else if(void 0!==e.wheelDelta)t=e.wheelDelta;else{if(!e.detail||1!==e.axis)return;t=-e.detail}t=this._scroll.rtlSame?-t:t,Math.abs(t)>=120&&(t=74*Math.max(-1,Math.min(1,t))),this._innerCont.scrollLeft-=t,this._checkItemsAfterScroll(this._innerCont.scrollLeft),(0,o.cancelEvent)(e)}_getScrollParams(){this._opts.shouldCheckGalleryViewed&&this._checkSizesAndUpdate();const e=this._width-2*this._arrowWidth,t=this._itemFullWidth>e;return{isItemBiggerThanWidth:t,scrollDistance:t?this._itemFullWidth:e}}_legacySlide(e,t,i){const{scrollDistance:s,isItemBiggerThanWidth:r}=this._getScrollParams();let a=this._innerCont.scrollLeft+(this._scroll.rtlSame?-e:e)*s;const l=this._innerCont.scrollWidth-this._width;this._scroll.negative?(a=Math.min(a,0),a=Math.abs(a)):a=Math.max(0,a),a=Math.min(l,a);const d=this._scroll.negative||this._scroll.rtlSame?-e:e;if(d>0&&a<l){a=Math.floor(a/this._itemFullWidth)*this._itemFullWidth}else if(d<0&&a>0){a=(r?Math.ceil(a/this._itemFullWidth):Math.floor(a/this._itemFullWidth))*this._itemFullWidth}if(this._opts.isFullSizeSlide&&(a=(this._visible.left+e)*this._itemFullWidth),0===a||a===l){const t=this._innerCont.scrollWidth;(0,_.addClass)(this._inner,"ui_gallery__inner_shift_instant"),this._onArrowMouseOut(),a&&(a+=e*(this._innerCont.scrollWidth-t))}this._scroll.negative&&(a=-a),(0,n.animate)(this._innerCont,{scrollLeft:a},{duration:Math.abs(this._innerCont.scrollLeft-a)+50,transition:n.Fx.Transitions.easeOutCubic}),this._checkItemsAfterScroll(a),setTimeout((()=>(0,_.removeClass)(this._inner,"ui_gallery__inner_shift_instant")),0),this._opts?.onSlide?.(e,{eventName:i?.eventName}),t&&(0,o.cancelEvent)(t)}_updateShift(e){let t=this._shift+e;const i=this._inner.scrollWidth-this._inner.clientWidth;t>i&&(t=i),t<0&&(t=0),this._shift=t}_slide(e,t,i){const{scrollDistance:s}=this._getScrollParams();this._updateShift(e*s),this._inner.style.transform=`translate3d(${-1*this._shift}px, 0, 0)`,this._checkItemsAfterScroll(this._shift),this._opts?.onSlide?.(e,{eventName:i?.eventName}),t&&(0,o.cancelEvent)(t)}_checkItemsAfterScroll(e,t){if(this._scroll.negative&&(e=Math.abs(e)),(!this._opts.shouldCheckGalleryViewed||this._visible.isGalleryViewed)&&(!this._opts.shouldCheckGalleryViewed||this._checkSizesAndUpdate())){if(this._opts.markOutside||this._opts.onViewItem){const i=this._itemWidth/3,s=(this._scroll.backward?this._inner.scrollWidth-this._width-e:e)-this._scrollOffset,r=e&&Math.floor(s/this._itemFullWidth),n=r*this._itemFullWidth+2*i;let o;o=this._scroll.backward?e+this._width<this._inner.scrollWidth-n:e>n;const l=Math.min(this._items.length-1,Math.floor((s+this._width)/this._itemFullWidth)),d=l*this._itemFullWidth+2*i;let h;if(h=this._scroll.backward?e>this._inner.scrollWidth-d:e+this._width<d,this._opts.onViewItem){const e=o?Math.min(this._items.length-1,r+1):r,i=h?Math.max(0,l-1):l;if(t||e!==this._visible.left||i!==this._visible.right){for(let s=e;s<=i;s++)(this._visible.left<0||t&&!(0,a.inArray)(this._items[s],this._visible.items)||s<this._visible.left||s>this._visible.right)&&this._opts.onViewItem(this._items[s],s);this._visible.left=e,this._visible.right=i,this._visible.items=this._items.slice(e,i+1)}}this._opts.markOutside&&(t?((0,_.geByClass)("ui_gallery_item_outside",this._inner).forEach((e=>{(0,_.removeClass)(e,"ui_gallery_item_outside")})),this._outside.left=-1,this._outside.right=-1):((r!==this._outside.left||!o)&&this._outside.left>=0&&((0,_.removeClass)(this._items[this._outside.left],"ui_gallery_item_outside"),this._outside.left=-1),(l!==this._outside.right||!h)&&this._outside.right>=0&&((0,_.removeClass)(this._items[this._outside.right],"ui_gallery_item_outside"),this._outside.right=-1)),o&&r!==this._outside.left&&((0,_.addClass)(this._items[r],"ui_gallery_item_outside"),this._outside.left=r),h&&l!==this._outside.right&&((0,_.addClass)(this._items[l],"ui_gallery_item_outside"),this._outside.right=l))}if(!this._opts.noArrows){const t=e>0,i=e+this._width<this._inner.scrollWidth;(0,_.toggleClass)(this._leftArrow,"ui_gallery__arrow_visible",this._scroll.rtl&&!this._scroll.backward?i:t),(0,_.toggleClass)(this._rightArrow,"ui_gallery__arrow_visible",this._scroll.rtl&&!this._scroll.backward?t:i)}(!this._scroll.backward&&this._inner.scrollWidth-e-this._width<1e3||this._scroll.backward&&e<1e3)&&this._onLoadMore()}}_onArrowMouseOver(e){this._inner.classList.add(`ui_gallery__inner_shift_${e}`)}_onArrowMouseOut(){this._inner.classList.remove("ui_gallery__inner_shift_left"),this._inner.classList.remove("ui_gallery__inner_shift_right")}_onLoadMore(){!this._opts.onLoadMore||this._loadingMore||this._finised||(this._loadingMore=!0,this._opts.onLoadMore(this._items.length))}addMore(e,t){e=e||[],this.addItems(e),this._finised=!!t||!e.length,this._loadingMore=!1}addItems(e,t){if((e=e||[]).length){const i=t>=0&&t<this._items.length?this._items[t]:null;e.forEach((e=>{i?(0,_.domInsertBefore)(e,i):this._inner.appendChild(e)})),this.refresh()}}destroy(){(0,o.removeEvent)(this._innerCont),(0,o.removeEvent)(this._leftArrow),(0,o.removeEvent)(this._rightArrow),(0,_.domData)(this._el,"gallery-id",null),delete d().galleries[this._id],this._opts.onDestroy&&this._opts.onDestroy(),(0,_.re)(this._el)}removeItem(e){return(0,r.isNumeric)(e)&&(e=this._items[e]),!(!e||!(0,a.inArray)(e,this._items))&&((0,_.re)(e),this.refresh(),this._items.length||this.destroy(),!0)}refresh(){this._width=Math.round((0,_.getSize)(this._el)[0]),this._items=(0,_.geByClass)("ui_gallery_item",this._el),this._checkItemsAfterScroll(this._innerCont.scrollLeft,!0)}scrollToDirection(e){this._opts.isModernTransitionsEnabled?this._slide(e,void 0,{eventName:"bullet"}):this._legacySlide(e,void 0,{eventName:"bullet"})}getItems(){return this._items}getVisibleItems(){return this._visible.items.map(((e,t)=>[e,this._visible.left+t]))}setGalleryViewed(){this._visible.isGalleryViewed=!0,this._checkItemsAfterScroll(this._innerCont.scrollLeft)}constructor(e,t){if(!e)throw new Error("No element was provided for UIGallery");if(!(e=(0,_.ge)(e)).classList.contains(l.UI_GALLERY_CLASSNAME))throw new Error("Provided incorrect element for UIGallery");const i=h(e);if(i)return i;this._opts=(0,a.extend)({markOutside:!1,scrollY:!0,scrollX:!0,noArrows:!1,isFullSizeSlide:!1,isModernTransitionsEnabled:!1},t),this._id=d().incIndex,d().incIndex+=1,this._el=e,this._width=Math.round((0,_.getSize)(this._el)[0]),this._items=(0,_.geByClass)("ui_gallery_item",this._el),this._itemWidth=(0,_.getSize)(this._items[0])[0],this._itemOffset=(0,a.intval)((0,_.getStyle)(this._items[0],vk.rtl?"marginLeft":"marginRight")),this._scrollOffset=(0,a.intval)((0,_.getStyle)(this._items[0],"marginLeft")),this._itemFullWidth=this._itemWidth+this._itemOffset,this._innerCont=(0,_.geByClass1)(l.UI_GALLERY_CONTENT_CLASSNAME,this._el),this._inner=(0,_.geByClass1)(l.UI_GALLERY_INNER_CLASSNAME,this._el),this._opts.isModernTransitionsEnabled&&(this._shift=0,this._inner.classList.add("ui_gallery__inner--withTransitions")),this._scroll=function(){const e={rtl:!1,backward:!1,delta:1,negative:!1,rtlSame:!1};if(!vk.rtl)return e;if(!cur._scrollInfo){const t=(0,_.se)('<div style="position: fixed; left: -1000px; width: 0; overflow: scroll">x</div>'),i=document.querySelector("#content");i?.appendChild(t);const s=t.scrollLeft;e.rtl=vk.rtl,e.backward=s>0,t.scrollLeft=1e3,e.delta=t.scrollLeft===s?-1:1,e.negative=!e.backward&&e.delta<0,e.rtlSame=e.rtl&&!e.backward&&!e.negative,(0,_.re)(t),cur._scrollInfo=e}return cur._scrollInfo}(),this._loadingMore=!1,this._finised=!1,this._visible={left:-1,right:-1,items:[],isGalleryViewed:!1},this._outside={left:-1,right:-1,timer:null},this._initScroll(),this._initArrows(),(0,_.domData)(this._el,"gallery-id",this._id),d().galleries[this._id]=this,this._checkItemsAfterScroll(this._innerCont.scrollLeft,!0)}}},742328:(e,t,i)=>{i.d(t,{ON_BOARDING_BG_RECT_ID:()=>_,default:()=>h});var s=i(452314),r=i(317412),n=i(688701),o=i(293878),a=i(96526);const _="onboarding_bg_rect",l="page_header_cont",d="onboarding";class h{initOnboardingBG(){if(!window.onboardingBG){let e='\n<div id="onboarding_layout">\n  <svg id="onboarding_bg_header" width="100%" height="49px">\n    <rect id="onboarding_bg_rect" class="GroupOnboardingBg" x="0" y="0" width="100%" height="100%" fill-opacity="0.8" fill="#000"></rect>\n  </svg>\n  <svg id="onboarding_bg" width="100%" height="100%">\n  <defs>\n    <mask id="mask" x="0" y="0" width="100%" height="100%">\n      <rect x="0" y="0" width="100%" height="100%" fill="#fff"></rect>\n      <rect id="onboarding_bg_clip" class="GroupOnboardingBgClip" x="0" y="0" width="0" height="0" fill="#000" rx="8" ry="8"></rect>\n    </mask>\n  </defs>\n  <rect id="onboarding_bg_rect" class="GroupOnboardingBg" x="0" y="42" width="100%" height="100%" mask="url(#mask)" fill-opacity="0.8"></rect>\n  </svg>\n</div>\n      ',t=(0,s.se)(e);(0,s.domInsertBefore)(t,window.layerBG),window.onboardingBGHeader=(0,s.ge)("onboarding_bg_header"),window.onboardingBG=(0,s.ge)("onboarding_bg"),window.onboardingBGRect=(0,s.ge)(_),window.onboardingBGClip=(0,s.ge)("onboarding_bg_clip"),window.cur.destroy.push((()=>{(0,s.hide)(window.onboardingBG),(0,s.hide)(window.onboardingBGHeader),(0,s.removeClass)((0,s.ge)(l),d),this.hideDarkness=!0,this.hideTT(),delete window.onboardingBG,delete window.onboardingBGHeader,delete window.onboardingBGRect,delete window.onboardingBGClip,this.opts.onBGClick&&(0,r.removeEvent)(window.onboardingBG,"click",this.opts.onBGClick)}))}this.opts.onBGClick&&(0,r.addEvent)(window.onboardingBG,"click",this.opts.onBGClick)}showTT(){const[,e]=(0,s.getXY)(this.el);this.tt=new a.ElementTooltip(this.el,this.ttParams),this.opts.highlight&&(this.addDarkness(),this.addHighlight()),this.tt.show();const t=this.tt.getContent();(0,o.isElementInViewport)(this.el)&&(0,o.isElementInViewport)(t)||(0,n.scrollToY)(e-42-this.ttParams.scrollOffset)}hideTT(){this.tt&&(this.tt.destroy(),this.removeDarkens(),this.hideDarkness&&((0,r.removeEvent)(window,"scroll"),(0,r.removeEvent)(window,"resize")),this.opts.onBGClick&&window.onboardingBG&&(0,r.removeEvent)(window.onboardingBG,"click",this.opts.onBGClick),this.opts.onHide&&this.opts.onHide())}addHighlight(){window.onboardingBGClip&&(this.highlightElement(),(0,r.addEvent)(window,"scroll",this.onScrollTT.bind(this)),(0,r.addEvent)(window,"resize",this.onResizeTT.bind(this)))}highlightElement(){let e=this.el.offsetWidth,t=this.el.offsetHeight,i=(0,s.getXY)(this.el);(0,s.attr)(window.onboardingBGClip,"width",e+this.border[1]+this.border[3]),(0,s.attr)(window.onboardingBGClip,"height",t+this.border[0]+this.border[2]),(0,s.attr)(window.onboardingBGClip,"x",i[0]-this.border[1]),(0,s.attr)(window.onboardingBGClip,"y",i[1]-this.border[0])}onResizeTT(){this.setDartToFullWidth(),this.highlightElement()}onScrollTT(){let e=this.getPageHeight();window.onboardingBG.height!=e&&this.setDartToFullHeight()}setDartToFullHeight(){(0,s.attr)(window.onboardingBG,"height",this.getPageHeight())}setDartToFullWidth(){(0,s.attr)(window.onboardingBG,"width",this.getPageWidth()),(0,s.attr)(window.onboardingBGHeader,"width",this.getPageWidth())}addDarkness(){(0,s.isVisible)(window.onboardingBG)||(this.setDartToFullHeight(),this.setDartToFullWidth(),(0,s.show)(window.onboardingBG),(0,s.isVisible)(window.onboardingBGHeader)||((0,s.show)(window.onboardingBGHeader),(0,s.addClass)((0,s.ge)(l),d)))}removeDarkens(){this.hideDarkness&&((0,s.hide)(window.onboardingBG),(0,s.hide)(window.onboardingBGHeader),(0,s.removeClass)((0,s.ge)(l),d))}ttOnHide(){this.hideTT()}show(){setTimeout(this.showTT.bind(this),1e3)}getPageWidth(){const e=document.documentElement,t=document.body;return Math.max(t.scrollWidth,e.scrollWidth,t.offsetWidth,e.offsetWidth,t.clientWidth,e.clientWidth)}getPageHeight(){const e=document.documentElement,t=document.body;return Math.max(t.scrollHeight,e.scrollHeight,t.offsetHeight,e.offsetHeight,t.clientHeight,e.clientHeight)}constructor(e,t,i={}){this.el=e,this.text=t,this.hideDarkness=!0,this.oldColor=!1;let s={autoShow:!1,noAutoHideOnWindowClick:i.noAutoHideOnWindowClick??!0,content:t instanceof HTMLElement?t:`${t}`,cls:`feature_intro_tt tutorial_tip_tt ${(()=>{const e=i.class??"";return i.tooltipWhite?e:e+" feature_intro_blue_tt"})()}`,appendToParent:!0,onHide:this.ttOnHide.bind(this),scrollOffset:i.scrollOffset||0,align:i.align||a.ElementTooltip.ALIGN_CENTER};i.side&&(s.forceSide=i.side),i.offset&&(s.offset=i.offset),i.width&&(s.width=i.width),i.shift&&(s.centerShift=i.shift),i.border?this.border=i.border:this.border=[10,10,10,10],i.ttOnHide&&(s.onHide=i.ttOnHide),i.withCloseButton&&(s.withCloseButton=i.withCloseButton,s.onCloseButtonClick=i.onCloseButtonClick),i.align&&(s.align=i.align),this.ttParams=s,this.opts=i,this.initOnboardingBG()}}},293878:(e,t,i)=>{function s(e){const t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}function r(e,t){return`<b>${e}</b><br/>${t}`}i.d(t,{buildTooltipeContent:()=>r,isElementInViewport:()=>s})},2432:(e,t,i)=>{i.d(t,{checkIfInternalLink:()=>o,getNearestPost:()=>n,getPostElementBySelector:()=>a});var s=i(705744),r=i(700444);const n=e=>e?.closest((0,s.isMvk)()?r.MVK_WALL_ITEM_SELECTOR:r.WEB_WALL_POST_SELECTOR)??null;function o(e){if(!e)return null;try{const t=decodeURIComponent(e),i=s.VK_URL_REGEX.test(t),r=new URL(t),n="/away.php"===r.pathname&&r.searchParams.has("to");return i&&!n}catch{return null}}function a(e,t){return t?t.querySelector(e):document.querySelector(e)}},700444:(e,t,i)=>{i.d(t,{MVK_WALL_ITEM_SELECTOR:()=>n,WEB_WALL_POST_SELECTOR:()=>r});const s=".feed_post_indicator",r=`.post, .wl_post, ${s}`,n=`.wall_item, .post_item, .js-wall_item, ${s}`},14352:(e,t,i)=>{function s(e,t=!0){return`${t?"data-":""}ad-stat-${e}`}i.d(t,{getStatAttrName:()=>s})},719583:(e,t,i)=>{i.d(t,{AD_POST_CLASS_SELECTOR:()=>r,PixelNames:()=>s});const s={audio_click:"audio_click",click:"click",click_deeplink:"click_deeplink",click_post_link:"click_post_link",click_post_owner:"click_post_owner",click_pretty_card:"click_pretty_card",closed_by_user:"closed_by_user",hide:"hide",impression:"impression",impression_pretty_card:"impression_pretty_card",like_post:"like_post",load:"load",playback_started:"playback_started",playback_paused:"playback_paused",playback_resumed:"playback_resumed",playback_completed:"playback_completed",playhead_reached_value:"playhead_reached_value",playhead_viewability_value:"playhead_viewability_value",render:"render",share_post:"share_post",show_off:"show_off",video_fullscreen_off:"video_fullscreen_off",video_fullscreen_on:"video_fullscreen_on",video_pause:"video_pause",video_play:"video_play",video_play_100:"video_play_100",video_resume:"video_resume",video_start:"video_start",video_volume_off:"video_volume_off",video_volume_on:"video_volume_on",viewability_duration:"viewability_duration",viewability_measurable:"viewability_measurable",viewability_unmeasurable:"viewability_unmeasurable",viewin:"viewin",volume_off:"volume_off",volume_on:"volume_on",error:"error"},r="._ads_block_data_w"},761085:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{logPixelEvent:()=>logPixelEventUntyped,triggerAdHtmlEvent:()=>triggerAdHtmlEvent});var _shared_lib_ls__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(250682),_shared_lib_common__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(7144),_shared_utils_numberHashCode__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(330733),_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(719583),_shared_lib_js_logger__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(87223),_shared_user_user_env__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(476726),_shared_feed_feed_utils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2432),_attributes__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(14352),_shared_pixels_utils__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(425972),_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(167517);const LS_ADS_EVENTS="ads.events",uniqueEvents=[_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__.PixelNames.render,_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__.PixelNames.viewability_measurable,_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__.PixelNames.viewability_unmeasurable,_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__.PixelNames.viewin],isUniqueEvent=e=>uniqueEvents.includes(e),triggerAdHtmlEvent=(el,event)=>{if(!el)return null;const statHtml=el.getAttribute(`data-ad-stat-html-${event}`);if(el.removeAttribute(`data-ad-stat-html-${event}`),statHtml){const statElemWrap=document.createElement("div");let elem;for(statElemWrap.setAttribute("innerHTML",statHtml);elem=statElemWrap.firstChild;)if(el.appendChild(elem),"SCRIPT"===elem.tagName)try{eval(elem.innerHTML)}catch(e){(0,_shared_lib_js_logger__WEBPACK_IMPORTED_MODULE_3__.logEvalError)(e,elem.innerHTML)}}};function parsePixels(e,t){try{const t=JSON.parse(e);if(Array.isArray(t))return{pixels:t}}catch(i){if(!/^https?:\/\//.test(e))return{isInvalid:!0,pixels:[]};return{pixels:e.split("$$$").map((e=>({type:t,url:e})))}}return{pixels:[]}}const makeDefaultPixelAction=(e,t,{triggerErrorPixel:i})=>{switch(t){case _shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__.PixelNames.playback_started:case _shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__.PixelNames.playback_completed:const t=e.getAttribute(`data-ad-stat-${_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__.PixelNames.playhead_reached_value}`),s=e.getAttribute(`data-ad-stat-disabled-${_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__.PixelNames.playhead_reached_value}`);try{if(t&&s){const i=JSON.parse(t),r=JSON.parse(s);Array.isArray(r)&&Array.isArray(i)&&(e.setAttribute(`data-ad-stat-${_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__.PixelNames.playhead_reached_value}`,JSON.stringify([...r,...i])),e.removeAttribute(`data-ad-stat-disabled-${_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__.PixelNames.playhead_reached_value}`))}}catch(e){try{i(),console.log(`throw Pixel event error: ${e.message}`)}catch(e){}}}},filterPixelReachedEvents=(e,t,i)=>{if(i?.pvalue||i?.value){const{pixelsFilter:s,pixelsRemainingFilter:r}=t.reduce(((e,t)=>(t?.pvalue&&"number"==typeof t?.pvalue&&i?.pvalue&&t?.pvalue>=i?.pvalue||t?.value&&"number"==typeof t?.value&&i?.value&&t?.value>=i?.value?e.pixelsFilter.push(t):e.pixelsRemainingFilter.push(t),e)),{pixelsFilter:[],pixelsRemainingFilter:[]}),n=e.getAttribute(`data-ad-stat-disabled-${_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__.PixelNames.playhead_reached_value}`);try{if(s&&n){const t=JSON.parse(n);Array.isArray(t)&&Array.isArray(s)&&e.setAttribute(`data-ad-stat-disabled-${_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__.PixelNames.playhead_reached_value}`,JSON.stringify([...t,...s])),e.setAttribute(`data-ad-stat-${_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__.PixelNames.playhead_reached_value}`,JSON.stringify(r))}}catch(e){try{console.log(`throw Pixel event error: ${e.message}`)}catch(e){}}return s}return t},logPixelEvent=(e,t,i)=>{if(!(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_4__.partConfigEnabled)("ads_pixels_track_new_events_web_mvk"))return;const s=(0,_shared_feed_feed_utils__WEBPACK_IMPORTED_MODULE_5__.getNearestPost)(e)??e;if(!(s instanceof HTMLElement))return;function r(){t!==_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__.PixelNames.error&&logPixelEvent(s,_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__.PixelNames.error)}makeDefaultPixelAction(e,t,{triggerErrorPixel:r});const n=(0,_attributes__WEBPACK_IMPORTED_MODULE_8__.getStatAttrName)(t,!1),o=(0,_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_7__.getAdAttribute)(s,n),a=(0,_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_7__.getAdAttribute)(s,"data-ad-block-uid");if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_4__.partConfigEnabled)("feed_ads_pixel_tracked_console_log")&&(0,_shared_pixels_utils__WEBPACK_IMPORTED_MODULE_6__.logIfAdPostPixelFired)(s,t),!o)return;let{isInvalid:_,pixels:l}=parsePixels(o,t);if(_&&r(),isUniqueEvent(t)&&l.length&&(s.setAttribute(`data-ad-disabled-stat-${t}`,o),s.removeAttribute(n)),a&&isUniqueEvent(t)&&l.length)try{const e=(0,_shared_utils_numberHashCode__WEBPACK_IMPORTED_MODULE_9__.numberHashCode)(`${t}${a}`),i=_shared_lib_ls__WEBPACK_IMPORTED_MODULE_0__.multiAccountLs.get(LS_ADS_EVENTS)||{};if(!i[e]){const t=(new Date).getTime()/1e3|0;i[e]=t,_shared_lib_ls__WEBPACK_IMPORTED_MODULE_0__.multiAccountLs.set(LS_ADS_EVENTS,i)}}catch(e){try{r(),console.log(`throw Pixel event error: ${e.message}`)}catch(e){}}t===_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__.PixelNames.playhead_reached_value&&(l=filterPixelReachedEvents(e,l,i)),l.forEach((e=>{sendPixelEvent({pixel:e,onSendError:r})})),triggerAdHtmlEvent(s,t)};function sendPixelEvent({onSendError:e,pixel:t,adEl:i}){if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_4__.partConfigEnabled)("ads_pixels_track_new_events_web_mvk")&&((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_4__.partConfigEnabled)("feed_ads_pixel_tracked_console_log")&&(0,_shared_pixels_utils__WEBPACK_IMPORTED_MODULE_6__.logPixelSent)(t.type,t,i),t.url)){const i=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_1__.vkImage)();i.src=t.url,e&&(i.onerror=e)}}const logPixelEventUntyped=(e,...t)=>{if(e instanceof HTMLElement)return logPixelEvent(e,...t)}},425972:(e,t,i)=>{i.d(t,{logIfAdPostPixelFired:()=>_,logPixelSent:()=>a});var s=i(719583),r=i(167517);const n=(e,t,i,s)=>{console.debug(`[ads pixels log][debug] Pixel "${e}" is touched${t?` with text "${t}"`:""}`,i,s)},o=(e,t,i)=>{n(e,"Pixel rich conditions and fired to track",t,i)},a=(e,t,i)=>{n(e,"Pixel sent",t,i)},_=(e,t,i)=>{if(i)return void o(t,void 0,e);const n=s.AD_POST_CLASS_SELECTOR;(e.classList.contains(n.replaceAll(".",""))||(0,r.hasAdElementAttributes)(e))&&o(t,void 0,e)}},1810:(e,t,i)=>{i.d(t,{ArticleTtsActionType:()=>s,articleTtsActionStatController:()=>n});var s,r=i(581903);!function(e){e.START="start",e.PAUSE="pause",e.CONTINUE="continue",e.SEEK="seek",e.CLOSE="close",e.P10="10p",e.P25="25p",e.P50="50p",e.P75="75p",e.P95="95p",e.P99="99p",e.P100="100p"}(s||(s={}));const n=new class{logEvent(e,t){const i={type:"type_marusia_reading_item",type_marusia_reading_item:e};this.actionStatCollector.logEvent(i,t)}constructor(){this.productStatCollector=new r.ProductionStatCollector,this.actionStatCollector=new r.ActionStatCollector(this.productStatCollector)}}},221097:(e,t,i)=>{i.d(t,{isDebugEnabled:()=>n});var s=i(250682);let r;const n=()=>(void 0!==r||(r=!!s.ls.get("reactions.debug_enabled")),r)},547835:(e,t,i)=>{i.d(t,{reactionLogError:()=>n});var s=i(87223);const r="reactions";function n({error:e,reportError:t=!1}){t&&(0,s.logError)(e,{environment:r}),console.error(e)}},207753:(e,t,i)=>{i.d(t,{DEFAULT_CACHE:()=>_,ORDER_ERRORS:()=>d,ORDER_ITEM_ERRORS:()=>h,SAMPLE_RECIPIENT_ID:()=>l,STICKER_ANIMATION:()=>a,STICKER_IMAGE:()=>o,STICKER_PACK_ICON:()=>r,STICKER_PACK_THUMB:()=>n});var s=i(81277);const r={square_png:{id:"square.png",width:104,height:104},square_15x_png:{id:"square_1.5x.png",width:156,height:156},square_2x_png:{id:"square_2x.png",width:208,height:208},square_3x_png:{id:"square_3x.png",width:312,height:312},square_4x_png:{id:"square_4x.png",width:416,height:416}},n={"102_png":{id:"102.png",width:102,height:102,theme:s.Theme.LIGHT},"51_png":{id:"51.png",width:51,height:51,theme:s.Theme.LIGHT},"68_png":{id:"68.png",width:68,height:68,theme:s.Theme.LIGHT},"34_png":{id:"34.png",width:34,height:34,theme:s.Theme.LIGHT},"60_png":{id:"60.png",width:60,height:60,theme:s.Theme.LIGHT},"30_png":{id:"30.png",width:30,height:30,theme:s.Theme.LIGHT},"102b_png":{id:"102b.png",width:102,height:102,theme:s.Theme.DARK},"51b_png":{id:"51b.png",width:51,height:51,theme:s.Theme.DARK},"68b_png":{id:"68b.png",width:68,height:68,theme:s.Theme.DARK},"34b_png":{id:"34b.png",width:34,height:34,theme:s.Theme.DARK},"60b_png":{id:"60b.png",width:60,height:60,theme:s.Theme.DARK},"30b_png":{id:"30b.png",width:30,height:30,theme:s.Theme.DARK},"44_png":{id:"44.png",width:44,height:44},"22_png":{id:"22.png",width:22,height:22}},o={"64_png":{id:"64.png",width:64,height:64,theme:s.Theme.LIGHT},"128_png":{id:"128.png",width:128,height:128,theme:s.Theme.LIGHT},"256_png":{id:"256.png",width:256,height:256,theme:s.Theme.LIGHT},"352_png":{id:"352.png",width:352,height:352,theme:s.Theme.LIGHT},"512_png":{id:"512.png",width:512,height:512,theme:s.Theme.LIGHT},"64b_png":{id:"64b.png",width:64,height:64,theme:s.Theme.DARK},"128b_png":{id:"128b.png",width:128,height:128,theme:s.Theme.DARK},"256b_png":{id:"256b.png",width:256,height:256,theme:s.Theme.DARK},"352b_png":{id:"352b.png",width:352,height:352,theme:s.Theme.DARK},"512b_png":{id:"512b.png",width:512,height:512,theme:s.Theme.DARK}},a={[s.Theme.LIGHT]:"animation.json",[s.Theme.DARK]:"animation.b.json"},_={products:(0,s.createProductsMap)([]),productIdsQueue:new Set,productsPromise:void 0,productPromises:new Map,stickers:new Map},l=-1;var d,h;!function(e){e.NOT_SIGNED_IN="not_signed_in",e.NO_VALID_ITEMS="no_valid_items"}(d||(d={})),function(e){e.DUPLICATE_PRODUCT="duplicate_product"}(h||(h={}))},81277:(e,t,i)=>{var s;i.d(t,{ProductsByType:()=>c,Theme:()=>s,UserProductStateKey:()=>a,createProductsMap:()=>o,imageSizeCache:()=>n,imageSizesIndex:()=>r,isBasePack:()=>_,isPackProduct:()=>d,isStyleProduct:()=>l}),function(e){e.LIGHT="light",e.DARK="dark",e.DEFAULT="light"}(s||(s={}));const r=Symbol(),n=Symbol(),o=e=>new Map(e);var a;!function(e){e.IsNew="is_new"}(a||(a={}));const _=e=>void 0!==e.sticker_ids,l=e=>void 0!==e.base_id,d=e=>_(e)&&!l(e);var h;!function(e){e.Pack="pack",e.Style="style"}(h||(h={}));class c{add(e){e&&(d(e)?this.pack.add(e):l(e)&&this.style.add(e))}getPack(){return this.pack.values().next().value}getStyles(){return Array.from(this.style.values())}getCount(){return this.pack.size+this.style.size}constructor(e=[]){this.pack=new Set,this.style=new Set,e.forEach((e=>this.add(e)))}}},755513:(e,t,i)=>{i.d(t,{getStickerAnimationUrl:()=>d,getStickerImageUrl:()=>l,getStickerPackIconUrl:()=>h,isSampleOrderItem:()=>c,logStickersError:()=>u});var s=i(81277),r=i(207753),n=i(87223);const o=(e,t,i,r=s.Theme.DEFAULT)=>{const n=window.devicePixelRatio,o=[t*=n,i*=n,r].toString();let a=e[s.imageSizeCache];if(a&&a.has(o)){const e=a.get(o);if(e)return e}a||(a=new Map,e[s.imageSizeCache]=a);const _=(e=>{let t=e[s.imageSizesIndex];return t||(t=Object.values(e).sort(((e,t)=>e.width-t.width||e.height-t.height)),e[s.imageSizesIndex]=t),t})(e).filter((e=>!e.theme||e.theme===r)),l=_.find((e=>e.width>=t&&e.height>=i))||_[_.length-1];return a.set(o,l),l},a=(e,t,i=s.Theme.DEFAULT)=>o(r.STICKER_IMAGE,e,t,i),_=(e,t)=>e.image.base_url+"/"+t.id+(e.image.version?`?${e.image.version}`:"");function l(e,t,i,r=s.Theme.DEFAULT){if(e.render?.images){const{images:s}=e.render;let n;s.sort(((e,t)=>e.width-t.width||e.height-t.height));for(const e of s)if(e.width>=t&&e.height>=i){if(e.theme===r)return e.url;n=e}if(n)return n.url}return _(e,a(t,i,r))}const d=(e,t=s.Theme.DEFAULT)=>e.animation?e.animation.base_url+"/"+r.STICKER_ANIMATION[t]+(e.animation.version?`?${e.animation.version}`:""):"",h=(e,t,i,n=s.Theme.DEFAULT)=>((e,t)=>e.icon.base_url+"/"+t.id+(e.thumb.version?`?${e.thumb.version}`:""))(e,((e,t,i=s.Theme.DEFAULT)=>o(r.STICKER_PACK_ICON,e,t,i))(t,i,n)),c=e=>e.recipient_id===r.SAMPLE_RECIPIENT_ID,u=e=>{(0,n.logError)(new Error(`Stickers: ${e}`),{environment:"stickers"})}},330733:(e,t,i)=>{function s(e){let t=0;if(0===e.length)return t;for(let i=0,s=e.length;i<s;i++){t=(t<<5)-t+e.charCodeAt(i),t|=0}return t}i.d(t,{numberHashCode:()=>s})},545284:(e,t,i)=>{i.d(t,{BADGES_BOX_WIDTH:()=>s,BADGE_COMMENT_SELECTOR:()=>_,BADGE_IMAGE_SIZE_100:()=>d,BADGE_IMAGE_SIZE_20:()=>h,BadgesEventName:()=>o,BadgesEventRef:()=>n,BadgesObjectType:()=>a,DONUT_BADGE_ID:()=>l,LINK_TO_HELP_FOR_AUTHORS:()=>r});const s=640,r="/@authors-badges",n={TAB:"tab",SENDER_LIST:"sender_list",POST_BTN:"post_btn",COLLECTION_BLOCK:"collection_block",COLLECTON_ALL:"collecton_all",NOTIFICATION:"notification",PUSH:"push",PIN:"pin",COMMENT_IMG:"comment_img",COMMENT_LINK:"comment_link",PROFILE_DETAILS:"profile_details"},o={OPEN_BADGE:"open_badge",OPEN_BADGES_ALL:"open_badges_all"};var a;!function(e){e[e.WALL=11]="WALL"}(a||(a={}));const _="BadgeComment",l=38,d=100,h=20},768354:(e,t,i)=>{i.d(t,{generateLatinizedName:()=>h,isPublishNameCorrect:()=>_,updateArticleSnippetsFromQueueByPost:()=>a});var s=i(87223),r=i(7144),n=i(476726);i(868132),i(626490),i(74472),i(705678),i(358172),i(514640),i(507035),i(610989);const o="article_snippet";function a(e){if(!window.vk.id)return;if(!(0,n.partConfigEnabled)("update_private_snippets_by_queue"))return;const t=Array.from(e.querySelectorAll(`.${o}`));if(!t.length)return;const i=[];t.forEach((e=>{if(!window.vk.id||!e.dataset.needUpdate)return;const t=e.dataset.articleRawId;t&&i.push({article_raw_id:t,post_raw_id:e.dataset.postId,is_mini_snippet:(0,r.intval)(e.dataset.isMiniSnippet)})})),i.length&&window.ajax.post("al_articles.php",{act:"get_snippets",article_snippets:JSON.stringify(i)},{onDone:e=>{t.forEach((t=>{t.dataset.articleRawId&&e[t.dataset.articleRawId]&&(t.outerHTML=e[t.dataset.articleRawId])}))},onFail:()=>((0,s.logError)(new Error("Fail: updateArticleSnippetsFromQueueByPost")),!0)})}function _(e){return!!/^[a-z0-9\-]+$/.test(e)&&(!e.includes("--")&&(!e.startsWith("-")&&!e.endsWith("-")&&!(e.length>60)))}const l=[{to:"a",from:"[ÀÁÂÃÄÅÆĀĂĄẠẢẤẦẨẪẬẮẰẲẴẶ]"},{to:"c",from:"[ÇĆĈČ]"},{to:"d",from:"[ÐĎĐÞ]"},{to:"e",from:"[ÈÉÊËĒĔĖĘĚẸẺẼẾỀỂỄỆ]"},{to:"g",from:"[ĜĞĢǴ]"},{to:"h",from:"[ĤḦ]"},{to:"i",from:"[ÌÍÎÏĨĪĮİỈỊ]"},{to:"j",from:"[Ĵ]"},{to:"ij",from:"[Ĳ]"},{to:"k",from:"[Ķ]"},{to:"l",from:"[ĹĻĽŁ]"},{to:"m",from:"[Ḿ]"},{to:"n",from:"[ÑŃŅŇ]"},{to:"o",from:"[ÒÓÔÕÖØŌŎŐỌỎỐỒỔỖỘỚỜỞỠỢǪǬƠ]"},{to:"oe",from:"[Œ]"},{to:"p",from:"[ṕ]"},{to:"r",from:"[ŔŖŘ]"},{to:"s",from:"[ßŚŜŞŠ]"},{to:"t",from:"[ŢŤ]"},{to:"u",from:"[ÙÚÛÜŨŪŬŮŰŲỤỦỨỪỬỮỰƯ]"},{to:"w",from:"[ẂŴẀẄ]"},{to:"x",from:"[ẍ]"},{to:"y",from:"[ÝŶŸỲỴỶỸ]"},{to:"z",from:"[ŹŻŽ]"}],d={1072:"a",1073:"b",1074:"v",1075:"g",1076:"d",1077:"e",1105:"e",1078:"zh",1079:"z",1080:"i",1081:"i",1082:"k",1083:"l",1084:"m",1085:"n",1086:"o",1087:"p",1088:"r",1089:"s",1090:"t",1091:"u",1092:"f",1093:"h",1094:"c",1095:"ch",1096:"sh",1097:"sch",1099:"y",1101:"e",1102:"u",1103:"ya"};function h(e,t){e=e.toLowerCase();let i="",s=!1;const r="-qwertyuiopasdfghjklzxcvbnm0123456789".split("");l.forEach((t=>{e=e.replace(new RegExp(t.from,"gi"),t.to)}));for(let t=0;t<e.length;t++)if(/\s/.test(e[t]))s||(i+="-",s=!0);else if(r.includes(e[t]))i+=e[t],s=!1;else{let r=d[e.charCodeAt(t)];r&&(i+=r,s=!1)}return i=i.substr(0,t),i=i.replace(/-*$/,"").replace(/^-*/,"").replace(/-+/g,"-"),i}},276901:(e,t,i)=>{i.d(t,{highlightModule:()=>d});var s=i(742328),r=i(22307),n=i(688701),o=i(452314),a=i(171444);let _,l;function d(e){const t=document.getElementById(e.module);if(!t||!t.classList.contains("module"))return;window.cur.__narrowBarForceNotFixed=!0;const i=e.speed?e.speed:300;(0,n.scrollToY)((0,o.getXY)(t)[1]-100,i);const d=()=>{_&&(_.hideTT(),(0,n.enableBodyScroll)(),delete window.cur.__narrowBarForceNotFixed,(0,r.updateNarrow)(),e.onClose&&e.onClose())};_=new s.default(t,e.text,{highlight:!0,width:250,offset:[0,-17],side:"bottom",withCloseButton:!0,onBGClick:d,onCloseButtonClick:d}),_.show(),(0,n.disableBodyScroll)(),e.autoCancelDelay&&(l=setTimeout((()=>{d(),l=null}),e.autoCancelDelay),(0,a.pushNavDestroy)((()=>{l&&clearTimeout(l)})))}},142718:(e,t,i)=>{i.d(t,{REACTIONS_COUNTS_RESPONSE_FIELD:()=>_,SIZE_128:()=>a,SIZE_32:()=>r,SIZE_40:()=>n,SIZE_96:()=>o,SUPPORTED_OBJECT_TYPES:()=>s,WK_SECTION_PREFIX_REACTIONS:()=>l});const s={wall:"wall",wall_reply:"wall_reply"},r={width:32,height:32},n={width:40,height:40},o={width:96,height:96},a={width:128,height:128},_="reactions_counts",l="reactions"},283080:(e,t,i)=>{i.d(t,{ENABLED_IN_POST_REPLY:()=>r,isDebugEnabled:()=>s.isDebugEnabled});var s=i(221097);const r=!1},259058:(e,t,i)=>{i.d(t,{reactionLogError:()=>n});var s=i(547835),r=i(185105);const n=({error:e})=>{const t=(0,r.getReactionConfig)(),i=t?.reportJsErrors??!1;(0,s.reactionLogError)({error:e,reportError:i})}},185105:(e,t,i)=>{i.d(t,{getReactionConfig:()=>g,getReactionSet:()=>c,storageAddSets:()=>h,storageSetConfig:()=>u});var s=i(942451),r=i(8520),n=i(198882),o=i(259058),a=i(142718),_=i(283080);const l=(0,s.makeSharedState)("reactions-storage",(()=>new Map),{version:0}),d=(0,s.makeSharedState)("reactions-config",(()=>({config:void 0})),{version:0}),h=e=>{(0,_.isDebugEnabled)()&&console.log(e),Object.entries(e).forEach((([e,t])=>{const i=(0,n.validateReactionSetPayloaditems)(t,e);if(i)return void(0,o.reactionLogError)({error:i.error});const s=t.map((e=>({...e,title:(0,r.decodeHTMLEntities)(e.title)})));l().set(e,(0,n.prepareReactionMenuSet)(e,s,{imageMenuSize:a.SIZE_96,imagePreviewSize:a.SIZE_32,imageStoryPanelSize:a.SIZE_128,imageStoryPreviewSize:a.SIZE_40}))}))},c=e=>{const t=l().get(e);if(t)return t;{const t=new Error(`Reaction set not found: ${e}`);(0,o.reactionLogError)({error:t})}},u=e=>{(0,_.isDebugEnabled)()&&console.log(e);const t=(0,n.parseReactionMenuConfig)(e);t?d().config=t:console.warn("Reactions: invalid menu config passed",e)},g=()=>{const e=d()?.config;return e}},30884:(e,t,i)=>{i.d(t,{getReactionsButtonPostTemplate:()=>u,getReactionsButtonReplyTemplate:()=>g,likeDataReactionsFields:()=>m});var s=i(476726),r=i(452314),n=i(142718),o=i(185105),a=i(198882),_=i(109971),l=i(545284);const d=(e,t,i)=>{const s=(e=>{try{const t=JSON.parse(e);if(null!==t&&"object"!=typeof t)return;return t}catch(e){return}})(e)?.set_id,n="string"==typeof s?s:void 0;if(!t||!n)return;const _=(0,o.getReactionSet)(n);return _?{likeClassName:"like_btn--hidden PostBottomAction--hidden",template:(0,r.rs)(t,{reactions_button_title:(0,a.getDefaultReactionTitle)(_)||"",reactions_set_id:n,badges_object_type:l.BadgesObjectType.WALL,badges_object_owner_id:i?.objectOwnerId||0,badges_object_id:i?.objectId||0,badges_ref:l.BadgesEventRef.POST_BTN})}:void 0},h=(e,t)=>t.length>e,c=e=>{const t=e[2],[i,s]=t.split("_");return{objectOwnerId:Number(i),objectId:Number(s)}},u=(e,t)=>{const i=c(e),s=t?.wallTpl?.post_likes_reactions,r=h(14,e)?e[14]:void 0;if("string"==typeof r)return d(r,s,i)},g=(e,t)=>{const i=c(e),r=t?.wallTpl?.reply_likes_reactions;if(!(0,s.partConfigEnabled)("reactions_enabled_post_replies"))return;const n=h(14,e)?e[14]:void 0;return"string"==typeof n?d(n,r,i):void 0},p=e=>{let t=JSON.parse(e);if(null===t||"object"==typeof t||Array.isArray(t)){if(Array.isArray(t)){t=(0,_.reactionCountsBrandWrap)((i=t,Object.assign({},i)))}var i;return t}},E=e=>{const t=h(5,e)?e[5]:void 0;if("string"!=typeof t)return;const i=(e=>{const t=e.indexOf(";"),i=e.substr(0,t),s=e.substr(t+1);if("1"===i)return p(s)})(t);return i?{counts:i}:void 0},m=e=>{const t=E(e);return{[n.REACTIONS_COUNTS_RESPONSE_FIELD]:t?.counts}}},427360:(e,t,i)=>{var s;i.d(t,{REGULAR_SIZES:()=>n,SIZE_512:()=>r,STICKER_ICON_CLASS:()=>a,STICKER_ROW_CLASS:()=>o,StickerSize:()=>s}),function(e){e[e.SMALL=128]="SMALL",e[e.MIDDLE=168]="MIDDLE",e[e.BIG=208]="BIG"}(s||(s={}));const r=512,n=[64,128,256,352,r],o="stickerRow",a="stickerIcon"},550072:(e,t,i)=>{i.d(t,{findClosestStickerSize:()=>w,getBoxLayerWrap:()=>c,getLangCode:()=>m,getPurchaseResult:()=>p,hideLoader:()=>g,showLoader:()=>u,updateStickersFromQueue:()=>E});var s=i(645024),r=i(610989),n=i(216147),o=i(452314),a=i(850101),_=i(81277),l=i(427360),d=i(755513);function h(){return document.querySelector("#box_loader")}function c(){return document.querySelector("#box_layer_wrap")}function u(){const e=h();(0,a.refreshBoxLoaderCoords)(),(0,o.show)(e),(0,o.show)(c())}function g(){(0,o.hide)(h())}function p(e){const t=new _.ProductsByType(e.items.filter((e=>!e.error)).map((e=>e.product))),i=t.getPack(),n=t.getStyles();if(i)return n.length?(0,s.langStr)(r.getLang("purchases_stickers_purchase_result_pack_and_styles",n.length),"pack_title",i.title,"n",n.length):(0,s.langStr)(r.getLang("purchases_stickers_purchase_result_pack"),"title",i.title);if(n.length)switch(n.length){case 1:return(0,s.langStr)(r.getLang("purchases_stickers_purchase_result_1_style"),"title",n[0].title);case 2:return(0,s.langStr)(r.getLang("purchases_stickers_purchase_result_2_styles"),"title1",n[0].title,"title2",n[1].title);case 3:return(0,s.langStr)(r.getLang("purchases_stickers_purchase_result_3_styles"),"title1",n[0].title,"title2",n[1].title,"title3",n[2].title);case 4:return(0,s.langStr)(r.getLang("purchases_stickers_purchase_result_3_styles_and_1_more"),"title1",n[0].title,"title2",n[1].title,"title3",n[2].title);default:const e=n.length-3;return(0,s.langStr)(r.getLang("purchases_stickers_purchase_result_3_styles_and_n_more",e),"title1",n[0].title,"title2",n[1].title,"title3",n[2].title,"n",e)}return null}function E(e){!function(e){const t=n.colorScheme.isDarkScheme()?"data-src-dark":"data-src-light";e.querySelectorAll(`.sticker_img[${t}]`).forEach((e=>{const i=e.getAttribute(t);i&&(e.src=i)}))}(e)}const m=()=>window.vk.lang||"ru",w=e=>e>l.SIZE_512?((0,d.logStickersError)("Нет размера стикера больше 512px"),l.SIZE_512):l.REGULAR_SIZES.find((t=>t>=e))},824738:(e,t,i)=>{i.d(t,{highlightNarrativeBlock:()=>p,prepareStoriesForPublishing:()=>u,updateNarrativeBlock:()=>g,updateNarrativeSnippetsFromQueueByPost:()=>E});var s=i(452314),r=i(850101),n=i(276901),o=i(610989),a=i(7144),_=i(87223),l=i(476726),d=i(388078),h=i(582351);const c="NarrativeSnippet";function u(e){return e.map((e=>e.id)).join(",")}function g(e=!1){const t=(0,a.intval)(window.cur.oid);d.Ranges.isUserId(t)&&"profile"===window.cur.module||(window.cur.narrativeBlock?window.ajax.post("al_stories.php",{act:"get_narrative_block",owner_id:t},{onDone:e=>{const t=(0,a.intval)(window.cur.oid),i=document.getElementById(`narratives_module${t}_wrapper`);if(i)if(e)(0,s.domReplaceEl)(i,e),window.cur.narrativeBlock&&window.cur.narrativeBlock.destroy(),window.NarrativeBlock&&(window.cur.narrativeBlock=new window.NarrativeBlock);else{const e=i.parentElement;e?.children.length&&e?.children.length>1?i.remove():e?.remove(),window.cur.narrativeBlock&&window.cur.narrativeBlock.destroy(),delete window.cur.narrativeBlock}(0,h.removeStoryList)(`narratives${t}`)}}):e&&function(e){window.boxQueue.hideAll();const t=document.querySelector("#box_layer_wrap"),i=document.querySelector("#box_loader");window.nav.reload({onDone:()=>{e&&e()},showProgress:()=>{(0,s.show)(t),(0,s.show)(i),(0,r.refreshBoxLoaderCoords)()},hideProgress:()=>{(0,s.hide)(t),(0,s.hide)(i)}})}((()=>{window.cur.needNarrativeOnboard=!0})))}function p(e){if(!e)return;const t=`narratives_module${window.vk.id}`;(0,n.highlightModule)({module:t,text:o.getLang("stories_narrative_block_onboarding_text"),onClose:()=>{delete window.cur.needNarrativeOnboard,window.ajax.post("al_index.php",{act:"hide_feature_tt",hash:e,type:"profile_narrative"})},autoCancelDelay:1e4,speed:600})}function E(e){if(!window.vk.id)return;if(!(0,l.partConfigEnabled)("update_private_snippets_by_queue"))return;const t=Array.from(e.querySelectorAll(`.${c}`));if(!t.length)return;const i=[];t.forEach((e=>{if(!window.vk.id||!e.dataset.needUpdate)return;const t=e.dataset.narrativeRawId;t&&i.push({narrative_raw_id:t,from:e.dataset.from})})),i.length&&window.ajax.post("al_stories.php",{act:"get_narrative_snippets",narrative_snippets:JSON.stringify(i)},{onDone:e=>{t.forEach((t=>{t.dataset.narrativeRawId&&e[t.dataset.narrativeRawId]&&(t.outerHTML=e[t.dataset.narrativeRawId])}))},onFail:()=>((0,_.logError)(new Error("Fail: updateNarrativeSnippetFromQueueByPost")),!0)})}},948585:(e,t,i)=>{i.d(t,{highlightUpdatedPost:()=>r,highlightUpdatedPostContent:()=>n});var s=i(226095);const r=e=>{(0,s.triggerAnimationClass)(e,"post_highlight_updated",3e3)},n=e=>{(0,s.triggerAnimationClass)(e,"post_highlight_updated_content",3e3)}},37645:(e,t,i)=>{i.d(t,{floatingButtonCollapseAllRepliesHide:()=>n,floatingButtonCollapseAllRepliesShow:()=>o,highlightUpdatedReply:()=>l,highlightUpdatedReplyContent:()=>d,loadRepliesLinkIsVisible:()=>_,loadRepliesLinkShow:()=>a});var s=i(226095),r=i(452314);const n=e=>{e instanceof HTMLElement&&e.classList.contains("replies_side")&&e.classList.add("replies_side_hidden")},o=e=>{e instanceof HTMLElement&&e.classList.contains("replies_side")&&e.classList.remove("replies_side_hidden")},a=e=>{e instanceof HTMLElement&&e.classList.contains("replies_next")&&e.classList.add("replies_next_shown")},_=e=>!!(e instanceof HTMLElement&&e.classList.contains("replies_next"))&&(e.classList.contains("replies_next_shown")||(0,r.isVisible)(e)),l=e=>{(0,s.triggerAnimationClass)(e,"reply_highlight_updated",3e3)},d=e=>{(0,s.triggerAnimationClass)(e,"reply_highlight_updated_content",3e3)}},524679:(e,t,i)=>{i.d(t,{getFixedReplyField:()=>a,initCommentsHandlers:()=>h,isInlineCommentsEnabled:()=>l,replyBoxOwnerIsNftFromAttr:()=>_});var s=i(823875),r=i(489944),n=i(681589),o=i(476726);const a=()=>window.cur.wallLayer?document.getElementById("wl_reply_form")??void 0:"full"===window.cur.wallType?document.querySelector(`#reply_box_wrap${window.cur.oid}_${window.cur.pid} .reply_box_inner_wrap`)??void 0:void 0,_=e=>"1"===e;function l(){return(0,o.partConfigEnabled)("feed_inline_comments_web")}function d(e,t,i){const s=e.match(/^(-?\d+)_(wall)?(\d+)$/);if(!s)return;const r=(o=t,o?.closest(".reply"));var o;const a=r?.id.split("_")[1],_=(0,n.getTrackCodeFromPost)(t),l=`wall${s[1]}_${s[3]}`;window.Wall.postFull(l,!1,{isPostCommentsDisabled:i.isPostCommentsDisabled,isInlineCommentsEnabled:i.isInlineCommentsEnabled,isInputFocusEnabled:i.isPostCommentsDisabled&&!i.isInputFocusDisabled,reply:i.isInlineCommentsEnabled?a:null,clickSource:i.clickSource,trackCode:_})}function h(){(0,s.tq)().setInteractiveHandler("PostBottomAction/comment",(e=>{const t=e.payload.target;if(!t)return;const i=(0,r.getPostElemByChildEl)(t),s=i?.getAttribute("data-post-id");if(!s||!i)return;const n=t?.classList.contains("replies_next_inline");d(s,t,{isPostCommentsDisabled:"true"===i?.getAttribute("data-post-comments-disabled"),isInlineCommentsEnabled:!1,isInputFocusDisabled:n,clickSource:"comments_button"})})),(0,s.tq)().setInteractiveHandler("FeedReplies/showCommentInLayer",(e=>{if(window.cur.editingPost)return;const t=e.payload.target;if(!t)return;const i=e.payload.event?.target;if(function(e){return e?.closest(".wall_reply_text a")}(i))return;const s=(0,r.getPostElemByChildEl)(t),n=s?.getAttribute("data-post-id");if(!n||!s)return;d(n,t,{isPostCommentsDisabled:!1,isInlineCommentsEnabled:"true"===s?.getAttribute("data-post-inline-comments"),clickSource:"inline_comment"})}))}},358172:(e,t,i)=>{e.exports=i.p+"icons/d7ccdb168db391d6a891.png"}}]);try{stManager.done("dist/web/chunks/429e74a8.a0a0c63f.js")}catch(e){}